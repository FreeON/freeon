       Z=Prim%Zeta
       TwoZ=Two*Prim%Zeta
       SELECT CASE(Prim%Ell)
       CASE(0)
          DO I=1,NGrid 
             RPx=Cube%Grid(I,1)-Prim%P(1)
             RPy=Cube%Grid(I,2)-Prim%P(2)
             RPz=Cube%Grid(I,3)-Prim%P(3)
             RP2=RPx**2+RPy**2+RPz**2
             X=Z*RP2
             IF(X<Exp_Switch)THEN
                J=AINT(X*Exp_Grid)
                Xpt=Exp_0(J)+X*(Exp_1(J)+X*(Exp_2(J)+X*(Exp_3(J)+X*Exp_4(J))))
                LambdaX(0)=Xpt
                LambdaY(0)=One
                LambdaZ(0)=One
                LambdaX(1)=TwoZ*RPx*Xpt
                LambdaY(1)=TwoZ*RPy
                LambdaZ(1)=TwoZ*RPz
                Wght=Cube%Wght(I)
                !Q&D...
                DO iSDen=SDBeg,NSDen-1
                  LMN=(iSDen-SDBeg)*OffSDen
                  I0=I+iSDen*NGrid
                  dEdRho=Cube%Vals(I0,1)
                  dEdAbsGradRho2=Cube%Vals(I0,2)
                  GradRhoX=Cube%Vals(I0,3)
                  GradRhoY=Cube%Vals(I0,4)
                  GradRhoZ=Cube%Vals(I0,5)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(1+LMN)=Ket(1+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                ENDDO
             ENDIF
          ENDDO
       CASE(1)
          DO I=1,NGrid 
             RPx=Cube%Grid(I,1)-Prim%P(1)
             RPy=Cube%Grid(I,2)-Prim%P(2)
             RPz=Cube%Grid(I,3)-Prim%P(3)
             RP2=RPx**2+RPy**2+RPz**2
             X=Z*RP2
             IF(X<Exp_Switch)THEN
                J=AINT(X*Exp_Grid)
                Xpt=Exp_0(J)+X*(Exp_1(J)+X*(Exp_2(J)+X*(Exp_3(J)+X*Exp_4(J))))
                LambdaX(0)=Xpt
                LambdaY(0)=One
                LambdaZ(0)=One
                LambdaX(1)=TwoZ*RPx*Xpt
                LambdaY(1)=TwoZ*RPy
                LambdaZ(1)=TwoZ*RPz
                LambdaX(2)=TwoZ*(RPX*LambdaX(1)-LambdaX(0))
                LambdaY(2)=TwoZ*(RPY*LambdaY(1)-LambdaY(0))
                LambdaZ(2)=TwoZ*(RPZ*LambdaZ(1)-LambdaZ(0))
                Wght=Cube%Wght(I)
                !Q&D...
                DO iSDen=SDBeg,NSDen-1
                  LMN=(iSDen-SDBeg)*OffSDen
                  I0=I+iSDen*NGrid
                  dEdRho=Cube%Vals(I0,1)
                  dEdAbsGradRho2=Cube%Vals(I0,2)
                  GradRhoX=Cube%Vals(I0,3)
                  GradRhoY=Cube%Vals(I0,4)
                  GradRhoZ=Cube%Vals(I0,5)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(1+LMN)=Ket(1+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(4+LMN)=Ket(4+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(3+LMN)=Ket(3+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(2+LMN)=Ket(2+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                ENDDO
             ENDIF
          ENDDO
       CASE(2)
          DO I=1,NGrid 
             RPx=Cube%Grid(I,1)-Prim%P(1)
             RPy=Cube%Grid(I,2)-Prim%P(2)
             RPz=Cube%Grid(I,3)-Prim%P(3)
             RP2=RPx**2+RPy**2+RPz**2
             X=Z*RP2
             IF(X<Exp_Switch)THEN
                J=AINT(X*Exp_Grid)
                Xpt=Exp_0(J)+X*(Exp_1(J)+X*(Exp_2(J)+X*(Exp_3(J)+X*Exp_4(J))))
                LambdaX(0)=Xpt
                LambdaY(0)=One
                LambdaZ(0)=One
                LambdaX(1)=TwoZ*RPx*Xpt
                LambdaY(1)=TwoZ*RPy
                LambdaZ(1)=TwoZ*RPz
                LambdaX(2)=TwoZ*(RPX*LambdaX(1)-LambdaX(0))
                LambdaX(3)=TwoZ*(RPX*LambdaX(2)-2.D0*LambdaX(1))
                LambdaY(2)=TwoZ*(RPY*LambdaY(1)-LambdaY(0))
                LambdaY(3)=TwoZ*(RPY*LambdaY(2)-2.D0*LambdaY(1))
                LambdaZ(2)=TwoZ*(RPZ*LambdaZ(1)-LambdaZ(0))
                LambdaZ(3)=TwoZ*(RPZ*LambdaZ(2)-2.D0*LambdaZ(1))
                Wght=Cube%Wght(I)
                !Q&D...
                DO iSDen=SDBeg,NSDen-1
                  LMN=(iSDen-SDBeg)*OffSDen
                  I0=I+iSDen*NGrid
                  dEdRho=Cube%Vals(I0,1)
                  dEdAbsGradRho2=Cube%Vals(I0,2)
                  GradRhoX=Cube%Vals(I0,3)
                  GradRhoY=Cube%Vals(I0,4)
                  GradRhoZ=Cube%Vals(I0,5)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(1+LMN)=Ket(1+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(4+LMN)=Ket(4+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(10+LMN)=Ket(10+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(3+LMN)=Ket(3+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(9+LMN)=Ket(9+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(7+LMN)=Ket(7+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(2+LMN)=Ket(2+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(8+LMN)=Ket(8+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(6+LMN)=Ket(6+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(5+LMN)=Ket(5+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                ENDDO
             ENDIF
          ENDDO
       CASE(3)
          DO I=1,NGrid 
             RPx=Cube%Grid(I,1)-Prim%P(1)
             RPy=Cube%Grid(I,2)-Prim%P(2)
             RPz=Cube%Grid(I,3)-Prim%P(3)
             RP2=RPx**2+RPy**2+RPz**2
             X=Z*RP2
             IF(X<Exp_Switch)THEN
                J=AINT(X*Exp_Grid)
                Xpt=Exp_0(J)+X*(Exp_1(J)+X*(Exp_2(J)+X*(Exp_3(J)+X*Exp_4(J))))
                LambdaX(0)=Xpt
                LambdaY(0)=One
                LambdaZ(0)=One
                LambdaX(1)=TwoZ*RPx*Xpt
                LambdaY(1)=TwoZ*RPy
                LambdaZ(1)=TwoZ*RPz
                LambdaX(2)=TwoZ*(RPX*LambdaX(1)-LambdaX(0))
                LambdaX(3)=TwoZ*(RPX*LambdaX(2)-2.D0*LambdaX(1))
                LambdaX(4)=TwoZ*(RPX*LambdaX(3)-3.D0*LambdaX(2))
                LambdaY(2)=TwoZ*(RPY*LambdaY(1)-LambdaY(0))
                LambdaY(3)=TwoZ*(RPY*LambdaY(2)-2.D0*LambdaY(1))
                LambdaY(4)=TwoZ*(RPY*LambdaY(3)-3.D0*LambdaY(2))
                LambdaZ(2)=TwoZ*(RPZ*LambdaZ(1)-LambdaZ(0))
                LambdaZ(3)=TwoZ*(RPZ*LambdaZ(2)-2.D0*LambdaZ(1))
                LambdaZ(4)=TwoZ*(RPZ*LambdaZ(3)-3.D0*LambdaZ(2))
                Wght=Cube%Wght(I)
                !Q&D...
                DO iSDen=SDBeg,NSDen-1
                  LMN=(iSDen-SDBeg)*OffSDen
                  I0=I+iSDen*NGrid
                  dEdRho=Cube%Vals(I0,1)
                  dEdAbsGradRho2=Cube%Vals(I0,2)
                  GradRhoX=Cube%Vals(I0,3)
                  GradRhoY=Cube%Vals(I0,4)
                  GradRhoZ=Cube%Vals(I0,5)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(1+LMN)=Ket(1+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(4+LMN)=Ket(4+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(10+LMN)=Ket(10+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(20+LMN)=Ket(20+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(3+LMN)=Ket(3+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(9+LMN)=Ket(9+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(19+LMN)=Ket(19+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(7+LMN)=Ket(7+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(17+LMN)=Ket(17+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(14+LMN)=Ket(14+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(2+LMN)=Ket(2+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(8+LMN)=Ket(8+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(18+LMN)=Ket(18+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(6+LMN)=Ket(6+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(16+LMN)=Ket(16+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(13+LMN)=Ket(13+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(5+LMN)=Ket(5+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(15+LMN)=Ket(15+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(12+LMN)=Ket(12+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(11+LMN)=Ket(11+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                ENDDO
             ENDIF
          ENDDO
       CASE(4)
          DO I=1,NGrid 
             RPx=Cube%Grid(I,1)-Prim%P(1)
             RPy=Cube%Grid(I,2)-Prim%P(2)
             RPz=Cube%Grid(I,3)-Prim%P(3)
             RP2=RPx**2+RPy**2+RPz**2
             X=Z*RP2
             IF(X<Exp_Switch)THEN
                J=AINT(X*Exp_Grid)
                Xpt=Exp_0(J)+X*(Exp_1(J)+X*(Exp_2(J)+X*(Exp_3(J)+X*Exp_4(J))))
                LambdaX(0)=Xpt
                LambdaY(0)=One
                LambdaZ(0)=One
                LambdaX(1)=TwoZ*RPx*Xpt
                LambdaY(1)=TwoZ*RPy
                LambdaZ(1)=TwoZ*RPz
                LambdaX(2)=TwoZ*(RPX*LambdaX(1)-LambdaX(0))
                LambdaX(3)=TwoZ*(RPX*LambdaX(2)-2.D0*LambdaX(1))
                LambdaX(4)=TwoZ*(RPX*LambdaX(3)-3.D0*LambdaX(2))
                LambdaX(5)=TwoZ*(RPX*LambdaX(4)-4.D0*LambdaX(3))
                LambdaY(2)=TwoZ*(RPY*LambdaY(1)-LambdaY(0))
                LambdaY(3)=TwoZ*(RPY*LambdaY(2)-2.D0*LambdaY(1))
                LambdaY(4)=TwoZ*(RPY*LambdaY(3)-3.D0*LambdaY(2))
                LambdaY(5)=TwoZ*(RPY*LambdaY(4)-4.D0*LambdaY(3))
                LambdaZ(2)=TwoZ*(RPZ*LambdaZ(1)-LambdaZ(0))
                LambdaZ(3)=TwoZ*(RPZ*LambdaZ(2)-2.D0*LambdaZ(1))
                LambdaZ(4)=TwoZ*(RPZ*LambdaZ(3)-3.D0*LambdaZ(2))
                LambdaZ(5)=TwoZ*(RPZ*LambdaZ(4)-4.D0*LambdaZ(3))
                Wght=Cube%Wght(I)
                !Q&D...
                DO iSDen=SDBeg,NSDen-1
                  LMN=(iSDen-SDBeg)*OffSDen
                  I0=I+iSDen*NGrid
                  dEdRho=Cube%Vals(I0,1)
                  dEdAbsGradRho2=Cube%Vals(I0,2)
                  GradRhoX=Cube%Vals(I0,3)
                  GradRhoY=Cube%Vals(I0,4)
                  GradRhoZ=Cube%Vals(I0,5)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(1+LMN)=Ket(1+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(4+LMN)=Ket(4+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(10+LMN)=Ket(10+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(20+LMN)=Ket(20+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(35+LMN)=Ket(35+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(3+LMN)=Ket(3+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(9+LMN)=Ket(9+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(19+LMN)=Ket(19+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(34+LMN)=Ket(34+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(7+LMN)=Ket(7+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(17+LMN)=Ket(17+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(32+LMN)=Ket(32+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(14+LMN)=Ket(14+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(29+LMN)=Ket(29+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(25+LMN)=Ket(25+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(2+LMN)=Ket(2+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(8+LMN)=Ket(8+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(18+LMN)=Ket(18+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(33+LMN)=Ket(33+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(6+LMN)=Ket(6+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(16+LMN)=Ket(16+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(31+LMN)=Ket(31+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(13+LMN)=Ket(13+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(28+LMN)=Ket(28+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(24+LMN)=Ket(24+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(5+LMN)=Ket(5+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(15+LMN)=Ket(15+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(30+LMN)=Ket(30+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(12+LMN)=Ket(12+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(27+LMN)=Ket(27+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(23+LMN)=Ket(23+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(11+LMN)=Ket(11+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(26+LMN)=Ket(26+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(22+LMN)=Ket(22+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(21+LMN)=Ket(21+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                ENDDO
             ENDIF
          ENDDO
       CASE(5)
          DO I=1,NGrid 
             RPx=Cube%Grid(I,1)-Prim%P(1)
             RPy=Cube%Grid(I,2)-Prim%P(2)
             RPz=Cube%Grid(I,3)-Prim%P(3)
             RP2=RPx**2+RPy**2+RPz**2
             X=Z*RP2
             IF(X<Exp_Switch)THEN
                J=AINT(X*Exp_Grid)
                Xpt=Exp_0(J)+X*(Exp_1(J)+X*(Exp_2(J)+X*(Exp_3(J)+X*Exp_4(J))))
                LambdaX(0)=Xpt
                LambdaY(0)=One
                LambdaZ(0)=One
                LambdaX(1)=TwoZ*RPx*Xpt
                LambdaY(1)=TwoZ*RPy
                LambdaZ(1)=TwoZ*RPz
                LambdaX(2)=TwoZ*(RPX*LambdaX(1)-LambdaX(0))
                LambdaX(3)=TwoZ*(RPX*LambdaX(2)-2.D0*LambdaX(1))
                LambdaX(4)=TwoZ*(RPX*LambdaX(3)-3.D0*LambdaX(2))
                LambdaX(5)=TwoZ*(RPX*LambdaX(4)-4.D0*LambdaX(3))
                LambdaX(6)=TwoZ*(RPX*LambdaX(5)-5.D0*LambdaX(4))
                LambdaY(2)=TwoZ*(RPY*LambdaY(1)-LambdaY(0))
                LambdaY(3)=TwoZ*(RPY*LambdaY(2)-2.D0*LambdaY(1))
                LambdaY(4)=TwoZ*(RPY*LambdaY(3)-3.D0*LambdaY(2))
                LambdaY(5)=TwoZ*(RPY*LambdaY(4)-4.D0*LambdaY(3))
                LambdaY(6)=TwoZ*(RPY*LambdaY(5)-5.D0*LambdaY(4))
                LambdaZ(2)=TwoZ*(RPZ*LambdaZ(1)-LambdaZ(0))
                LambdaZ(3)=TwoZ*(RPZ*LambdaZ(2)-2.D0*LambdaZ(1))
                LambdaZ(4)=TwoZ*(RPZ*LambdaZ(3)-3.D0*LambdaZ(2))
                LambdaZ(5)=TwoZ*(RPZ*LambdaZ(4)-4.D0*LambdaZ(3))
                LambdaZ(6)=TwoZ*(RPZ*LambdaZ(5)-5.D0*LambdaZ(4))
                Wght=Cube%Wght(I)
                !Q&D...
                DO iSDen=SDBeg,NSDen-1
                  LMN=(iSDen-SDBeg)*OffSDen
                  I0=I+iSDen*NGrid
                  dEdRho=Cube%Vals(I0,1)
                  dEdAbsGradRho2=Cube%Vals(I0,2)
                  GradRhoX=Cube%Vals(I0,3)
                  GradRhoY=Cube%Vals(I0,4)
                  GradRhoZ=Cube%Vals(I0,5)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(1+LMN)=Ket(1+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(4+LMN)=Ket(4+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(10+LMN)=Ket(10+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(20+LMN)=Ket(20+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(35+LMN)=Ket(35+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(56+LMN)=Ket(56+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(3+LMN)=Ket(3+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(9+LMN)=Ket(9+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(19+LMN)=Ket(19+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(34+LMN)=Ket(34+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(55+LMN)=Ket(55+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(7+LMN)=Ket(7+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(17+LMN)=Ket(17+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(32+LMN)=Ket(32+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(53+LMN)=Ket(53+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(14+LMN)=Ket(14+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(29+LMN)=Ket(29+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(50+LMN)=Ket(50+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(25+LMN)=Ket(25+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(46+LMN)=Ket(46+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(5)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(41+LMN)=Ket(41+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(2+LMN)=Ket(2+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(8+LMN)=Ket(8+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(18+LMN)=Ket(18+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(33+LMN)=Ket(33+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(54+LMN)=Ket(54+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(6+LMN)=Ket(6+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(16+LMN)=Ket(16+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(31+LMN)=Ket(31+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(52+LMN)=Ket(52+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(13+LMN)=Ket(13+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(28+LMN)=Ket(28+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(49+LMN)=Ket(49+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(24+LMN)=Ket(24+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(45+LMN)=Ket(45+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(40+LMN)=Ket(40+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(5+LMN)=Ket(5+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(15+LMN)=Ket(15+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(30+LMN)=Ket(30+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(51+LMN)=Ket(51+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(12+LMN)=Ket(12+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(27+LMN)=Ket(27+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(48+LMN)=Ket(48+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(23+LMN)=Ket(23+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(44+LMN)=Ket(44+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(39+LMN)=Ket(39+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(11+LMN)=Ket(11+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(26+LMN)=Ket(26+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(47+LMN)=Ket(47+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(22+LMN)=Ket(22+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(43+LMN)=Ket(43+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(38+LMN)=Ket(38+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(21+LMN)=Ket(21+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(42+LMN)=Ket(42+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(37+LMN)=Ket(37+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(6)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(5)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(36+LMN)=Ket(36+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                ENDDO
             ENDIF
          ENDDO
       CASE(6)
          DO I=1,NGrid 
             RPx=Cube%Grid(I,1)-Prim%P(1)
             RPy=Cube%Grid(I,2)-Prim%P(2)
             RPz=Cube%Grid(I,3)-Prim%P(3)
             RP2=RPx**2+RPy**2+RPz**2
             X=Z*RP2
             IF(X<Exp_Switch)THEN
                J=AINT(X*Exp_Grid)
                Xpt=Exp_0(J)+X*(Exp_1(J)+X*(Exp_2(J)+X*(Exp_3(J)+X*Exp_4(J))))
                LambdaX(0)=Xpt
                LambdaY(0)=One
                LambdaZ(0)=One
                LambdaX(1)=TwoZ*RPx*Xpt
                LambdaY(1)=TwoZ*RPy
                LambdaZ(1)=TwoZ*RPz
                LambdaX(2)=TwoZ*(RPX*LambdaX(1)-LambdaX(0))
                LambdaX(3)=TwoZ*(RPX*LambdaX(2)-2.D0*LambdaX(1))
                LambdaX(4)=TwoZ*(RPX*LambdaX(3)-3.D0*LambdaX(2))
                LambdaX(5)=TwoZ*(RPX*LambdaX(4)-4.D0*LambdaX(3))
                LambdaX(6)=TwoZ*(RPX*LambdaX(5)-5.D0*LambdaX(4))
                LambdaX(7)=TwoZ*(RPX*LambdaX(6)-6.D0*LambdaX(5))
                LambdaY(2)=TwoZ*(RPY*LambdaY(1)-LambdaY(0))
                LambdaY(3)=TwoZ*(RPY*LambdaY(2)-2.D0*LambdaY(1))
                LambdaY(4)=TwoZ*(RPY*LambdaY(3)-3.D0*LambdaY(2))
                LambdaY(5)=TwoZ*(RPY*LambdaY(4)-4.D0*LambdaY(3))
                LambdaY(6)=TwoZ*(RPY*LambdaY(5)-5.D0*LambdaY(4))
                LambdaY(7)=TwoZ*(RPY*LambdaY(6)-6.D0*LambdaY(5))
                LambdaZ(2)=TwoZ*(RPZ*LambdaZ(1)-LambdaZ(0))
                LambdaZ(3)=TwoZ*(RPZ*LambdaZ(2)-2.D0*LambdaZ(1))
                LambdaZ(4)=TwoZ*(RPZ*LambdaZ(3)-3.D0*LambdaZ(2))
                LambdaZ(5)=TwoZ*(RPZ*LambdaZ(4)-4.D0*LambdaZ(3))
                LambdaZ(6)=TwoZ*(RPZ*LambdaZ(5)-5.D0*LambdaZ(4))
                LambdaZ(7)=TwoZ*(RPZ*LambdaZ(6)-6.D0*LambdaZ(5))
                Wght=Cube%Wght(I)
                !Q&D...
                DO iSDen=SDBeg,NSDen-1
                  LMN=(iSDen-SDBeg)*OffSDen
                  I0=I+iSDen*NGrid
                  dEdRho=Cube%Vals(I0,1)
                  dEdAbsGradRho2=Cube%Vals(I0,2)
                  GradRhoX=Cube%Vals(I0,3)
                  GradRhoY=Cube%Vals(I0,4)
                  GradRhoZ=Cube%Vals(I0,5)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(1+LMN)=Ket(1+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(4+LMN)=Ket(4+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(10+LMN)=Ket(10+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(20+LMN)=Ket(20+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(35+LMN)=Ket(35+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(56+LMN)=Ket(56+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(6)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(6)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(6)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(7)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(84+LMN)=Ket(84+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(3+LMN)=Ket(3+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(9+LMN)=Ket(9+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(19+LMN)=Ket(19+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(34+LMN)=Ket(34+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(55+LMN)=Ket(55+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(83+LMN)=Ket(83+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(7+LMN)=Ket(7+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(17+LMN)=Ket(17+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(32+LMN)=Ket(32+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(53+LMN)=Ket(53+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(81+LMN)=Ket(81+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(14+LMN)=Ket(14+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(29+LMN)=Ket(29+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(50+LMN)=Ket(50+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(78+LMN)=Ket(78+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(25+LMN)=Ket(25+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(46+LMN)=Ket(46+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(74+LMN)=Ket(74+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(5)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(41+LMN)=Ket(41+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(6)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(5)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(69+LMN)=Ket(69+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(7)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(6)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(63+LMN)=Ket(63+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(2+LMN)=Ket(2+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(8+LMN)=Ket(8+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(18+LMN)=Ket(18+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(33+LMN)=Ket(33+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(54+LMN)=Ket(54+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(82+LMN)=Ket(82+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(6+LMN)=Ket(6+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(16+LMN)=Ket(16+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(31+LMN)=Ket(31+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(52+LMN)=Ket(52+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(80+LMN)=Ket(80+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(13+LMN)=Ket(13+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(28+LMN)=Ket(28+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(49+LMN)=Ket(49+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(77+LMN)=Ket(77+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(24+LMN)=Ket(24+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(45+LMN)=Ket(45+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(73+LMN)=Ket(73+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(40+LMN)=Ket(40+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(4)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(68+LMN)=Ket(68+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(5)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(62+LMN)=Ket(62+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(5+LMN)=Ket(5+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(15+LMN)=Ket(15+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(30+LMN)=Ket(30+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(51+LMN)=Ket(51+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(79+LMN)=Ket(79+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(12+LMN)=Ket(12+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(27+LMN)=Ket(27+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(48+LMN)=Ket(48+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(76+LMN)=Ket(76+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(23+LMN)=Ket(23+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(44+LMN)=Ket(44+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(72+LMN)=Ket(72+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(39+LMN)=Ket(39+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(67+LMN)=Ket(67+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(61+LMN)=Ket(61+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(11+LMN)=Ket(11+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(26+LMN)=Ket(26+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(47+LMN)=Ket(47+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(75+LMN)=Ket(75+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(22+LMN)=Ket(22+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(43+LMN)=Ket(43+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(71+LMN)=Ket(71+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(38+LMN)=Ket(38+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(66+LMN)=Ket(66+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(60+LMN)=Ket(60+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(21+LMN)=Ket(21+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(42+LMN)=Ket(42+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(70+LMN)=Ket(70+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(37+LMN)=Ket(37+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(5)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(4)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(65+LMN)=Ket(65+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(59+LMN)=Ket(59+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(6)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(5)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(36+LMN)=Ket(36+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(6)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(5)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(64+LMN)=Ket(64+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(6)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(5)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(58+LMN)=Ket(58+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(6)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(7)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(6)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(6)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(57+LMN)=Ket(57+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                ENDDO
             ENDIF
          ENDDO
       CASE(7)
          DO I=1,NGrid 
             RPx=Cube%Grid(I,1)-Prim%P(1)
             RPy=Cube%Grid(I,2)-Prim%P(2)
             RPz=Cube%Grid(I,3)-Prim%P(3)
             RP2=RPx**2+RPy**2+RPz**2
             X=Z*RP2
             IF(X<Exp_Switch)THEN
                J=AINT(X*Exp_Grid)
                Xpt=Exp_0(J)+X*(Exp_1(J)+X*(Exp_2(J)+X*(Exp_3(J)+X*Exp_4(J))))
                LambdaX(0)=Xpt
                LambdaY(0)=One
                LambdaZ(0)=One
                LambdaX(1)=TwoZ*RPx*Xpt
                LambdaY(1)=TwoZ*RPy
                LambdaZ(1)=TwoZ*RPz
                LambdaX(2)=TwoZ*(RPX*LambdaX(1)-LambdaX(0))
                LambdaX(3)=TwoZ*(RPX*LambdaX(2)-2.D0*LambdaX(1))
                LambdaX(4)=TwoZ*(RPX*LambdaX(3)-3.D0*LambdaX(2))
                LambdaX(5)=TwoZ*(RPX*LambdaX(4)-4.D0*LambdaX(3))
                LambdaX(6)=TwoZ*(RPX*LambdaX(5)-5.D0*LambdaX(4))
                LambdaX(7)=TwoZ*(RPX*LambdaX(6)-6.D0*LambdaX(5))
                LambdaX(8)=TwoZ*(RPX*LambdaX(7)-7.D0*LambdaX(6))
                LambdaY(2)=TwoZ*(RPY*LambdaY(1)-LambdaY(0))
                LambdaY(3)=TwoZ*(RPY*LambdaY(2)-2.D0*LambdaY(1))
                LambdaY(4)=TwoZ*(RPY*LambdaY(3)-3.D0*LambdaY(2))
                LambdaY(5)=TwoZ*(RPY*LambdaY(4)-4.D0*LambdaY(3))
                LambdaY(6)=TwoZ*(RPY*LambdaY(5)-5.D0*LambdaY(4))
                LambdaY(7)=TwoZ*(RPY*LambdaY(6)-6.D0*LambdaY(5))
                LambdaY(8)=TwoZ*(RPY*LambdaY(7)-7.D0*LambdaY(6))
                LambdaZ(2)=TwoZ*(RPZ*LambdaZ(1)-LambdaZ(0))
                LambdaZ(3)=TwoZ*(RPZ*LambdaZ(2)-2.D0*LambdaZ(1))
                LambdaZ(4)=TwoZ*(RPZ*LambdaZ(3)-3.D0*LambdaZ(2))
                LambdaZ(5)=TwoZ*(RPZ*LambdaZ(4)-4.D0*LambdaZ(3))
                LambdaZ(6)=TwoZ*(RPZ*LambdaZ(5)-5.D0*LambdaZ(4))
                LambdaZ(7)=TwoZ*(RPZ*LambdaZ(6)-6.D0*LambdaZ(5))
                LambdaZ(8)=TwoZ*(RPZ*LambdaZ(7)-7.D0*LambdaZ(6))
                Wght=Cube%Wght(I)
                !Q&D...
                DO iSDen=SDBeg,NSDen-1
                  LMN=(iSDen-SDBeg)*OffSDen
                  I0=I+iSDen*NGrid
                  dEdRho=Cube%Vals(I0,1)
                  dEdAbsGradRho2=Cube%Vals(I0,2)
                  GradRhoX=Cube%Vals(I0,3)
                  GradRhoY=Cube%Vals(I0,4)
                  GradRhoZ=Cube%Vals(I0,5)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(1+LMN)=Ket(1+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(4+LMN)=Ket(4+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(10+LMN)=Ket(10+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(20+LMN)=Ket(20+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(35+LMN)=Ket(35+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(56+LMN)=Ket(56+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(6)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(6)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(6)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(7)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(84+LMN)=Ket(84+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(0)*LambdaZ(7)
                  GradPrimDistX=-LambdaX(1)*LambdaY(0)*LambdaZ(7)
                  GradPrimDistY=-LambdaX(0)*LambdaY(1)*LambdaZ(7)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(0)*LambdaZ(8)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(120+LMN)=Ket(120+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(3+LMN)=Ket(3+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(9+LMN)=Ket(9+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(19+LMN)=Ket(19+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(34+LMN)=Ket(34+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(55+LMN)=Ket(55+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(83+LMN)=Ket(83+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(1)*LambdaZ(6)
                  GradPrimDistX=-LambdaX(1)*LambdaY(1)*LambdaZ(6)
                  GradPrimDistY=-LambdaX(0)*LambdaY(2)*LambdaZ(6)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(1)*LambdaZ(7)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(119+LMN)=Ket(119+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(7+LMN)=Ket(7+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(17+LMN)=Ket(17+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(32+LMN)=Ket(32+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(53+LMN)=Ket(53+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(81+LMN)=Ket(81+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(2)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(1)*LambdaY(2)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(0)*LambdaY(3)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(2)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(117+LMN)=Ket(117+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(14+LMN)=Ket(14+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(29+LMN)=Ket(29+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(50+LMN)=Ket(50+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(78+LMN)=Ket(78+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(3)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(1)*LambdaY(3)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(0)*LambdaY(4)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(3)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(114+LMN)=Ket(114+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(25+LMN)=Ket(25+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(46+LMN)=Ket(46+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(74+LMN)=Ket(74+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(4)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(1)*LambdaY(4)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(0)*LambdaY(5)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(4)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(110+LMN)=Ket(110+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(5)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(41+LMN)=Ket(41+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(6)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(5)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(69+LMN)=Ket(69+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(5)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(1)*LambdaY(5)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(0)*LambdaY(6)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(5)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(105+LMN)=Ket(105+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(7)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(6)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(63+LMN)=Ket(63+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(6)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(1)*LambdaY(6)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(0)*LambdaY(7)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(6)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(99+LMN)=Ket(99+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(0)*LambdaY(7)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(1)*LambdaY(7)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(0)*LambdaY(8)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(0)*LambdaY(7)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(92+LMN)=Ket(92+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(2+LMN)=Ket(2+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(8+LMN)=Ket(8+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(18+LMN)=Ket(18+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(33+LMN)=Ket(33+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(54+LMN)=Ket(54+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(82+LMN)=Ket(82+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(0)*LambdaZ(6)
                  GradPrimDistX=-LambdaX(2)*LambdaY(0)*LambdaZ(6)
                  GradPrimDistY=-LambdaX(1)*LambdaY(1)*LambdaZ(6)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(0)*LambdaZ(7)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(118+LMN)=Ket(118+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(6+LMN)=Ket(6+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(16+LMN)=Ket(16+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(31+LMN)=Ket(31+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(52+LMN)=Ket(52+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(80+LMN)=Ket(80+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(2)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(1)*LambdaY(2)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(1)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(116+LMN)=Ket(116+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(13+LMN)=Ket(13+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(28+LMN)=Ket(28+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(49+LMN)=Ket(49+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(77+LMN)=Ket(77+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(2)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(1)*LambdaY(3)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(2)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(113+LMN)=Ket(113+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(24+LMN)=Ket(24+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(45+LMN)=Ket(45+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(73+LMN)=Ket(73+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(2)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(1)*LambdaY(4)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(3)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(109+LMN)=Ket(109+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(40+LMN)=Ket(40+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(4)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(68+LMN)=Ket(68+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(2)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(1)*LambdaY(5)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(4)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(104+LMN)=Ket(104+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(5)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(62+LMN)=Ket(62+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(2)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(1)*LambdaY(6)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(5)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(98+LMN)=Ket(98+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(1)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(2)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(1)*LambdaY(7)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(1)*LambdaY(6)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(91+LMN)=Ket(91+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(5+LMN)=Ket(5+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(15+LMN)=Ket(15+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(30+LMN)=Ket(30+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(51+LMN)=Ket(51+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(79+LMN)=Ket(79+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistX=-LambdaX(3)*LambdaY(0)*LambdaZ(5)
                  GradPrimDistY=-LambdaX(2)*LambdaY(1)*LambdaZ(5)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(0)*LambdaZ(6)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(115+LMN)=Ket(115+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(12+LMN)=Ket(12+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(27+LMN)=Ket(27+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(48+LMN)=Ket(48+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(76+LMN)=Ket(76+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(3)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(2)*LambdaY(2)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(1)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(112+LMN)=Ket(112+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(23+LMN)=Ket(23+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(44+LMN)=Ket(44+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(72+LMN)=Ket(72+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(3)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(2)*LambdaY(3)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(2)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(108+LMN)=Ket(108+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(39+LMN)=Ket(39+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(67+LMN)=Ket(67+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(3)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(2)*LambdaY(4)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(3)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(103+LMN)=Ket(103+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(61+LMN)=Ket(61+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(3)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(2)*LambdaY(5)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(4)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(97+LMN)=Ket(97+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(2)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(3)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(2)*LambdaY(6)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(2)*LambdaY(5)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(90+LMN)=Ket(90+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(11+LMN)=Ket(11+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(26+LMN)=Ket(26+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(47+LMN)=Ket(47+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(75+LMN)=Ket(75+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistX=-LambdaX(4)*LambdaY(0)*LambdaZ(4)
                  GradPrimDistY=-LambdaX(3)*LambdaY(1)*LambdaZ(4)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(0)*LambdaZ(5)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(111+LMN)=Ket(111+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(22+LMN)=Ket(22+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(43+LMN)=Ket(43+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(71+LMN)=Ket(71+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(4)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(3)*LambdaY(2)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(1)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(107+LMN)=Ket(107+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(38+LMN)=Ket(38+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(66+LMN)=Ket(66+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(4)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(3)*LambdaY(3)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(2)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(102+LMN)=Ket(102+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(60+LMN)=Ket(60+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(4)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(3)*LambdaY(4)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(3)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(96+LMN)=Ket(96+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(3)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(4)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(3)*LambdaY(5)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(3)*LambdaY(4)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(89+LMN)=Ket(89+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(21+LMN)=Ket(21+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(42+LMN)=Ket(42+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(70+LMN)=Ket(70+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistX=-LambdaX(5)*LambdaY(0)*LambdaZ(3)
                  GradPrimDistY=-LambdaX(4)*LambdaY(1)*LambdaZ(3)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(0)*LambdaZ(4)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(106+LMN)=Ket(106+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(37+LMN)=Ket(37+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(5)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(4)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(65+LMN)=Ket(65+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(5)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(4)*LambdaY(2)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(1)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(101+LMN)=Ket(101+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(59+LMN)=Ket(59+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(5)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(4)*LambdaY(3)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(2)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(95+LMN)=Ket(95+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(4)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(5)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(4)*LambdaY(4)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(4)*LambdaY(3)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(88+LMN)=Ket(88+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(6)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(5)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(36+LMN)=Ket(36+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(6)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(5)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(64+LMN)=Ket(64+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistX=-LambdaX(6)*LambdaY(0)*LambdaZ(2)
                  GradPrimDistY=-LambdaX(5)*LambdaY(1)*LambdaZ(2)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(0)*LambdaZ(3)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(100+LMN)=Ket(100+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(6)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(5)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(58+LMN)=Ket(58+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(6)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(5)*LambdaY(2)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(1)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(94+LMN)=Ket(94+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(5)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(6)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(5)*LambdaY(3)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(5)*LambdaY(2)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(87+LMN)=Ket(87+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(6)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(7)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(6)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(6)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(57+LMN)=Ket(57+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(6)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistX=-LambdaX(7)*LambdaY(0)*LambdaZ(1)
                  GradPrimDistY=-LambdaX(6)*LambdaY(1)*LambdaZ(1)
                  GradPrimDistZ=-LambdaX(6)*LambdaY(0)*LambdaZ(2)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(93+LMN)=Ket(93+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(6)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(7)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(6)*LambdaY(2)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(6)*LambdaY(1)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(86+LMN)=Ket(86+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                  PrimDist=LambdaX(7)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistX=-LambdaX(8)*LambdaY(0)*LambdaZ(0)
                  GradPrimDistY=-LambdaX(7)*LambdaY(1)*LambdaZ(0)
                  GradPrimDistZ=-LambdaX(7)*LambdaY(0)*LambdaZ(1)
                  GradBraRhoDot=GradRhoX*GradPrimDistX&
                  +GradRhoY*GradPrimDistY+GradRhoZ*GradPrimDistZ
                  Ket(85+LMN)=Ket(85+LMN)&
                  +Wght*(dEdRho*PrimDist+dEdAbsGradRho2*GradBraRhoDot)
                ENDDO
             ENDIF
          ENDDO
       CASE(8:)
          CALL Halt("Increase HGEll in MondoMods/GlobalScalars.F90 and remake")
       END SELECT
