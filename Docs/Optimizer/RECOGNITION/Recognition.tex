% NOTE TO AIP TYPSETERS: TO CONVERT FROM TWO-COL TO PREPRINT, SWITCH
% COMMENTOUT COMMAND FROM A TO B IE. USE:
%
%%\documentclass[prl,twocolumn,showpacs,twocolumngrid,superbib]{revtex4}
%\documentclass[prl,twocolumn,twocolumngrid,superbib]{revtex4}
%\newcommand{\commentoutB}[1]{}
%\newcommand{\commentoutA}[1]{#1}
%
% INSTEAD OF THE FOLLOWING:
%
\newcommand{\commentoutB}[1]{#1}
\newcommand{\commentoutA}[1]{}
%\documentclass[prl,aps,preprint,showpacs,superbib]{revtex4}
\documentclass[prl,aps,preprint,superbib,12pt]{revtex4}

\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{alltt}
\usepackage{fancyhdr}
\newcommand{\bms}[1]{{\boldsymbol #1}}
\renewcommand{\thefootnote}{\fnsymbol{footnote}}

%\draft
%\tighten
\pagestyle{fancy}

\begin{document}

\title{On the recognition of internal coordinates in various 
chemical systems}

\author{K\'aroly N\'emeth\footnotemark[1]}
\author{Matt Challacombe}

\affiliation{Theoretical Division, Los Alamos National Laboratory, Los Alamos, NM 87545, USA}

\date{\today}

\begin{abstract}
This paper presents several considerations for the appropriate choice 
of internal coordinates in various chemical systems. The appropriate
and black box recognition of internal coordinates is of fundamental 
importance
for the extension of internal coordinate algorithms to all fields where
previously Cartesian coordinates were the preferred means of geometry 
manipulations. Such fields range from local and global geometry 
optimizations to molecular dynamics as applied to a wide variety of
chemical systems. We peresent a robust algorithm that is capable 
to quickly determine the appropriate choice of internal coordinates
in a wide range of atomic arrangements.
\end{abstract}

%\pacs{31.15.-p,31.15.Ne,02.60.Pn, 45.10.Db, 02.40.Hw} 

\maketitle

\footnotetext[1]{\tt KNemeth@LANL.Gov}

\section{Introduction}
The earliest use of curvilinear internal coordinates 
in computational chemistry
is associated with vibrational analysis \cite{EWilson55}. 
It has been recognized in vibrational analysis 
that most molecular vibrations
are fairly well localized on internal coordinates that reflect
chemical concepts, such as chemical bonds, valence angles or
dihedral torsions. In fact, vibrational coupling between
appropriately chosen internal coordinates is typically
an order of magnitude smaller than in the corresponding Cartesian
representation \cite{PPulay69,GFogarasi79,GFogarasi92,PPulay77}.
This observation holds not only for harmonic but more importantly
also for anharmonic vibrational couplings.
The recognition of this reduced vibrational coupling lead to the
development of internal coordinates based geometry optimization
\cite{PPulay69,PPulay77,GFogarasi79,HSchlegel82,HSchlegel03} which
is now the standard mean of local optimization in most quantum
chemistry software packages. Internal coordinate geometry optimization
reduces the number of optimization steps typically by a factor of 2-10
for small or medium sized molecules, as compared to Cartesian
conjugate gradient algorithms \cite{TBucko05}. Another field of
potentially great use of internal coordinates is represented
by molecular dynamics \cite{PPulay02}, where research aims on developing
efficient simulation of long time-scale dynamics of large molecules.

In order to define an appropriate internal coordinate set, first
the molecular connectivity has to be determined.
The connectivity of atoms is usually recognized on the basis of 
overlapping spheres of atomic or Van der Waals radii 
\cite{VBakken02,TBucko05,KNemeth04}. Atomic radii are often not suitable
to recognize bonding in e.g. ionic salts, since typical ionic radii
may be 2-3 times larger or smaller then atomic ones. The application
of Van der Waals radii usually results in a huge number of 
connectivities of which most ones are neither chemically relevant nor 
helpful for the optimization. In fact an overly large number
of internal coordinates can substantially decrease the efficiency of
an internal coordinate optimizer. On the other hand, missing internal 
coordinates can lead to inefficient or non-convergent optimizations.

Besides the case of ionic systems or random clusters of atoms,
also fragmented sytems can cause problems. Consider, for example
a system of isolated molecules that interact only by very long range
forces but the intermolecular interaction cannot be described
in terms of well defined bonds such as in covalently bound systems.
E.g. two water molecules at a larger separation and at a random 
orientation, where no clear hydrogen bonding exists but there is still
a dipole-dipole interaction.
In principle the interaction of these isolated units could be treated
in terms or the Cartesian coordinates of the correspondig centers 
of masses
and the appropriate rotations around them, however use of 
relative (internal) coordinates could provide a substantial advantage
in the description of the relative motions of these units.

Another very important area where internal coordinate recognition
may become troblesome is related to Van der Waals contacts.
Consider for example two strands of polymeric teflon. Which 
Van der Waals contacts should we allow for the optimization of their
structures and which ones not? The same question raises even more
importantly in biopolymers, such as proteins, when one considers
their interchain interactions. Or, also in many important
inorganic systems, e.g. in sulphur crystal where Van der Waals 
interaction determines the size and shape of the elementary cell and
may also have a considerable influence on the structure of the
covalently bound S$_{8}$ rings.

Clearly, an important disadvantage of internal coordinates 
over Cartesian ones
is that while Cartesian coordinates are always readily and
obviously at hand,
internal ones are often somewhat arbitrarily defined and thus
can provide a large, definitions-based performance difference. 
Unfortunately,
a general algorithm that would overcome this inconvenience in the use
of internal coordinates has not yet been developed. This is probably
the reason why internal coordinates based geometry manipulation
is sometimes cosidered an art rather then science.
Indeed, the problem is that in many of the
problematic systems the boundaries of the chemical concepts are 
reached while the universality of Cartesian coordinates is always 
clearly undoubted. Thus, at one hand internal coordinates offer
great advantage in geometry manipulations on the other hand their
use seems to be much less deterministic then the one of Cartesians.
In the present paper we attempt to bridge the coordinate recognition
gap between the great performance of internal coordinates and the 
troblesomeness of their definition.

\section{Selection via a condition number}
The most important computational operations that are carried out 
with internal coordinates are the coordinate transformations 
\cite{PPulay77}. The coordinate transformations involve
Wilson's B matrix \cite{EWilson55}, $B$, and its pseudo-inverse, A.
Wilson's B matrix is defined as
\begin{equation}
B_{ij} = \frac{\partial \phi_{i}}{\partial x_{j}},
\end{equation}
where $\phi_{i}$ denotes the $i$-th internal coordinate and $x_{j}$
denotes the $j$-th Cartesian coordinate of the molecule.
The matrix $G_{c}$ connects the $B$ matrix with its pseudo-inverse
$A$ via the definitions
\begin{equation}
G_{c} = B^{t} B
\end{equation}
and
\begin{equation}
A = G_{c}^{-1} B^{t} ,
\end{equation}
where $G_{c}$ is an $N_{c} \times N_{c}$ matrix, with $N_{c}$ being the
number of Cartesian coordinates, and $N_{c}=3N$, for a molecule
with $N$ atoms. $G_{c}$ has $3N-6$ nonzero eigenvalues that refer to 
the internal degrees of motion of a non-linear molecule, and
$6$ zero eigenvalues referring to molecular translations and rotations. 
Thus the
matrix, $G_{c}^{-1}$ must be computed as a generalized inverse. 
Let $\lambda_{max}$ and $\lambda_{min}$ denote the maximum and minimum
of the largest $3N-6$ eigenvalues of $G_{c}$ and 
$\lambda_{c}=\lambda_{min}/\lambda_{max}$ is the condition number
of $G_{c}$. 
$\lambda_{c}$ can always be calculated once
an internal coordinate set is given. 
The first condition (Condition \#1) that any internal coordinate set
must satisfy is that the $G_{c}$ matrix calculated over the 
internal coordinates given,
has $3N-6$ nonzero eigenvalues. This condition refers to the requirement
that the internal coordinates must span the whole space 
of internal motions of the molecule.
Once this first condition is satisfied one can think of making
selection between the actual internal coordinates and search
for a reduced set of internal coordinates that satisfies 
Condition \#1 with the minimal number of internal coordinates.
Say, for an $N=100$ atoms molecule $N_{i}=294$ internal coordinates
can be selected that satisfy Condition \#1. However, these $N_{i}=294$
internal coordinates can be selected in lots of different ways,
i.e. lots of sub-sets of the originally $N_{i}>294$ elements internal
coordinate set can be chosen. To make a further selection
among these subsets, Condition \#2 can be introduced:
Let's choose the one among equal-sized subsets which provides the
largest $\lambda_{c}$ condition number. This way both
the size and the choice of internal coordinates can be chosen
uniquely, unless degenerate subsets occure in the $\lambda_{c}$ sense.

The condition number $\lambda_{c}$ of a given internal coordinate set
can also be modified by the construction of appropriate linear 
combinations of primarily given internal coordinates. Usually, the
primary internal coordinate set consists of so-called primitive
internal coordinates, i.e. stretchings, bendings, torsions,
out-of-planes and linear bendings. One well established set of such
linear-combinations is the so-called natural internal coordinates
\cite{GFogarasi92,MvonArnim99}. Unfortunately, the construction
of natural internal coordinates may be highly non-trivial for
topologically complex systems and therefor it is difficult to 
be automatized. Alternatively, one can use the so-called delocalized
internal coordinates \cite{JBaker96}. Delocalized internal coordinates
provide a $3N-6$ dimensional set of linear-combined primitive
internal coordinates, where the linear combination coefficients
come from a unitary matrix. 

Delocalized are unique, and make selection through coefficients
though diagonalization or RU decomposition is needed. We want
more robust selection schemes. 




that 



\section{Conclusions} \label{Conclusions}

\bibliography{../../Bib/mondo_new}



\end{document}

