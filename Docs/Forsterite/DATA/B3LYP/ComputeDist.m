
#####################################
#Mg-O
#Name="_b3lyp_DistMat_MgO__";
#dmin=1.95;
#dmax=2.30;
#####################################
#Si-O
Name="_b3lyp_DistMat_SiO__";
dmin=1.50;
dmax=1.70;
#####################################

#Geo in Atom
#Q=[
#####################################
#2x1x1
#       4.76156       10.18345        6.11814  
#       4.76129       10.18146        3.05958  
#       2.38046        5.09130        0.00141  
#       2.38039        5.09085        3.06028  
#       4.80824        2.83340        4.58963  
#       4.71462        7.34953        1.52862  
#       2.42698        2.25786        1.52836  
#       2.33456        7.92554        4.58986  
#       0.33791        4.13069        1.52985  
#       4.42254        6.05249        4.58962  
#       2.71952        0.96088        4.58894  
#       2.04170        9.22252        1.52970  
#       1.09034        0.93582        4.58999  
#       3.67064        9.24748        1.52863  
#       3.47116        4.15601        1.52910  
#       1.28965        6.02743        4.59058  
#       1.31838        0.54031        1.52804  
#       3.44277        9.64348        4.59066  
#       3.69889        4.55057        4.59108  
#       1.06162        5.63258        1.52877  
#       1.04963        3.44607        2.84719  
#       3.71060        6.73872        5.90550  
#       3.43088        1.64492        3.27125  
#       1.32976        8.53645        0.21324  
#       3.71122        6.73703        3.27210  
#       1.05015        3.44455        0.21389  
#       1.33059        8.53872        2.84767  
#       3.43133        1.64704        5.90504  
#       9.52382       10.18334        6.11868  
#       0.00076        0.00076        3.05949  
#       7.14230        5.09173        6.11759  
#       7.14219        5.09191        3.05925  
#       0.04672        2.83404        4.58984  
#       9.47532        7.34928        1.52916  
#       7.18788        2.25802        1.52878  
#       7.09572        7.92572        4.58968  
#       5.10035        4.13093        1.52953  
#       9.18464        6.05282        4.58954  
#       7.48131        0.96067        4.58912  
#       6.80373        9.22251        1.52955  
#       5.85193        0.93532        4.59012  
#       8.43295        9.24721        1.52882  
#       8.23305        4.15607        1.52872  
#       6.05140        6.02746        4.59011  
#       6.08003        0.53985        1.52835  
#       8.20466        9.64311        4.59042  
#       8.46105        4.55085        4.59045  
#       5.82400        5.63273        1.52797  
#       5.81160        3.44662        2.84723  
#       8.47253        6.73873        5.90550  
#       8.19251        1.64508        3.27130  
#       6.09146        8.53616        0.21324  
#       8.47288        6.73729        3.27221  
#       5.81219        3.44441        0.21385  
#       6.09200        8.53798        2.84724  
#       8.19329        1.64700        5.90545  
#####################################
#2x1x2
#Q=[   4.77641        0.01038        5.98420  
#      4.77569        0.01127        2.98646  
#      2.38174        5.13929        5.98438  
#      2.38245        5.13983        2.98676  
#      4.80897        2.86014        4.48589  
#      4.74232        7.42040        1.48905  
#      2.41576        2.29076        1.48863  
#      2.34902        7.98898        4.48538  
#      0.32883        4.17568        1.48797  
#      4.43540        6.10456        4.48668  
#      2.72262        0.97515        4.48648  
#      2.04158        9.30478        1.48788  
#      1.09586        0.94304        4.48614  
#      3.66841        9.33702        1.48829  
#      3.48915        4.20764        1.48786  
#      1.27511        6.07240        4.48638  
#      1.31434        0.55037        1.48817  
#      3.45003        9.72991        4.48582  
#      3.70801        4.60052        4.48613  
#      1.05609        5.67973        1.48824  
#      1.05763        3.47706        2.79349  
#      3.70672        6.80279        5.79197  
#      3.45104        1.67432        3.18138  
#      1.31355        8.60666        0.18224  
#      3.70680        6.80332        3.18145  
#      1.05715        3.47731        0.18212  
#      1.31275        8.60620        2.79338  
#      3.45135        1.67342        5.79201  
#      4.77584        0.01045       11.98002  
#      4.77528        0.01160        8.98215  
#      2.38134        5.14033       11.98002  
#      2.38273        5.14059        8.98215  
#      4.80835        2.86007       10.48128  
#      4.74223        7.42032        7.48425  
#      2.41585        2.29085        7.48435  
#      2.34922        7.98912       10.48061  
#      0.32904        4.17552        7.48401  
#      4.43565        6.10452       10.48216  
#      2.72232        0.97502       10.48204  
#      2.04184        9.30494        7.48340  
#      1.09558        0.94298       10.48157  
#      3.66876        9.33730        7.48368  
#      3.48918        4.20783        7.48383  
#      1.27493        6.07249       10.48146  
#      1.31444        0.55053        7.48384  
#      3.44977        9.72969       10.48132  
#      3.70802        4.60061       10.48165  
#      1.05636        5.67963        7.48416  
#      1.05753        3.47657        8.78891  
#      3.70660        6.80323       11.78773  
#      3.45118        1.67382        9.17705  
#      1.31329        8.60668        6.17792  
#      3.70691        6.80317        9.17650  
#      1.05724        3.47726        6.17835  
#      1.31324        8.60599        8.78875  
#      3.45071        1.67360       11.78724  
#      9.56334        0.01091        5.98432  
#      9.56260        0.01138        2.98673  
#      7.16978        5.13981        5.98484  
#      7.16914        5.14082        2.98700  
#      0.02110        2.85985        4.48584  
#      9.52893        7.42036        1.48946  
#      7.20331        2.29108        1.48892  
#      7.13576        7.98910        4.48583  
#      5.11625        4.17552        1.48805  
#      9.22277        6.10445        4.48665  
#      7.50961        0.97508        4.48655  
#      6.82890        9.30503        1.48805  
#      5.88292        0.94295        4.48612  
#      8.45575        9.33705        1.48848  
#      8.27655        4.20771        1.48830  
#      6.06227        6.07246        4.48623  
#      6.10177        0.55043        1.48821  
#      8.23708        9.72969        4.48620  
#      8.49511        4.60065        4.48623  
#      5.84341        5.67972        1.48800  
#      5.84500        3.47706        2.79357  
#      8.49407        6.80267        5.79207  
#      8.23833        1.67390        3.18148  
#      6.10057        8.60656        0.18271  
#      8.49383        6.80361        3.18130  
#      5.84474        3.47738        0.18238  
#      6.10041        8.60653        2.79324  
#      8.23828        1.67357        5.79194  
#      9.56327        0.01041       11.98007  
#      9.56284        0.01147        8.98233  
#      7.16936        5.13981       11.98017  
#      7.16978        5.14063        8.98245  
#      0.02137        2.85980       10.48060  
#      9.52945        7.42074        7.48484  
#      7.20308        2.29108        7.48481  
#      7.13626        7.98884       10.48069  
#      5.11617        4.17569        7.48384  
#      9.22279        6.10453       10.48218  
#      7.50964        0.97496       10.48221  
#      6.82903        9.30503        7.48390  
#      5.88272        0.94267       10.48126  
#      8.45599        9.33712        7.48404  
#      8.27670        4.20770        7.48409  
#      6.06239        6.07223       10.48171  
#      6.10188        0.55021        7.48396  
#      8.23721        9.72957       10.48157  
#      8.49549        4.60051       10.48159  
#      5.84364        5.67954        7.48404  
#      5.84481        3.47702        8.78918  
#      8.49413        6.80259       11.78788  
#      8.23846        1.67386        9.17710  
#      6.10054        8.60676        6.17823  
#      8.49402        6.80300        9.17687  
#      5.84466        3.47745        6.17830  
#      6.10026        8.60622        8.78890  
#      8.23836        1.67352       11.78757  
#####################################
#3x1x2
Q=[    4.77082       10.25398        5.99418  
       4.77091       10.25404        2.99666  
       2.37715        5.12533        5.99445  
       2.37713        5.12525        2.99652  
       4.80452        2.84531        4.49551  
       4.73760        7.40517        1.49794  
       2.41058        2.27634        1.49777  
       2.34374        7.97351        4.49545  
       0.32383        4.16063        1.49764  
       4.43071        6.08911        4.49540  
       2.71734        0.96078        4.49545  
       2.03713        9.28870        1.49787  
       1.09038        0.92903        4.49541  
       3.66373        9.32144        1.49792  
       3.48427        4.19289        1.49777  
       1.26986        6.05669        4.49534  
       1.31006        0.53552        1.49796  
       3.44445        9.71427        4.49549  
       3.70310        4.58532        4.49547  
       1.05123        5.66422        1.49766  
       1.05268        3.46216        2.80277  
       3.70190        6.78766        5.80036  
       3.44629        1.65906        3.19034  
       1.30816        8.59085        0.19228  
       3.70210        6.78763        3.19050  
       1.05261        3.46197        0.19277  
       1.30824        8.59096        2.80327  
       3.44630        1.65921        5.80049  
       4.77085       10.25449       11.99007  
       4.77096       10.25399        8.99210  
       2.37753        5.12564       11.99025  
       2.37725        5.12501        8.99198  
       4.80493        2.84530       10.49050  
       4.73746        7.40529        7.49293  
       2.41081        2.27629        7.49301  
       2.34381        7.97352       10.49059  
       0.32375        4.16061        7.49321  
       4.43078        6.08907       10.49075  
       2.71743        0.96064       10.49072  
       2.03693        9.28869        7.49320  
       1.09027        0.92892       10.49067  
       3.66377        9.32122        7.49313  
       3.48425        4.19271        7.49306  
       1.26989        6.05674       10.49083  
       1.30983        0.53545        7.49303  
       3.44453        9.71448       10.49098  
       3.70316        4.58523       10.49073  
       1.05137        5.66438        7.49328  
       1.05255        3.46195        8.79809  
       3.70195        6.78764       11.79590  
       3.44638        1.65882        9.18553  
       1.30819        8.59082        6.18800  
       3.70189        6.78763        9.18573  
       1.05255        3.46222        6.18819  
       1.30809        8.59108        8.79853  
       3.44629        1.65901       11.79583  
       9.55886       10.25386        5.99404  
       9.55868       10.25371        2.99675  
       7.16493        5.12510        5.99438  
       7.16463        5.12501        2.99659  
       9.59213        2.84528        4.49549  
       9.52493        7.40531        1.49761  
       7.19810        2.27592        1.49788  
       7.13145        7.97382        4.49547  
       5.11118        4.16066        1.49764  
       9.21831        6.08934        4.49524  
       7.50510        0.96042        4.49533  
       6.82410        9.28944        1.49775  
       5.87805        0.92816        4.49539  
       8.45109        9.32153        1.49771  
       8.27177        4.19282        1.49775  
       6.05762        6.05689        4.49551  
       6.09656        0.53603        1.49772  
       8.23245        9.71424        4.49547  
       8.49076        4.58551        4.49540  
       5.83871        5.66447        1.49764  
       5.83986        3.46218        2.80280  
       8.48952        6.78792        5.80027  
       8.23401        1.65900        3.19019  
       6.09564        8.59107        0.19267  
       8.48944        6.78764        3.19014  
       5.84025        3.46191        0.19251  
       6.09557        8.59091        2.80284  
       8.23409        1.65915        5.80040  
       9.55857       10.25426       11.98972  
       9.55870       10.25371        8.99203  
       7.16497        5.12498       11.98989  
       7.16482        5.12511        8.99195  
       9.59227        2.84513       10.49053  
       9.52526        7.40526        7.49285  
       7.19825        2.27605        7.49300  
       7.13138        7.97387       10.49067  
       5.11124        4.16075        7.49304  
       9.21841        6.08935       10.49062  
       7.50503        0.96037       10.49072  
       6.82418        9.28942        7.49307  
       5.87807        0.92833       10.49072  
       8.45136        9.32160        7.49289  
       8.27199        4.19299        7.49301  
       6.05775        6.05678       10.49077  
       6.09669        0.53595        7.49305  
       8.23252        9.71415       10.49078  
       8.49087        4.58539       10.49072  
       5.83870        5.66457        7.49301  
       5.84019        3.46225        8.79821  
       8.48977        6.78796       11.79565  
       8.23407        1.65908        9.18539  
       6.09562        8.59102        6.18820  
       8.48946        6.78781        9.18551  
       5.84011        3.46213        6.18804  
       6.09569        8.59099        8.79815  
       8.23374        1.65902       11.79571  
      14.34721       10.25427        5.99417  
      14.34718       10.25412        2.99673  
      11.95251        5.12484        5.99437  
      11.95228        5.12490        2.99645  
       0.01765        2.84560        4.49537  
      14.31168        7.40501        1.49758  
      11.98517        2.27603        1.49790  
      11.91899        7.97395        4.49533  
       9.89864        4.16084        1.49770  
      14.00564        6.08929        4.49523  
      12.29313        0.96023        4.49538  
      11.61190        9.28939        1.49768  
      10.66581        0.92816        4.49540  
      13.23944        9.32164        1.49774  
      13.05972        4.19300        1.49764  
      10.84529        6.05690        4.49523  
      10.88435        0.53560        1.49773  
      13.02080        9.71423        4.49519  
      13.27810        4.58531        4.49537  
      10.62635        5.66468        1.49750  
      10.62769        3.46213        2.80282  
      13.27706        6.78761        5.80031  
      13.02153        1.65891        3.19008  
      10.88305        8.59104        0.19255  
      13.27716        6.78762        3.19025  
      10.62727        3.46209        0.19296  
      10.88324        8.59098        2.80273  
      13.02155        1.65883        5.80065  
      14.34712       10.25460       11.98950  
      14.34699       10.25470        8.99203  
      11.95228        5.12455       11.98980  
      11.95252        5.12485        8.99187  
       0.01773        2.84558       10.49094  
      14.31170        7.40497        7.49317  
      11.98542        2.27575        7.49280  
      11.91866        7.97389       10.49059  
       9.89887        4.16088        7.49300  
      14.00570        6.08938       10.49092  
      12.29294        0.96028       10.49079  
      11.61216        9.28919        7.49307  
      10.66565        0.92837       10.49071  
      13.23904        9.32133        7.49298  
      13.05972        4.19303        7.49305  
      10.84539        6.05697       10.49059  
      10.88451        0.53562        7.49307  
      13.02039        9.71426       10.49076  
      13.27830        4.58557       10.49087  
      10.62647        5.66443        7.49277  
      10.62794        3.46197        8.79828  
      13.27703        6.78793       11.79591  
      13.02132        1.65885        9.18540  
      10.88326        8.59085        6.18796  
      13.27679        6.78804        9.18564  
      10.62786        3.46200        6.18786  
      10.88314        8.59087        8.79819  
      13.02154        1.65898       11.79615  
];


N=size(Q,1)

NPair=0;
id1=fopen([Name,".dat"],"w");
for iAt=1:N
  for jAt=iAt+1:N
    d=sqrt((Q(iAt,1)-Q(jAt,1))^2+(Q(iAt,2)-Q(jAt,2))^2+(Q(iAt,3)-Q(jAt,3))^2);
    if(dmin<d && d<dmax)
      NPair=NPair+1;
      QPair(NPair)=d;
      fprintf(id1,"%4i %4i %6.3f \n",iAt,jAt,d);
    endif
  end
end
fclose(id1);

hist( QPair, 150 )

[XX,NN]=hist( QPair, 150 );
id1=fopen([Name,".val"],"w");
for i=1:size(XX,2)
  if(XX(i)>0)
    fprintf(id1,"%4i %7.4f \n",XX(i),NN(i));
  endif
end
fclose(id1);

#NHist=ceil((dmax-dmin)/ddlt)
#Hist=zeros( NHist )
#for i=1:NPair
#  iHist=round(QPair(i)-dmin)+1;
#  Hist(iHist)=Hist(iHist)+1;
#end

#################
#MgO
#NBnd=[1 12 17 24 18 22 16 24]';
#NBnd=[1 20 33 36 30 27 24 40]';
#SiO
#NBnd=[1 12 32 8]';
NBnd=[1 20 48 12]';

QPair=sort(QPair);
i1=0;i2=0;
for i=1:size(NBnd,1)-1
  i1=i1+NBnd(i);
  i2=i1+NBnd(i+1)-1;
  m(i)=mean(QPair(i1:i2));
  s(i)=std(QPair(i1:i2));
end
if(size(NBnd,1)>4)
printf(" Mg1-O = %7.5f %7.5f  %7.5f %7.5f  %7.5f %7.5f \n", m(4), s(4), m(2), s(2), m(5), s(5) );
printf(" Mg2-O = %7.5f %7.5f  %7.5f %7.5f  %7.5f %7.5f  %7.5f %7.5f \n", m(6), s(6), m(1), s(1), m(3), s(3),  m(7), s(7) );
else
printf(" Si-O = %7.5f %7.5f  %7.5f %7.5f  %7.5f %7.5f \n", m(1), s(1), m(3), s(3), m(2), s(2) );
endif
