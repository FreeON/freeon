!------------------------------------------------------------------------------
!    This code is part of the MondoSCF suite of programs for linear scaling
!    electronic structure theory and ab initio molecular dynamics.
!
!    Copyright (2004). The Regents of the University of California. This
!    material was produced under U.S. Government contract W-7405-ENG-36
!    for Los Alamos National Laboratory, which is operated by the University
!    of California for the U.S. Department of Energy. The U.S. Government has
!    rights to use, reproduce, and distribute this software.  NEITHER THE
!    GOVERNMENT NOR THE UNIVERSITY MAKES ANY WARRANTY, EXPRESS OR IMPLIED,
!    OR ASSUMES ANY LIABILITY FOR THE USE OF THIS SOFTWARE.
!
!    This program is free software; you can redistribute it and/or modify
!    it under the terms of the GNU General Public License as published by the
!    Free Software Foundation; either version 2 of the License, or (at your
!    option) any later version. Accordingly, this program is distributed in
!    the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
!    the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
!    PURPOSE. See the GNU General Public License at www.gnu.org for details.
!
!    While you may do as you like with this software, the GNU license requires
!    that you clearly mark derivative software.  In addition, you are encouraged
!    to return derivative works to the MondoSCF group for review, and possible
!    disemination in future releases.
!------------------------------------------------------------------------------
      SUBROUTINE CTraX407(Q)
         USE PoleNodeType
         USE PoleGlobals
         USE ERIGlobals
         TYPE(PoleNode) :: Q
!       -------------------------------- Lp=0, Mp = 0-------------------------------------
        W(1)=Cpq(0)*Q%C(0)+Cpq(1)*Q%C(1)+Cpq(3)*Q%C(3)+Cpq(6)*Q%C(6)
        W(2)=Cpq(10)*Q%C(10)+Cpq(15)*Q%C(15)+Cpq(21)*Q%C(21)+Cpq(28)*Q%C(28)
        COne=W(1)+W(2)
        W(1)=Cpq(2)*Q%C(2)+Cpq(4)*Q%C(4)+Cpq(5)*Q%C(5)
        W(2)=Cpq(7)*Q%C(7)+Cpq(8)*Q%C(8)+Cpq(9)*Q%C(9)+Cpq(11)*Q%C(11)
        W(3)=Cpq(12)*Q%C(12)+Cpq(13)*Q%C(13)+Cpq(14)*Q%C(14)
        W(4)=Cpq(16)*Q%C(16)+Cpq(17)*Q%C(17)+Cpq(18)*Q%C(18)+Cpq(19)*Q%C(19)
        W(5)=Cpq(20)*Q%C(20)+Cpq(22)*Q%C(22)+Cpq(23)*Q%C(23)
        W(6)=Cpq(24)*Q%C(24)+Cpq(25)*Q%C(25)+Cpq(26)*Q%C(26)+Cpq(27)*Q%C(27)
        W(7)=Cpq(29)*Q%C(29)+Cpq(30)*Q%C(30)+Cpq(31)*Q%C(31)
        W(8)=Cpq(32)*Q%C(32)+Cpq(33)*Q%C(33)+Cpq(34)*Q%C(34)+Cpq(35)*Q%C(35)
        W(9)=Spq(2)*Q%S(2)+Spq(4)*Q%S(4)+Spq(5)*Q%S(5)
        W(10)=Spq(7)*Q%S(7)+Spq(8)*Q%S(8)+Spq(9)*Q%S(9)+Spq(11)*Q%S(11)
        W(11)=Spq(12)*Q%S(12)+Spq(13)*Q%S(13)+Spq(14)*Q%S(14)
        W(12)=Spq(16)*Q%S(16)+Spq(17)*Q%S(17)+Spq(18)*Q%S(18)+Spq(19)*Q%S(19)
        W(13)=Spq(20)*Q%S(20)+Spq(22)*Q%S(22)+Spq(23)*Q%S(23)
        W(14)=Spq(24)*Q%S(24)+Spq(25)*Q%S(25)+Spq(26)*Q%S(26)+Spq(27)*Q%S(27)
        W(15)=Spq(29)*Q%S(29)+Spq(30)*Q%S(30)+Spq(31)*Q%S(31)
        W(16)=Spq(32)*Q%S(32)+Spq(33)*Q%S(33)+Spq(34)*Q%S(34)+Spq(35)*Q%S(35)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        SPKetC(0)=SPKetC(0)+COne+CTwo*Two
!       -------------------------------- Lp=1, Mp = 0-------------------------------------
        W(1)=-(Cpq(1)*Q%C(0))-Cpq(3)*Q%C(1)-Cpq(6)*Q%C(3)-Cpq(10)*Q%C(6)
        W(2)=-(Cpq(15)*Q%C(10))-Cpq(21)*Q%C(15)-Cpq(28)*Q%C(21)-Cpq(36)*Q%C(28)
        COne=W(1)+W(2)
        W(1)=-(Cpq(4)*Q%C(2))-Cpq(7)*Q%C(4)-Cpq(8)*Q%C(5)
        W(2)=-(Cpq(11)*Q%C(7))-Cpq(12)*Q%C(8)-Cpq(13)*Q%C(9)-Cpq(16)*Q%C(11)
        W(3)=-(Cpq(17)*Q%C(12))-Cpq(18)*Q%C(13)-Cpq(19)*Q%C(14)
        W(4)=-(Cpq(22)*Q%C(16))-Cpq(23)*Q%C(17)-Cpq(24)*Q%C(18)-Cpq(25)*Q%C(19)
        W(5)=-(Cpq(26)*Q%C(20))-Cpq(29)*Q%C(22)-Cpq(30)*Q%C(23)
        W(6)=-(Cpq(31)*Q%C(24))-Cpq(32)*Q%C(25)-Cpq(33)*Q%C(26)-Cpq(34)*Q%C(27)
        W(7)=-(Cpq(37)*Q%C(29))-Cpq(38)*Q%C(30)-Cpq(39)*Q%C(31)
        W(8)=-(Cpq(40)*Q%C(32))-Cpq(41)*Q%C(33)-Cpq(42)*Q%C(34)-Cpq(43)*Q%C(35)
        W(9)=-(Spq(4)*Q%S(2))-Spq(7)*Q%S(4)-Spq(8)*Q%S(5)
        W(10)=-(Spq(11)*Q%S(7))-Spq(12)*Q%S(8)-Spq(13)*Q%S(9)-Spq(16)*Q%S(11)
        W(11)=-(Spq(17)*Q%S(12))-Spq(18)*Q%S(13)-Spq(19)*Q%S(14)
        W(12)=-(Spq(22)*Q%S(16))-Spq(23)*Q%S(17)-Spq(24)*Q%S(18)-Spq(25)*Q%S(19)
        W(13)=-(Spq(26)*Q%S(20))-Spq(29)*Q%S(22)-Spq(30)*Q%S(23)
        W(14)=-(Spq(31)*Q%S(24))-Spq(32)*Q%S(25)-Spq(33)*Q%S(26)-Spq(34)*Q%S(27)
        W(15)=-(Spq(37)*Q%S(29))-Spq(38)*Q%S(30)-Spq(39)*Q%S(31)
        W(16)=-(Spq(40)*Q%S(32))-Spq(41)*Q%S(33)-Spq(42)*Q%S(34)-Spq(43)*Q%S(35)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        SPKetC(1)=SPKetC(1)+COne+CTwo*Two
!       -------------------------------- Lp=1, Mp = 1-------------------------------------
        W(1)=-(Cpq(2)*Q%C(0))-Cpq(4)*Q%C(1)
        W(2)=(Cpq(3)-Cpq(5))*Q%C(2)-Cpq(7)*Q%C(3)
        W(3)=(Cpq(6)-Cpq(8))*Q%C(4)+(Cpq(7)-Cpq(9))*Q%C(5)
        W(4)=-(Cpq(11)*Q%C(6))+(Cpq(10)-Cpq(12))*Q%C(7)
        W(5)=(Cpq(11)-Cpq(13))*Q%C(8)+(Cpq(12)-Cpq(14))*Q%C(9)
        W(6)=-(Cpq(16)*Q%C(10))+(Cpq(15)-Cpq(17))*Q%C(11)
        W(7)=(Cpq(16)-Cpq(18))*Q%C(12)+(Cpq(17)-Cpq(19))*Q%C(13)
        W(8)=(Cpq(18)-Cpq(20))*Q%C(14)-Cpq(22)*Q%C(15)
        W(9)=(Cpq(21)-Cpq(23))*Q%C(16)+(Cpq(22)-Cpq(24))*Q%C(17)
        W(10)=(Cpq(23)-Cpq(25))*Q%C(18)+(Cpq(24)-Cpq(26))*Q%C(19)
        W(11)=(Cpq(25)-Cpq(27))*Q%C(20)-Cpq(29)*Q%C(21)
        W(12)=(Cpq(28)-Cpq(30))*Q%C(22)+(Cpq(29)-Cpq(31))*Q%C(23)
        W(13)=(Cpq(30)-Cpq(32))*Q%C(24)+(Cpq(31)-Cpq(33))*Q%C(25)
        W(14)=(Cpq(32)-Cpq(34))*Q%C(26)+(Cpq(33)-Cpq(35))*Q%C(27)
        W(15)=-(Cpq(37)*Q%C(28))+(Cpq(36)-Cpq(38))*Q%C(29)
        W(16)=(Cpq(37)-Cpq(39))*Q%C(30)+(Cpq(38)-Cpq(40))*Q%C(31)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=(Cpq(39)-Cpq(41))*Q%C(32)+(Cpq(40)-Cpq(42))*Q%C(33)
        W(20)=(Cpq(41)-Cpq(43))*Q%C(34)+(Cpq(42)-Cpq(44))*Q%C(35)
        W(21)=-(Spq(5)*Q%S(2))-Spq(8)*Q%S(4)
        W(22)=(Spq(7)-Spq(9))*Q%S(5)-Spq(12)*Q%S(7)
        W(23)=(Spq(11)-Spq(13))*Q%S(8)+(Spq(12)-Spq(14))*Q%S(9)
        W(24)=-(Spq(17)*Q%S(11))+(Spq(16)-Spq(18))*Q%S(12)
        W(25)=(Spq(17)-Spq(19))*Q%S(13)+(Spq(18)-Spq(20))*Q%S(14)
        W(26)=-(Spq(23)*Q%S(16))+(Spq(22)-Spq(24))*Q%S(17)
        W(27)=(Spq(23)-Spq(25))*Q%S(18)+(Spq(24)-Spq(26))*Q%S(19)
        W(28)=(Spq(25)-Spq(27))*Q%S(20)-Spq(30)*Q%S(22)
        W(29)=(Spq(29)-Spq(31))*Q%S(23)+(Spq(30)-Spq(32))*Q%S(24)
        W(30)=(Spq(31)-Spq(33))*Q%S(25)+(Spq(32)-Spq(34))*Q%S(26)
        W(31)=(Spq(33)-Spq(35))*Q%S(27)-Spq(38)*Q%S(29)
        W(32)=(Spq(37)-Spq(39))*Q%S(30)+(Spq(38)-Spq(40))*Q%S(31)
        W(33)=(Spq(39)-Spq(41))*Q%S(32)+(Spq(40)-Spq(42))*Q%S(33)
        W(34)=(Spq(41)-Spq(43))*Q%S(34)+(Spq(42)-Spq(44))*Q%S(35)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        CTwo=W(17)+W(18)+W(35)+W(36)
        W(1)=-(Q%C(0)*Spq(2))-Q%C(1)*Spq(4)-Q%C(2)*Spq(5)-Q%C(3)*Spq(7)
        W(2)=-(Q%C(4)*Spq(8))-Q%C(5)*(Spq(7)+Spq(9))
        W(3)=-(Q%C(6)*Spq(11))-Q%C(7)*Spq(12)
        W(4)=-(Q%C(8)*(Spq(11)+Spq(13)))-Q%C(9)*(Spq(12)+Spq(14))
        W(5)=-(Q%C(10)*Spq(16))-Q%C(11)*Spq(17)
        W(6)=-(Q%C(12)*(Spq(16)+Spq(18)))-Q%C(13)*(Spq(17)+Spq(19))
        W(7)=-(Q%C(14)*(Spq(18)+Spq(20)))-Q%C(15)*Spq(22)
        W(8)=-(Q%C(16)*Spq(23))-Q%C(17)*(Spq(22)+Spq(24))
        W(9)=-(Q%C(18)*(Spq(23)+Spq(25)))-Q%C(19)*(Spq(24)+Spq(26))
        W(10)=-(Q%C(20)*(Spq(25)+Spq(27)))-Q%C(21)*Spq(29)
        W(11)=-(Q%C(22)*Spq(30))-Q%C(23)*(Spq(29)+Spq(31))
        W(12)=-(Q%C(24)*(Spq(30)+Spq(32)))-Q%C(25)*(Spq(31)+Spq(33))
        W(13)=-(Q%C(26)*(Spq(32)+Spq(34)))-Q%C(27)*(Spq(33)+Spq(35))
        W(14)=-(Q%C(28)*Spq(37))-Q%C(29)*Spq(38)
        W(15)=-(Q%C(30)*(Spq(37)+Spq(39)))-Q%C(31)*(Spq(38)+Spq(40))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Q%C(32)*(Spq(39)+Spq(41)))-Q%C(33)*(Spq(40)+Spq(42))
        W(19)=-(Q%C(34)*(Spq(41)+Spq(43)))-Q%C(35)*(Spq(42)+Spq(44))
        W(20)=(Cpq(3)+Cpq(5))*Q%S(2)+(Cpq(6)+Cpq(8))*Q%S(4)
        W(21)=(Cpq(7)+Cpq(9))*Q%S(5)+(Cpq(10)+Cpq(12))*Q%S(7)
        W(22)=(Cpq(11)+Cpq(13))*Q%S(8)+(Cpq(12)+Cpq(14))*Q%S(9)
        W(23)=(Cpq(15)+Cpq(17))*Q%S(11)+(Cpq(16)+Cpq(18))*Q%S(12)
        W(24)=(Cpq(17)+Cpq(19))*Q%S(13)+(Cpq(18)+Cpq(20))*Q%S(14)
        W(25)=(Cpq(21)+Cpq(23))*Q%S(16)+(Cpq(22)+Cpq(24))*Q%S(17)
        W(26)=(Cpq(23)+Cpq(25))*Q%S(18)+(Cpq(24)+Cpq(26))*Q%S(19)
        W(27)=(Cpq(25)+Cpq(27))*Q%S(20)+(Cpq(28)+Cpq(30))*Q%S(22)
        W(28)=(Cpq(29)+Cpq(31))*Q%S(23)+(Cpq(30)+Cpq(32))*Q%S(24)
        W(29)=(Cpq(31)+Cpq(33))*Q%S(25)+(Cpq(32)+Cpq(34))*Q%S(26)
        W(30)=(Cpq(33)+Cpq(35))*Q%S(27)+(Cpq(36)+Cpq(38))*Q%S(29)
        W(31)=(Cpq(37)+Cpq(39))*Q%S(30)+(Cpq(38)+Cpq(40))*Q%S(31)
        W(32)=(Cpq(39)+Cpq(41))*Q%S(32)+(Cpq(40)+Cpq(42))*Q%S(33)
        W(33)=(Cpq(41)+Cpq(43))*Q%S(34)+(Cpq(42)+Cpq(44))*Q%S(35)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        STwo=W(16)+W(17)+W(34)+W(35)
        SPKetC(2)=SPKetC(2)+CTwo*Two
        SPKetS(2)=SPKetS(2)+STwo*Two
!       -------------------------------- Lp=2, Mp = 0-------------------------------------
        W(1)=Cpq(3)*Q%C(0)+Cpq(6)*Q%C(1)+Cpq(10)*Q%C(3)+Cpq(15)*Q%C(6)
        W(2)=Cpq(21)*Q%C(10)+Cpq(28)*Q%C(15)+Cpq(36)*Q%C(21)+Cpq(45)*Q%C(28)
        COne=W(1)+W(2)
        W(1)=Cpq(7)*Q%C(2)+Cpq(11)*Q%C(4)+Cpq(12)*Q%C(5)
        W(2)=Cpq(16)*Q%C(7)+Cpq(17)*Q%C(8)+Cpq(18)*Q%C(9)+Cpq(22)*Q%C(11)
        W(3)=Cpq(23)*Q%C(12)+Cpq(24)*Q%C(13)+Cpq(25)*Q%C(14)
        W(4)=Cpq(29)*Q%C(16)+Cpq(30)*Q%C(17)+Cpq(31)*Q%C(18)+Cpq(32)*Q%C(19)
        W(5)=Cpq(33)*Q%C(20)+Cpq(37)*Q%C(22)+Cpq(38)*Q%C(23)
        W(6)=Cpq(39)*Q%C(24)+Cpq(40)*Q%C(25)+Cpq(41)*Q%C(26)+Cpq(42)*Q%C(27)
        W(7)=Cpq(46)*Q%C(29)+Cpq(47)*Q%C(30)+Cpq(48)*Q%C(31)
        W(8)=Cpq(49)*Q%C(32)+Cpq(50)*Q%C(33)+Cpq(51)*Q%C(34)+Cpq(52)*Q%C(35)
        W(9)=Spq(7)*Q%S(2)+Spq(11)*Q%S(4)+Spq(12)*Q%S(5)
        W(10)=Spq(16)*Q%S(7)+Spq(17)*Q%S(8)+Spq(18)*Q%S(9)+Spq(22)*Q%S(11)
        W(11)=Spq(23)*Q%S(12)+Spq(24)*Q%S(13)+Spq(25)*Q%S(14)
        W(12)=Spq(29)*Q%S(16)+Spq(30)*Q%S(17)+Spq(31)*Q%S(18)+Spq(32)*Q%S(19)
        W(13)=Spq(33)*Q%S(20)+Spq(37)*Q%S(22)+Spq(38)*Q%S(23)
        W(14)=Spq(39)*Q%S(24)+Spq(40)*Q%S(25)+Spq(41)*Q%S(26)+Spq(42)*Q%S(27)
        W(15)=Spq(46)*Q%S(29)+Spq(47)*Q%S(30)+Spq(48)*Q%S(31)
        W(16)=Spq(49)*Q%S(32)+Spq(50)*Q%S(33)+Spq(51)*Q%S(34)+Spq(52)*Q%S(35)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        SPKetC(3)=SPKetC(3)+COne+CTwo*Two
!       -------------------------------- Lp=2, Mp = 1-------------------------------------
        W(1)=Cpq(4)*Q%C(0)+Cpq(7)*Q%C(1)+(-Cpq(6)+Cpq(8))*Q%C(2)+Cpq(11)*Q%C(3)
        W(2)=(-Cpq(10)+Cpq(12))*Q%C(4)+(-Cpq(11)+Cpq(13))*Q%C(5)
        W(3)=Cpq(16)*Q%C(6)+(-Cpq(15)+Cpq(17))*Q%C(7)
        W(4)=(-Cpq(16)+Cpq(18))*Q%C(8)+(-Cpq(17)+Cpq(19))*Q%C(9)
        W(5)=Cpq(22)*Q%C(10)+(-Cpq(21)+Cpq(23))*Q%C(11)
        W(6)=(-Cpq(22)+Cpq(24))*Q%C(12)+(-Cpq(23)+Cpq(25))*Q%C(13)
        W(7)=(-Cpq(24)+Cpq(26))*Q%C(14)+Cpq(29)*Q%C(15)
        W(8)=(-Cpq(28)+Cpq(30))*Q%C(16)+(-Cpq(29)+Cpq(31))*Q%C(17)
        W(9)=(-Cpq(30)+Cpq(32))*Q%C(18)+(-Cpq(31)+Cpq(33))*Q%C(19)
        W(10)=(-Cpq(32)+Cpq(34))*Q%C(20)+Cpq(37)*Q%C(21)
        W(11)=(-Cpq(36)+Cpq(38))*Q%C(22)+(-Cpq(37)+Cpq(39))*Q%C(23)
        W(12)=(-Cpq(38)+Cpq(40))*Q%C(24)+(-Cpq(39)+Cpq(41))*Q%C(25)
        W(13)=(-Cpq(40)+Cpq(42))*Q%C(26)+(-Cpq(41)+Cpq(43))*Q%C(27)
        W(14)=Cpq(46)*Q%C(28)+(-Cpq(45)+Cpq(47))*Q%C(29)
        W(15)=(-Cpq(46)+Cpq(48))*Q%C(30)+(-Cpq(47)+Cpq(49))*Q%C(31)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=(-Cpq(48)+Cpq(50))*Q%C(32)+(-Cpq(49)+Cpq(51))*Q%C(33)
        W(19)=(-Cpq(50)+Cpq(52))*Q%C(34)+(-Cpq(51)+Cpq(53))*Q%C(35)
        W(20)=Spq(8)*Q%S(2)+Spq(12)*Q%S(4)+(-Spq(11)+Spq(13))*Q%S(5)+Spq(17)*Q%S(7)
        W(21)=(-Spq(16)+Spq(18))*Q%S(8)+(-Spq(17)+Spq(19))*Q%S(9)
        W(22)=Spq(23)*Q%S(11)+(-Spq(22)+Spq(24))*Q%S(12)
        W(23)=(-Spq(23)+Spq(25))*Q%S(13)+(-Spq(24)+Spq(26))*Q%S(14)
        W(24)=Spq(30)*Q%S(16)+(-Spq(29)+Spq(31))*Q%S(17)
        W(25)=(-Spq(30)+Spq(32))*Q%S(18)+(-Spq(31)+Spq(33))*Q%S(19)
        W(26)=(-Spq(32)+Spq(34))*Q%S(20)+Spq(38)*Q%S(22)
        W(27)=(-Spq(37)+Spq(39))*Q%S(23)+(-Spq(38)+Spq(40))*Q%S(24)
        W(28)=(-Spq(39)+Spq(41))*Q%S(25)+(-Spq(40)+Spq(42))*Q%S(26)
        W(29)=(-Spq(41)+Spq(43))*Q%S(27)+Spq(47)*Q%S(29)
        W(30)=(-Spq(46)+Spq(48))*Q%S(30)+(-Spq(47)+Spq(49))*Q%S(31)
        W(31)=(-Spq(48)+Spq(50))*Q%S(32)+(-Spq(49)+Spq(51))*Q%S(33)
        W(32)=(-Spq(50)+Spq(52))*Q%S(34)+(-Spq(51)+Spq(53))*Q%S(35)
        W(33)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(34)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)
        CTwo=W(16)+W(17)+W(33)+W(34)
        W(1)=Q%C(0)*Spq(4)+Q%C(1)*Spq(7)+Q%C(2)*Spq(8)+Q%C(3)*Spq(11)
        W(2)=Q%C(4)*Spq(12)+Q%C(5)*(Spq(11)+Spq(13))+Q%C(6)*Spq(16)+Q%C(7)*Spq(17)
        W(3)=Q%C(8)*(Spq(16)+Spq(18))+Q%C(9)*(Spq(17)+Spq(19))+Q%C(10)*Spq(22)+Q%C(11)*Spq(23)
        W(4)=Q%C(12)*(Spq(22)+Spq(24))+Q%C(13)*(Spq(23)+Spq(25))
        W(5)=Q%C(14)*(Spq(24)+Spq(26))+Q%C(15)*Spq(29)
        W(6)=Q%C(16)*Spq(30)+Q%C(17)*(Spq(29)+Spq(31))
        W(7)=Q%C(18)*(Spq(30)+Spq(32))+Q%C(19)*(Spq(31)+Spq(33))
        W(8)=Q%C(20)*(Spq(32)+Spq(34))+Q%C(21)*Spq(37)+Q%C(22)*Spq(38)+Q%C(23)*(Spq(37)+Spq(39))
        W(9)=Q%C(24)*(Spq(38)+Spq(40))+Q%C(25)*(Spq(39)+Spq(41))
        W(10)=Q%C(26)*(Spq(40)+Spq(42))+Q%C(27)*(Spq(41)+Spq(43))
        W(11)=Q%C(28)*Spq(46)+Q%C(29)*Spq(47)+Q%C(30)*(Spq(46)+Spq(48))+Q%C(31)*(Spq(47)+Spq(49))
        W(12)=Q%C(32)*(Spq(48)+Spq(50))+Q%C(33)*(Spq(49)+Spq(51))
        W(13)=Q%C(34)*(Spq(50)+Spq(52))+Q%C(35)*(Spq(51)+Spq(53))
        W(14)=-((Cpq(6)+Cpq(8))*Q%S(2))-(Cpq(10)+Cpq(12))*Q%S(4)
        W(15)=-((Cpq(11)+Cpq(13))*Q%S(5))-(Cpq(15)+Cpq(17))*Q%S(7)
        W(16)=-((Cpq(16)+Cpq(18))*Q%S(8))-(Cpq(17)+Cpq(19))*Q%S(9)
        W(17)=-((Cpq(21)+Cpq(23))*Q%S(11))-(Cpq(22)+Cpq(24))*Q%S(12)
        W(18)=-((Cpq(23)+Cpq(25))*Q%S(13))-(Cpq(24)+Cpq(26))*Q%S(14)
        W(19)=-((Cpq(28)+Cpq(30))*Q%S(16))-(Cpq(29)+Cpq(31))*Q%S(17)
        W(20)=-((Cpq(30)+Cpq(32))*Q%S(18))-(Cpq(31)+Cpq(33))*Q%S(19)
        W(21)=-((Cpq(32)+Cpq(34))*Q%S(20))-(Cpq(36)+Cpq(38))*Q%S(22)
        W(22)=-((Cpq(37)+Cpq(39))*Q%S(23))-(Cpq(38)+Cpq(40))*Q%S(24)
        W(23)=-((Cpq(39)+Cpq(41))*Q%S(25))-(Cpq(40)+Cpq(42))*Q%S(26)
        W(24)=-((Cpq(41)+Cpq(43))*Q%S(27))-(Cpq(45)+Cpq(47))*Q%S(29)
        W(25)=-((Cpq(46)+Cpq(48))*Q%S(30))-(Cpq(47)+Cpq(49))*Q%S(31)
        W(26)=-((Cpq(48)+Cpq(50))*Q%S(32))-(Cpq(49)+Cpq(51))*Q%S(33)
        W(27)=-((Cpq(50)+Cpq(52))*Q%S(34))-(Cpq(51)+Cpq(53))*Q%S(35)
        W(28)=W(12)+W(13)+W(14)+W(15)+W(16)+W(17)+W(18)+W(19)
        W(29)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        STwo=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)+W(9)+W(10)+W(11)+W(28)+W(29)
        SPKetC(4)=SPKetC(4)+CTwo*Two
        SPKetS(4)=SPKetS(4)+STwo*Two
!       -------------------------------- Lp=2, Mp = 2-------------------------------------
        W(1)=Cpq(5)*Q%C(0)+Cpq(8)*Q%C(1)+(-Cpq(7)+Cpq(9))*Q%C(2)+Cpq(12)*Q%C(3)
        W(2)=(-Cpq(11)+Cpq(13))*Q%C(4)+(Cpq(10)+Cpq(14))*Q%C(5)
        W(3)=Cpq(17)*Q%C(6)+(-Cpq(16)+Cpq(18))*Q%C(7)
        W(4)=(Cpq(15)+Cpq(19))*Q%C(8)+(Cpq(16)+Cpq(20))*Q%C(9)
        W(5)=Cpq(23)*Q%C(10)+(-Cpq(22)+Cpq(24))*Q%C(11)
        W(6)=(Cpq(21)+Cpq(25))*Q%C(12)+(Cpq(22)+Cpq(26))*Q%C(13)
        W(7)=(Cpq(23)+Cpq(27))*Q%C(14)+Cpq(30)*Q%C(15)
        W(8)=(-Cpq(29)+Cpq(31))*Q%C(16)+(Cpq(28)+Cpq(32))*Q%C(17)
        W(9)=(Cpq(29)+Cpq(33))*Q%C(18)+(Cpq(30)+Cpq(34))*Q%C(19)
        W(10)=(Cpq(31)+Cpq(35))*Q%C(20)+Cpq(38)*Q%C(21)
        W(11)=(-Cpq(37)+Cpq(39))*Q%C(22)+(Cpq(36)+Cpq(40))*Q%C(23)
        W(12)=(Cpq(37)+Cpq(41))*Q%C(24)+(Cpq(38)+Cpq(42))*Q%C(25)
        W(13)=(Cpq(39)+Cpq(43))*Q%C(26)+(Cpq(40)+Cpq(44))*Q%C(27)
        W(14)=Cpq(47)*Q%C(28)+(-Cpq(46)+Cpq(48))*Q%C(29)
        W(15)=(Cpq(45)+Cpq(49))*Q%C(30)+(Cpq(46)+Cpq(50))*Q%C(31)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=(Cpq(47)+Cpq(51))*Q%C(32)+(Cpq(48)+Cpq(52))*Q%C(33)
        W(19)=(Cpq(49)+Cpq(53))*Q%C(34)+(Cpq(50)+Cpq(54))*Q%C(35)
        W(20)=(Spq(7)+Spq(9))*Q%S(2)+(Spq(11)+Spq(13))*Q%S(4)
        W(21)=Spq(14)*Q%S(5)+(Spq(16)+Spq(18))*Q%S(7)
        W(22)=Spq(19)*Q%S(8)+(Spq(16)+Spq(20))*Q%S(9)+(Spq(22)+Spq(24))*Q%S(11)+Spq(25)*Q%S(12)
        W(23)=(Spq(22)+Spq(26))*Q%S(13)+(Spq(23)+Spq(27))*Q%S(14)
        W(24)=(Spq(29)+Spq(31))*Q%S(16)+Spq(32)*Q%S(17)
        W(25)=(Spq(29)+Spq(33))*Q%S(18)+(Spq(30)+Spq(34))*Q%S(19)
        W(26)=(Spq(31)+Spq(35))*Q%S(20)+(Spq(37)+Spq(39))*Q%S(22)
        W(27)=Spq(40)*Q%S(23)+(Spq(37)+Spq(41))*Q%S(24)
        W(28)=(Spq(38)+Spq(42))*Q%S(25)+(Spq(39)+Spq(43))*Q%S(26)
        W(29)=(Spq(40)+Spq(44))*Q%S(27)+(Spq(46)+Spq(48))*Q%S(29)
        W(30)=Spq(49)*Q%S(30)+(Spq(46)+Spq(50))*Q%S(31)
        W(31)=(Spq(47)+Spq(51))*Q%S(32)+(Spq(48)+Spq(52))*Q%S(33)
        W(32)=(Spq(49)+Spq(53))*Q%S(34)+(Spq(50)+Spq(54))*Q%S(35)
        W(33)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(34)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)
        CTwo=W(16)+W(17)+W(33)+W(34)
        W(1)=Q%C(0)*Spq(5)+Q%C(1)*Spq(8)+Q%C(2)*(-Spq(7)+Spq(9))+Q%C(3)*Spq(12)
        W(2)=Q%C(4)*(-Spq(11)+Spq(13))+Q%C(5)*Spq(14)
        W(3)=Q%C(6)*Spq(17)+Q%C(7)*(-Spq(16)+Spq(18))
        W(4)=Q%C(8)*Spq(19)+Q%C(9)*(-Spq(16)+Spq(20))
        W(5)=Q%C(10)*Spq(23)+Q%C(11)*(-Spq(22)+Spq(24))
        W(6)=Q%C(12)*Spq(25)+Q%C(13)*(-Spq(22)+Spq(26))
        W(7)=Q%C(14)*(-Spq(23)+Spq(27))+Q%C(15)*Spq(30)
        W(8)=Q%C(16)*(-Spq(29)+Spq(31))+Q%C(17)*Spq(32)
        W(9)=Q%C(18)*(-Spq(29)+Spq(33))+Q%C(19)*(-Spq(30)+Spq(34))
        W(10)=Q%C(20)*(-Spq(31)+Spq(35))+Q%C(21)*Spq(38)
        W(11)=Q%C(22)*(-Spq(37)+Spq(39))+Q%C(23)*Spq(40)
        W(12)=Q%C(24)*(-Spq(37)+Spq(41))+Q%C(25)*(-Spq(38)+Spq(42))
        W(13)=Q%C(26)*(-Spq(39)+Spq(43))+Q%C(27)*(-Spq(40)+Spq(44))
        W(14)=Q%C(28)*Spq(47)+Q%C(29)*(-Spq(46)+Spq(48))
        W(15)=Q%C(30)*Spq(49)+Q%C(31)*(-Spq(46)+Spq(50))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Q%C(32)*(-Spq(47)+Spq(51))+Q%C(33)*(-Spq(48)+Spq(52))
        W(19)=Q%C(34)*(-Spq(49)+Spq(53))+Q%C(35)*(-Spq(50)+Spq(54))
        W(20)=-((Cpq(7)+Cpq(9))*Q%S(2))-(Cpq(11)+Cpq(13))*Q%S(4)
        W(21)=(Cpq(10)-Cpq(14))*Q%S(5)-(Cpq(16)+Cpq(18))*Q%S(7)
        W(22)=(Cpq(15)-Cpq(19))*Q%S(8)+(Cpq(16)-Cpq(20))*Q%S(9)
        W(23)=-((Cpq(22)+Cpq(24))*Q%S(11))+(Cpq(21)-Cpq(25))*Q%S(12)
        W(24)=(Cpq(22)-Cpq(26))*Q%S(13)+(Cpq(23)-Cpq(27))*Q%S(14)
        W(25)=-((Cpq(29)+Cpq(31))*Q%S(16))+(Cpq(28)-Cpq(32))*Q%S(17)
        W(26)=(Cpq(29)-Cpq(33))*Q%S(18)+(Cpq(30)-Cpq(34))*Q%S(19)
        W(27)=(Cpq(31)-Cpq(35))*Q%S(20)-(Cpq(37)+Cpq(39))*Q%S(22)
        W(28)=(Cpq(36)-Cpq(40))*Q%S(23)+(Cpq(37)-Cpq(41))*Q%S(24)
        W(29)=(Cpq(38)-Cpq(42))*Q%S(25)+(Cpq(39)-Cpq(43))*Q%S(26)
        W(30)=(Cpq(40)-Cpq(44))*Q%S(27)-(Cpq(46)+Cpq(48))*Q%S(29)
        W(31)=(Cpq(45)-Cpq(49))*Q%S(30)+(Cpq(46)-Cpq(50))*Q%S(31)
        W(32)=(Cpq(47)-Cpq(51))*Q%S(32)+(Cpq(48)-Cpq(52))*Q%S(33)
        W(33)=(Cpq(49)-Cpq(53))*Q%S(34)+(Cpq(50)-Cpq(54))*Q%S(35)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        STwo=W(16)+W(17)+W(34)+W(35)
        SPKetC(5)=SPKetC(5)+CTwo*Two
        SPKetS(5)=SPKetS(5)+STwo*Two
!       -------------------------------- Lp=3, Mp = 0-------------------------------------
        W(1)=-(Cpq(6)*Q%C(0))-Cpq(10)*Q%C(1)-Cpq(15)*Q%C(3)-Cpq(21)*Q%C(6)
        W(2)=-(Cpq(28)*Q%C(10))-Cpq(36)*Q%C(15)-Cpq(45)*Q%C(21)-Cpq(55)*Q%C(28)
        COne=W(1)+W(2)
        W(1)=-(Cpq(11)*Q%C(2))-Cpq(16)*Q%C(4)-Cpq(17)*Q%C(5)
        W(2)=-(Cpq(22)*Q%C(7))-Cpq(23)*Q%C(8)-Cpq(24)*Q%C(9)-Cpq(29)*Q%C(11)
        W(3)=-(Cpq(30)*Q%C(12))-Cpq(31)*Q%C(13)-Cpq(32)*Q%C(14)
        W(4)=-(Cpq(37)*Q%C(16))-Cpq(38)*Q%C(17)-Cpq(39)*Q%C(18)-Cpq(40)*Q%C(19)
        W(5)=-(Cpq(41)*Q%C(20))-Cpq(46)*Q%C(22)-Cpq(47)*Q%C(23)
        W(6)=-(Cpq(48)*Q%C(24))-Cpq(49)*Q%C(25)-Cpq(50)*Q%C(26)-Cpq(51)*Q%C(27)
        W(7)=-(Cpq(56)*Q%C(29))-Cpq(57)*Q%C(30)-Cpq(58)*Q%C(31)
        W(8)=-(Cpq(59)*Q%C(32))-Cpq(60)*Q%C(33)-Cpq(61)*Q%C(34)-Cpq(62)*Q%C(35)
        W(9)=-(Spq(11)*Q%S(2))-Spq(16)*Q%S(4)-Spq(17)*Q%S(5)
        W(10)=-(Spq(22)*Q%S(7))-Spq(23)*Q%S(8)-Spq(24)*Q%S(9)-Spq(29)*Q%S(11)
        W(11)=-(Spq(30)*Q%S(12))-Spq(31)*Q%S(13)-Spq(32)*Q%S(14)
        W(12)=-(Spq(37)*Q%S(16))-Spq(38)*Q%S(17)-Spq(39)*Q%S(18)-Spq(40)*Q%S(19)
        W(13)=-(Spq(41)*Q%S(20))-Spq(46)*Q%S(22)-Spq(47)*Q%S(23)
        W(14)=-(Spq(48)*Q%S(24))-Spq(49)*Q%S(25)-Spq(50)*Q%S(26)-Spq(51)*Q%S(27)
        W(15)=-(Spq(56)*Q%S(29))-Spq(57)*Q%S(30)-Spq(58)*Q%S(31)
        W(16)=-(Spq(59)*Q%S(32))-Spq(60)*Q%S(33)-Spq(61)*Q%S(34)-Spq(62)*Q%S(35)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        SPKetC(6)=SPKetC(6)+COne+CTwo*Two
!       -------------------------------- Lp=3, Mp = 1-------------------------------------
        W(1)=-(Cpq(7)*Q%C(0))-Cpq(11)*Q%C(1)
        W(2)=(Cpq(10)-Cpq(12))*Q%C(2)-Cpq(16)*Q%C(3)
        W(3)=(Cpq(15)-Cpq(17))*Q%C(4)+(Cpq(16)-Cpq(18))*Q%C(5)
        W(4)=-(Cpq(22)*Q%C(6))+(Cpq(21)-Cpq(23))*Q%C(7)
        W(5)=(Cpq(22)-Cpq(24))*Q%C(8)+(Cpq(23)-Cpq(25))*Q%C(9)
        W(6)=-(Cpq(29)*Q%C(10))+(Cpq(28)-Cpq(30))*Q%C(11)
        W(7)=(Cpq(29)-Cpq(31))*Q%C(12)+(Cpq(30)-Cpq(32))*Q%C(13)
        W(8)=(Cpq(31)-Cpq(33))*Q%C(14)-Cpq(37)*Q%C(15)
        W(9)=(Cpq(36)-Cpq(38))*Q%C(16)+(Cpq(37)-Cpq(39))*Q%C(17)
        W(10)=(Cpq(38)-Cpq(40))*Q%C(18)+(Cpq(39)-Cpq(41))*Q%C(19)
        W(11)=(Cpq(40)-Cpq(42))*Q%C(20)-Cpq(46)*Q%C(21)
        W(12)=(Cpq(45)-Cpq(47))*Q%C(22)+(Cpq(46)-Cpq(48))*Q%C(23)
        W(13)=(Cpq(47)-Cpq(49))*Q%C(24)+(Cpq(48)-Cpq(50))*Q%C(25)
        W(14)=(Cpq(49)-Cpq(51))*Q%C(26)+(Cpq(50)-Cpq(52))*Q%C(27)
        W(15)=-(Cpq(56)*Q%C(28))+(Cpq(55)-Cpq(57))*Q%C(29)
        W(16)=(Cpq(56)-Cpq(58))*Q%C(30)+(Cpq(57)-Cpq(59))*Q%C(31)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=(Cpq(58)-Cpq(60))*Q%C(32)+(Cpq(59)-Cpq(61))*Q%C(33)
        W(20)=(Cpq(60)-Cpq(62))*Q%C(34)+(Cpq(61)-Cpq(63))*Q%C(35)
        W(21)=-(Spq(12)*Q%S(2))-Spq(17)*Q%S(4)
        W(22)=(Spq(16)-Spq(18))*Q%S(5)-Spq(23)*Q%S(7)
        W(23)=(Spq(22)-Spq(24))*Q%S(8)+(Spq(23)-Spq(25))*Q%S(9)
        W(24)=-(Spq(30)*Q%S(11))+(Spq(29)-Spq(31))*Q%S(12)
        W(25)=(Spq(30)-Spq(32))*Q%S(13)+(Spq(31)-Spq(33))*Q%S(14)
        W(26)=-(Spq(38)*Q%S(16))+(Spq(37)-Spq(39))*Q%S(17)
        W(27)=(Spq(38)-Spq(40))*Q%S(18)+(Spq(39)-Spq(41))*Q%S(19)
        W(28)=(Spq(40)-Spq(42))*Q%S(20)-Spq(47)*Q%S(22)
        W(29)=(Spq(46)-Spq(48))*Q%S(23)+(Spq(47)-Spq(49))*Q%S(24)
        W(30)=(Spq(48)-Spq(50))*Q%S(25)+(Spq(49)-Spq(51))*Q%S(26)
        W(31)=(Spq(50)-Spq(52))*Q%S(27)-Spq(57)*Q%S(29)
        W(32)=(Spq(56)-Spq(58))*Q%S(30)+(Spq(57)-Spq(59))*Q%S(31)
        W(33)=(Spq(58)-Spq(60))*Q%S(32)+(Spq(59)-Spq(61))*Q%S(33)
        W(34)=(Spq(60)-Spq(62))*Q%S(34)+(Spq(61)-Spq(63))*Q%S(35)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        CTwo=W(17)+W(18)+W(35)+W(36)
        W(1)=-(Q%C(0)*Spq(7))-Q%C(1)*Spq(11)-Q%C(2)*Spq(12)-Q%C(3)*Spq(16)
        W(2)=-(Q%C(4)*Spq(17))-Q%C(5)*(Spq(16)+Spq(18))
        W(3)=-(Q%C(6)*Spq(22))-Q%C(7)*Spq(23)
        W(4)=-(Q%C(8)*(Spq(22)+Spq(24)))-Q%C(9)*(Spq(23)+Spq(25))
        W(5)=-(Q%C(10)*Spq(29))-Q%C(11)*Spq(30)
        W(6)=-(Q%C(12)*(Spq(29)+Spq(31)))-Q%C(13)*(Spq(30)+Spq(32))
        W(7)=-(Q%C(14)*(Spq(31)+Spq(33)))-Q%C(15)*Spq(37)
        W(8)=-(Q%C(16)*Spq(38))-Q%C(17)*(Spq(37)+Spq(39))
        W(9)=-(Q%C(18)*(Spq(38)+Spq(40)))-Q%C(19)*(Spq(39)+Spq(41))
        W(10)=-(Q%C(20)*(Spq(40)+Spq(42)))-Q%C(21)*Spq(46)
        W(11)=-(Q%C(22)*Spq(47))-Q%C(23)*(Spq(46)+Spq(48))
        W(12)=-(Q%C(24)*(Spq(47)+Spq(49)))-Q%C(25)*(Spq(48)+Spq(50))
        W(13)=-(Q%C(26)*(Spq(49)+Spq(51)))-Q%C(27)*(Spq(50)+Spq(52))
        W(14)=-(Q%C(28)*Spq(56))-Q%C(29)*Spq(57)
        W(15)=-(Q%C(30)*(Spq(56)+Spq(58)))-Q%C(31)*(Spq(57)+Spq(59))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Q%C(32)*(Spq(58)+Spq(60)))-Q%C(33)*(Spq(59)+Spq(61))
        W(19)=-(Q%C(34)*(Spq(60)+Spq(62)))-Q%C(35)*(Spq(61)+Spq(63))
        W(20)=(Cpq(10)+Cpq(12))*Q%S(2)+(Cpq(15)+Cpq(17))*Q%S(4)
        W(21)=(Cpq(16)+Cpq(18))*Q%S(5)+(Cpq(21)+Cpq(23))*Q%S(7)
        W(22)=(Cpq(22)+Cpq(24))*Q%S(8)+(Cpq(23)+Cpq(25))*Q%S(9)
        W(23)=(Cpq(28)+Cpq(30))*Q%S(11)+(Cpq(29)+Cpq(31))*Q%S(12)
        W(24)=(Cpq(30)+Cpq(32))*Q%S(13)+(Cpq(31)+Cpq(33))*Q%S(14)
        W(25)=(Cpq(36)+Cpq(38))*Q%S(16)+(Cpq(37)+Cpq(39))*Q%S(17)
        W(26)=(Cpq(38)+Cpq(40))*Q%S(18)+(Cpq(39)+Cpq(41))*Q%S(19)
        W(27)=(Cpq(40)+Cpq(42))*Q%S(20)+(Cpq(45)+Cpq(47))*Q%S(22)
        W(28)=(Cpq(46)+Cpq(48))*Q%S(23)+(Cpq(47)+Cpq(49))*Q%S(24)
        W(29)=(Cpq(48)+Cpq(50))*Q%S(25)+(Cpq(49)+Cpq(51))*Q%S(26)
        W(30)=(Cpq(50)+Cpq(52))*Q%S(27)+(Cpq(55)+Cpq(57))*Q%S(29)
        W(31)=(Cpq(56)+Cpq(58))*Q%S(30)+(Cpq(57)+Cpq(59))*Q%S(31)
        W(32)=(Cpq(58)+Cpq(60))*Q%S(32)+(Cpq(59)+Cpq(61))*Q%S(33)
        W(33)=(Cpq(60)+Cpq(62))*Q%S(34)+(Cpq(61)+Cpq(63))*Q%S(35)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        STwo=W(16)+W(17)+W(34)+W(35)
        SPKetC(7)=SPKetC(7)+CTwo*Two
        SPKetS(7)=SPKetS(7)+STwo*Two
!       -------------------------------- Lp=3, Mp = 2-------------------------------------
        W(1)=-(Cpq(8)*Q%C(0))-Cpq(12)*Q%C(1)+Cpq(11)*Q%C(2)
        W(2)=-(Cpq(13)*Q%C(2))-Cpq(17)*Q%C(3)+Cpq(16)*Q%C(4)-Cpq(18)*Q%C(4)
        W(3)=-(Cpq(15)*Q%C(5))-Cpq(19)*Q%C(5)-Cpq(23)*Q%C(6)
        W(4)=Cpq(22)*Q%C(7)-Cpq(24)*Q%C(7)-Cpq(21)*Q%C(8)-Cpq(25)*Q%C(8)
        W(5)=-(Cpq(22)*Q%C(9))-Cpq(26)*Q%C(9)-Cpq(30)*Q%C(10)
        W(6)=Cpq(29)*Q%C(11)-Cpq(31)*Q%C(11)-Cpq(28)*Q%C(12)-Cpq(32)*Q%C(12)
        W(7)=-(Cpq(29)*Q%C(13))-Cpq(33)*Q%C(13)-Cpq(30)*Q%C(14)
        W(8)=-(Cpq(34)*Q%C(14))-Cpq(38)*Q%C(15)+Cpq(37)*Q%C(16)-Cpq(39)*Q%C(16)
        W(9)=-(Cpq(36)*Q%C(17))-Cpq(40)*Q%C(17)-Cpq(37)*Q%C(18)
        W(10)=-(Cpq(41)*Q%C(18))-Cpq(38)*Q%C(19)-Cpq(42)*Q%C(19)-Cpq(39)*Q%C(20)
        W(11)=-(Cpq(43)*Q%C(20))-Cpq(47)*Q%C(21)+Cpq(46)*Q%C(22)
        W(12)=-(Cpq(48)*Q%C(22))-Cpq(45)*Q%C(23)-Cpq(49)*Q%C(23)-Cpq(46)*Q%C(24)
        W(13)=-(Cpq(50)*Q%C(24))-Cpq(47)*Q%C(25)-Cpq(51)*Q%C(25)
        W(14)=-(Cpq(48)*Q%C(26))-Cpq(52)*Q%C(26)-Cpq(49)*Q%C(27)-Cpq(53)*Q%C(27)
        W(15)=-(Cpq(57)*Q%C(28))+Cpq(56)*Q%C(29)-Cpq(58)*Q%C(29)-Cpq(55)*Q%C(30)
        W(16)=-(Cpq(59)*Q%C(30))-Cpq(56)*Q%C(31)-Cpq(60)*Q%C(31)-Cpq(57)*Q%C(32)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=-(Cpq(61)*Q%C(32))-Cpq(58)*Q%C(33)-Cpq(62)*Q%C(33)
        W(20)=-(Cpq(59)*Q%C(34))-Cpq(63)*Q%C(34)-Cpq(60)*Q%C(35)-Cpq(64)*Q%C(35)
        W(21)=-(Spq(11)*Q%S(2))-Spq(13)*Q%S(2)-Spq(16)*Q%S(4)
        W(22)=-(Spq(18)*Q%S(4))-Spq(19)*Q%S(5)-Spq(22)*Q%S(7)-Spq(24)*Q%S(7)
        W(23)=-(Spq(25)*Q%S(8))-Spq(22)*Q%S(9)-Spq(26)*Q%S(9)
        W(24)=-(Spq(29)*Q%S(11))-Spq(31)*Q%S(11)-Spq(32)*Q%S(12)-Spq(29)*Q%S(13)
        W(25)=-(Spq(33)*Q%S(13))-Spq(30)*Q%S(14)-Spq(34)*Q%S(14)
        W(26)=-(Spq(37)*Q%S(16))-Spq(39)*Q%S(16)-Spq(40)*Q%S(17)-Spq(37)*Q%S(18)
        W(27)=-(Spq(41)*Q%S(18))-Spq(38)*Q%S(19)-Spq(42)*Q%S(19)
        W(28)=-(Spq(39)*Q%S(20))-Spq(43)*Q%S(20)-Spq(46)*Q%S(22)-Spq(48)*Q%S(22)
        W(29)=-(Spq(49)*Q%S(23))-Spq(46)*Q%S(24)-Spq(50)*Q%S(24)
        W(30)=-(Spq(47)*Q%S(25))-Spq(51)*Q%S(25)-Spq(48)*Q%S(26)-Spq(52)*Q%S(26)
        W(31)=-(Spq(49)*Q%S(27))-Spq(53)*Q%S(27)-Spq(56)*Q%S(29)
        W(32)=-(Spq(58)*Q%S(29))-Spq(59)*Q%S(30)-Spq(56)*Q%S(31)-Spq(60)*Q%S(31)
        W(33)=-(Spq(57)*Q%S(32))-Spq(61)*Q%S(32)-Spq(58)*Q%S(33)-Spq(62)*Q%S(33)
        W(34)=-(Spq(59)*Q%S(34))-Spq(63)*Q%S(34)-Spq(60)*Q%S(35)-Spq(64)*Q%S(35)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        CTwo=W(17)+W(18)+W(35)+W(36)
        W(1)=-(Q%C(0)*Spq(8))-Q%C(1)*Spq(12)
        W(2)=Q%C(2)*(Spq(11)-Spq(13))-Q%C(3)*Spq(17)
        W(3)=Q%C(4)*(Spq(16)-Spq(18))-Q%C(5)*Spq(19)
        W(4)=-(Q%C(6)*Spq(23))+Q%C(7)*(Spq(22)-Spq(24))
        W(5)=-(Q%C(8)*Spq(25))+Q%C(9)*(Spq(22)-Spq(26))
        W(6)=-(Q%C(10)*Spq(30))+Q%C(11)*(Spq(29)-Spq(31))
        W(7)=-(Q%C(12)*Spq(32))+Q%C(13)*(Spq(29)-Spq(33))
        W(8)=Q%C(14)*(Spq(30)-Spq(34))-Q%C(15)*Spq(38)
        W(9)=Q%C(16)*(Spq(37)-Spq(39))-Q%C(17)*Spq(40)
        W(10)=Q%C(18)*(Spq(37)-Spq(41))+Q%C(19)*(Spq(38)-Spq(42))
        W(11)=Q%C(20)*(Spq(39)-Spq(43))-Q%C(21)*Spq(47)
        W(12)=Q%C(22)*(Spq(46)-Spq(48))-Q%C(23)*Spq(49)
        W(13)=Q%C(24)*(Spq(46)-Spq(50))+Q%C(25)*(Spq(47)-Spq(51))
        W(14)=Q%C(26)*(Spq(48)-Spq(52))+Q%C(27)*(Spq(49)-Spq(53))
        W(15)=-(Q%C(28)*Spq(57))+Q%C(29)*(Spq(56)-Spq(58))
        W(16)=-(Q%C(30)*Spq(59))+Q%C(31)*(Spq(56)-Spq(60))
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=Q%C(32)*(Spq(57)-Spq(61))+Q%C(33)*(Spq(58)-Spq(62))
        W(20)=Q%C(34)*(Spq(59)-Spq(63))+Q%C(35)*(Spq(60)-Spq(64))
        W(21)=(Cpq(11)+Cpq(13))*Q%S(2)+(Cpq(16)+Cpq(18))*Q%S(4)
        W(22)=(-Cpq(15)+Cpq(19))*Q%S(5)+(Cpq(22)+Cpq(24))*Q%S(7)
        W(23)=(-Cpq(21)+Cpq(25))*Q%S(8)+(-Cpq(22)+Cpq(26))*Q%S(9)
        W(24)=(Cpq(29)+Cpq(31))*Q%S(11)+(-Cpq(28)+Cpq(32))*Q%S(12)
        W(25)=(-Cpq(29)+Cpq(33))*Q%S(13)+(-Cpq(30)+Cpq(34))*Q%S(14)
        W(26)=(Cpq(37)+Cpq(39))*Q%S(16)+(-Cpq(36)+Cpq(40))*Q%S(17)
        W(27)=(-Cpq(37)+Cpq(41))*Q%S(18)+(-Cpq(38)+Cpq(42))*Q%S(19)
        W(28)=(-Cpq(39)+Cpq(43))*Q%S(20)+(Cpq(46)+Cpq(48))*Q%S(22)
        W(29)=(-Cpq(45)+Cpq(49))*Q%S(23)+(-Cpq(46)+Cpq(50))*Q%S(24)
        W(30)=(-Cpq(47)+Cpq(51))*Q%S(25)+(-Cpq(48)+Cpq(52))*Q%S(26)
        W(31)=(-Cpq(49)+Cpq(53))*Q%S(27)+(Cpq(56)+Cpq(58))*Q%S(29)
        W(32)=(-Cpq(55)+Cpq(59))*Q%S(30)+(-Cpq(56)+Cpq(60))*Q%S(31)
        W(33)=(-Cpq(57)+Cpq(61))*Q%S(32)+(-Cpq(58)+Cpq(62))*Q%S(33)
        W(34)=(-Cpq(59)+Cpq(63))*Q%S(34)+(-Cpq(60)+Cpq(64))*Q%S(35)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        STwo=W(17)+W(18)+W(35)+W(36)
        SPKetC(8)=SPKetC(8)+CTwo*Two
        SPKetS(8)=SPKetS(8)+STwo*Two
!       -------------------------------- Lp=3, Mp = 3-------------------------------------
        W(1)=-(Cpq(9)*Q%C(0))-Cpq(13)*Q%C(1)
        W(2)=(Cpq(12)-Cpq(14))*Q%C(2)-Cpq(18)*Q%C(3)
        W(3)=(Cpq(17)-Cpq(19))*Q%C(4)-(Cpq(16)+Cpq(20))*Q%C(5)
        W(4)=-(Cpq(24)*Q%C(6))+(Cpq(23)-Cpq(25))*Q%C(7)
        W(5)=-((Cpq(22)+Cpq(26))*Q%C(8))+(Cpq(21)-Cpq(27))*Q%C(9)
        W(6)=-(Cpq(31)*Q%C(10))+(Cpq(30)-Cpq(32))*Q%C(11)
        W(7)=-((Cpq(29)+Cpq(33))*Q%C(12))+(Cpq(28)-Cpq(34))*Q%C(13)
        W(8)=(Cpq(29)-Cpq(35))*Q%C(14)-Cpq(39)*Q%C(15)
        W(9)=(Cpq(38)-Cpq(40))*Q%C(16)-(Cpq(37)+Cpq(41))*Q%C(17)
        W(10)=(Cpq(36)-Cpq(42))*Q%C(18)+(Cpq(37)-Cpq(43))*Q%C(19)
        W(11)=(Cpq(38)-Cpq(44))*Q%C(20)-Cpq(48)*Q%C(21)
        W(12)=(Cpq(47)-Cpq(49))*Q%C(22)-(Cpq(46)+Cpq(50))*Q%C(23)
        W(13)=(Cpq(45)-Cpq(51))*Q%C(24)+(Cpq(46)-Cpq(52))*Q%C(25)
        W(14)=(Cpq(47)-Cpq(53))*Q%C(26)+(Cpq(48)-Cpq(54))*Q%C(27)
        W(15)=-(Cpq(58)*Q%C(28))+(Cpq(57)-Cpq(59))*Q%C(29)
        W(16)=-((Cpq(56)+Cpq(60))*Q%C(30))+(Cpq(55)-Cpq(61))*Q%C(31)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=(Cpq(56)-Cpq(62))*Q%C(32)+(Cpq(57)-Cpq(63))*Q%C(33)
        W(20)=(Cpq(58)-Cpq(64))*Q%C(34)+(Cpq(59)-Cpq(65))*Q%C(35)
        W(21)=-((Spq(12)+Spq(14))*Q%S(2))-(Spq(17)+Spq(19))*Q%S(4)
        W(22)=(Spq(16)-Spq(20))*Q%S(5)-(Spq(23)+Spq(25))*Q%S(7)
        W(23)=(Spq(22)-Spq(26))*Q%S(8)-Spq(27)*Q%S(9)
        W(24)=-((Spq(30)+Spq(32))*Q%S(11))+(Spq(29)-Spq(33))*Q%S(12)
        W(25)=-(Spq(34)*Q%S(13))+(Spq(29)-Spq(35))*Q%S(14)
        W(26)=-((Spq(38)+Spq(40))*Q%S(16))+(Spq(37)-Spq(41))*Q%S(17)
        W(27)=-(Spq(42)*Q%S(18))+(Spq(37)-Spq(43))*Q%S(19)
        W(28)=(Spq(38)-Spq(44))*Q%S(20)-(Spq(47)+Spq(49))*Q%S(22)
        W(29)=(Spq(46)-Spq(50))*Q%S(23)-Spq(51)*Q%S(24)
        W(30)=(Spq(46)-Spq(52))*Q%S(25)+(Spq(47)-Spq(53))*Q%S(26)
        W(31)=(Spq(48)-Spq(54))*Q%S(27)-(Spq(57)+Spq(59))*Q%S(29)
        W(32)=(Spq(56)-Spq(60))*Q%S(30)-Spq(61)*Q%S(31)
        W(33)=(Spq(56)-Spq(62))*Q%S(32)+(Spq(57)-Spq(63))*Q%S(33)
        W(34)=(Spq(58)-Spq(64))*Q%S(34)+(Spq(59)-Spq(65))*Q%S(35)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        CTwo=W(17)+W(18)+W(35)+W(36)
        W(1)=-(Q%C(0)*Spq(9))-Q%C(1)*Spq(13)
        W(2)=Q%C(2)*(Spq(12)-Spq(14))-Q%C(3)*Spq(18)
        W(3)=Q%C(4)*(Spq(17)-Spq(19))-Q%C(5)*(Spq(16)+Spq(20))
        W(4)=-(Q%C(6)*Spq(24))+Q%C(7)*(Spq(23)-Spq(25))
        W(5)=-(Q%C(8)*(Spq(22)+Spq(26)))-Q%C(9)*Spq(27)
        W(6)=-(Q%C(10)*Spq(31))+Q%C(11)*(Spq(30)-Spq(32))
        W(7)=-(Q%C(12)*(Spq(29)+Spq(33)))-Q%C(13)*Spq(34)
        W(8)=-(Q%C(14)*(Spq(29)+Spq(35)))-Q%C(15)*Spq(39)
        W(9)=Q%C(16)*(Spq(38)-Spq(40))-Q%C(17)*(Spq(37)+Spq(41))
        W(10)=-(Q%C(18)*Spq(42))-Q%C(19)*(Spq(37)+Spq(43))
        W(11)=-(Q%C(20)*(Spq(38)+Spq(44)))-Q%C(21)*Spq(48)
        W(12)=Q%C(22)*(Spq(47)-Spq(49))-Q%C(23)*(Spq(46)+Spq(50))
        W(13)=-(Q%C(24)*Spq(51))-Q%C(25)*(Spq(46)+Spq(52))
        W(14)=-(Q%C(26)*(Spq(47)+Spq(53)))-Q%C(27)*(Spq(48)+Spq(54))
        W(15)=-(Q%C(28)*Spq(58))+Q%C(29)*(Spq(57)-Spq(59))
        W(16)=-(Q%C(30)*(Spq(56)+Spq(60)))-Q%C(31)*Spq(61)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=-(Q%C(32)*(Spq(56)+Spq(62)))-Q%C(33)*(Spq(57)+Spq(63))
        W(20)=-(Q%C(34)*(Spq(58)+Spq(64)))-Q%C(35)*(Spq(59)+Spq(65))
        W(21)=(Cpq(12)+Cpq(14))*Q%S(2)+(Cpq(17)+Cpq(19))*Q%S(4)
        W(22)=(-Cpq(16)+Cpq(20))*Q%S(5)+(Cpq(23)+Cpq(25))*Q%S(7)
        W(23)=(-Cpq(22)+Cpq(26))*Q%S(8)+(Cpq(21)+Cpq(27))*Q%S(9)
        W(24)=(Cpq(30)+Cpq(32))*Q%S(11)+(-Cpq(29)+Cpq(33))*Q%S(12)
        W(25)=(Cpq(28)+Cpq(34))*Q%S(13)+(Cpq(29)+Cpq(35))*Q%S(14)
        W(26)=(Cpq(38)+Cpq(40))*Q%S(16)+(-Cpq(37)+Cpq(41))*Q%S(17)
        W(27)=(Cpq(36)+Cpq(42))*Q%S(18)+(Cpq(37)+Cpq(43))*Q%S(19)
        W(28)=(Cpq(38)+Cpq(44))*Q%S(20)+(Cpq(47)+Cpq(49))*Q%S(22)
        W(29)=(-Cpq(46)+Cpq(50))*Q%S(23)+(Cpq(45)+Cpq(51))*Q%S(24)
        W(30)=(Cpq(46)+Cpq(52))*Q%S(25)+(Cpq(47)+Cpq(53))*Q%S(26)
        W(31)=(Cpq(48)+Cpq(54))*Q%S(27)+(Cpq(57)+Cpq(59))*Q%S(29)
        W(32)=(-Cpq(56)+Cpq(60))*Q%S(30)+(Cpq(55)+Cpq(61))*Q%S(31)
        W(33)=(Cpq(56)+Cpq(62))*Q%S(32)+(Cpq(57)+Cpq(63))*Q%S(33)
        W(34)=(Cpq(58)+Cpq(64))*Q%S(34)+(Cpq(59)+Cpq(65))*Q%S(35)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        STwo=W(17)+W(18)+W(35)+W(36)
        SPKetC(9)=SPKetC(9)+CTwo*Two
        SPKetS(9)=SPKetS(9)+STwo*Two
!       -------------------------------- Lp=4, Mp = 0-------------------------------------
        W(1)=Cpq(10)*Q%C(0)+Cpq(15)*Q%C(1)+Cpq(21)*Q%C(3)+Cpq(28)*Q%C(6)
        W(2)=Cpq(36)*Q%C(10)+Cpq(45)*Q%C(15)+Cpq(55)*Q%C(21)+Cpq(66)*Q%C(28)
        COne=W(1)+W(2)
        W(1)=Cpq(16)*Q%C(2)+Cpq(22)*Q%C(4)+Cpq(23)*Q%C(5)
        W(2)=Cpq(29)*Q%C(7)+Cpq(30)*Q%C(8)+Cpq(31)*Q%C(9)+Cpq(37)*Q%C(11)
        W(3)=Cpq(38)*Q%C(12)+Cpq(39)*Q%C(13)+Cpq(40)*Q%C(14)
        W(4)=Cpq(46)*Q%C(16)+Cpq(47)*Q%C(17)+Cpq(48)*Q%C(18)+Cpq(49)*Q%C(19)
        W(5)=Cpq(50)*Q%C(20)+Cpq(56)*Q%C(22)+Cpq(57)*Q%C(23)
        W(6)=Cpq(58)*Q%C(24)+Cpq(59)*Q%C(25)+Cpq(60)*Q%C(26)+Cpq(61)*Q%C(27)
        W(7)=Cpq(67)*Q%C(29)+Cpq(68)*Q%C(30)+Cpq(69)*Q%C(31)
        W(8)=Cpq(70)*Q%C(32)+Cpq(71)*Q%C(33)+Cpq(72)*Q%C(34)+Cpq(73)*Q%C(35)
        W(9)=Spq(16)*Q%S(2)+Spq(22)*Q%S(4)+Spq(23)*Q%S(5)
        W(10)=Spq(29)*Q%S(7)+Spq(30)*Q%S(8)+Spq(31)*Q%S(9)+Spq(37)*Q%S(11)
        W(11)=Spq(38)*Q%S(12)+Spq(39)*Q%S(13)+Spq(40)*Q%S(14)
        W(12)=Spq(46)*Q%S(16)+Spq(47)*Q%S(17)+Spq(48)*Q%S(18)+Spq(49)*Q%S(19)
        W(13)=Spq(50)*Q%S(20)+Spq(56)*Q%S(22)+Spq(57)*Q%S(23)
        W(14)=Spq(58)*Q%S(24)+Spq(59)*Q%S(25)+Spq(60)*Q%S(26)+Spq(61)*Q%S(27)
        W(15)=Spq(67)*Q%S(29)+Spq(68)*Q%S(30)+Spq(69)*Q%S(31)
        W(16)=Spq(70)*Q%S(32)+Spq(71)*Q%S(33)+Spq(72)*Q%S(34)+Spq(73)*Q%S(35)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        SPKetC(10)=SPKetC(10)+COne+CTwo*Two
!       -------------------------------- Lp=4, Mp = 1-------------------------------------
        W(1)=Cpq(11)*Q%C(0)+Cpq(16)*Q%C(1)+(-Cpq(15)+Cpq(17))*Q%C(2)+Cpq(22)*Q%C(3)
        W(2)=(-Cpq(21)+Cpq(23))*Q%C(4)+(-Cpq(22)+Cpq(24))*Q%C(5)
        W(3)=Cpq(29)*Q%C(6)+(-Cpq(28)+Cpq(30))*Q%C(7)
        W(4)=(-Cpq(29)+Cpq(31))*Q%C(8)+(-Cpq(30)+Cpq(32))*Q%C(9)
        W(5)=Cpq(37)*Q%C(10)+(-Cpq(36)+Cpq(38))*Q%C(11)
        W(6)=(-Cpq(37)+Cpq(39))*Q%C(12)+(-Cpq(38)+Cpq(40))*Q%C(13)
        W(7)=(-Cpq(39)+Cpq(41))*Q%C(14)+Cpq(46)*Q%C(15)
        W(8)=(-Cpq(45)+Cpq(47))*Q%C(16)+(-Cpq(46)+Cpq(48))*Q%C(17)
        W(9)=(-Cpq(47)+Cpq(49))*Q%C(18)+(-Cpq(48)+Cpq(50))*Q%C(19)
        W(10)=(-Cpq(49)+Cpq(51))*Q%C(20)+Cpq(56)*Q%C(21)
        W(11)=(-Cpq(55)+Cpq(57))*Q%C(22)+(-Cpq(56)+Cpq(58))*Q%C(23)
        W(12)=(-Cpq(57)+Cpq(59))*Q%C(24)+(-Cpq(58)+Cpq(60))*Q%C(25)
        W(13)=(-Cpq(59)+Cpq(61))*Q%C(26)+(-Cpq(60)+Cpq(62))*Q%C(27)
        W(14)=Cpq(67)*Q%C(28)+(-Cpq(66)+Cpq(68))*Q%C(29)
        W(15)=(-Cpq(67)+Cpq(69))*Q%C(30)+(-Cpq(68)+Cpq(70))*Q%C(31)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=(-Cpq(69)+Cpq(71))*Q%C(32)+(-Cpq(70)+Cpq(72))*Q%C(33)
        W(19)=(-Cpq(71)+Cpq(73))*Q%C(34)+(-Cpq(72)+Cpq(74))*Q%C(35)
        W(20)=Spq(17)*Q%S(2)+Spq(23)*Q%S(4)+(-Spq(22)+Spq(24))*Q%S(5)+Spq(30)*Q%S(7)
        W(21)=(-Spq(29)+Spq(31))*Q%S(8)+(-Spq(30)+Spq(32))*Q%S(9)
        W(22)=Spq(38)*Q%S(11)+(-Spq(37)+Spq(39))*Q%S(12)
        W(23)=(-Spq(38)+Spq(40))*Q%S(13)+(-Spq(39)+Spq(41))*Q%S(14)
        W(24)=Spq(47)*Q%S(16)+(-Spq(46)+Spq(48))*Q%S(17)
        W(25)=(-Spq(47)+Spq(49))*Q%S(18)+(-Spq(48)+Spq(50))*Q%S(19)
        W(26)=(-Spq(49)+Spq(51))*Q%S(20)+Spq(57)*Q%S(22)
        W(27)=(-Spq(56)+Spq(58))*Q%S(23)+(-Spq(57)+Spq(59))*Q%S(24)
        W(28)=(-Spq(58)+Spq(60))*Q%S(25)+(-Spq(59)+Spq(61))*Q%S(26)
        W(29)=(-Spq(60)+Spq(62))*Q%S(27)+Spq(68)*Q%S(29)
        W(30)=(-Spq(67)+Spq(69))*Q%S(30)+(-Spq(68)+Spq(70))*Q%S(31)
        W(31)=(-Spq(69)+Spq(71))*Q%S(32)+(-Spq(70)+Spq(72))*Q%S(33)
        W(32)=(-Spq(71)+Spq(73))*Q%S(34)+(-Spq(72)+Spq(74))*Q%S(35)
        W(33)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(34)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)
        CTwo=W(16)+W(17)+W(33)+W(34)
        W(1)=Q%C(0)*Spq(11)+Q%C(1)*Spq(16)+Q%C(2)*Spq(17)+Q%C(3)*Spq(22)
        W(2)=Q%C(4)*Spq(23)+Q%C(5)*(Spq(22)+Spq(24))+Q%C(6)*Spq(29)+Q%C(7)*Spq(30)
        W(3)=Q%C(8)*(Spq(29)+Spq(31))+Q%C(9)*(Spq(30)+Spq(32))+Q%C(10)*Spq(37)+Q%C(11)*Spq(38)
        W(4)=Q%C(12)*(Spq(37)+Spq(39))+Q%C(13)*(Spq(38)+Spq(40))
        W(5)=Q%C(14)*(Spq(39)+Spq(41))+Q%C(15)*Spq(46)
        W(6)=Q%C(16)*Spq(47)+Q%C(17)*(Spq(46)+Spq(48))
        W(7)=Q%C(18)*(Spq(47)+Spq(49))+Q%C(19)*(Spq(48)+Spq(50))
        W(8)=Q%C(20)*(Spq(49)+Spq(51))+Q%C(21)*Spq(56)+Q%C(22)*Spq(57)+Q%C(23)*(Spq(56)+Spq(58))
        W(9)=Q%C(24)*(Spq(57)+Spq(59))+Q%C(25)*(Spq(58)+Spq(60))
        W(10)=Q%C(26)*(Spq(59)+Spq(61))+Q%C(27)*(Spq(60)+Spq(62))
        W(11)=Q%C(28)*Spq(67)+Q%C(29)*Spq(68)+Q%C(30)*(Spq(67)+Spq(69))+Q%C(31)*(Spq(68)+Spq(70))
        W(12)=Q%C(32)*(Spq(69)+Spq(71))+Q%C(33)*(Spq(70)+Spq(72))
        W(13)=Q%C(34)*(Spq(71)+Spq(73))+Q%C(35)*(Spq(72)+Spq(74))
        W(14)=-((Cpq(15)+Cpq(17))*Q%S(2))-(Cpq(21)+Cpq(23))*Q%S(4)
        W(15)=-((Cpq(22)+Cpq(24))*Q%S(5))-(Cpq(28)+Cpq(30))*Q%S(7)
        W(16)=-((Cpq(29)+Cpq(31))*Q%S(8))-(Cpq(30)+Cpq(32))*Q%S(9)
        W(17)=-((Cpq(36)+Cpq(38))*Q%S(11))-(Cpq(37)+Cpq(39))*Q%S(12)
        W(18)=-((Cpq(38)+Cpq(40))*Q%S(13))-(Cpq(39)+Cpq(41))*Q%S(14)
        W(19)=-((Cpq(45)+Cpq(47))*Q%S(16))-(Cpq(46)+Cpq(48))*Q%S(17)
        W(20)=-((Cpq(47)+Cpq(49))*Q%S(18))-(Cpq(48)+Cpq(50))*Q%S(19)
        W(21)=-((Cpq(49)+Cpq(51))*Q%S(20))-(Cpq(55)+Cpq(57))*Q%S(22)
        W(22)=-((Cpq(56)+Cpq(58))*Q%S(23))-(Cpq(57)+Cpq(59))*Q%S(24)
        W(23)=-((Cpq(58)+Cpq(60))*Q%S(25))-(Cpq(59)+Cpq(61))*Q%S(26)
        W(24)=-((Cpq(60)+Cpq(62))*Q%S(27))-(Cpq(66)+Cpq(68))*Q%S(29)
        W(25)=-((Cpq(67)+Cpq(69))*Q%S(30))-(Cpq(68)+Cpq(70))*Q%S(31)
        W(26)=-((Cpq(69)+Cpq(71))*Q%S(32))-(Cpq(70)+Cpq(72))*Q%S(33)
        W(27)=-((Cpq(71)+Cpq(73))*Q%S(34))-(Cpq(72)+Cpq(74))*Q%S(35)
        W(28)=W(12)+W(13)+W(14)+W(15)+W(16)+W(17)+W(18)+W(19)
        W(29)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        STwo=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)+W(9)+W(10)+W(11)+W(28)+W(29)
        SPKetC(11)=SPKetC(11)+CTwo*Two
        SPKetS(11)=SPKetS(11)+STwo*Two
!       -------------------------------- Lp=4, Mp = 2-------------------------------------
        W(1)=Cpq(12)*Q%C(0)+Cpq(17)*Q%C(1)+(-Cpq(16)+Cpq(18))*Q%C(2)+Cpq(23)*Q%C(3)
        W(2)=(-Cpq(22)+Cpq(24))*Q%C(4)+(Cpq(21)+Cpq(25))*Q%C(5)
        W(3)=Cpq(30)*Q%C(6)+(-Cpq(29)+Cpq(31))*Q%C(7)
        W(4)=(Cpq(28)+Cpq(32))*Q%C(8)+(Cpq(29)+Cpq(33))*Q%C(9)
        W(5)=Cpq(38)*Q%C(10)+(-Cpq(37)+Cpq(39))*Q%C(11)
        W(6)=(Cpq(36)+Cpq(40))*Q%C(12)+(Cpq(37)+Cpq(41))*Q%C(13)
        W(7)=(Cpq(38)+Cpq(42))*Q%C(14)+Cpq(47)*Q%C(15)
        W(8)=(-Cpq(46)+Cpq(48))*Q%C(16)+(Cpq(45)+Cpq(49))*Q%C(17)
        W(9)=(Cpq(46)+Cpq(50))*Q%C(18)+(Cpq(47)+Cpq(51))*Q%C(19)
        W(10)=(Cpq(48)+Cpq(52))*Q%C(20)+Cpq(57)*Q%C(21)
        W(11)=(-Cpq(56)+Cpq(58))*Q%C(22)+(Cpq(55)+Cpq(59))*Q%C(23)
        W(12)=(Cpq(56)+Cpq(60))*Q%C(24)+(Cpq(57)+Cpq(61))*Q%C(25)
        W(13)=(Cpq(58)+Cpq(62))*Q%C(26)+(Cpq(59)+Cpq(63))*Q%C(27)
        W(14)=Cpq(68)*Q%C(28)+(-Cpq(67)+Cpq(69))*Q%C(29)
        W(15)=(Cpq(66)+Cpq(70))*Q%C(30)+(Cpq(67)+Cpq(71))*Q%C(31)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=(Cpq(68)+Cpq(72))*Q%C(32)+(Cpq(69)+Cpq(73))*Q%C(33)
        W(19)=(Cpq(70)+Cpq(74))*Q%C(34)+(Cpq(71)+Cpq(75))*Q%C(35)
        W(20)=(Spq(16)+Spq(18))*Q%S(2)+(Spq(22)+Spq(24))*Q%S(4)
        W(21)=Spq(25)*Q%S(5)+(Spq(29)+Spq(31))*Q%S(7)
        W(22)=Spq(32)*Q%S(8)+(Spq(29)+Spq(33))*Q%S(9)+(Spq(37)+Spq(39))*Q%S(11)+Spq(40)*Q%S(12)
        W(23)=(Spq(37)+Spq(41))*Q%S(13)+(Spq(38)+Spq(42))*Q%S(14)
        W(24)=(Spq(46)+Spq(48))*Q%S(16)+Spq(49)*Q%S(17)
        W(25)=(Spq(46)+Spq(50))*Q%S(18)+(Spq(47)+Spq(51))*Q%S(19)
        W(26)=(Spq(48)+Spq(52))*Q%S(20)+(Spq(56)+Spq(58))*Q%S(22)
        W(27)=Spq(59)*Q%S(23)+(Spq(56)+Spq(60))*Q%S(24)
        W(28)=(Spq(57)+Spq(61))*Q%S(25)+(Spq(58)+Spq(62))*Q%S(26)
        W(29)=(Spq(59)+Spq(63))*Q%S(27)+(Spq(67)+Spq(69))*Q%S(29)
        W(30)=Spq(70)*Q%S(30)+(Spq(67)+Spq(71))*Q%S(31)
        W(31)=(Spq(68)+Spq(72))*Q%S(32)+(Spq(69)+Spq(73))*Q%S(33)
        W(32)=(Spq(70)+Spq(74))*Q%S(34)+(Spq(71)+Spq(75))*Q%S(35)
        W(33)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(34)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)
        CTwo=W(16)+W(17)+W(33)+W(34)
        W(1)=Q%C(0)*Spq(12)+Q%C(1)*Spq(17)+Q%C(2)*(-Spq(16)+Spq(18))+Q%C(3)*Spq(23)
        W(2)=Q%C(4)*(-Spq(22)+Spq(24))+Q%C(5)*Spq(25)
        W(3)=Q%C(6)*Spq(30)+Q%C(7)*(-Spq(29)+Spq(31))
        W(4)=Q%C(8)*Spq(32)+Q%C(9)*(-Spq(29)+Spq(33))
        W(5)=Q%C(10)*Spq(38)+Q%C(11)*(-Spq(37)+Spq(39))
        W(6)=Q%C(12)*Spq(40)+Q%C(13)*(-Spq(37)+Spq(41))
        W(7)=Q%C(14)*(-Spq(38)+Spq(42))+Q%C(15)*Spq(47)
        W(8)=Q%C(16)*(-Spq(46)+Spq(48))+Q%C(17)*Spq(49)
        W(9)=Q%C(18)*(-Spq(46)+Spq(50))+Q%C(19)*(-Spq(47)+Spq(51))
        W(10)=Q%C(20)*(-Spq(48)+Spq(52))+Q%C(21)*Spq(57)
        W(11)=Q%C(22)*(-Spq(56)+Spq(58))+Q%C(23)*Spq(59)
        W(12)=Q%C(24)*(-Spq(56)+Spq(60))+Q%C(25)*(-Spq(57)+Spq(61))
        W(13)=Q%C(26)*(-Spq(58)+Spq(62))+Q%C(27)*(-Spq(59)+Spq(63))
        W(14)=Q%C(28)*Spq(68)+Q%C(29)*(-Spq(67)+Spq(69))
        W(15)=Q%C(30)*Spq(70)+Q%C(31)*(-Spq(67)+Spq(71))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Q%C(32)*(-Spq(68)+Spq(72))+Q%C(33)*(-Spq(69)+Spq(73))
        W(19)=Q%C(34)*(-Spq(70)+Spq(74))+Q%C(35)*(-Spq(71)+Spq(75))
        W(20)=-((Cpq(16)+Cpq(18))*Q%S(2))-(Cpq(22)+Cpq(24))*Q%S(4)
        W(21)=(Cpq(21)-Cpq(25))*Q%S(5)-(Cpq(29)+Cpq(31))*Q%S(7)
        W(22)=(Cpq(28)-Cpq(32))*Q%S(8)+(Cpq(29)-Cpq(33))*Q%S(9)
        W(23)=-((Cpq(37)+Cpq(39))*Q%S(11))+(Cpq(36)-Cpq(40))*Q%S(12)
        W(24)=(Cpq(37)-Cpq(41))*Q%S(13)+(Cpq(38)-Cpq(42))*Q%S(14)
        W(25)=-((Cpq(46)+Cpq(48))*Q%S(16))+(Cpq(45)-Cpq(49))*Q%S(17)
        W(26)=(Cpq(46)-Cpq(50))*Q%S(18)+(Cpq(47)-Cpq(51))*Q%S(19)
        W(27)=(Cpq(48)-Cpq(52))*Q%S(20)-(Cpq(56)+Cpq(58))*Q%S(22)
        W(28)=(Cpq(55)-Cpq(59))*Q%S(23)+(Cpq(56)-Cpq(60))*Q%S(24)
        W(29)=(Cpq(57)-Cpq(61))*Q%S(25)+(Cpq(58)-Cpq(62))*Q%S(26)
        W(30)=(Cpq(59)-Cpq(63))*Q%S(27)-(Cpq(67)+Cpq(69))*Q%S(29)
        W(31)=(Cpq(66)-Cpq(70))*Q%S(30)+(Cpq(67)-Cpq(71))*Q%S(31)
        W(32)=(Cpq(68)-Cpq(72))*Q%S(32)+(Cpq(69)-Cpq(73))*Q%S(33)
        W(33)=(Cpq(70)-Cpq(74))*Q%S(34)+(Cpq(71)-Cpq(75))*Q%S(35)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        STwo=W(16)+W(17)+W(34)+W(35)
        SPKetC(12)=SPKetC(12)+CTwo*Two
        SPKetS(12)=SPKetS(12)+STwo*Two
!       -------------------------------- Lp=4, Mp = 3-------------------------------------
        W(1)=Cpq(13)*Q%C(0)+Cpq(18)*Q%C(1)+(-Cpq(17)+Cpq(19))*Q%C(2)+Cpq(24)*Q%C(3)
        W(2)=(-Cpq(23)+Cpq(25))*Q%C(4)+(Cpq(22)+Cpq(26))*Q%C(5)
        W(3)=Cpq(31)*Q%C(6)+(-Cpq(30)+Cpq(32))*Q%C(7)
        W(4)=(Cpq(29)+Cpq(33))*Q%C(8)+(-Cpq(28)+Cpq(34))*Q%C(9)
        W(5)=Cpq(39)*Q%C(10)+(-Cpq(38)+Cpq(40))*Q%C(11)
        W(6)=(Cpq(37)+Cpq(41))*Q%C(12)+(-Cpq(36)+Cpq(42))*Q%C(13)
        W(7)=(-Cpq(37)+Cpq(43))*Q%C(14)+Cpq(48)*Q%C(15)
        W(8)=(-Cpq(47)+Cpq(49))*Q%C(16)+(Cpq(46)+Cpq(50))*Q%C(17)
        W(9)=(-Cpq(45)+Cpq(51))*Q%C(18)+(-Cpq(46)+Cpq(52))*Q%C(19)
        W(10)=(-Cpq(47)+Cpq(53))*Q%C(20)+Cpq(58)*Q%C(21)
        W(11)=(-Cpq(57)+Cpq(59))*Q%C(22)+(Cpq(56)+Cpq(60))*Q%C(23)
        W(12)=(-Cpq(55)+Cpq(61))*Q%C(24)+(-Cpq(56)+Cpq(62))*Q%C(25)
        W(13)=(-Cpq(57)+Cpq(63))*Q%C(26)+(-Cpq(58)+Cpq(64))*Q%C(27)
        W(14)=Cpq(69)*Q%C(28)+(-Cpq(68)+Cpq(70))*Q%C(29)
        W(15)=(Cpq(67)+Cpq(71))*Q%C(30)+(-Cpq(66)+Cpq(72))*Q%C(31)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=(-Cpq(67)+Cpq(73))*Q%C(32)+(-Cpq(68)+Cpq(74))*Q%C(33)
        W(19)=(-Cpq(69)+Cpq(75))*Q%C(34)+(-Cpq(70)+Cpq(76))*Q%C(35)
        W(20)=(Spq(17)+Spq(19))*Q%S(2)+(Spq(23)+Spq(25))*Q%S(4)
        W(21)=(-Spq(22)+Spq(26))*Q%S(5)+(Spq(30)+Spq(32))*Q%S(7)
        W(22)=(-Spq(29)+Spq(33))*Q%S(8)+Spq(34)*Q%S(9)
        W(23)=(Spq(38)+Spq(40))*Q%S(11)+(-Spq(37)+Spq(41))*Q%S(12)
        W(24)=Spq(42)*Q%S(13)+(-Spq(37)+Spq(43))*Q%S(14)
        W(25)=(Spq(47)+Spq(49))*Q%S(16)+(-Spq(46)+Spq(50))*Q%S(17)
        W(26)=Spq(51)*Q%S(18)+(-Spq(46)+Spq(52))*Q%S(19)
        W(27)=(-Spq(47)+Spq(53))*Q%S(20)+(Spq(57)+Spq(59))*Q%S(22)
        W(28)=(-Spq(56)+Spq(60))*Q%S(23)+Spq(61)*Q%S(24)
        W(29)=(-Spq(56)+Spq(62))*Q%S(25)+(-Spq(57)+Spq(63))*Q%S(26)
        W(30)=(-Spq(58)+Spq(64))*Q%S(27)+(Spq(68)+Spq(70))*Q%S(29)
        W(31)=(-Spq(67)+Spq(71))*Q%S(30)+Spq(72)*Q%S(31)
        W(32)=(-Spq(67)+Spq(73))*Q%S(32)+(-Spq(68)+Spq(74))*Q%S(33)
        W(33)=(-Spq(69)+Spq(75))*Q%S(34)+(-Spq(70)+Spq(76))*Q%S(35)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        W(1)=Q%C(0)*Spq(13)+Q%C(1)*Spq(18)+Q%C(2)*(-Spq(17)+Spq(19))+Q%C(3)*Spq(24)
        W(2)=Q%C(4)*(-Spq(23)+Spq(25))+Q%C(5)*(Spq(22)+Spq(26))
        W(3)=Q%C(6)*Spq(31)+Q%C(7)*(-Spq(30)+Spq(32))
        W(4)=Q%C(8)*(Spq(29)+Spq(33))+Q%C(9)*Spq(34)
        W(5)=Q%C(10)*Spq(39)+Q%C(11)*(-Spq(38)+Spq(40))
        W(6)=Q%C(12)*(Spq(37)+Spq(41))+Q%C(13)*Spq(42)+Q%C(14)*(Spq(37)+Spq(43))+Q%C(15)*Spq(48)
        W(7)=Q%C(16)*(-Spq(47)+Spq(49))+Q%C(17)*(Spq(46)+Spq(50))
        W(8)=Q%C(18)*Spq(51)+Q%C(19)*(Spq(46)+Spq(52))
        W(9)=Q%C(20)*(Spq(47)+Spq(53))+Q%C(21)*Spq(58)
        W(10)=Q%C(22)*(-Spq(57)+Spq(59))+Q%C(23)*(Spq(56)+Spq(60))
        W(11)=Q%C(24)*Spq(61)+Q%C(25)*(Spq(56)+Spq(62))
        W(12)=Q%C(26)*(Spq(57)+Spq(63))+Q%C(27)*(Spq(58)+Spq(64))
        W(13)=Q%C(28)*Spq(69)+Q%C(29)*(-Spq(68)+Spq(70))
        W(14)=Q%C(30)*(Spq(67)+Spq(71))+Q%C(31)*Spq(72)
        W(15)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(16)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)
        W(17)=Q%C(32)*(Spq(67)+Spq(73))+Q%C(33)*(Spq(68)+Spq(74))
        W(18)=Q%C(34)*(Spq(69)+Spq(75))+Q%C(35)*(Spq(70)+Spq(76))
        W(19)=-((Cpq(17)+Cpq(19))*Q%S(2))-(Cpq(23)+Cpq(25))*Q%S(4)
        W(20)=(Cpq(22)-Cpq(26))*Q%S(5)-(Cpq(30)+Cpq(32))*Q%S(7)
        W(21)=(Cpq(29)-Cpq(33))*Q%S(8)-(Cpq(28)+Cpq(34))*Q%S(9)
        W(22)=-((Cpq(38)+Cpq(40))*Q%S(11))+(Cpq(37)-Cpq(41))*Q%S(12)
        W(23)=-((Cpq(36)+Cpq(42))*Q%S(13))-(Cpq(37)+Cpq(43))*Q%S(14)
        W(24)=-((Cpq(47)+Cpq(49))*Q%S(16))+(Cpq(46)-Cpq(50))*Q%S(17)
        W(25)=-((Cpq(45)+Cpq(51))*Q%S(18))-(Cpq(46)+Cpq(52))*Q%S(19)
        W(26)=-((Cpq(47)+Cpq(53))*Q%S(20))-(Cpq(57)+Cpq(59))*Q%S(22)
        W(27)=(Cpq(56)-Cpq(60))*Q%S(23)-(Cpq(55)+Cpq(61))*Q%S(24)
        W(28)=-((Cpq(56)+Cpq(62))*Q%S(25))-(Cpq(57)+Cpq(63))*Q%S(26)
        W(29)=-((Cpq(58)+Cpq(64))*Q%S(27))-(Cpq(68)+Cpq(70))*Q%S(29)
        W(30)=(Cpq(67)-Cpq(71))*Q%S(30)-(Cpq(66)+Cpq(72))*Q%S(31)
        W(31)=-((Cpq(67)+Cpq(73))*Q%S(32))-(Cpq(68)+Cpq(74))*Q%S(33)
        W(32)=-((Cpq(69)+Cpq(75))*Q%S(34))-(Cpq(70)+Cpq(76))*Q%S(35)
        W(33)=W(17)+W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(34)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)
        STwo=W(15)+W(16)+W(33)+W(34)
        SPKetC(13)=SPKetC(13)+CTwo*Two
        SPKetS(13)=SPKetS(13)+STwo*Two
!       -------------------------------- Lp=4, Mp = 4-------------------------------------
        W(1)=Cpq(14)*Q%C(0)+Cpq(19)*Q%C(1)+(-Cpq(18)+Cpq(20))*Q%C(2)+Cpq(25)*Q%C(3)
        W(2)=(-Cpq(24)+Cpq(26))*Q%C(4)+(Cpq(23)+Cpq(27))*Q%C(5)
        W(3)=Cpq(32)*Q%C(6)+(-Cpq(31)+Cpq(33))*Q%C(7)
        W(4)=(Cpq(30)+Cpq(34))*Q%C(8)+(-Cpq(29)+Cpq(35))*Q%C(9)
        W(5)=Cpq(40)*Q%C(10)+(-Cpq(39)+Cpq(41))*Q%C(11)
        W(6)=(Cpq(38)+Cpq(42))*Q%C(12)+(-Cpq(37)+Cpq(43))*Q%C(13)
        W(7)=(Cpq(36)+Cpq(44))*Q%C(14)+Cpq(49)*Q%C(15)
        W(8)=(-Cpq(48)+Cpq(50))*Q%C(16)+(Cpq(47)+Cpq(51))*Q%C(17)
        W(9)=(-Cpq(46)+Cpq(52))*Q%C(18)+(Cpq(45)+Cpq(53))*Q%C(19)
        W(10)=(Cpq(46)+Cpq(54))*Q%C(20)+Cpq(59)*Q%C(21)
        W(11)=(-Cpq(58)+Cpq(60))*Q%C(22)+(Cpq(57)+Cpq(61))*Q%C(23)
        W(12)=(-Cpq(56)+Cpq(62))*Q%C(24)+(Cpq(55)+Cpq(63))*Q%C(25)
        W(13)=(Cpq(56)+Cpq(64))*Q%C(26)+(Cpq(57)+Cpq(65))*Q%C(27)
        W(14)=Cpq(70)*Q%C(28)+(-Cpq(69)+Cpq(71))*Q%C(29)
        W(15)=(Cpq(68)+Cpq(72))*Q%C(30)+(-Cpq(67)+Cpq(73))*Q%C(31)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=(Cpq(66)+Cpq(74))*Q%C(32)+(Cpq(67)+Cpq(75))*Q%C(33)
        W(19)=(Cpq(68)+Cpq(76))*Q%C(34)+(Cpq(69)+Cpq(77))*Q%C(35)
        W(20)=(Spq(18)+Spq(20))*Q%S(2)+(Spq(24)+Spq(26))*Q%S(4)
        W(21)=(-Spq(23)+Spq(27))*Q%S(5)+(Spq(31)+Spq(33))*Q%S(7)
        W(22)=(-Spq(30)+Spq(34))*Q%S(8)+(Spq(29)+Spq(35))*Q%S(9)
        W(23)=(Spq(39)+Spq(41))*Q%S(11)+(-Spq(38)+Spq(42))*Q%S(12)
        W(24)=(Spq(37)+Spq(43))*Q%S(13)+Spq(44)*Q%S(14)
        W(25)=(Spq(48)+Spq(50))*Q%S(16)+(-Spq(47)+Spq(51))*Q%S(17)
        W(26)=(Spq(46)+Spq(52))*Q%S(18)+Spq(53)*Q%S(19)
        W(27)=(Spq(46)+Spq(54))*Q%S(20)+(Spq(58)+Spq(60))*Q%S(22)
        W(28)=(-Spq(57)+Spq(61))*Q%S(23)+(Spq(56)+Spq(62))*Q%S(24)
        W(29)=Spq(63)*Q%S(25)+(Spq(56)+Spq(64))*Q%S(26)
        W(30)=(Spq(57)+Spq(65))*Q%S(27)+(Spq(69)+Spq(71))*Q%S(29)
        W(31)=(-Spq(68)+Spq(72))*Q%S(30)+(Spq(67)+Spq(73))*Q%S(31)
        W(32)=Spq(74)*Q%S(32)+(Spq(67)+Spq(75))*Q%S(33)
        W(33)=(Spq(68)+Spq(76))*Q%S(34)+(Spq(69)+Spq(77))*Q%S(35)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        W(1)=Q%C(0)*Spq(14)+Q%C(1)*Spq(19)+Q%C(2)*(-Spq(18)+Spq(20))+Q%C(3)*Spq(25)
        W(2)=Q%C(4)*(-Spq(24)+Spq(26))+Q%C(5)*(Spq(23)+Spq(27))
        W(3)=Q%C(6)*Spq(32)+Q%C(7)*(-Spq(31)+Spq(33))
        W(4)=Q%C(8)*(Spq(30)+Spq(34))+Q%C(9)*(-Spq(29)+Spq(35))
        W(5)=Q%C(10)*Spq(40)+Q%C(11)*(-Spq(39)+Spq(41))
        W(6)=Q%C(12)*(Spq(38)+Spq(42))+Q%C(13)*(-Spq(37)+Spq(43))
        W(7)=Q%C(14)*Spq(44)+Q%C(15)*Spq(49)
        W(8)=Q%C(16)*(-Spq(48)+Spq(50))+Q%C(17)*(Spq(47)+Spq(51))
        W(9)=Q%C(18)*(-Spq(46)+Spq(52))+Q%C(19)*Spq(53)
        W(10)=Q%C(20)*(-Spq(46)+Spq(54))+Q%C(21)*Spq(59)
        W(11)=Q%C(22)*(-Spq(58)+Spq(60))+Q%C(23)*(Spq(57)+Spq(61))
        W(12)=Q%C(24)*(-Spq(56)+Spq(62))+Q%C(25)*Spq(63)
        W(13)=Q%C(26)*(-Spq(56)+Spq(64))+Q%C(27)*(-Spq(57)+Spq(65))
        W(14)=Q%C(28)*Spq(70)+Q%C(29)*(-Spq(69)+Spq(71))
        W(15)=Q%C(30)*(Spq(68)+Spq(72))+Q%C(31)*(-Spq(67)+Spq(73))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Q%C(32)*Spq(74)+Q%C(33)*(-Spq(67)+Spq(75))
        W(19)=Q%C(34)*(-Spq(68)+Spq(76))+Q%C(35)*(-Spq(69)+Spq(77))
        W(20)=-((Cpq(18)+Cpq(20))*Q%S(2))-(Cpq(24)+Cpq(26))*Q%S(4)
        W(21)=(Cpq(23)-Cpq(27))*Q%S(5)-(Cpq(31)+Cpq(33))*Q%S(7)
        W(22)=(Cpq(30)-Cpq(34))*Q%S(8)-(Cpq(29)+Cpq(35))*Q%S(9)
        W(23)=-((Cpq(39)+Cpq(41))*Q%S(11))+(Cpq(38)-Cpq(42))*Q%S(12)
        W(24)=-((Cpq(37)+Cpq(43))*Q%S(13))+(Cpq(36)-Cpq(44))*Q%S(14)
        W(25)=-((Cpq(48)+Cpq(50))*Q%S(16))+(Cpq(47)-Cpq(51))*Q%S(17)
        W(26)=-((Cpq(46)+Cpq(52))*Q%S(18))+(Cpq(45)-Cpq(53))*Q%S(19)
        W(27)=(Cpq(46)-Cpq(54))*Q%S(20)-(Cpq(58)+Cpq(60))*Q%S(22)
        W(28)=(Cpq(57)-Cpq(61))*Q%S(23)-(Cpq(56)+Cpq(62))*Q%S(24)
        W(29)=(Cpq(55)-Cpq(63))*Q%S(25)+(Cpq(56)-Cpq(64))*Q%S(26)
        W(30)=(Cpq(57)-Cpq(65))*Q%S(27)-(Cpq(69)+Cpq(71))*Q%S(29)
        W(31)=(Cpq(68)-Cpq(72))*Q%S(30)-(Cpq(67)+Cpq(73))*Q%S(31)
        W(32)=(Cpq(66)-Cpq(74))*Q%S(32)+(Cpq(67)-Cpq(75))*Q%S(33)
        W(33)=(Cpq(68)-Cpq(76))*Q%S(34)+(Cpq(69)-Cpq(77))*Q%S(35)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        STwo=W(16)+W(17)+W(34)+W(35)
        SPKetC(14)=SPKetC(14)+CTwo*Two
        SPKetS(14)=SPKetS(14)+STwo*Two
      END SUBROUTINE CTraX407
