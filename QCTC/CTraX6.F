      SUBROUTINE CTX6_0_0_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:27),Spq(0:27),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(0)*Cq(0)+Cpq(1)*Cq(1)+Cpq(3)*Cq(3)
        W(2)=Cpq(6)*Cq(6)+Cpq(10)*Cq(10)+Cpq(15)*Cq(15)+Cpq(21)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(2)*Cq(2)+Cpq(4)*Cq(4)
        W(2)=Cpq(5)*Cq(5)+Cpq(7)*Cq(7)+Cpq(8)*Cq(8)
        W(3)=Cpq(9)*Cq(9)+Cpq(11)*Cq(11)
        W(4)=Cpq(12)*Cq(12)+Cpq(13)*Cq(13)+Cpq(14)*Cq(14)
        W(5)=Cpq(16)*Cq(16)+Cpq(17)*Cq(17)
        W(6)=Cpq(18)*Cq(18)+Cpq(19)*Cq(19)+Cpq(20)*Cq(20)
        W(7)=Cpq(22)*Cq(22)+Cpq(23)*Cq(23)+Cpq(24)*Cq(24)
        W(8)=Cpq(25)*Cq(25)+Cpq(26)*Cq(26)+Cpq(27)*Cq(27)
        W(9)=Spq(2)*Sq(2)+Spq(4)*Sq(4)
        W(10)=Spq(5)*Sq(5)+Spq(7)*Sq(7)+Spq(8)*Sq(8)
        W(11)=Spq(9)*Sq(9)+Spq(11)*Sq(11)
        W(12)=Spq(12)*Sq(12)+Spq(13)*Sq(13)+Spq(14)*Sq(14)
        W(13)=Spq(16)*Sq(16)+Spq(17)*Sq(17)
        W(14)=Spq(18)*Sq(18)+Spq(19)*Sq(19)+Spq(20)*Sq(20)
        W(15)=Spq(22)*Sq(22)+Spq(23)*Sq(23)+Spq(24)*Sq(24)
        W(16)=Spq(25)*Sq(25)+Spq(26)*Sq(26)+Spq(27)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE IrRegular6(PQx,PQy,PQz,Cpq,Spq)
         IMPLICIT NONE
         REAL*8 Cpq(0:27),Spq(0:27),LegendreP(0:27)
         REAL*8 Sine(0:6),Cosine(0:6),CoFact(2:6)
         REAL*8 PQx,PQy,PQz,PQ2,pqx2,pqy2,pqxy,PQ
         REAL*8 Zero,One,Two,TT,TwoC,OneOvPQ
         REAL*8 CoTan,OneOvPQxy,RS,SQ,PQToThMnsL
         PARAMETER (Two=2D0,One=1D0,Zero=0D0)
         PQx2=PQx*PQx
         PQy2=PQy*PQy
         PQ=DSQRT(PQx2+PQy2+PQz*PQz)
         OneOvPQ=One/PQ
         CoTan=PQz*OneOvPQ
!        Compute Cosine and Sine by recursion
         Sine(0)  =Zero
         Cosine(0)=One
         PQxy=DSQRT(PQx2+PQy2)
         IF(PQxy/=Zero)THEN
            OneOvPQxy=One/PQxy
            Sine(1)  =PQx*OneOvPQxy
            Cosine(1)=PQy*OneOvPQxy
         ELSE
            Sine(1)  =0.70710678118654752D0
            Cosine(1)=0.70710678118654752D0
         ENDIF
         TwoC=Two*Cosine(1)
         Sine(2)=TwoC*Sine(1)-Sine(0)
         Cosine(2)=TwoC*Cosine(1)-Cosine(0)
         Sine(3)=TwoC*Sine(2)-Sine(1)
         Cosine(3)=TwoC*Cosine(2)-Cosine(1)
         Sine(4)=TwoC*Sine(3)-Sine(2)
         Cosine(4)=TwoC*Cosine(3)-Cosine(2)
         Sine(5)=TwoC*Sine(4)-Sine(3)
         Cosine(5)=TwoC*Cosine(4)-Cosine(3)
         Sine(6)=TwoC*Sine(5)-Sine(4)
         Cosine(6)=TwoC*Cosine(5)-Cosine(4)
!        ----------------------------------------------------------------
!        Associated Legendre Polynomials by recursion
!
!        M=0,Ell; Compute LegendreP(M,M)
         RS=One
         Sq=SQRT(ABS(One-CoTan**2))
         LegendreP(0)=+1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(2)=-1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(5)=+3.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(9)=-1.500000000000000D+01*RS
         RS=RS*Sq
         LegendreP(14)=+1.050000000000000D+02*RS
         RS=RS*Sq
         LegendreP(20)=-9.450000000000000D+02*RS
         RS=RS*Sq
         LegendreP(27)=+1.039500000000000D+04*RS
!        ----------------------------------------------------------------
!        M=0,Ell-1; Compute LegendreP(M+1,M)
         LegendreP(1)=+1.000000000000000D+00*CoTan*LegendreP(0)
         LegendreP(4)=+3.000000000000000D+00*CoTan*LegendreP(2)
         LegendreP(8)=+5.000000000000000D+00*CoTan*LegendreP(5)
         LegendreP(13)=+7.000000000000000D+00*CoTan*LegendreP(9)
         LegendreP(19)=+9.000000000000000D+00*CoTan*LegendreP(14)
         LegendreP(26)=+1.100000000000000D+01*CoTan*LegendreP(20)
!        ----------------------------------------------------------------
         CoFact(2)=+3.000000000000000D+00*CoTan
         CoFact(3)=+5.000000000000000D+00*CoTan
         CoFact(4)=+7.000000000000000D+00*CoTan
         CoFact(5)=+9.000000000000000D+00*CoTan
         CoFact(6)=+1.100000000000000D+01*CoTan
!        ----------------------------------------------------------------
!        M=0,Ell-2; L=M+2,Ell; Compute LegendreP(L,M)
         LegendreP(3)=CoFact(2)*LegendreP(1)-1.000000000000000D+00*LegendreP(0)
         LegendreP(6)=CoFact(3)*LegendreP(3)-4.000000000000000D+00*LegendreP(1)
         LegendreP(10)=CoFact(4)*LegendreP(6)-9.000000000000000D+00*LegendreP(3)
         LegendreP(15)=CoFact(5)*LegendreP(10)-1.600000000000000D+01*LegendreP(6)
         LegendreP(21)=CoFact(6)*LegendreP(15)-2.500000000000000D+01*LegendreP(10)
         LegendreP(7)=CoFact(3)*LegendreP(4)-3.000000000000000D+00*LegendreP(2)
         LegendreP(11)=CoFact(4)*LegendreP(7)-8.000000000000000D+00*LegendreP(4)
         LegendreP(16)=CoFact(5)*LegendreP(11)-1.500000000000000D+01*LegendreP(7)
         LegendreP(22)=CoFact(6)*LegendreP(16)-2.400000000000000D+01*LegendreP(11)
         LegendreP(12)=CoFact(4)*LegendreP(8)-5.000000000000000D+00*LegendreP(5)
         LegendreP(17)=CoFact(5)*LegendreP(12)-1.200000000000000D+01*LegendreP(8)
         LegendreP(23)=CoFact(6)*LegendreP(17)-2.100000000000000D+01*LegendreP(12)
         LegendreP(18)=CoFact(5)*LegendreP(13)-7.000000000000000D+00*LegendreP(9)
         LegendreP(24)=CoFact(6)*LegendreP(18)-1.600000000000000D+01*LegendreP(13)
         LegendreP(25)=CoFact(6)*LegendreP(19)-9.000000000000000D+00*LegendreP(14)
!        ----------------------------------------------------------------
!        Compute Cpq(L,M) and Spq(L,M)
         PQToThMnsL=OneOvPQ
         TT=PQToThMnsL*LegendreP(0)
         Spq(0)=TT*Sine(0)
         Cpq(0)=TT*Cosine(0)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(1)
         Spq(1)=TT*Sine(0)
         Cpq(1)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(2)
         Spq(2)=TT*Sine(1)
         Cpq(2)=TT*Cosine(1)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(3)
         Spq(3)=TT*Sine(0)
         Cpq(3)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(4)
         Spq(4)=TT*Sine(1)
         Cpq(4)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(5)
         Spq(5)=TT*Sine(2)
         Cpq(5)=TT*Cosine(2)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(6)
         Spq(6)=TT*Sine(0)
         Cpq(6)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(7)
         Spq(7)=TT*Sine(1)
         Cpq(7)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(8)
         Spq(8)=TT*Sine(2)
         Cpq(8)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(9)
         Spq(9)=TT*Sine(3)
         Cpq(9)=TT*Cosine(3)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(10)
         Spq(10)=TT*Sine(0)
         Cpq(10)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(11)
         Spq(11)=TT*Sine(1)
         Cpq(11)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(12)
         Spq(12)=TT*Sine(2)
         Cpq(12)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(13)
         Spq(13)=TT*Sine(3)
         Cpq(13)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(14)
         Spq(14)=TT*Sine(4)
         Cpq(14)=TT*Cosine(4)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(15)
         Spq(15)=TT*Sine(0)
         Cpq(15)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(16)
         Spq(16)=TT*Sine(1)
         Cpq(16)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(17)
         Spq(17)=TT*Sine(2)
         Cpq(17)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(18)
         Spq(18)=TT*Sine(3)
         Cpq(18)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(19)
         Spq(19)=TT*Sine(4)
         Cpq(19)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(20)
         Spq(20)=TT*Sine(5)
         Cpq(20)=TT*Cosine(5)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(21)
         Spq(21)=TT*Sine(0)
         Cpq(21)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(22)
         Spq(22)=TT*Sine(1)
         Cpq(22)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(23)
         Spq(23)=TT*Sine(2)
         Cpq(23)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(24)
         Spq(24)=TT*Sine(3)
         Cpq(24)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(25)
         Spq(25)=TT*Sine(4)
         Cpq(25)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(26)
         Spq(26)=TT*Sine(5)
         Cpq(26)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(27)
         Spq(27)=TT*Sine(6)
         Cpq(27)=TT*Cosine(6)
      RETURN
      END
      SUBROUTINE CTraX6(PQx,PQy,PQz,Cq,Sq,Cp,Sp)
         IMPLICIT NONE
         REAL*8 PQx,PQy,PQz
         REAL*8 Cq(0:27),Sq(0:27),Cp(0:0),Sp(0:0)
         REAL*8 Cpq(0:27),Spq(0:27)
         CALL IrRegular6(PQx,PQy,PQz,Cpq,Spq)
         CALL CTX6_0_0_C(Cp(0),Cpq,Spq,Cq,Sq)
      RETURN
      END
      SUBROUTINE CTX106_0_0_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:35),Spq(0:35),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(0)*Cq(0)+Cpq(1)*Cq(1)+Cpq(3)*Cq(3)
        W(2)=Cpq(6)*Cq(6)+Cpq(10)*Cq(10)+Cpq(15)*Cq(15)+Cpq(21)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(2)*Cq(2)+Cpq(4)*Cq(4)
        W(2)=Cpq(5)*Cq(5)+Cpq(7)*Cq(7)+Cpq(8)*Cq(8)
        W(3)=Cpq(9)*Cq(9)+Cpq(11)*Cq(11)
        W(4)=Cpq(12)*Cq(12)+Cpq(13)*Cq(13)+Cpq(14)*Cq(14)
        W(5)=Cpq(16)*Cq(16)+Cpq(17)*Cq(17)
        W(6)=Cpq(18)*Cq(18)+Cpq(19)*Cq(19)+Cpq(20)*Cq(20)
        W(7)=Cpq(22)*Cq(22)+Cpq(23)*Cq(23)+Cpq(24)*Cq(24)
        W(8)=Cpq(25)*Cq(25)+Cpq(26)*Cq(26)+Cpq(27)*Cq(27)
        W(9)=Spq(2)*Sq(2)+Spq(4)*Sq(4)
        W(10)=Spq(5)*Sq(5)+Spq(7)*Sq(7)+Spq(8)*Sq(8)
        W(11)=Spq(9)*Sq(9)+Spq(11)*Sq(11)
        W(12)=Spq(12)*Sq(12)+Spq(13)*Sq(13)+Spq(14)*Sq(14)
        W(13)=Spq(16)*Sq(16)+Spq(17)*Sq(17)
        W(14)=Spq(18)*Sq(18)+Spq(19)*Sq(19)+Spq(20)*Sq(20)
        W(15)=Spq(22)*Sq(22)+Spq(23)*Sq(23)+Spq(24)*Sq(24)
        W(16)=Spq(25)*Sq(25)+Spq(26)*Sq(26)+Spq(27)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX106_0_1_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:35),Spq(0:35),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(1)*Cq(0))-Cpq(3)*Cq(1)-Cpq(6)*Cq(3)
        W(2)=-(Cpq(10)*Cq(6))-Cpq(15)*Cq(10)
        W(3)=-(Cpq(21)*Cq(15))-Cpq(28)*Cq(21)
        COne=W(1)+W(2)+W(3)
        W(1)=-(Cpq(4)*Cq(2))-Cpq(7)*Cq(4)
        W(2)=-(Cpq(8)*Cq(5))-Cpq(11)*Cq(7)-Cpq(12)*Cq(8)
        W(3)=-(Cpq(13)*Cq(9))-Cpq(16)*Cq(11)
        W(4)=-(Cpq(17)*Cq(12))-Cpq(18)*Cq(13)-Cpq(19)*Cq(14)
        W(5)=-(Cpq(22)*Cq(16))-Cpq(23)*Cq(17)
        W(6)=-(Cpq(24)*Cq(18))-Cpq(25)*Cq(19)-Cpq(26)*Cq(20)
        W(7)=-(Cpq(29)*Cq(22))-Cpq(30)*Cq(23)-Cpq(31)*Cq(24)
        W(8)=-(Cpq(32)*Cq(25))-Cpq(33)*Cq(26)-Cpq(34)*Cq(27)
        W(9)=-(Spq(4)*Sq(2))-Spq(7)*Sq(4)
        W(10)=-(Spq(8)*Sq(5))-Spq(11)*Sq(7)-Spq(12)*Sq(8)
        W(11)=-(Spq(13)*Sq(9))-Spq(16)*Sq(11)
        W(12)=-(Spq(17)*Sq(12))-Spq(18)*Sq(13)-Spq(19)*Sq(14)
        W(13)=-(Spq(22)*Sq(16))-Spq(23)*Sq(17)
        W(14)=-(Spq(24)*Sq(18))-Spq(25)*Sq(19)-Spq(26)*Sq(20)
        W(15)=-(Spq(29)*Sq(22))-Spq(30)*Sq(23)-Spq(31)*Sq(24)
        W(16)=-(Spq(32)*Sq(25))-Spq(33)*Sq(26)-Spq(34)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX106_1_1_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:35),Spq(0:35),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(2)*Cq(0))-Cpq(4)*Cq(1)+Cpq(3)*Cq(2)
        W(2)=-(Cpq(5)*Cq(2))+Cpq(6)*Cq(4)
        W(3)=-(Cpq(8)*Cq(4))-Cpq(9)*Cq(5)
        W(4)=Cpq(7)*(-Cq(3)+Cq(5))+Cpq(10)*Cq(7)
        W(5)=-(Cpq(13)*Cq(8))+Cpq(11)*(-Cq(6)+Cq(8))
        W(6)=-(Cpq(14)*Cq(9))+Cpq(12)*(-Cq(7)+Cq(9))
        W(7)=Cpq(15)*Cq(11)+Cpq(16)*(-Cq(10)+Cq(12))
        W(8)=-(Cpq(19)*Cq(13))
        W(9)=Cpq(17)*(-Cq(11)+Cq(13))-Cpq(20)*Cq(14)
        W(10)=Cpq(18)*(-Cq(12)+Cq(14))+Cpq(21)*Cq(16)
        W(11)=Cpq(22)*(-Cq(15)+Cq(17))+Cpq(23)*(-Cq(16)+Cq(18))
        W(12)=-(Cpq(26)*Cq(19))+Cpq(24)*(-Cq(17)+Cq(19))
        W(13)=-(Cpq(27)*Cq(20))+Cpq(25)*(-Cq(18)+Cq(20))
        W(14)=Cpq(28)*Cq(22)+Cpq(29)*(-Cq(21)+Cq(23))
        W(15)=Cpq(30)*(-Cq(22)+Cq(24))+Cpq(31)*(-Cq(23)+Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(34)*Cq(26))
        W(19)=Cpq(32)*(-Cq(24)+Cq(26))-Cpq(35)*Cq(27)
        W(20)=Cpq(33)*(-Cq(25)+Cq(27))-Spq(5)*Sq(2)
        W(21)=-(Spq(8)*Sq(4))+Spq(7)*Sq(5)
        W(22)=-(Spq(9)*Sq(5))+Spq(11)*Sq(8)
        W(23)=-(Spq(13)*Sq(8))-Spq(14)*Sq(9)
        W(24)=Spq(12)*(-Sq(7)+Sq(9))+Spq(16)*Sq(12)
        W(25)=-(Spq(19)*Sq(13))+Spq(17)*(-Sq(11)+Sq(13))
        W(26)=-(Spq(20)*Sq(14))
        W(27)=Spq(18)*(-Sq(12)+Sq(14))+Spq(22)*Sq(17)
        W(28)=Spq(23)*(-Sq(16)+Sq(18))-Spq(26)*Sq(19)
        W(29)=Spq(24)*(-Sq(17)+Sq(19))-Spq(27)*Sq(20)
        W(30)=Spq(25)*(-Sq(18)+Sq(20))+Spq(29)*Sq(23)
        W(31)=Spq(30)*(-Sq(22)+Sq(24))+Spq(31)*(-Sq(23)+Sq(25))
        W(32)=-(Spq(34)*Sq(26))+Spq(32)*(-Sq(24)+Sq(26))
        W(33)=-(Spq(35)*Sq(27))+Spq(33)*(-Sq(25)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX106_1_1_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:35),Spq(0:35),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(2))-Cq(1)*Spq(4)-Cq(2)*Spq(5)
        W(2)=-((Cq(3)+Cq(5))*Spq(7))-Cq(4)*Spq(8)
        W(3)=-(Cq(5)*Spq(9))-(Cq(6)+Cq(8))*Spq(11)
        W(4)=-((Cq(7)+Cq(9))*Spq(12))-Cq(8)*Spq(13)
        W(5)=-(Cq(9)*Spq(14))-(Cq(10)+Cq(12))*Spq(16)
        W(6)=-((Cq(11)+Cq(13))*Spq(17))-(Cq(12)+Cq(14))*Spq(18)
        W(7)=-(Cq(13)*Spq(19))-Cq(14)*Spq(20)
        W(8)=-((Cq(15)+Cq(17))*Spq(22))
        W(9)=-((Cq(16)+Cq(18))*Spq(23))-(Cq(17)+Cq(19))*Spq(24)
        W(10)=-((Cq(18)+Cq(20))*Spq(25))-Cq(19)*Spq(26)
        W(11)=-(Cq(20)*Spq(27))-(Cq(21)+Cq(23))*Spq(29)
        W(12)=-((Cq(22)+Cq(24))*Spq(30))-(Cq(23)+Cq(25))*Spq(31)
        W(13)=-((Cq(24)+Cq(26))*Spq(32))-(Cq(25)+Cq(27))*Spq(33)
        W(14)=-(Cq(26)*Spq(34))-Cq(27)*Spq(35)
        W(15)=Cpq(3)*Sq(2)+Cpq(5)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(6)*Sq(4)+Cpq(8)*Sq(4)+Cpq(7)*Sq(5)
        W(19)=Cpq(9)*Sq(5)+Cpq(10)*Sq(7)+Cpq(11)*Sq(8)+Cpq(13)*Sq(8)
        W(20)=Cpq(14)*Sq(9)+Cpq(12)*(Sq(7)+Sq(9))
        W(21)=Cpq(15)*Sq(11)+Cpq(16)*Sq(12)
        W(22)=Cpq(19)*Sq(13)+Cpq(17)*(Sq(11)+Sq(13))
        W(23)=Cpq(20)*Sq(14)+Cpq(18)*(Sq(12)+Sq(14))
        W(24)=Cpq(21)*Sq(16)+Cpq(22)*Sq(17)+Cpq(23)*(Sq(16)+Sq(18))
        W(25)=Cpq(26)*Sq(19)+Cpq(24)*(Sq(17)+Sq(19))
        W(26)=Cpq(27)*Sq(20)+Cpq(25)*(Sq(18)+Sq(20))
        W(27)=Cpq(28)*Sq(22)+Cpq(29)*Sq(23)
        W(28)=Cpq(30)*(Sq(22)+Sq(24))+Cpq(31)*(Sq(23)+Sq(25))
        W(29)=Cpq(34)*Sq(26)+Cpq(32)*(Sq(24)+Sq(26))
        W(30)=Cpq(35)*Sq(27)+Cpq(33)*(Sq(25)+Sq(27))
        W(31)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)
        W(32)=W(24)+W(25)+W(26)+W(27)+W(28)+W(29)+W(30)
        STwo=W(16)+W(17)+W(31)+W(32)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE IrRegular106(PQx,PQy,PQz,Cpq,Spq)
         IMPLICIT NONE
         REAL*8 Cpq(0:35),Spq(0:35),LegendreP(0:35)
         REAL*8 Sine(0:7),Cosine(0:7),CoFact(2:7)
         REAL*8 PQx,PQy,PQz,PQ2,pqx2,pqy2,pqxy,PQ
         REAL*8 Zero,One,Two,TT,TwoC,OneOvPQ
         REAL*8 CoTan,OneOvPQxy,RS,SQ,PQToThMnsL
         PARAMETER (Two=2D0,One=1D0,Zero=0D0)
         PQx2=PQx*PQx
         PQy2=PQy*PQy
         PQ=DSQRT(PQx2+PQy2+PQz*PQz)
         OneOvPQ=One/PQ
         CoTan=PQz*OneOvPQ
!        Compute Cosine and Sine by recursion
         Sine(0)  =Zero
         Cosine(0)=One
         PQxy=DSQRT(PQx2+PQy2)
         IF(PQxy/=Zero)THEN
            OneOvPQxy=One/PQxy
            Sine(1)  =PQx*OneOvPQxy
            Cosine(1)=PQy*OneOvPQxy
         ELSE
            Sine(1)  =0.70710678118654752D0
            Cosine(1)=0.70710678118654752D0
         ENDIF
         TwoC=Two*Cosine(1)
         Sine(2)=TwoC*Sine(1)-Sine(0)
         Cosine(2)=TwoC*Cosine(1)-Cosine(0)
         Sine(3)=TwoC*Sine(2)-Sine(1)
         Cosine(3)=TwoC*Cosine(2)-Cosine(1)
         Sine(4)=TwoC*Sine(3)-Sine(2)
         Cosine(4)=TwoC*Cosine(3)-Cosine(2)
         Sine(5)=TwoC*Sine(4)-Sine(3)
         Cosine(5)=TwoC*Cosine(4)-Cosine(3)
         Sine(6)=TwoC*Sine(5)-Sine(4)
         Cosine(6)=TwoC*Cosine(5)-Cosine(4)
         Sine(7)=TwoC*Sine(6)-Sine(5)
         Cosine(7)=TwoC*Cosine(6)-Cosine(5)
!        ----------------------------------------------------------------
!        Associated Legendre Polynomials by recursion
!
!        M=0,Ell; Compute LegendreP(M,M)
         RS=One
         Sq=SQRT(ABS(One-CoTan**2))
         LegendreP(0)=+1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(2)=-1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(5)=+3.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(9)=-1.500000000000000D+01*RS
         RS=RS*Sq
         LegendreP(14)=+1.050000000000000D+02*RS
         RS=RS*Sq
         LegendreP(20)=-9.450000000000000D+02*RS
         RS=RS*Sq
         LegendreP(27)=+1.039500000000000D+04*RS
         RS=RS*Sq
         LegendreP(35)=-1.351350000000000D+05*RS
!        ----------------------------------------------------------------
!        M=0,Ell-1; Compute LegendreP(M+1,M)
         LegendreP(1)=+1.000000000000000D+00*CoTan*LegendreP(0)
         LegendreP(4)=+3.000000000000000D+00*CoTan*LegendreP(2)
         LegendreP(8)=+5.000000000000000D+00*CoTan*LegendreP(5)
         LegendreP(13)=+7.000000000000000D+00*CoTan*LegendreP(9)
         LegendreP(19)=+9.000000000000000D+00*CoTan*LegendreP(14)
         LegendreP(26)=+1.100000000000000D+01*CoTan*LegendreP(20)
         LegendreP(34)=+1.300000000000000D+01*CoTan*LegendreP(27)
!        ----------------------------------------------------------------
         CoFact(2)=+3.000000000000000D+00*CoTan
         CoFact(3)=+5.000000000000000D+00*CoTan
         CoFact(4)=+7.000000000000000D+00*CoTan
         CoFact(5)=+9.000000000000000D+00*CoTan
         CoFact(6)=+1.100000000000000D+01*CoTan
         CoFact(7)=+1.300000000000000D+01*CoTan
!        ----------------------------------------------------------------
!        M=0,Ell-2; L=M+2,Ell; Compute LegendreP(L,M)
         LegendreP(3)=CoFact(2)*LegendreP(1)-1.000000000000000D+00*LegendreP(0)
         LegendreP(6)=CoFact(3)*LegendreP(3)-4.000000000000000D+00*LegendreP(1)
         LegendreP(10)=CoFact(4)*LegendreP(6)-9.000000000000000D+00*LegendreP(3)
         LegendreP(15)=CoFact(5)*LegendreP(10)-1.600000000000000D+01*LegendreP(6)
         LegendreP(21)=CoFact(6)*LegendreP(15)-2.500000000000000D+01*LegendreP(10)
         LegendreP(28)=CoFact(7)*LegendreP(21)-3.600000000000000D+01*LegendreP(15)
         LegendreP(7)=CoFact(3)*LegendreP(4)-3.000000000000000D+00*LegendreP(2)
         LegendreP(11)=CoFact(4)*LegendreP(7)-8.000000000000000D+00*LegendreP(4)
         LegendreP(16)=CoFact(5)*LegendreP(11)-1.500000000000000D+01*LegendreP(7)
         LegendreP(22)=CoFact(6)*LegendreP(16)-2.400000000000000D+01*LegendreP(11)
         LegendreP(29)=CoFact(7)*LegendreP(22)-3.500000000000000D+01*LegendreP(16)
         LegendreP(12)=CoFact(4)*LegendreP(8)-5.000000000000000D+00*LegendreP(5)
         LegendreP(17)=CoFact(5)*LegendreP(12)-1.200000000000000D+01*LegendreP(8)
         LegendreP(23)=CoFact(6)*LegendreP(17)-2.100000000000000D+01*LegendreP(12)
         LegendreP(30)=CoFact(7)*LegendreP(23)-3.200000000000000D+01*LegendreP(17)
         LegendreP(18)=CoFact(5)*LegendreP(13)-7.000000000000000D+00*LegendreP(9)
         LegendreP(24)=CoFact(6)*LegendreP(18)-1.600000000000000D+01*LegendreP(13)
         LegendreP(31)=CoFact(7)*LegendreP(24)-2.700000000000000D+01*LegendreP(18)
         LegendreP(25)=CoFact(6)*LegendreP(19)-9.000000000000000D+00*LegendreP(14)
         LegendreP(32)=CoFact(7)*LegendreP(25)-2.000000000000000D+01*LegendreP(19)
         LegendreP(33)=CoFact(7)*LegendreP(26)-1.100000000000000D+01*LegendreP(20)
!        ----------------------------------------------------------------
!        Compute Cpq(L,M) and Spq(L,M)
         PQToThMnsL=OneOvPQ
         TT=PQToThMnsL*LegendreP(0)
         Spq(0)=TT*Sine(0)
         Cpq(0)=TT*Cosine(0)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(1)
         Spq(1)=TT*Sine(0)
         Cpq(1)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(2)
         Spq(2)=TT*Sine(1)
         Cpq(2)=TT*Cosine(1)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(3)
         Spq(3)=TT*Sine(0)
         Cpq(3)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(4)
         Spq(4)=TT*Sine(1)
         Cpq(4)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(5)
         Spq(5)=TT*Sine(2)
         Cpq(5)=TT*Cosine(2)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(6)
         Spq(6)=TT*Sine(0)
         Cpq(6)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(7)
         Spq(7)=TT*Sine(1)
         Cpq(7)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(8)
         Spq(8)=TT*Sine(2)
         Cpq(8)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(9)
         Spq(9)=TT*Sine(3)
         Cpq(9)=TT*Cosine(3)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(10)
         Spq(10)=TT*Sine(0)
         Cpq(10)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(11)
         Spq(11)=TT*Sine(1)
         Cpq(11)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(12)
         Spq(12)=TT*Sine(2)
         Cpq(12)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(13)
         Spq(13)=TT*Sine(3)
         Cpq(13)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(14)
         Spq(14)=TT*Sine(4)
         Cpq(14)=TT*Cosine(4)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(15)
         Spq(15)=TT*Sine(0)
         Cpq(15)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(16)
         Spq(16)=TT*Sine(1)
         Cpq(16)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(17)
         Spq(17)=TT*Sine(2)
         Cpq(17)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(18)
         Spq(18)=TT*Sine(3)
         Cpq(18)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(19)
         Spq(19)=TT*Sine(4)
         Cpq(19)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(20)
         Spq(20)=TT*Sine(5)
         Cpq(20)=TT*Cosine(5)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(21)
         Spq(21)=TT*Sine(0)
         Cpq(21)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(22)
         Spq(22)=TT*Sine(1)
         Cpq(22)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(23)
         Spq(23)=TT*Sine(2)
         Cpq(23)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(24)
         Spq(24)=TT*Sine(3)
         Cpq(24)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(25)
         Spq(25)=TT*Sine(4)
         Cpq(25)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(26)
         Spq(26)=TT*Sine(5)
         Cpq(26)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(27)
         Spq(27)=TT*Sine(6)
         Cpq(27)=TT*Cosine(6)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(28)
         Spq(28)=TT*Sine(0)
         Cpq(28)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(29)
         Spq(29)=TT*Sine(1)
         Cpq(29)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(30)
         Spq(30)=TT*Sine(2)
         Cpq(30)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(31)
         Spq(31)=TT*Sine(3)
         Cpq(31)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(32)
         Spq(32)=TT*Sine(4)
         Cpq(32)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(33)
         Spq(33)=TT*Sine(5)
         Cpq(33)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(34)
         Spq(34)=TT*Sine(6)
         Cpq(34)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(35)
         Spq(35)=TT*Sine(7)
         Cpq(35)=TT*Cosine(7)
      RETURN
      END
      SUBROUTINE CTraX106(PQx,PQy,PQz,Cq,Sq,Cp,Sp)
         IMPLICIT NONE
         REAL*8 PQx,PQy,PQz
         REAL*8 Cq(0:27),Sq(0:27),Cp(0:2),Sp(0:2)
         REAL*8 Cpq(0:35),Spq(0:35)
         CALL IrRegular106(PQx,PQy,PQz,Cpq,Spq)
         CALL CTX106_0_0_C(Cp(0),Cpq,Spq,Cq,Sq)
         CALL CTX106_0_1_C(Cp(1),Cpq,Spq,Cq,Sq)
         CALL CTX106_1_1_C(Cp(2),Cpq,Spq,Cq,Sq)
         CALL CTX106_1_1_S(Sp(2),Cpq,Spq,Cq,Sq)
      RETURN
      END
      SUBROUTINE CTX206_0_0_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(0)*Cq(0)+Cpq(1)*Cq(1)+Cpq(3)*Cq(3)
        W(2)=Cpq(6)*Cq(6)+Cpq(10)*Cq(10)+Cpq(15)*Cq(15)+Cpq(21)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(2)*Cq(2)+Cpq(4)*Cq(4)
        W(2)=Cpq(5)*Cq(5)+Cpq(7)*Cq(7)+Cpq(8)*Cq(8)
        W(3)=Cpq(9)*Cq(9)+Cpq(11)*Cq(11)
        W(4)=Cpq(12)*Cq(12)+Cpq(13)*Cq(13)+Cpq(14)*Cq(14)
        W(5)=Cpq(16)*Cq(16)+Cpq(17)*Cq(17)
        W(6)=Cpq(18)*Cq(18)+Cpq(19)*Cq(19)+Cpq(20)*Cq(20)
        W(7)=Cpq(22)*Cq(22)+Cpq(23)*Cq(23)+Cpq(24)*Cq(24)
        W(8)=Cpq(25)*Cq(25)+Cpq(26)*Cq(26)+Cpq(27)*Cq(27)
        W(9)=Spq(2)*Sq(2)+Spq(4)*Sq(4)
        W(10)=Spq(5)*Sq(5)+Spq(7)*Sq(7)+Spq(8)*Sq(8)
        W(11)=Spq(9)*Sq(9)+Spq(11)*Sq(11)
        W(12)=Spq(12)*Sq(12)+Spq(13)*Sq(13)+Spq(14)*Sq(14)
        W(13)=Spq(16)*Sq(16)+Spq(17)*Sq(17)
        W(14)=Spq(18)*Sq(18)+Spq(19)*Sq(19)+Spq(20)*Sq(20)
        W(15)=Spq(22)*Sq(22)+Spq(23)*Sq(23)+Spq(24)*Sq(24)
        W(16)=Spq(25)*Sq(25)+Spq(26)*Sq(26)+Spq(27)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX206_0_1_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(1)*Cq(0))-Cpq(3)*Cq(1)-Cpq(6)*Cq(3)
        W(2)=-(Cpq(10)*Cq(6))-Cpq(15)*Cq(10)
        W(3)=-(Cpq(21)*Cq(15))-Cpq(28)*Cq(21)
        COne=W(1)+W(2)+W(3)
        W(1)=-(Cpq(4)*Cq(2))-Cpq(7)*Cq(4)
        W(2)=-(Cpq(8)*Cq(5))-Cpq(11)*Cq(7)-Cpq(12)*Cq(8)
        W(3)=-(Cpq(13)*Cq(9))-Cpq(16)*Cq(11)
        W(4)=-(Cpq(17)*Cq(12))-Cpq(18)*Cq(13)-Cpq(19)*Cq(14)
        W(5)=-(Cpq(22)*Cq(16))-Cpq(23)*Cq(17)
        W(6)=-(Cpq(24)*Cq(18))-Cpq(25)*Cq(19)-Cpq(26)*Cq(20)
        W(7)=-(Cpq(29)*Cq(22))-Cpq(30)*Cq(23)-Cpq(31)*Cq(24)
        W(8)=-(Cpq(32)*Cq(25))-Cpq(33)*Cq(26)-Cpq(34)*Cq(27)
        W(9)=-(Spq(4)*Sq(2))-Spq(7)*Sq(4)
        W(10)=-(Spq(8)*Sq(5))-Spq(11)*Sq(7)-Spq(12)*Sq(8)
        W(11)=-(Spq(13)*Sq(9))-Spq(16)*Sq(11)
        W(12)=-(Spq(17)*Sq(12))-Spq(18)*Sq(13)-Spq(19)*Sq(14)
        W(13)=-(Spq(22)*Sq(16))-Spq(23)*Sq(17)
        W(14)=-(Spq(24)*Sq(18))-Spq(25)*Sq(19)-Spq(26)*Sq(20)
        W(15)=-(Spq(29)*Sq(22))-Spq(30)*Sq(23)-Spq(31)*Sq(24)
        W(16)=-(Spq(32)*Sq(25))-Spq(33)*Sq(26)-Spq(34)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX206_1_1_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(2)*Cq(0))-Cpq(4)*Cq(1)+Cpq(3)*Cq(2)
        W(2)=-(Cpq(5)*Cq(2))+Cpq(6)*Cq(4)
        W(3)=-(Cpq(8)*Cq(4))-Cpq(9)*Cq(5)
        W(4)=Cpq(7)*(-Cq(3)+Cq(5))+Cpq(10)*Cq(7)
        W(5)=-(Cpq(13)*Cq(8))+Cpq(11)*(-Cq(6)+Cq(8))
        W(6)=-(Cpq(14)*Cq(9))+Cpq(12)*(-Cq(7)+Cq(9))
        W(7)=Cpq(15)*Cq(11)+Cpq(16)*(-Cq(10)+Cq(12))
        W(8)=-(Cpq(19)*Cq(13))
        W(9)=Cpq(17)*(-Cq(11)+Cq(13))-Cpq(20)*Cq(14)
        W(10)=Cpq(18)*(-Cq(12)+Cq(14))+Cpq(21)*Cq(16)
        W(11)=Cpq(22)*(-Cq(15)+Cq(17))+Cpq(23)*(-Cq(16)+Cq(18))
        W(12)=-(Cpq(26)*Cq(19))+Cpq(24)*(-Cq(17)+Cq(19))
        W(13)=-(Cpq(27)*Cq(20))+Cpq(25)*(-Cq(18)+Cq(20))
        W(14)=Cpq(28)*Cq(22)+Cpq(29)*(-Cq(21)+Cq(23))
        W(15)=Cpq(30)*(-Cq(22)+Cq(24))+Cpq(31)*(-Cq(23)+Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(34)*Cq(26))
        W(19)=Cpq(32)*(-Cq(24)+Cq(26))-Cpq(35)*Cq(27)
        W(20)=Cpq(33)*(-Cq(25)+Cq(27))-Spq(5)*Sq(2)
        W(21)=-(Spq(8)*Sq(4))+Spq(7)*Sq(5)
        W(22)=-(Spq(9)*Sq(5))+Spq(11)*Sq(8)
        W(23)=-(Spq(13)*Sq(8))-Spq(14)*Sq(9)
        W(24)=Spq(12)*(-Sq(7)+Sq(9))+Spq(16)*Sq(12)
        W(25)=-(Spq(19)*Sq(13))+Spq(17)*(-Sq(11)+Sq(13))
        W(26)=-(Spq(20)*Sq(14))
        W(27)=Spq(18)*(-Sq(12)+Sq(14))+Spq(22)*Sq(17)
        W(28)=Spq(23)*(-Sq(16)+Sq(18))-Spq(26)*Sq(19)
        W(29)=Spq(24)*(-Sq(17)+Sq(19))-Spq(27)*Sq(20)
        W(30)=Spq(25)*(-Sq(18)+Sq(20))+Spq(29)*Sq(23)
        W(31)=Spq(30)*(-Sq(22)+Sq(24))+Spq(31)*(-Sq(23)+Sq(25))
        W(32)=-(Spq(34)*Sq(26))+Spq(32)*(-Sq(24)+Sq(26))
        W(33)=-(Spq(35)*Sq(27))+Spq(33)*(-Sq(25)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX206_1_1_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(2))-Cq(1)*Spq(4)-Cq(2)*Spq(5)
        W(2)=-((Cq(3)+Cq(5))*Spq(7))-Cq(4)*Spq(8)
        W(3)=-(Cq(5)*Spq(9))-(Cq(6)+Cq(8))*Spq(11)
        W(4)=-((Cq(7)+Cq(9))*Spq(12))-Cq(8)*Spq(13)
        W(5)=-(Cq(9)*Spq(14))-(Cq(10)+Cq(12))*Spq(16)
        W(6)=-((Cq(11)+Cq(13))*Spq(17))-(Cq(12)+Cq(14))*Spq(18)
        W(7)=-(Cq(13)*Spq(19))-Cq(14)*Spq(20)
        W(8)=-((Cq(15)+Cq(17))*Spq(22))
        W(9)=-((Cq(16)+Cq(18))*Spq(23))-(Cq(17)+Cq(19))*Spq(24)
        W(10)=-((Cq(18)+Cq(20))*Spq(25))-Cq(19)*Spq(26)
        W(11)=-(Cq(20)*Spq(27))-(Cq(21)+Cq(23))*Spq(29)
        W(12)=-((Cq(22)+Cq(24))*Spq(30))-(Cq(23)+Cq(25))*Spq(31)
        W(13)=-((Cq(24)+Cq(26))*Spq(32))-(Cq(25)+Cq(27))*Spq(33)
        W(14)=-(Cq(26)*Spq(34))-Cq(27)*Spq(35)
        W(15)=Cpq(3)*Sq(2)+Cpq(5)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(6)*Sq(4)+Cpq(8)*Sq(4)+Cpq(7)*Sq(5)
        W(19)=Cpq(9)*Sq(5)+Cpq(10)*Sq(7)+Cpq(11)*Sq(8)+Cpq(13)*Sq(8)
        W(20)=Cpq(14)*Sq(9)+Cpq(12)*(Sq(7)+Sq(9))
        W(21)=Cpq(15)*Sq(11)+Cpq(16)*Sq(12)
        W(22)=Cpq(19)*Sq(13)+Cpq(17)*(Sq(11)+Sq(13))
        W(23)=Cpq(20)*Sq(14)+Cpq(18)*(Sq(12)+Sq(14))
        W(24)=Cpq(21)*Sq(16)+Cpq(22)*Sq(17)+Cpq(23)*(Sq(16)+Sq(18))
        W(25)=Cpq(26)*Sq(19)+Cpq(24)*(Sq(17)+Sq(19))
        W(26)=Cpq(27)*Sq(20)+Cpq(25)*(Sq(18)+Sq(20))
        W(27)=Cpq(28)*Sq(22)+Cpq(29)*Sq(23)
        W(28)=Cpq(30)*(Sq(22)+Sq(24))+Cpq(31)*(Sq(23)+Sq(25))
        W(29)=Cpq(34)*Sq(26)+Cpq(32)*(Sq(24)+Sq(26))
        W(30)=Cpq(35)*Sq(27)+Cpq(33)*(Sq(25)+Sq(27))
        W(31)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)
        W(32)=W(24)+W(25)+W(26)+W(27)+W(28)+W(29)+W(30)
        STwo=W(16)+W(17)+W(31)+W(32)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX206_0_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(3)*Cq(0)+Cpq(6)*Cq(1)+Cpq(10)*Cq(3)
        W(2)=Cpq(15)*Cq(6)+Cpq(21)*Cq(10)+Cpq(28)*Cq(15)+Cpq(36)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(7)*Cq(2)+Cpq(11)*Cq(4)
        W(2)=Cpq(12)*Cq(5)+Cpq(16)*Cq(7)+Cpq(17)*Cq(8)
        W(3)=Cpq(18)*Cq(9)+Cpq(22)*Cq(11)
        W(4)=Cpq(23)*Cq(12)+Cpq(24)*Cq(13)+Cpq(25)*Cq(14)
        W(5)=Cpq(29)*Cq(16)+Cpq(30)*Cq(17)
        W(6)=Cpq(31)*Cq(18)+Cpq(32)*Cq(19)+Cpq(33)*Cq(20)
        W(7)=Cpq(37)*Cq(22)+Cpq(38)*Cq(23)+Cpq(39)*Cq(24)
        W(8)=Cpq(40)*Cq(25)+Cpq(41)*Cq(26)+Cpq(42)*Cq(27)
        W(9)=Spq(7)*Sq(2)+Spq(11)*Sq(4)
        W(10)=Spq(12)*Sq(5)+Spq(16)*Sq(7)+Spq(17)*Sq(8)
        W(11)=Spq(18)*Sq(9)+Spq(22)*Sq(11)
        W(12)=Spq(23)*Sq(12)+Spq(24)*Sq(13)+Spq(25)*Sq(14)
        W(13)=Spq(29)*Sq(16)+Spq(30)*Sq(17)
        W(14)=Spq(31)*Sq(18)+Spq(32)*Sq(19)+Spq(33)*Sq(20)
        W(15)=Spq(37)*Sq(22)+Spq(38)*Sq(23)+Spq(39)*Sq(24)
        W(16)=Spq(40)*Sq(25)+Spq(41)*Sq(26)+Spq(42)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX206_1_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(4)*Cq(0)+Cpq(7)*Cq(1)-Cpq(6)*Cq(2)
        W(2)=Cpq(8)*Cq(2)-Cpq(10)*Cq(4)
        W(3)=Cpq(12)*Cq(4)+Cpq(11)*(Cq(3)-Cq(5))
        W(4)=Cpq(13)*Cq(5)-Cpq(15)*Cq(7)
        W(5)=Cpq(16)*(Cq(6)-Cq(8))+Cpq(18)*Cq(8)
        W(6)=Cpq(17)*(Cq(7)-Cq(9))+Cpq(19)*Cq(9)
        W(7)=-(Cpq(21)*Cq(11))+Cpq(22)*(Cq(10)-Cq(12))
        W(8)=Cpq(23)*(Cq(11)-Cq(13))
        W(9)=Cpq(25)*Cq(13)+Cpq(24)*(Cq(12)-Cq(14))
        W(10)=Cpq(26)*Cq(14)-Cpq(28)*Cq(16)
        W(11)=Cpq(29)*(Cq(15)-Cq(17))+Cpq(30)*(Cq(16)-Cq(18))
        W(12)=Cpq(31)*(Cq(17)-Cq(19))+Cpq(33)*Cq(19)
        W(13)=Cpq(32)*(Cq(18)-Cq(20))+Cpq(34)*Cq(20)
        W(14)=-(Cpq(36)*Cq(22))+Cpq(37)*(Cq(21)-Cq(23))
        W(15)=Cpq(38)*(Cq(22)-Cq(24))+Cpq(39)*(Cq(23)-Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(40)*(Cq(24)-Cq(26))
        W(19)=Cpq(42)*Cq(26)+Cpq(41)*(Cq(25)-Cq(27))
        W(20)=Cpq(43)*Cq(27)+Spq(8)*Sq(2)
        W(21)=Spq(12)*Sq(4)-Spq(11)*Sq(5)
        W(22)=Spq(13)*Sq(5)-Spq(16)*Sq(8)
        W(23)=Spq(18)*Sq(8)+Spq(17)*(Sq(7)-Sq(9))
        W(24)=Spq(19)*Sq(9)-Spq(22)*Sq(12)
        W(25)=Spq(23)*(Sq(11)-Sq(13))+Spq(25)*Sq(13)
        W(26)=Spq(24)*(Sq(12)-Sq(14))
        W(27)=Spq(26)*Sq(14)-Spq(29)*Sq(17)
        W(28)=Spq(30)*(Sq(16)-Sq(18))+Spq(31)*(Sq(17)-Sq(19))
        W(29)=Spq(33)*Sq(19)+Spq(32)*(Sq(18)-Sq(20))
        W(30)=Spq(34)*Sq(20)-Spq(37)*Sq(23)
        W(31)=Spq(38)*(Sq(22)-Sq(24))+Spq(39)*(Sq(23)-Sq(25))
        W(32)=Spq(40)*(Sq(24)-Sq(26))+Spq(42)*Sq(26)
        W(33)=Spq(41)*(Sq(25)-Sq(27))+Spq(43)*Sq(27)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX206_1_2_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(4)+Cq(1)*Spq(7)+Cq(2)*Spq(8)
        W(2)=(Cq(3)+Cq(5))*Spq(11)+Cq(4)*Spq(12)
        W(3)=Cq(5)*Spq(13)+(Cq(6)+Cq(8))*Spq(16)
        W(4)=(Cq(7)+Cq(9))*Spq(17)+Cq(8)*Spq(18)
        W(5)=Cq(9)*Spq(19)+(Cq(10)+Cq(12))*Spq(22)
        W(6)=(Cq(11)+Cq(13))*Spq(23)+(Cq(12)+Cq(14))*Spq(24)
        W(7)=Cq(13)*Spq(25)+Cq(14)*Spq(26)
        W(8)=(Cq(15)+Cq(17))*Spq(29)
        W(9)=(Cq(16)+Cq(18))*Spq(30)+(Cq(17)+Cq(19))*Spq(31)
        W(10)=(Cq(18)+Cq(20))*Spq(32)+Cq(19)*Spq(33)
        W(11)=Cq(20)*Spq(34)+(Cq(21)+Cq(23))*Spq(37)
        W(12)=(Cq(22)+Cq(24))*Spq(38)+(Cq(23)+Cq(25))*Spq(39)
        W(13)=(Cq(24)+Cq(26))*Spq(40)+(Cq(25)+Cq(27))*Spq(41)
        W(14)=Cq(26)*Spq(42)+Cq(27)*Spq(43)
        W(15)=-(Cpq(6)*Sq(2))-Cpq(8)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(10)*Sq(4))-Cpq(12)*Sq(4)-Cpq(11)*Sq(5)
        W(19)=-(Cpq(13)*Sq(5))-Cpq(15)*Sq(7)
        W(20)=-(Cpq(16)*Sq(8))-Cpq(18)*Sq(8)
        W(21)=-(Cpq(19)*Sq(9))-Cpq(17)*(Sq(7)+Sq(9))
        W(22)=-(Cpq(21)*Sq(11))-Cpq(22)*Sq(12)
        W(23)=-(Cpq(25)*Sq(13))-Cpq(23)*(Sq(11)+Sq(13))
        W(24)=-(Cpq(26)*Sq(14))-Cpq(24)*(Sq(12)+Sq(14))
        W(25)=-(Cpq(28)*Sq(16))-Cpq(29)*Sq(17)-Cpq(30)*(Sq(16)+Sq(18))
        W(26)=-(Cpq(33)*Sq(19))-Cpq(31)*(Sq(17)+Sq(19))
        W(27)=-(Cpq(34)*Sq(20))-Cpq(32)*(Sq(18)+Sq(20))
        W(28)=-(Cpq(36)*Sq(22))-Cpq(37)*Sq(23)
        W(29)=-(Cpq(38)*(Sq(22)+Sq(24)))-Cpq(39)*(Sq(23)+Sq(25))
        W(30)=-(Cpq(42)*Sq(26))-Cpq(40)*(Sq(24)+Sq(26))
        W(31)=-(Cpq(43)*Sq(27))-Cpq(41)*(Sq(25)+Sq(27))
        W(32)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(33)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)
        STwo=W(16)+W(17)+W(32)+W(33)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX206_2_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(5)*Cq(0)+Cpq(8)*Cq(1)
        W(2)=-(Cpq(7)*Cq(2))+Cpq(9)*Cq(2)
        W(3)=Cpq(12)*Cq(3)-Cpq(11)*Cq(4)
        W(4)=Cpq(13)*Cq(4)+Cpq(10)*Cq(5)
        W(5)=Cpq(14)*Cq(5)+Cpq(17)*Cq(6)+Cpq(18)*Cq(7)+Cpq(15)*Cq(8)
        W(6)=Cpq(19)*Cq(8)+Cpq(20)*Cq(9)
        W(7)=Cpq(16)*(-Cq(7)+Cq(9))+Cpq(24)*Cq(11)+Cpq(21)*Cq(12)
        W(8)=Cpq(25)*Cq(12)+Cpq(26)*Cq(13)
        W(9)=Cpq(22)*(-Cq(11)+Cq(13))+Cpq(27)*Cq(14)
        W(10)=Cpq(23)*(Cq(10)+Cq(14))+Cpq(28)*Cq(17)
        W(11)=Cpq(32)*Cq(17)+Cpq(33)*Cq(18)
        W(12)=Cpq(29)*(-Cq(16)+Cq(18))+Cpq(34)*Cq(19)
        W(13)=Cpq(30)*(Cq(15)+Cq(19))+Cpq(35)*Cq(20)
        W(14)=Cpq(31)*(Cq(16)+Cq(20))+Cpq(36)*Cq(23)
        W(15)=Cpq(41)*Cq(24)+Cpq(37)*(-Cq(22)+Cq(24))+Cpq(42)*Cq(25)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(38)*(Cq(21)+Cq(25))+Cpq(43)*Cq(26)
        W(19)=Cpq(39)*(Cq(22)+Cq(26))+Cpq(44)*Cq(27)
        W(20)=Cpq(40)*(Cq(23)+Cq(27))+Spq(7)*Sq(2)
        W(21)=Spq(9)*Sq(2)+Spq(11)*Sq(4)
        W(22)=Spq(13)*Sq(4)+Spq(14)*Sq(5)+Spq(18)*Sq(7)+Spq(19)*Sq(8)
        W(23)=Spq(20)*Sq(9)+Spq(16)*(Sq(7)+Sq(9))
        W(24)=Spq(24)*Sq(11)+Spq(25)*Sq(12)+Spq(26)*Sq(13)
        W(25)=Spq(22)*(Sq(11)+Sq(13))+Spq(23)*Sq(14)
        W(26)=Spq(27)*Sq(14)+Spq(32)*Sq(17)
        W(27)=Spq(33)*Sq(18)+Spq(29)*(Sq(16)+Sq(18))
        W(28)=Spq(30)*Sq(19)+Spq(34)*Sq(19)+Spq(35)*Sq(20)
        W(29)=Spq(31)*(Sq(16)+Sq(20))+Spq(41)*Sq(24)
        W(30)=Spq(37)*(Sq(22)+Sq(24))+Spq(38)*Sq(25)
        W(31)=Spq(42)*Sq(25)+Spq(43)*Sq(26)
        W(32)=Spq(39)*(Sq(22)+Sq(26))
        W(33)=Spq(44)*Sq(27)+Spq(40)*(Sq(23)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX206_2_2_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:44),Spq(0:44),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(5)-Cq(2)*Spq(7)
        W(2)=Cq(1)*Spq(8)+Cq(2)*Spq(9)
        W(3)=-(Cq(4)*Spq(11))+Cq(3)*Spq(12)
        W(4)=Cq(4)*Spq(13)+Cq(5)*Spq(14)
        W(5)=-((Cq(7)+Cq(9))*Spq(16))+Cq(6)*Spq(17)
        W(6)=Cq(7)*Spq(18)+Cq(8)*Spq(19)
        W(7)=Cq(9)*Spq(20)-(Cq(11)+Cq(13))*Spq(22)
        W(8)=(Cq(10)-Cq(14))*Spq(23)+Cq(11)*Spq(24)+Cq(12)*Spq(25)
        W(9)=Cq(13)*Spq(26)+Cq(14)*Spq(27)
        W(10)=-((Cq(16)+Cq(18))*Spq(29))+(Cq(15)-Cq(19))*Spq(30)
        W(11)=(Cq(16)-Cq(20))*Spq(31)+Cq(17)*Spq(32)
        W(12)=Cq(18)*Spq(33)+Cq(19)*Spq(34)
        W(13)=Cq(20)*Spq(35)-(Cq(22)+Cq(24))*Spq(37)
        W(14)=(Cq(21)-Cq(25))*Spq(38)+(Cq(22)-Cq(26))*Spq(39)
        W(15)=(Cq(23)-Cq(27))*Spq(40)+Cq(24)*Spq(41)
        W(16)=Cq(25)*Spq(42)+Cq(26)*Spq(43)+Cq(27)*Spq(44)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=-(Cpq(7)*Sq(2))-Cpq(9)*Sq(2)
        W(20)=-(Cpq(11)*Sq(4))-Cpq(13)*Sq(4)
        W(21)=Cpq(10)*Sq(5)-Cpq(14)*Sq(5)
        W(22)=-(Cpq(18)*Sq(7))+Cpq(15)*Sq(8)
        W(23)=-(Cpq(19)*Sq(8))-Cpq(20)*Sq(9)
        W(24)=Cpq(16)*(-Sq(7)+Sq(9))-Cpq(24)*Sq(11)
        W(25)=Cpq(21)*Sq(12)-Cpq(25)*Sq(12)
        W(26)=-(Cpq(26)*Sq(13))
        W(27)=Cpq(22)*(-Sq(11)+Sq(13))+Cpq(23)*Sq(14)
        W(28)=-(Cpq(27)*Sq(14))+Cpq(28)*Sq(17)
        W(29)=-(Cpq(32)*Sq(17))-Cpq(33)*Sq(18)
        W(30)=Cpq(29)*(-Sq(16)+Sq(18))+Cpq(30)*Sq(19)
        W(31)=-(Cpq(34)*Sq(19))
        W(32)=-(Cpq(35)*Sq(20))+Cpq(31)*(-Sq(16)+Sq(20))
        W(33)=Cpq(36)*Sq(23)-Cpq(41)*Sq(24)
        W(34)=Cpq(37)*(-Sq(22)+Sq(24))+Cpq(38)*Sq(25)
        W(35)=-(Cpq(42)*Sq(25))-Cpq(43)*Sq(26)
        W(36)=Cpq(39)*(-Sq(22)+Sq(26))
        W(37)=-(Cpq(44)*Sq(27))+Cpq(40)*(-Sq(23)+Sq(27))
        W(38)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(39)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)+W(37)
        STwo=W(17)+W(18)+W(38)+W(39)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE IrRegular206(PQx,PQy,PQz,Cpq,Spq)
         IMPLICIT NONE
         REAL*8 Cpq(0:44),Spq(0:44),LegendreP(0:44)
         REAL*8 Sine(0:8),Cosine(0:8),CoFact(2:8)
         REAL*8 PQx,PQy,PQz,PQ2,pqx2,pqy2,pqxy,PQ
         REAL*8 Zero,One,Two,TT,TwoC,OneOvPQ
         REAL*8 CoTan,OneOvPQxy,RS,SQ,PQToThMnsL
         PARAMETER (Two=2D0,One=1D0,Zero=0D0)
         PQx2=PQx*PQx
         PQy2=PQy*PQy
         PQ=DSQRT(PQx2+PQy2+PQz*PQz)
         OneOvPQ=One/PQ
         CoTan=PQz*OneOvPQ
!        Compute Cosine and Sine by recursion
         Sine(0)  =Zero
         Cosine(0)=One
         PQxy=DSQRT(PQx2+PQy2)
         IF(PQxy/=Zero)THEN
            OneOvPQxy=One/PQxy
            Sine(1)  =PQx*OneOvPQxy
            Cosine(1)=PQy*OneOvPQxy
         ELSE
            Sine(1)  =0.70710678118654752D0
            Cosine(1)=0.70710678118654752D0
         ENDIF
         TwoC=Two*Cosine(1)
         Sine(2)=TwoC*Sine(1)-Sine(0)
         Cosine(2)=TwoC*Cosine(1)-Cosine(0)
         Sine(3)=TwoC*Sine(2)-Sine(1)
         Cosine(3)=TwoC*Cosine(2)-Cosine(1)
         Sine(4)=TwoC*Sine(3)-Sine(2)
         Cosine(4)=TwoC*Cosine(3)-Cosine(2)
         Sine(5)=TwoC*Sine(4)-Sine(3)
         Cosine(5)=TwoC*Cosine(4)-Cosine(3)
         Sine(6)=TwoC*Sine(5)-Sine(4)
         Cosine(6)=TwoC*Cosine(5)-Cosine(4)
         Sine(7)=TwoC*Sine(6)-Sine(5)
         Cosine(7)=TwoC*Cosine(6)-Cosine(5)
         Sine(8)=TwoC*Sine(7)-Sine(6)
         Cosine(8)=TwoC*Cosine(7)-Cosine(6)
!        ----------------------------------------------------------------
!        Associated Legendre Polynomials by recursion
!
!        M=0,Ell; Compute LegendreP(M,M)
         RS=One
         Sq=SQRT(ABS(One-CoTan**2))
         LegendreP(0)=+1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(2)=-1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(5)=+3.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(9)=-1.500000000000000D+01*RS
         RS=RS*Sq
         LegendreP(14)=+1.050000000000000D+02*RS
         RS=RS*Sq
         LegendreP(20)=-9.450000000000000D+02*RS
         RS=RS*Sq
         LegendreP(27)=+1.039500000000000D+04*RS
         RS=RS*Sq
         LegendreP(35)=-1.351350000000000D+05*RS
         RS=RS*Sq
         LegendreP(44)=+2.027025000000000D+06*RS
!        ----------------------------------------------------------------
!        M=0,Ell-1; Compute LegendreP(M+1,M)
         LegendreP(1)=+1.000000000000000D+00*CoTan*LegendreP(0)
         LegendreP(4)=+3.000000000000000D+00*CoTan*LegendreP(2)
         LegendreP(8)=+5.000000000000000D+00*CoTan*LegendreP(5)
         LegendreP(13)=+7.000000000000000D+00*CoTan*LegendreP(9)
         LegendreP(19)=+9.000000000000000D+00*CoTan*LegendreP(14)
         LegendreP(26)=+1.100000000000000D+01*CoTan*LegendreP(20)
         LegendreP(34)=+1.300000000000000D+01*CoTan*LegendreP(27)
         LegendreP(43)=+1.500000000000000D+01*CoTan*LegendreP(35)
!        ----------------------------------------------------------------
         CoFact(2)=+3.000000000000000D+00*CoTan
         CoFact(3)=+5.000000000000000D+00*CoTan
         CoFact(4)=+7.000000000000000D+00*CoTan
         CoFact(5)=+9.000000000000000D+00*CoTan
         CoFact(6)=+1.100000000000000D+01*CoTan
         CoFact(7)=+1.300000000000000D+01*CoTan
         CoFact(8)=+1.500000000000000D+01*CoTan
!        ----------------------------------------------------------------
!        M=0,Ell-2; L=M+2,Ell; Compute LegendreP(L,M)
         LegendreP(3)=CoFact(2)*LegendreP(1)-1.000000000000000D+00*LegendreP(0)
         LegendreP(6)=CoFact(3)*LegendreP(3)-4.000000000000000D+00*LegendreP(1)
         LegendreP(10)=CoFact(4)*LegendreP(6)-9.000000000000000D+00*LegendreP(3)
         LegendreP(15)=CoFact(5)*LegendreP(10)-1.600000000000000D+01*LegendreP(6)
         LegendreP(21)=CoFact(6)*LegendreP(15)-2.500000000000000D+01*LegendreP(10)
         LegendreP(28)=CoFact(7)*LegendreP(21)-3.600000000000000D+01*LegendreP(15)
         LegendreP(36)=CoFact(8)*LegendreP(28)-4.900000000000000D+01*LegendreP(21)
         LegendreP(7)=CoFact(3)*LegendreP(4)-3.000000000000000D+00*LegendreP(2)
         LegendreP(11)=CoFact(4)*LegendreP(7)-8.000000000000000D+00*LegendreP(4)
         LegendreP(16)=CoFact(5)*LegendreP(11)-1.500000000000000D+01*LegendreP(7)
         LegendreP(22)=CoFact(6)*LegendreP(16)-2.400000000000000D+01*LegendreP(11)
         LegendreP(29)=CoFact(7)*LegendreP(22)-3.500000000000000D+01*LegendreP(16)
         LegendreP(37)=CoFact(8)*LegendreP(29)-4.800000000000000D+01*LegendreP(22)
         LegendreP(12)=CoFact(4)*LegendreP(8)-5.000000000000000D+00*LegendreP(5)
         LegendreP(17)=CoFact(5)*LegendreP(12)-1.200000000000000D+01*LegendreP(8)
         LegendreP(23)=CoFact(6)*LegendreP(17)-2.100000000000000D+01*LegendreP(12)
         LegendreP(30)=CoFact(7)*LegendreP(23)-3.200000000000000D+01*LegendreP(17)
         LegendreP(38)=CoFact(8)*LegendreP(30)-4.500000000000000D+01*LegendreP(23)
         LegendreP(18)=CoFact(5)*LegendreP(13)-7.000000000000000D+00*LegendreP(9)
         LegendreP(24)=CoFact(6)*LegendreP(18)-1.600000000000000D+01*LegendreP(13)
         LegendreP(31)=CoFact(7)*LegendreP(24)-2.700000000000000D+01*LegendreP(18)
         LegendreP(39)=CoFact(8)*LegendreP(31)-4.000000000000000D+01*LegendreP(24)
         LegendreP(25)=CoFact(6)*LegendreP(19)-9.000000000000000D+00*LegendreP(14)
         LegendreP(32)=CoFact(7)*LegendreP(25)-2.000000000000000D+01*LegendreP(19)
         LegendreP(40)=CoFact(8)*LegendreP(32)-3.300000000000000D+01*LegendreP(25)
         LegendreP(33)=CoFact(7)*LegendreP(26)-1.100000000000000D+01*LegendreP(20)
         LegendreP(41)=CoFact(8)*LegendreP(33)-2.400000000000000D+01*LegendreP(26)
         LegendreP(42)=CoFact(8)*LegendreP(34)-1.300000000000000D+01*LegendreP(27)
!        ----------------------------------------------------------------
!        Compute Cpq(L,M) and Spq(L,M)
         PQToThMnsL=OneOvPQ
         TT=PQToThMnsL*LegendreP(0)
         Spq(0)=TT*Sine(0)
         Cpq(0)=TT*Cosine(0)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(1)
         Spq(1)=TT*Sine(0)
         Cpq(1)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(2)
         Spq(2)=TT*Sine(1)
         Cpq(2)=TT*Cosine(1)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(3)
         Spq(3)=TT*Sine(0)
         Cpq(3)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(4)
         Spq(4)=TT*Sine(1)
         Cpq(4)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(5)
         Spq(5)=TT*Sine(2)
         Cpq(5)=TT*Cosine(2)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(6)
         Spq(6)=TT*Sine(0)
         Cpq(6)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(7)
         Spq(7)=TT*Sine(1)
         Cpq(7)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(8)
         Spq(8)=TT*Sine(2)
         Cpq(8)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(9)
         Spq(9)=TT*Sine(3)
         Cpq(9)=TT*Cosine(3)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(10)
         Spq(10)=TT*Sine(0)
         Cpq(10)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(11)
         Spq(11)=TT*Sine(1)
         Cpq(11)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(12)
         Spq(12)=TT*Sine(2)
         Cpq(12)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(13)
         Spq(13)=TT*Sine(3)
         Cpq(13)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(14)
         Spq(14)=TT*Sine(4)
         Cpq(14)=TT*Cosine(4)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(15)
         Spq(15)=TT*Sine(0)
         Cpq(15)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(16)
         Spq(16)=TT*Sine(1)
         Cpq(16)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(17)
         Spq(17)=TT*Sine(2)
         Cpq(17)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(18)
         Spq(18)=TT*Sine(3)
         Cpq(18)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(19)
         Spq(19)=TT*Sine(4)
         Cpq(19)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(20)
         Spq(20)=TT*Sine(5)
         Cpq(20)=TT*Cosine(5)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(21)
         Spq(21)=TT*Sine(0)
         Cpq(21)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(22)
         Spq(22)=TT*Sine(1)
         Cpq(22)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(23)
         Spq(23)=TT*Sine(2)
         Cpq(23)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(24)
         Spq(24)=TT*Sine(3)
         Cpq(24)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(25)
         Spq(25)=TT*Sine(4)
         Cpq(25)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(26)
         Spq(26)=TT*Sine(5)
         Cpq(26)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(27)
         Spq(27)=TT*Sine(6)
         Cpq(27)=TT*Cosine(6)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(28)
         Spq(28)=TT*Sine(0)
         Cpq(28)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(29)
         Spq(29)=TT*Sine(1)
         Cpq(29)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(30)
         Spq(30)=TT*Sine(2)
         Cpq(30)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(31)
         Spq(31)=TT*Sine(3)
         Cpq(31)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(32)
         Spq(32)=TT*Sine(4)
         Cpq(32)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(33)
         Spq(33)=TT*Sine(5)
         Cpq(33)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(34)
         Spq(34)=TT*Sine(6)
         Cpq(34)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(35)
         Spq(35)=TT*Sine(7)
         Cpq(35)=TT*Cosine(7)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(36)
         Spq(36)=TT*Sine(0)
         Cpq(36)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(37)
         Spq(37)=TT*Sine(1)
         Cpq(37)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(38)
         Spq(38)=TT*Sine(2)
         Cpq(38)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(39)
         Spq(39)=TT*Sine(3)
         Cpq(39)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(40)
         Spq(40)=TT*Sine(4)
         Cpq(40)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(41)
         Spq(41)=TT*Sine(5)
         Cpq(41)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(42)
         Spq(42)=TT*Sine(6)
         Cpq(42)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(43)
         Spq(43)=TT*Sine(7)
         Cpq(43)=TT*Cosine(7)
         TT=PQToThMnsL*LegendreP(44)
         Spq(44)=TT*Sine(8)
         Cpq(44)=TT*Cosine(8)
      RETURN
      END
      SUBROUTINE CTraX206(PQx,PQy,PQz,Cq,Sq,Cp,Sp)
         IMPLICIT NONE
         REAL*8 PQx,PQy,PQz
         REAL*8 Cq(0:27),Sq(0:27),Cp(0:5),Sp(0:5)
         REAL*8 Cpq(0:44),Spq(0:44)
         CALL IrRegular206(PQx,PQy,PQz,Cpq,Spq)
         CALL CTX206_0_0_C(Cp(0),Cpq,Spq,Cq,Sq)
         CALL CTX206_0_1_C(Cp(1),Cpq,Spq,Cq,Sq)
         CALL CTX206_1_1_C(Cp(2),Cpq,Spq,Cq,Sq)
         CALL CTX206_1_1_S(Sp(2),Cpq,Spq,Cq,Sq)
         CALL CTX206_0_2_C(Cp(3),Cpq,Spq,Cq,Sq)
         CALL CTX206_1_2_C(Cp(4),Cpq,Spq,Cq,Sq)
         CALL CTX206_1_2_S(Sp(4),Cpq,Spq,Cq,Sq)
         CALL CTX206_2_2_C(Cp(5),Cpq,Spq,Cq,Sq)
         CALL CTX206_2_2_S(Sp(5),Cpq,Spq,Cq,Sq)
      RETURN
      END
      SUBROUTINE CTX306_0_0_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(0)*Cq(0)+Cpq(1)*Cq(1)+Cpq(3)*Cq(3)
        W(2)=Cpq(6)*Cq(6)+Cpq(10)*Cq(10)+Cpq(15)*Cq(15)+Cpq(21)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(2)*Cq(2)+Cpq(4)*Cq(4)
        W(2)=Cpq(5)*Cq(5)+Cpq(7)*Cq(7)+Cpq(8)*Cq(8)
        W(3)=Cpq(9)*Cq(9)+Cpq(11)*Cq(11)
        W(4)=Cpq(12)*Cq(12)+Cpq(13)*Cq(13)+Cpq(14)*Cq(14)
        W(5)=Cpq(16)*Cq(16)+Cpq(17)*Cq(17)
        W(6)=Cpq(18)*Cq(18)+Cpq(19)*Cq(19)+Cpq(20)*Cq(20)
        W(7)=Cpq(22)*Cq(22)+Cpq(23)*Cq(23)+Cpq(24)*Cq(24)
        W(8)=Cpq(25)*Cq(25)+Cpq(26)*Cq(26)+Cpq(27)*Cq(27)
        W(9)=Spq(2)*Sq(2)+Spq(4)*Sq(4)
        W(10)=Spq(5)*Sq(5)+Spq(7)*Sq(7)+Spq(8)*Sq(8)
        W(11)=Spq(9)*Sq(9)+Spq(11)*Sq(11)
        W(12)=Spq(12)*Sq(12)+Spq(13)*Sq(13)+Spq(14)*Sq(14)
        W(13)=Spq(16)*Sq(16)+Spq(17)*Sq(17)
        W(14)=Spq(18)*Sq(18)+Spq(19)*Sq(19)+Spq(20)*Sq(20)
        W(15)=Spq(22)*Sq(22)+Spq(23)*Sq(23)+Spq(24)*Sq(24)
        W(16)=Spq(25)*Sq(25)+Spq(26)*Sq(26)+Spq(27)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_0_1_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(1)*Cq(0))-Cpq(3)*Cq(1)-Cpq(6)*Cq(3)
        W(2)=-(Cpq(10)*Cq(6))-Cpq(15)*Cq(10)
        W(3)=-(Cpq(21)*Cq(15))-Cpq(28)*Cq(21)
        COne=W(1)+W(2)+W(3)
        W(1)=-(Cpq(4)*Cq(2))-Cpq(7)*Cq(4)
        W(2)=-(Cpq(8)*Cq(5))-Cpq(11)*Cq(7)-Cpq(12)*Cq(8)
        W(3)=-(Cpq(13)*Cq(9))-Cpq(16)*Cq(11)
        W(4)=-(Cpq(17)*Cq(12))-Cpq(18)*Cq(13)-Cpq(19)*Cq(14)
        W(5)=-(Cpq(22)*Cq(16))-Cpq(23)*Cq(17)
        W(6)=-(Cpq(24)*Cq(18))-Cpq(25)*Cq(19)-Cpq(26)*Cq(20)
        W(7)=-(Cpq(29)*Cq(22))-Cpq(30)*Cq(23)-Cpq(31)*Cq(24)
        W(8)=-(Cpq(32)*Cq(25))-Cpq(33)*Cq(26)-Cpq(34)*Cq(27)
        W(9)=-(Spq(4)*Sq(2))-Spq(7)*Sq(4)
        W(10)=-(Spq(8)*Sq(5))-Spq(11)*Sq(7)-Spq(12)*Sq(8)
        W(11)=-(Spq(13)*Sq(9))-Spq(16)*Sq(11)
        W(12)=-(Spq(17)*Sq(12))-Spq(18)*Sq(13)-Spq(19)*Sq(14)
        W(13)=-(Spq(22)*Sq(16))-Spq(23)*Sq(17)
        W(14)=-(Spq(24)*Sq(18))-Spq(25)*Sq(19)-Spq(26)*Sq(20)
        W(15)=-(Spq(29)*Sq(22))-Spq(30)*Sq(23)-Spq(31)*Sq(24)
        W(16)=-(Spq(32)*Sq(25))-Spq(33)*Sq(26)-Spq(34)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_1_1_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(2)*Cq(0))-Cpq(4)*Cq(1)+Cpq(3)*Cq(2)
        W(2)=-(Cpq(5)*Cq(2))+Cpq(6)*Cq(4)
        W(3)=-(Cpq(8)*Cq(4))-Cpq(9)*Cq(5)
        W(4)=Cpq(7)*(-Cq(3)+Cq(5))+Cpq(10)*Cq(7)
        W(5)=-(Cpq(13)*Cq(8))+Cpq(11)*(-Cq(6)+Cq(8))
        W(6)=-(Cpq(14)*Cq(9))+Cpq(12)*(-Cq(7)+Cq(9))
        W(7)=Cpq(15)*Cq(11)+Cpq(16)*(-Cq(10)+Cq(12))
        W(8)=-(Cpq(19)*Cq(13))
        W(9)=Cpq(17)*(-Cq(11)+Cq(13))-Cpq(20)*Cq(14)
        W(10)=Cpq(18)*(-Cq(12)+Cq(14))+Cpq(21)*Cq(16)
        W(11)=Cpq(22)*(-Cq(15)+Cq(17))+Cpq(23)*(-Cq(16)+Cq(18))
        W(12)=-(Cpq(26)*Cq(19))+Cpq(24)*(-Cq(17)+Cq(19))
        W(13)=-(Cpq(27)*Cq(20))+Cpq(25)*(-Cq(18)+Cq(20))
        W(14)=Cpq(28)*Cq(22)+Cpq(29)*(-Cq(21)+Cq(23))
        W(15)=Cpq(30)*(-Cq(22)+Cq(24))+Cpq(31)*(-Cq(23)+Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(34)*Cq(26))
        W(19)=Cpq(32)*(-Cq(24)+Cq(26))-Cpq(35)*Cq(27)
        W(20)=Cpq(33)*(-Cq(25)+Cq(27))-Spq(5)*Sq(2)
        W(21)=-(Spq(8)*Sq(4))+Spq(7)*Sq(5)
        W(22)=-(Spq(9)*Sq(5))+Spq(11)*Sq(8)
        W(23)=-(Spq(13)*Sq(8))-Spq(14)*Sq(9)
        W(24)=Spq(12)*(-Sq(7)+Sq(9))+Spq(16)*Sq(12)
        W(25)=-(Spq(19)*Sq(13))+Spq(17)*(-Sq(11)+Sq(13))
        W(26)=-(Spq(20)*Sq(14))
        W(27)=Spq(18)*(-Sq(12)+Sq(14))+Spq(22)*Sq(17)
        W(28)=Spq(23)*(-Sq(16)+Sq(18))-Spq(26)*Sq(19)
        W(29)=Spq(24)*(-Sq(17)+Sq(19))-Spq(27)*Sq(20)
        W(30)=Spq(25)*(-Sq(18)+Sq(20))+Spq(29)*Sq(23)
        W(31)=Spq(30)*(-Sq(22)+Sq(24))+Spq(31)*(-Sq(23)+Sq(25))
        W(32)=-(Spq(34)*Sq(26))+Spq(32)*(-Sq(24)+Sq(26))
        W(33)=-(Spq(35)*Sq(27))+Spq(33)*(-Sq(25)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_1_1_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(2))-Cq(1)*Spq(4)-Cq(2)*Spq(5)
        W(2)=-((Cq(3)+Cq(5))*Spq(7))-Cq(4)*Spq(8)
        W(3)=-(Cq(5)*Spq(9))-(Cq(6)+Cq(8))*Spq(11)
        W(4)=-((Cq(7)+Cq(9))*Spq(12))-Cq(8)*Spq(13)
        W(5)=-(Cq(9)*Spq(14))-(Cq(10)+Cq(12))*Spq(16)
        W(6)=-((Cq(11)+Cq(13))*Spq(17))-(Cq(12)+Cq(14))*Spq(18)
        W(7)=-(Cq(13)*Spq(19))-Cq(14)*Spq(20)
        W(8)=-((Cq(15)+Cq(17))*Spq(22))
        W(9)=-((Cq(16)+Cq(18))*Spq(23))-(Cq(17)+Cq(19))*Spq(24)
        W(10)=-((Cq(18)+Cq(20))*Spq(25))-Cq(19)*Spq(26)
        W(11)=-(Cq(20)*Spq(27))-(Cq(21)+Cq(23))*Spq(29)
        W(12)=-((Cq(22)+Cq(24))*Spq(30))-(Cq(23)+Cq(25))*Spq(31)
        W(13)=-((Cq(24)+Cq(26))*Spq(32))-(Cq(25)+Cq(27))*Spq(33)
        W(14)=-(Cq(26)*Spq(34))-Cq(27)*Spq(35)
        W(15)=Cpq(3)*Sq(2)+Cpq(5)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(6)*Sq(4)+Cpq(8)*Sq(4)+Cpq(7)*Sq(5)
        W(19)=Cpq(9)*Sq(5)+Cpq(10)*Sq(7)+Cpq(11)*Sq(8)+Cpq(13)*Sq(8)
        W(20)=Cpq(14)*Sq(9)+Cpq(12)*(Sq(7)+Sq(9))
        W(21)=Cpq(15)*Sq(11)+Cpq(16)*Sq(12)
        W(22)=Cpq(19)*Sq(13)+Cpq(17)*(Sq(11)+Sq(13))
        W(23)=Cpq(20)*Sq(14)+Cpq(18)*(Sq(12)+Sq(14))
        W(24)=Cpq(21)*Sq(16)+Cpq(22)*Sq(17)+Cpq(23)*(Sq(16)+Sq(18))
        W(25)=Cpq(26)*Sq(19)+Cpq(24)*(Sq(17)+Sq(19))
        W(26)=Cpq(27)*Sq(20)+Cpq(25)*(Sq(18)+Sq(20))
        W(27)=Cpq(28)*Sq(22)+Cpq(29)*Sq(23)
        W(28)=Cpq(30)*(Sq(22)+Sq(24))+Cpq(31)*(Sq(23)+Sq(25))
        W(29)=Cpq(34)*Sq(26)+Cpq(32)*(Sq(24)+Sq(26))
        W(30)=Cpq(35)*Sq(27)+Cpq(33)*(Sq(25)+Sq(27))
        W(31)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)
        W(32)=W(24)+W(25)+W(26)+W(27)+W(28)+W(29)+W(30)
        STwo=W(16)+W(17)+W(31)+W(32)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX306_0_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(3)*Cq(0)+Cpq(6)*Cq(1)+Cpq(10)*Cq(3)
        W(2)=Cpq(15)*Cq(6)+Cpq(21)*Cq(10)+Cpq(28)*Cq(15)+Cpq(36)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(7)*Cq(2)+Cpq(11)*Cq(4)
        W(2)=Cpq(12)*Cq(5)+Cpq(16)*Cq(7)+Cpq(17)*Cq(8)
        W(3)=Cpq(18)*Cq(9)+Cpq(22)*Cq(11)
        W(4)=Cpq(23)*Cq(12)+Cpq(24)*Cq(13)+Cpq(25)*Cq(14)
        W(5)=Cpq(29)*Cq(16)+Cpq(30)*Cq(17)
        W(6)=Cpq(31)*Cq(18)+Cpq(32)*Cq(19)+Cpq(33)*Cq(20)
        W(7)=Cpq(37)*Cq(22)+Cpq(38)*Cq(23)+Cpq(39)*Cq(24)
        W(8)=Cpq(40)*Cq(25)+Cpq(41)*Cq(26)+Cpq(42)*Cq(27)
        W(9)=Spq(7)*Sq(2)+Spq(11)*Sq(4)
        W(10)=Spq(12)*Sq(5)+Spq(16)*Sq(7)+Spq(17)*Sq(8)
        W(11)=Spq(18)*Sq(9)+Spq(22)*Sq(11)
        W(12)=Spq(23)*Sq(12)+Spq(24)*Sq(13)+Spq(25)*Sq(14)
        W(13)=Spq(29)*Sq(16)+Spq(30)*Sq(17)
        W(14)=Spq(31)*Sq(18)+Spq(32)*Sq(19)+Spq(33)*Sq(20)
        W(15)=Spq(37)*Sq(22)+Spq(38)*Sq(23)+Spq(39)*Sq(24)
        W(16)=Spq(40)*Sq(25)+Spq(41)*Sq(26)+Spq(42)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_1_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(4)*Cq(0)+Cpq(7)*Cq(1)-Cpq(6)*Cq(2)
        W(2)=Cpq(8)*Cq(2)-Cpq(10)*Cq(4)
        W(3)=Cpq(12)*Cq(4)+Cpq(11)*(Cq(3)-Cq(5))
        W(4)=Cpq(13)*Cq(5)-Cpq(15)*Cq(7)
        W(5)=Cpq(16)*(Cq(6)-Cq(8))+Cpq(18)*Cq(8)
        W(6)=Cpq(17)*(Cq(7)-Cq(9))+Cpq(19)*Cq(9)
        W(7)=-(Cpq(21)*Cq(11))+Cpq(22)*(Cq(10)-Cq(12))
        W(8)=Cpq(23)*(Cq(11)-Cq(13))
        W(9)=Cpq(25)*Cq(13)+Cpq(24)*(Cq(12)-Cq(14))
        W(10)=Cpq(26)*Cq(14)-Cpq(28)*Cq(16)
        W(11)=Cpq(29)*(Cq(15)-Cq(17))+Cpq(30)*(Cq(16)-Cq(18))
        W(12)=Cpq(31)*(Cq(17)-Cq(19))+Cpq(33)*Cq(19)
        W(13)=Cpq(32)*(Cq(18)-Cq(20))+Cpq(34)*Cq(20)
        W(14)=-(Cpq(36)*Cq(22))+Cpq(37)*(Cq(21)-Cq(23))
        W(15)=Cpq(38)*(Cq(22)-Cq(24))+Cpq(39)*(Cq(23)-Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(40)*(Cq(24)-Cq(26))
        W(19)=Cpq(42)*Cq(26)+Cpq(41)*(Cq(25)-Cq(27))
        W(20)=Cpq(43)*Cq(27)+Spq(8)*Sq(2)
        W(21)=Spq(12)*Sq(4)-Spq(11)*Sq(5)
        W(22)=Spq(13)*Sq(5)-Spq(16)*Sq(8)
        W(23)=Spq(18)*Sq(8)+Spq(17)*(Sq(7)-Sq(9))
        W(24)=Spq(19)*Sq(9)-Spq(22)*Sq(12)
        W(25)=Spq(23)*(Sq(11)-Sq(13))+Spq(25)*Sq(13)
        W(26)=Spq(24)*(Sq(12)-Sq(14))
        W(27)=Spq(26)*Sq(14)-Spq(29)*Sq(17)
        W(28)=Spq(30)*(Sq(16)-Sq(18))+Spq(31)*(Sq(17)-Sq(19))
        W(29)=Spq(33)*Sq(19)+Spq(32)*(Sq(18)-Sq(20))
        W(30)=Spq(34)*Sq(20)-Spq(37)*Sq(23)
        W(31)=Spq(38)*(Sq(22)-Sq(24))+Spq(39)*(Sq(23)-Sq(25))
        W(32)=Spq(40)*(Sq(24)-Sq(26))+Spq(42)*Sq(26)
        W(33)=Spq(41)*(Sq(25)-Sq(27))+Spq(43)*Sq(27)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_1_2_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(4)+Cq(1)*Spq(7)+Cq(2)*Spq(8)
        W(2)=(Cq(3)+Cq(5))*Spq(11)+Cq(4)*Spq(12)
        W(3)=Cq(5)*Spq(13)+(Cq(6)+Cq(8))*Spq(16)
        W(4)=(Cq(7)+Cq(9))*Spq(17)+Cq(8)*Spq(18)
        W(5)=Cq(9)*Spq(19)+(Cq(10)+Cq(12))*Spq(22)
        W(6)=(Cq(11)+Cq(13))*Spq(23)+(Cq(12)+Cq(14))*Spq(24)
        W(7)=Cq(13)*Spq(25)+Cq(14)*Spq(26)
        W(8)=(Cq(15)+Cq(17))*Spq(29)
        W(9)=(Cq(16)+Cq(18))*Spq(30)+(Cq(17)+Cq(19))*Spq(31)
        W(10)=(Cq(18)+Cq(20))*Spq(32)+Cq(19)*Spq(33)
        W(11)=Cq(20)*Spq(34)+(Cq(21)+Cq(23))*Spq(37)
        W(12)=(Cq(22)+Cq(24))*Spq(38)+(Cq(23)+Cq(25))*Spq(39)
        W(13)=(Cq(24)+Cq(26))*Spq(40)+(Cq(25)+Cq(27))*Spq(41)
        W(14)=Cq(26)*Spq(42)+Cq(27)*Spq(43)
        W(15)=-(Cpq(6)*Sq(2))-Cpq(8)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(10)*Sq(4))-Cpq(12)*Sq(4)-Cpq(11)*Sq(5)
        W(19)=-(Cpq(13)*Sq(5))-Cpq(15)*Sq(7)
        W(20)=-(Cpq(16)*Sq(8))-Cpq(18)*Sq(8)
        W(21)=-(Cpq(19)*Sq(9))-Cpq(17)*(Sq(7)+Sq(9))
        W(22)=-(Cpq(21)*Sq(11))-Cpq(22)*Sq(12)
        W(23)=-(Cpq(25)*Sq(13))-Cpq(23)*(Sq(11)+Sq(13))
        W(24)=-(Cpq(26)*Sq(14))-Cpq(24)*(Sq(12)+Sq(14))
        W(25)=-(Cpq(28)*Sq(16))-Cpq(29)*Sq(17)-Cpq(30)*(Sq(16)+Sq(18))
        W(26)=-(Cpq(33)*Sq(19))-Cpq(31)*(Sq(17)+Sq(19))
        W(27)=-(Cpq(34)*Sq(20))-Cpq(32)*(Sq(18)+Sq(20))
        W(28)=-(Cpq(36)*Sq(22))-Cpq(37)*Sq(23)
        W(29)=-(Cpq(38)*(Sq(22)+Sq(24)))-Cpq(39)*(Sq(23)+Sq(25))
        W(30)=-(Cpq(42)*Sq(26))-Cpq(40)*(Sq(24)+Sq(26))
        W(31)=-(Cpq(43)*Sq(27))-Cpq(41)*(Sq(25)+Sq(27))
        W(32)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(33)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)
        STwo=W(16)+W(17)+W(32)+W(33)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX306_2_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(5)*Cq(0)+Cpq(8)*Cq(1)
        W(2)=-(Cpq(7)*Cq(2))+Cpq(9)*Cq(2)
        W(3)=Cpq(12)*Cq(3)-Cpq(11)*Cq(4)
        W(4)=Cpq(13)*Cq(4)+Cpq(10)*Cq(5)
        W(5)=Cpq(14)*Cq(5)+Cpq(17)*Cq(6)+Cpq(18)*Cq(7)+Cpq(15)*Cq(8)
        W(6)=Cpq(19)*Cq(8)+Cpq(20)*Cq(9)
        W(7)=Cpq(16)*(-Cq(7)+Cq(9))+Cpq(24)*Cq(11)+Cpq(21)*Cq(12)
        W(8)=Cpq(25)*Cq(12)+Cpq(26)*Cq(13)
        W(9)=Cpq(22)*(-Cq(11)+Cq(13))+Cpq(27)*Cq(14)
        W(10)=Cpq(23)*(Cq(10)+Cq(14))+Cpq(28)*Cq(17)
        W(11)=Cpq(32)*Cq(17)+Cpq(33)*Cq(18)
        W(12)=Cpq(29)*(-Cq(16)+Cq(18))+Cpq(34)*Cq(19)
        W(13)=Cpq(30)*(Cq(15)+Cq(19))+Cpq(35)*Cq(20)
        W(14)=Cpq(31)*(Cq(16)+Cq(20))+Cpq(36)*Cq(23)
        W(15)=Cpq(41)*Cq(24)+Cpq(37)*(-Cq(22)+Cq(24))+Cpq(42)*Cq(25)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(38)*(Cq(21)+Cq(25))+Cpq(43)*Cq(26)
        W(19)=Cpq(39)*(Cq(22)+Cq(26))+Cpq(44)*Cq(27)
        W(20)=Cpq(40)*(Cq(23)+Cq(27))+Spq(7)*Sq(2)
        W(21)=Spq(9)*Sq(2)+Spq(11)*Sq(4)
        W(22)=Spq(13)*Sq(4)+Spq(14)*Sq(5)+Spq(18)*Sq(7)+Spq(19)*Sq(8)
        W(23)=Spq(20)*Sq(9)+Spq(16)*(Sq(7)+Sq(9))
        W(24)=Spq(24)*Sq(11)+Spq(25)*Sq(12)+Spq(26)*Sq(13)
        W(25)=Spq(22)*(Sq(11)+Sq(13))+Spq(23)*Sq(14)
        W(26)=Spq(27)*Sq(14)+Spq(32)*Sq(17)
        W(27)=Spq(33)*Sq(18)+Spq(29)*(Sq(16)+Sq(18))
        W(28)=Spq(30)*Sq(19)+Spq(34)*Sq(19)+Spq(35)*Sq(20)
        W(29)=Spq(31)*(Sq(16)+Sq(20))+Spq(41)*Sq(24)
        W(30)=Spq(37)*(Sq(22)+Sq(24))+Spq(38)*Sq(25)
        W(31)=Spq(42)*Sq(25)+Spq(43)*Sq(26)
        W(32)=Spq(39)*(Sq(22)+Sq(26))
        W(33)=Spq(44)*Sq(27)+Spq(40)*(Sq(23)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_2_2_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(5)-Cq(2)*Spq(7)
        W(2)=Cq(1)*Spq(8)+Cq(2)*Spq(9)
        W(3)=-(Cq(4)*Spq(11))+Cq(3)*Spq(12)
        W(4)=Cq(4)*Spq(13)+Cq(5)*Spq(14)
        W(5)=-((Cq(7)+Cq(9))*Spq(16))+Cq(6)*Spq(17)
        W(6)=Cq(7)*Spq(18)+Cq(8)*Spq(19)
        W(7)=Cq(9)*Spq(20)-(Cq(11)+Cq(13))*Spq(22)
        W(8)=(Cq(10)-Cq(14))*Spq(23)+Cq(11)*Spq(24)+Cq(12)*Spq(25)
        W(9)=Cq(13)*Spq(26)+Cq(14)*Spq(27)
        W(10)=-((Cq(16)+Cq(18))*Spq(29))+(Cq(15)-Cq(19))*Spq(30)
        W(11)=(Cq(16)-Cq(20))*Spq(31)+Cq(17)*Spq(32)
        W(12)=Cq(18)*Spq(33)+Cq(19)*Spq(34)
        W(13)=Cq(20)*Spq(35)-(Cq(22)+Cq(24))*Spq(37)
        W(14)=(Cq(21)-Cq(25))*Spq(38)+(Cq(22)-Cq(26))*Spq(39)
        W(15)=(Cq(23)-Cq(27))*Spq(40)+Cq(24)*Spq(41)
        W(16)=Cq(25)*Spq(42)+Cq(26)*Spq(43)+Cq(27)*Spq(44)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=-(Cpq(7)*Sq(2))-Cpq(9)*Sq(2)
        W(20)=-(Cpq(11)*Sq(4))-Cpq(13)*Sq(4)
        W(21)=Cpq(10)*Sq(5)-Cpq(14)*Sq(5)
        W(22)=-(Cpq(18)*Sq(7))+Cpq(15)*Sq(8)
        W(23)=-(Cpq(19)*Sq(8))-Cpq(20)*Sq(9)
        W(24)=Cpq(16)*(-Sq(7)+Sq(9))-Cpq(24)*Sq(11)
        W(25)=Cpq(21)*Sq(12)-Cpq(25)*Sq(12)
        W(26)=-(Cpq(26)*Sq(13))
        W(27)=Cpq(22)*(-Sq(11)+Sq(13))+Cpq(23)*Sq(14)
        W(28)=-(Cpq(27)*Sq(14))+Cpq(28)*Sq(17)
        W(29)=-(Cpq(32)*Sq(17))-Cpq(33)*Sq(18)
        W(30)=Cpq(29)*(-Sq(16)+Sq(18))+Cpq(30)*Sq(19)
        W(31)=-(Cpq(34)*Sq(19))
        W(32)=-(Cpq(35)*Sq(20))+Cpq(31)*(-Sq(16)+Sq(20))
        W(33)=Cpq(36)*Sq(23)-Cpq(41)*Sq(24)
        W(34)=Cpq(37)*(-Sq(22)+Sq(24))+Cpq(38)*Sq(25)
        W(35)=-(Cpq(42)*Sq(25))-Cpq(43)*Sq(26)
        W(36)=Cpq(39)*(-Sq(22)+Sq(26))
        W(37)=-(Cpq(44)*Sq(27))+Cpq(40)*(-Sq(23)+Sq(27))
        W(38)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(39)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)+W(37)
        STwo=W(17)+W(18)+W(38)+W(39)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX306_0_3_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(6)*Cq(0))-Cpq(10)*Cq(1)-Cpq(15)*Cq(3)
        W(2)=-(Cpq(21)*Cq(6))-Cpq(28)*Cq(10)
        W(3)=-(Cpq(36)*Cq(15))-Cpq(45)*Cq(21)
        COne=W(1)+W(2)+W(3)
        W(1)=-(Cpq(11)*Cq(2))-Cpq(16)*Cq(4)
        W(2)=-(Cpq(17)*Cq(5))-Cpq(22)*Cq(7)-Cpq(23)*Cq(8)
        W(3)=-(Cpq(24)*Cq(9))-Cpq(29)*Cq(11)
        W(4)=-(Cpq(30)*Cq(12))-Cpq(31)*Cq(13)-Cpq(32)*Cq(14)
        W(5)=-(Cpq(37)*Cq(16))-Cpq(38)*Cq(17)
        W(6)=-(Cpq(39)*Cq(18))-Cpq(40)*Cq(19)-Cpq(41)*Cq(20)
        W(7)=-(Cpq(46)*Cq(22))-Cpq(47)*Cq(23)-Cpq(48)*Cq(24)
        W(8)=-(Cpq(49)*Cq(25))-Cpq(50)*Cq(26)-Cpq(51)*Cq(27)
        W(9)=-(Spq(11)*Sq(2))-Spq(16)*Sq(4)
        W(10)=-(Spq(17)*Sq(5))-Spq(22)*Sq(7)-Spq(23)*Sq(8)
        W(11)=-(Spq(24)*Sq(9))-Spq(29)*Sq(11)
        W(12)=-(Spq(30)*Sq(12))-Spq(31)*Sq(13)-Spq(32)*Sq(14)
        W(13)=-(Spq(37)*Sq(16))-Spq(38)*Sq(17)
        W(14)=-(Spq(39)*Sq(18))-Spq(40)*Sq(19)-Spq(41)*Sq(20)
        W(15)=-(Spq(46)*Sq(22))-Spq(47)*Sq(23)-Spq(48)*Sq(24)
        W(16)=-(Spq(49)*Sq(25))-Spq(50)*Sq(26)-Spq(51)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_1_3_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(7)*Cq(0))-Cpq(11)*Cq(1)+Cpq(10)*Cq(2)
        W(2)=-(Cpq(12)*Cq(2))+Cpq(15)*Cq(4)
        W(3)=-(Cpq(17)*Cq(4))-Cpq(18)*Cq(5)
        W(4)=Cpq(16)*(-Cq(3)+Cq(5))+Cpq(21)*Cq(7)
        W(5)=-(Cpq(24)*Cq(8))+Cpq(22)*(-Cq(6)+Cq(8))
        W(6)=-(Cpq(25)*Cq(9))+Cpq(23)*(-Cq(7)+Cq(9))
        W(7)=Cpq(28)*Cq(11)+Cpq(29)*(-Cq(10)+Cq(12))
        W(8)=-(Cpq(32)*Cq(13))
        W(9)=Cpq(30)*(-Cq(11)+Cq(13))-Cpq(33)*Cq(14)
        W(10)=Cpq(31)*(-Cq(12)+Cq(14))+Cpq(36)*Cq(16)
        W(11)=Cpq(37)*(-Cq(15)+Cq(17))+Cpq(38)*(-Cq(16)+Cq(18))
        W(12)=-(Cpq(41)*Cq(19))+Cpq(39)*(-Cq(17)+Cq(19))
        W(13)=-(Cpq(42)*Cq(20))+Cpq(40)*(-Cq(18)+Cq(20))
        W(14)=Cpq(45)*Cq(22)+Cpq(46)*(-Cq(21)+Cq(23))
        W(15)=Cpq(47)*(-Cq(22)+Cq(24))+Cpq(48)*(-Cq(23)+Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(51)*Cq(26))
        W(19)=Cpq(49)*(-Cq(24)+Cq(26))-Cpq(52)*Cq(27)
        W(20)=Cpq(50)*(-Cq(25)+Cq(27))-Spq(12)*Sq(2)
        W(21)=-(Spq(17)*Sq(4))+Spq(16)*Sq(5)
        W(22)=-(Spq(18)*Sq(5))+Spq(22)*Sq(8)
        W(23)=-(Spq(24)*Sq(8))-Spq(25)*Sq(9)
        W(24)=Spq(23)*(-Sq(7)+Sq(9))+Spq(29)*Sq(12)
        W(25)=-(Spq(32)*Sq(13))+Spq(30)*(-Sq(11)+Sq(13))
        W(26)=-(Spq(33)*Sq(14))
        W(27)=Spq(31)*(-Sq(12)+Sq(14))+Spq(37)*Sq(17)
        W(28)=Spq(38)*(-Sq(16)+Sq(18))-Spq(41)*Sq(19)
        W(29)=Spq(39)*(-Sq(17)+Sq(19))-Spq(42)*Sq(20)
        W(30)=Spq(40)*(-Sq(18)+Sq(20))+Spq(46)*Sq(23)
        W(31)=Spq(47)*(-Sq(22)+Sq(24))+Spq(48)*(-Sq(23)+Sq(25))
        W(32)=-(Spq(51)*Sq(26))+Spq(49)*(-Sq(24)+Sq(26))
        W(33)=-(Spq(52)*Sq(27))+Spq(50)*(-Sq(25)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_1_3_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(7))-Cq(1)*Spq(11)-Cq(2)*Spq(12)
        W(2)=-((Cq(3)+Cq(5))*Spq(16))-Cq(4)*Spq(17)
        W(3)=-(Cq(5)*Spq(18))-(Cq(6)+Cq(8))*Spq(22)
        W(4)=-((Cq(7)+Cq(9))*Spq(23))-Cq(8)*Spq(24)
        W(5)=-(Cq(9)*Spq(25))-(Cq(10)+Cq(12))*Spq(29)
        W(6)=-((Cq(11)+Cq(13))*Spq(30))-(Cq(12)+Cq(14))*Spq(31)
        W(7)=-(Cq(13)*Spq(32))-Cq(14)*Spq(33)
        W(8)=-((Cq(15)+Cq(17))*Spq(37))
        W(9)=-((Cq(16)+Cq(18))*Spq(38))-(Cq(17)+Cq(19))*Spq(39)
        W(10)=-((Cq(18)+Cq(20))*Spq(40))-Cq(19)*Spq(41)
        W(11)=-(Cq(20)*Spq(42))-(Cq(21)+Cq(23))*Spq(46)
        W(12)=-((Cq(22)+Cq(24))*Spq(47))-(Cq(23)+Cq(25))*Spq(48)
        W(13)=-((Cq(24)+Cq(26))*Spq(49))-(Cq(25)+Cq(27))*Spq(50)
        W(14)=-(Cq(26)*Spq(51))-Cq(27)*Spq(52)
        W(15)=Cpq(10)*Sq(2)+Cpq(12)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(15)*Sq(4)+Cpq(17)*Sq(4)+Cpq(16)*Sq(5)
        W(19)=Cpq(18)*Sq(5)+Cpq(21)*Sq(7)+Cpq(22)*Sq(8)+Cpq(24)*Sq(8)
        W(20)=Cpq(25)*Sq(9)+Cpq(23)*(Sq(7)+Sq(9))
        W(21)=Cpq(28)*Sq(11)+Cpq(29)*Sq(12)
        W(22)=Cpq(32)*Sq(13)+Cpq(30)*(Sq(11)+Sq(13))
        W(23)=Cpq(33)*Sq(14)+Cpq(31)*(Sq(12)+Sq(14))
        W(24)=Cpq(36)*Sq(16)+Cpq(37)*Sq(17)+Cpq(38)*(Sq(16)+Sq(18))
        W(25)=Cpq(41)*Sq(19)+Cpq(39)*(Sq(17)+Sq(19))
        W(26)=Cpq(42)*Sq(20)+Cpq(40)*(Sq(18)+Sq(20))
        W(27)=Cpq(45)*Sq(22)+Cpq(46)*Sq(23)
        W(28)=Cpq(47)*(Sq(22)+Sq(24))+Cpq(48)*(Sq(23)+Sq(25))
        W(29)=Cpq(51)*Sq(26)+Cpq(49)*(Sq(24)+Sq(26))
        W(30)=Cpq(52)*Sq(27)+Cpq(50)*(Sq(25)+Sq(27))
        W(31)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)
        W(32)=W(24)+W(25)+W(26)+W(27)+W(28)+W(29)+W(30)
        STwo=W(16)+W(17)+W(31)+W(32)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX306_2_3_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(8)*Cq(0))-Cpq(12)*Cq(1)
        W(2)=Cpq(11)*Cq(2)-Cpq(13)*Cq(2)-Cpq(17)*Cq(3)
        W(3)=Cpq(16)*Cq(4)-Cpq(18)*Cq(4)
        W(4)=-(Cpq(15)*Cq(5))-Cpq(19)*Cq(5)-Cpq(23)*Cq(6)
        W(5)=Cpq(22)*Cq(7)-Cpq(24)*Cq(7)
        W(6)=-(Cpq(21)*Cq(8))-Cpq(25)*Cq(8)-Cpq(22)*Cq(9)
        W(7)=-(Cpq(26)*Cq(9))-Cpq(30)*Cq(10)+Cpq(29)*Cq(11)
        W(8)=-(Cpq(31)*Cq(11))-Cpq(28)*Cq(12)-Cpq(32)*Cq(12)
        W(9)=-(Cpq(29)*Cq(13))-Cpq(33)*Cq(13)
        W(10)=-(Cpq(30)*Cq(14))-Cpq(34)*Cq(14)-Cpq(38)*Cq(15)
        W(11)=Cpq(37)*Cq(16)-Cpq(39)*Cq(16)-Cpq(36)*Cq(17)
        W(12)=-(Cpq(40)*Cq(17))-Cpq(37)*Cq(18)-Cpq(41)*Cq(18)
        W(13)=-(Cpq(38)*Cq(19))-Cpq(42)*Cq(19)
        W(14)=-(Cpq(39)*Cq(20))-Cpq(43)*Cq(20)-Cpq(47)*Cq(21)
        W(15)=Cpq(46)*Cq(22)-Cpq(48)*Cq(22)-Cpq(45)*Cq(23)
        W(16)=-(Cpq(49)*Cq(23))-Cpq(46)*Cq(24)-Cpq(50)*Cq(24)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=-(Cpq(47)*Cq(25))-Cpq(51)*Cq(25)
        W(20)=-(Cpq(48)*Cq(26))-Cpq(52)*Cq(26)-Cpq(49)*Cq(27)
        W(21)=-(Cpq(53)*Cq(27))-Spq(11)*Sq(2)
        W(22)=-(Spq(13)*Sq(2))-Spq(16)*Sq(4)-Spq(18)*Sq(4)
        W(23)=-(Spq(19)*Sq(5))-Spq(22)*Sq(7)
        W(24)=-(Spq(24)*Sq(7))-Spq(25)*Sq(8)-Spq(22)*Sq(9)
        W(25)=-(Spq(26)*Sq(9))-Spq(29)*Sq(11)-Spq(31)*Sq(11)
        W(26)=-(Spq(32)*Sq(12))-Spq(29)*Sq(13)-Spq(33)*Sq(13)
        W(27)=-(Spq(30)*Sq(14))-Spq(34)*Sq(14)
        W(28)=-(Spq(37)*Sq(16))-Spq(39)*Sq(16)-Spq(40)*Sq(17)
        W(29)=-(Spq(37)*Sq(18))-Spq(41)*Sq(18)-Spq(38)*Sq(19)
        W(30)=-(Spq(42)*Sq(19))-Spq(39)*Sq(20)-Spq(43)*Sq(20)
        W(31)=-(Spq(46)*Sq(22))-Spq(48)*Sq(22)
        W(32)=-(Spq(49)*Sq(23))-Spq(46)*Sq(24)-Spq(50)*Sq(24)
        W(33)=-(Spq(47)*Sq(25))-Spq(51)*Sq(25)-Spq(48)*Sq(26)
        W(34)=-(Spq(52)*Sq(26))-Spq(49)*Sq(27)-Spq(53)*Sq(27)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        CTwo=W(17)+W(18)+W(35)+W(36)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_2_3_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(8))+Cq(2)*Spq(11)
        W(2)=-(Cq(1)*Spq(12))-Cq(2)*Spq(13)
        W(3)=Cq(4)*Spq(16)-Cq(3)*Spq(17)
        W(4)=-(Cq(4)*Spq(18))-Cq(5)*Spq(19)
        W(5)=(Cq(7)+Cq(9))*Spq(22)-Cq(6)*Spq(23)
        W(6)=-(Cq(7)*Spq(24))-Cq(8)*Spq(25)
        W(7)=-(Cq(9)*Spq(26))+(Cq(11)+Cq(13))*Spq(29)
        W(8)=(-Cq(10)+Cq(14))*Spq(30)
        W(9)=-(Cq(11)*Spq(31))-Cq(12)*Spq(32)
        W(10)=-(Cq(13)*Spq(33))-Cq(14)*Spq(34)
        W(11)=(Cq(16)+Cq(18))*Spq(37)+(-Cq(15)+Cq(19))*Spq(38)
        W(12)=(-Cq(16)+Cq(20))*Spq(39)-Cq(17)*Spq(40)
        W(13)=-(Cq(18)*Spq(41))-Cq(19)*Spq(42)
        W(14)=-(Cq(20)*Spq(43))+(Cq(22)+Cq(24))*Spq(46)
        W(15)=(-Cq(21)+Cq(25))*Spq(47)+(-Cq(22)+Cq(26))*Spq(48)
        W(16)=(-Cq(23)+Cq(27))*Spq(49)-Cq(24)*Spq(50)
        W(17)=-(Cq(25)*Spq(51))-Cq(26)*Spq(52)-Cq(27)*Spq(53)
        W(18)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(19)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)+W(17)
        W(20)=Cpq(11)*Sq(2)+Cpq(13)*Sq(2)+Cpq(16)*Sq(4)+Cpq(18)*Sq(4)
        W(21)=-(Cpq(15)*Sq(5))+Cpq(19)*Sq(5)
        W(22)=Cpq(24)*Sq(7)-Cpq(21)*Sq(8)
        W(23)=Cpq(25)*Sq(8)+Cpq(22)*(Sq(7)-Sq(9))
        W(24)=Cpq(26)*Sq(9)+Cpq(31)*Sq(11)
        W(25)=-(Cpq(28)*Sq(12))+Cpq(32)*Sq(12)
        W(26)=Cpq(29)*(Sq(11)-Sq(13))
        W(27)=Cpq(33)*Sq(13)-Cpq(30)*Sq(14)
        W(28)=Cpq(34)*Sq(14)-Cpq(36)*Sq(17)
        W(29)=Cpq(40)*Sq(17)+Cpq(37)*(Sq(16)-Sq(18))
        W(30)=Cpq(41)*Sq(18)-Cpq(38)*Sq(19)
        W(31)=Cpq(42)*Sq(19)+Cpq(39)*(Sq(16)-Sq(20))+Cpq(43)*Sq(20)
        W(32)=-(Cpq(45)*Sq(23))+Cpq(46)*(Sq(22)-Sq(24))
        W(33)=Cpq(50)*Sq(24)-Cpq(47)*Sq(25)
        W(34)=Cpq(51)*Sq(25)+Cpq(48)*(Sq(22)-Sq(26))
        W(35)=Cpq(52)*Sq(26)+Cpq(49)*(Sq(23)-Sq(27))+Cpq(53)*Sq(27)
        W(36)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(37)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)
        STwo=W(18)+W(19)+W(36)+W(37)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX306_3_3_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(9)*Cq(0))-Cpq(13)*Cq(1)
        W(2)=Cpq(12)*Cq(2)-Cpq(14)*Cq(2)-Cpq(18)*Cq(3)
        W(3)=Cpq(17)*Cq(4)-Cpq(19)*Cq(4)
        W(4)=-(Cpq(16)*Cq(5))-Cpq(20)*Cq(5)-Cpq(24)*Cq(6)
        W(5)=Cpq(23)*Cq(7)-Cpq(25)*Cq(7)
        W(6)=-(Cpq(22)*Cq(8))-Cpq(26)*Cq(8)+Cpq(21)*Cq(9)
        W(7)=-(Cpq(27)*Cq(9))-Cpq(31)*Cq(10)+Cpq(30)*Cq(11)
        W(8)=-(Cpq(32)*Cq(11))-Cpq(29)*Cq(12)-Cpq(33)*Cq(12)
        W(9)=Cpq(28)*Cq(13)-Cpq(34)*Cq(13)
        W(10)=Cpq(29)*Cq(14)-Cpq(35)*Cq(14)-Cpq(39)*Cq(15)
        W(11)=Cpq(38)*Cq(16)-Cpq(40)*Cq(16)-Cpq(37)*Cq(17)
        W(12)=-(Cpq(41)*Cq(17))+Cpq(36)*Cq(18)-Cpq(42)*Cq(18)
        W(13)=Cpq(37)*Cq(19)-Cpq(43)*Cq(19)
        W(14)=Cpq(38)*Cq(20)-Cpq(44)*Cq(20)-Cpq(48)*Cq(21)
        W(15)=Cpq(47)*Cq(22)-Cpq(49)*Cq(22)-Cpq(46)*Cq(23)
        W(16)=-(Cpq(50)*Cq(23))+Cpq(45)*Cq(24)-Cpq(51)*Cq(24)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=Cpq(46)*Cq(25)-Cpq(52)*Cq(25)
        W(20)=Cpq(47)*Cq(26)-Cpq(53)*Cq(26)+Cpq(48)*Cq(27)
        W(21)=-(Cpq(54)*Cq(27))-Spq(12)*Sq(2)-Spq(14)*Sq(2)
        W(22)=-(Spq(17)*Sq(4))-Spq(19)*Sq(4)+Spq(16)*Sq(5)
        W(23)=-(Spq(20)*Sq(5))-Spq(23)*Sq(7)
        W(24)=-(Spq(25)*Sq(7))+Spq(22)*Sq(8)-Spq(26)*Sq(8)
        W(25)=-(Spq(27)*Sq(9))-Spq(30)*Sq(11)-Spq(32)*Sq(11)
        W(26)=Spq(29)*Sq(12)-Spq(33)*Sq(12)-Spq(34)*Sq(13)
        W(27)=Spq(29)*Sq(14)-Spq(35)*Sq(14)
        W(28)=-(Spq(38)*Sq(16))-Spq(40)*Sq(16)+Spq(37)*Sq(17)
        W(29)=-(Spq(41)*Sq(17))-Spq(42)*Sq(18)+Spq(37)*Sq(19)
        W(30)=-(Spq(43)*Sq(19))+Spq(38)*Sq(20)-Spq(44)*Sq(20)
        W(31)=-(Spq(47)*Sq(22))-Spq(49)*Sq(22)
        W(32)=Spq(46)*Sq(23)-Spq(50)*Sq(23)-Spq(51)*Sq(24)
        W(33)=Spq(46)*Sq(25)-Spq(52)*Sq(25)+Spq(47)*Sq(26)
        W(34)=-(Spq(53)*Sq(26))+Spq(48)*Sq(27)-Spq(54)*Sq(27)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        CTwo=W(17)+W(18)+W(35)+W(36)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX306_3_3_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:54),Spq(0:54),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(9))+Cq(2)*Spq(12)
        W(2)=-(Cq(1)*Spq(13))-Cq(2)*Spq(14)
        W(3)=-(Cq(5)*Spq(16))+Cq(4)*Spq(17)
        W(4)=-(Cq(3)*Spq(18))-Cq(4)*Spq(19)-Cq(5)*Spq(20)
        W(5)=-(Cq(8)*Spq(22))+Cq(7)*Spq(23)
        W(6)=-(Cq(6)*Spq(24))-Cq(7)*Spq(25)-Cq(8)*Spq(26)
        W(7)=-(Cq(9)*Spq(27))-(Cq(12)+Cq(14))*Spq(29)
        W(8)=Cq(11)*Spq(30)-Cq(10)*Spq(31)-Cq(11)*Spq(32)
        W(9)=-(Cq(12)*Spq(33))-Cq(13)*Spq(34)
        W(10)=-(Cq(14)*Spq(35))-(Cq(17)+Cq(19))*Spq(37)
        W(11)=(Cq(16)-Cq(20))*Spq(38)-Cq(15)*Spq(39)
        W(12)=-(Cq(16)*Spq(40))-Cq(17)*Spq(41)-Cq(18)*Spq(42)
        W(13)=-(Cq(19)*Spq(43))-Cq(20)*Spq(44)
        W(14)=-((Cq(23)+Cq(25))*Spq(46))
        W(15)=(Cq(22)-Cq(26))*Spq(47)-(Cq(21)+Cq(27))*Spq(48)
        W(16)=-(Cq(22)*Spq(49))-Cq(23)*Spq(50)
        W(17)=-(Cq(24)*Spq(51))-Cq(25)*Spq(52)-Cq(26)*Spq(53)
        W(18)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(19)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)+W(17)
        W(20)=-(Cq(27)*Spq(54))+Cpq(12)*Sq(2)
        W(21)=Cpq(14)*Sq(2)+Cpq(17)*Sq(4)
        W(22)=Cpq(19)*Sq(4)-Cpq(16)*Sq(5)
        W(23)=Cpq(20)*Sq(5)+Cpq(23)*Sq(7)+Cpq(25)*Sq(7)
        W(24)=-(Cpq(22)*Sq(8))+Cpq(26)*Sq(8)
        W(25)=Cpq(21)*Sq(9)+Cpq(27)*Sq(9)+Cpq(30)*Sq(11)
        W(26)=Cpq(32)*Sq(11)+Cpq(33)*Sq(12)
        W(27)=Cpq(28)*Sq(13)+Cpq(34)*Sq(13)+Cpq(35)*Sq(14)
        W(28)=Cpq(29)*(-Sq(12)+Sq(14))+Cpq(40)*Sq(16)
        W(29)=Cpq(41)*Sq(17)+Cpq(36)*Sq(18)
        W(30)=Cpq(42)*Sq(18)+Cpq(43)*Sq(19)
        W(31)=Cpq(37)*(-Sq(17)+Sq(19))
        W(32)=Cpq(44)*Sq(20)+Cpq(38)*(Sq(16)+Sq(20))
        W(33)=Cpq(49)*Sq(22)+Cpq(50)*Sq(23)
        W(34)=Cpq(45)*Sq(24)+Cpq(51)*Sq(24)+Cpq(52)*Sq(25)
        W(35)=Cpq(46)*(-Sq(23)+Sq(25))+Cpq(53)*Sq(26)
        W(36)=Cpq(47)*(Sq(22)+Sq(26))+Cpq(48)*Sq(27)+Cpq(54)*Sq(27)
        W(37)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(38)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)
        STwo=W(18)+W(19)+W(37)+W(38)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE IrRegular306(PQx,PQy,PQz,Cpq,Spq)
         IMPLICIT NONE
         REAL*8 Cpq(0:54),Spq(0:54),LegendreP(0:54)
         REAL*8 Sine(0:9),Cosine(0:9),CoFact(2:9)
         REAL*8 PQx,PQy,PQz,PQ2,pqx2,pqy2,pqxy,PQ
         REAL*8 Zero,One,Two,TT,TwoC,OneOvPQ
         REAL*8 CoTan,OneOvPQxy,RS,SQ,PQToThMnsL
         PARAMETER (Two=2D0,One=1D0,Zero=0D0)
         PQx2=PQx*PQx
         PQy2=PQy*PQy
         PQ=DSQRT(PQx2+PQy2+PQz*PQz)
         OneOvPQ=One/PQ
         CoTan=PQz*OneOvPQ
!        Compute Cosine and Sine by recursion
         Sine(0)  =Zero
         Cosine(0)=One
         PQxy=DSQRT(PQx2+PQy2)
         IF(PQxy/=Zero)THEN
            OneOvPQxy=One/PQxy
            Sine(1)  =PQx*OneOvPQxy
            Cosine(1)=PQy*OneOvPQxy
         ELSE
            Sine(1)  =0.70710678118654752D0
            Cosine(1)=0.70710678118654752D0
         ENDIF
         TwoC=Two*Cosine(1)
         Sine(2)=TwoC*Sine(1)-Sine(0)
         Cosine(2)=TwoC*Cosine(1)-Cosine(0)
         Sine(3)=TwoC*Sine(2)-Sine(1)
         Cosine(3)=TwoC*Cosine(2)-Cosine(1)
         Sine(4)=TwoC*Sine(3)-Sine(2)
         Cosine(4)=TwoC*Cosine(3)-Cosine(2)
         Sine(5)=TwoC*Sine(4)-Sine(3)
         Cosine(5)=TwoC*Cosine(4)-Cosine(3)
         Sine(6)=TwoC*Sine(5)-Sine(4)
         Cosine(6)=TwoC*Cosine(5)-Cosine(4)
         Sine(7)=TwoC*Sine(6)-Sine(5)
         Cosine(7)=TwoC*Cosine(6)-Cosine(5)
         Sine(8)=TwoC*Sine(7)-Sine(6)
         Cosine(8)=TwoC*Cosine(7)-Cosine(6)
         Sine(9)=TwoC*Sine(8)-Sine(7)
         Cosine(9)=TwoC*Cosine(8)-Cosine(7)
!        ----------------------------------------------------------------
!        Associated Legendre Polynomials by recursion
!
!        M=0,Ell; Compute LegendreP(M,M)
         RS=One
         Sq=SQRT(ABS(One-CoTan**2))
         LegendreP(0)=+1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(2)=-1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(5)=+3.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(9)=-1.500000000000000D+01*RS
         RS=RS*Sq
         LegendreP(14)=+1.050000000000000D+02*RS
         RS=RS*Sq
         LegendreP(20)=-9.450000000000000D+02*RS
         RS=RS*Sq
         LegendreP(27)=+1.039500000000000D+04*RS
         RS=RS*Sq
         LegendreP(35)=-1.351350000000000D+05*RS
         RS=RS*Sq
         LegendreP(44)=+2.027025000000000D+06*RS
         RS=RS*Sq
         LegendreP(54)=-3.445942500000000D+07*RS
!        ----------------------------------------------------------------
!        M=0,Ell-1; Compute LegendreP(M+1,M)
         LegendreP(1)=+1.000000000000000D+00*CoTan*LegendreP(0)
         LegendreP(4)=+3.000000000000000D+00*CoTan*LegendreP(2)
         LegendreP(8)=+5.000000000000000D+00*CoTan*LegendreP(5)
         LegendreP(13)=+7.000000000000000D+00*CoTan*LegendreP(9)
         LegendreP(19)=+9.000000000000000D+00*CoTan*LegendreP(14)
         LegendreP(26)=+1.100000000000000D+01*CoTan*LegendreP(20)
         LegendreP(34)=+1.300000000000000D+01*CoTan*LegendreP(27)
         LegendreP(43)=+1.500000000000000D+01*CoTan*LegendreP(35)
         LegendreP(53)=+1.700000000000000D+01*CoTan*LegendreP(44)
!        ----------------------------------------------------------------
         CoFact(2)=+3.000000000000000D+00*CoTan
         CoFact(3)=+5.000000000000000D+00*CoTan
         CoFact(4)=+7.000000000000000D+00*CoTan
         CoFact(5)=+9.000000000000000D+00*CoTan
         CoFact(6)=+1.100000000000000D+01*CoTan
         CoFact(7)=+1.300000000000000D+01*CoTan
         CoFact(8)=+1.500000000000000D+01*CoTan
         CoFact(9)=+1.700000000000000D+01*CoTan
!        ----------------------------------------------------------------
!        M=0,Ell-2; L=M+2,Ell; Compute LegendreP(L,M)
         LegendreP(3)=CoFact(2)*LegendreP(1)-1.000000000000000D+00*LegendreP(0)
         LegendreP(6)=CoFact(3)*LegendreP(3)-4.000000000000000D+00*LegendreP(1)
         LegendreP(10)=CoFact(4)*LegendreP(6)-9.000000000000000D+00*LegendreP(3)
         LegendreP(15)=CoFact(5)*LegendreP(10)-1.600000000000000D+01*LegendreP(6)
         LegendreP(21)=CoFact(6)*LegendreP(15)-2.500000000000000D+01*LegendreP(10)
         LegendreP(28)=CoFact(7)*LegendreP(21)-3.600000000000000D+01*LegendreP(15)
         LegendreP(36)=CoFact(8)*LegendreP(28)-4.900000000000000D+01*LegendreP(21)
         LegendreP(45)=CoFact(9)*LegendreP(36)-6.400000000000000D+01*LegendreP(28)
         LegendreP(7)=CoFact(3)*LegendreP(4)-3.000000000000000D+00*LegendreP(2)
         LegendreP(11)=CoFact(4)*LegendreP(7)-8.000000000000000D+00*LegendreP(4)
         LegendreP(16)=CoFact(5)*LegendreP(11)-1.500000000000000D+01*LegendreP(7)
         LegendreP(22)=CoFact(6)*LegendreP(16)-2.400000000000000D+01*LegendreP(11)
         LegendreP(29)=CoFact(7)*LegendreP(22)-3.500000000000000D+01*LegendreP(16)
         LegendreP(37)=CoFact(8)*LegendreP(29)-4.800000000000000D+01*LegendreP(22)
         LegendreP(46)=CoFact(9)*LegendreP(37)-6.300000000000000D+01*LegendreP(29)
         LegendreP(12)=CoFact(4)*LegendreP(8)-5.000000000000000D+00*LegendreP(5)
         LegendreP(17)=CoFact(5)*LegendreP(12)-1.200000000000000D+01*LegendreP(8)
         LegendreP(23)=CoFact(6)*LegendreP(17)-2.100000000000000D+01*LegendreP(12)
         LegendreP(30)=CoFact(7)*LegendreP(23)-3.200000000000000D+01*LegendreP(17)
         LegendreP(38)=CoFact(8)*LegendreP(30)-4.500000000000000D+01*LegendreP(23)
         LegendreP(47)=CoFact(9)*LegendreP(38)-6.000000000000000D+01*LegendreP(30)
         LegendreP(18)=CoFact(5)*LegendreP(13)-7.000000000000000D+00*LegendreP(9)
         LegendreP(24)=CoFact(6)*LegendreP(18)-1.600000000000000D+01*LegendreP(13)
         LegendreP(31)=CoFact(7)*LegendreP(24)-2.700000000000000D+01*LegendreP(18)
         LegendreP(39)=CoFact(8)*LegendreP(31)-4.000000000000000D+01*LegendreP(24)
         LegendreP(48)=CoFact(9)*LegendreP(39)-5.500000000000000D+01*LegendreP(31)
         LegendreP(25)=CoFact(6)*LegendreP(19)-9.000000000000000D+00*LegendreP(14)
         LegendreP(32)=CoFact(7)*LegendreP(25)-2.000000000000000D+01*LegendreP(19)
         LegendreP(40)=CoFact(8)*LegendreP(32)-3.300000000000000D+01*LegendreP(25)
         LegendreP(49)=CoFact(9)*LegendreP(40)-4.800000000000000D+01*LegendreP(32)
         LegendreP(33)=CoFact(7)*LegendreP(26)-1.100000000000000D+01*LegendreP(20)
         LegendreP(41)=CoFact(8)*LegendreP(33)-2.400000000000000D+01*LegendreP(26)
         LegendreP(50)=CoFact(9)*LegendreP(41)-3.900000000000000D+01*LegendreP(33)
         LegendreP(42)=CoFact(8)*LegendreP(34)-1.300000000000000D+01*LegendreP(27)
         LegendreP(51)=CoFact(9)*LegendreP(42)-2.800000000000000D+01*LegendreP(34)
         LegendreP(52)=CoFact(9)*LegendreP(43)-1.500000000000000D+01*LegendreP(35)
!        ----------------------------------------------------------------
!        Compute Cpq(L,M) and Spq(L,M)
         PQToThMnsL=OneOvPQ
         TT=PQToThMnsL*LegendreP(0)
         Spq(0)=TT*Sine(0)
         Cpq(0)=TT*Cosine(0)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(1)
         Spq(1)=TT*Sine(0)
         Cpq(1)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(2)
         Spq(2)=TT*Sine(1)
         Cpq(2)=TT*Cosine(1)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(3)
         Spq(3)=TT*Sine(0)
         Cpq(3)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(4)
         Spq(4)=TT*Sine(1)
         Cpq(4)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(5)
         Spq(5)=TT*Sine(2)
         Cpq(5)=TT*Cosine(2)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(6)
         Spq(6)=TT*Sine(0)
         Cpq(6)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(7)
         Spq(7)=TT*Sine(1)
         Cpq(7)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(8)
         Spq(8)=TT*Sine(2)
         Cpq(8)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(9)
         Spq(9)=TT*Sine(3)
         Cpq(9)=TT*Cosine(3)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(10)
         Spq(10)=TT*Sine(0)
         Cpq(10)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(11)
         Spq(11)=TT*Sine(1)
         Cpq(11)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(12)
         Spq(12)=TT*Sine(2)
         Cpq(12)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(13)
         Spq(13)=TT*Sine(3)
         Cpq(13)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(14)
         Spq(14)=TT*Sine(4)
         Cpq(14)=TT*Cosine(4)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(15)
         Spq(15)=TT*Sine(0)
         Cpq(15)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(16)
         Spq(16)=TT*Sine(1)
         Cpq(16)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(17)
         Spq(17)=TT*Sine(2)
         Cpq(17)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(18)
         Spq(18)=TT*Sine(3)
         Cpq(18)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(19)
         Spq(19)=TT*Sine(4)
         Cpq(19)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(20)
         Spq(20)=TT*Sine(5)
         Cpq(20)=TT*Cosine(5)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(21)
         Spq(21)=TT*Sine(0)
         Cpq(21)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(22)
         Spq(22)=TT*Sine(1)
         Cpq(22)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(23)
         Spq(23)=TT*Sine(2)
         Cpq(23)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(24)
         Spq(24)=TT*Sine(3)
         Cpq(24)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(25)
         Spq(25)=TT*Sine(4)
         Cpq(25)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(26)
         Spq(26)=TT*Sine(5)
         Cpq(26)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(27)
         Spq(27)=TT*Sine(6)
         Cpq(27)=TT*Cosine(6)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(28)
         Spq(28)=TT*Sine(0)
         Cpq(28)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(29)
         Spq(29)=TT*Sine(1)
         Cpq(29)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(30)
         Spq(30)=TT*Sine(2)
         Cpq(30)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(31)
         Spq(31)=TT*Sine(3)
         Cpq(31)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(32)
         Spq(32)=TT*Sine(4)
         Cpq(32)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(33)
         Spq(33)=TT*Sine(5)
         Cpq(33)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(34)
         Spq(34)=TT*Sine(6)
         Cpq(34)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(35)
         Spq(35)=TT*Sine(7)
         Cpq(35)=TT*Cosine(7)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(36)
         Spq(36)=TT*Sine(0)
         Cpq(36)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(37)
         Spq(37)=TT*Sine(1)
         Cpq(37)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(38)
         Spq(38)=TT*Sine(2)
         Cpq(38)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(39)
         Spq(39)=TT*Sine(3)
         Cpq(39)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(40)
         Spq(40)=TT*Sine(4)
         Cpq(40)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(41)
         Spq(41)=TT*Sine(5)
         Cpq(41)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(42)
         Spq(42)=TT*Sine(6)
         Cpq(42)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(43)
         Spq(43)=TT*Sine(7)
         Cpq(43)=TT*Cosine(7)
         TT=PQToThMnsL*LegendreP(44)
         Spq(44)=TT*Sine(8)
         Cpq(44)=TT*Cosine(8)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(45)
         Spq(45)=TT*Sine(0)
         Cpq(45)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(46)
         Spq(46)=TT*Sine(1)
         Cpq(46)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(47)
         Spq(47)=TT*Sine(2)
         Cpq(47)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(48)
         Spq(48)=TT*Sine(3)
         Cpq(48)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(49)
         Spq(49)=TT*Sine(4)
         Cpq(49)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(50)
         Spq(50)=TT*Sine(5)
         Cpq(50)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(51)
         Spq(51)=TT*Sine(6)
         Cpq(51)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(52)
         Spq(52)=TT*Sine(7)
         Cpq(52)=TT*Cosine(7)
         TT=PQToThMnsL*LegendreP(53)
         Spq(53)=TT*Sine(8)
         Cpq(53)=TT*Cosine(8)
         TT=PQToThMnsL*LegendreP(54)
         Spq(54)=TT*Sine(9)
         Cpq(54)=TT*Cosine(9)
      RETURN
      END
      SUBROUTINE CTraX306(PQx,PQy,PQz,Cq,Sq,Cp,Sp)
         IMPLICIT NONE
         REAL*8 PQx,PQy,PQz
         REAL*8 Cq(0:27),Sq(0:27),Cp(0:9),Sp(0:9)
         REAL*8 Cpq(0:54),Spq(0:54)
         CALL IrRegular306(PQx,PQy,PQz,Cpq,Spq)
         CALL CTX306_0_0_C(Cp(0),Cpq,Spq,Cq,Sq)
         CALL CTX306_0_1_C(Cp(1),Cpq,Spq,Cq,Sq)
         CALL CTX306_1_1_C(Cp(2),Cpq,Spq,Cq,Sq)
         CALL CTX306_1_1_S(Sp(2),Cpq,Spq,Cq,Sq)
         CALL CTX306_0_2_C(Cp(3),Cpq,Spq,Cq,Sq)
         CALL CTX306_1_2_C(Cp(4),Cpq,Spq,Cq,Sq)
         CALL CTX306_1_2_S(Sp(4),Cpq,Spq,Cq,Sq)
         CALL CTX306_2_2_C(Cp(5),Cpq,Spq,Cq,Sq)
         CALL CTX306_2_2_S(Sp(5),Cpq,Spq,Cq,Sq)
         CALL CTX306_0_3_C(Cp(6),Cpq,Spq,Cq,Sq)
         CALL CTX306_1_3_C(Cp(7),Cpq,Spq,Cq,Sq)
         CALL CTX306_1_3_S(Sp(7),Cpq,Spq,Cq,Sq)
         CALL CTX306_2_3_C(Cp(8),Cpq,Spq,Cq,Sq)
         CALL CTX306_2_3_S(Sp(8),Cpq,Spq,Cq,Sq)
         CALL CTX306_3_3_C(Cp(9),Cpq,Spq,Cq,Sq)
         CALL CTX306_3_3_S(Sp(9),Cpq,Spq,Cq,Sq)
      RETURN
      END
      SUBROUTINE CTX406_0_0_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(0)*Cq(0)+Cpq(1)*Cq(1)+Cpq(3)*Cq(3)
        W(2)=Cpq(6)*Cq(6)+Cpq(10)*Cq(10)+Cpq(15)*Cq(15)+Cpq(21)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(2)*Cq(2)+Cpq(4)*Cq(4)
        W(2)=Cpq(5)*Cq(5)+Cpq(7)*Cq(7)+Cpq(8)*Cq(8)
        W(3)=Cpq(9)*Cq(9)+Cpq(11)*Cq(11)
        W(4)=Cpq(12)*Cq(12)+Cpq(13)*Cq(13)+Cpq(14)*Cq(14)
        W(5)=Cpq(16)*Cq(16)+Cpq(17)*Cq(17)
        W(6)=Cpq(18)*Cq(18)+Cpq(19)*Cq(19)+Cpq(20)*Cq(20)
        W(7)=Cpq(22)*Cq(22)+Cpq(23)*Cq(23)+Cpq(24)*Cq(24)
        W(8)=Cpq(25)*Cq(25)+Cpq(26)*Cq(26)+Cpq(27)*Cq(27)
        W(9)=Spq(2)*Sq(2)+Spq(4)*Sq(4)
        W(10)=Spq(5)*Sq(5)+Spq(7)*Sq(7)+Spq(8)*Sq(8)
        W(11)=Spq(9)*Sq(9)+Spq(11)*Sq(11)
        W(12)=Spq(12)*Sq(12)+Spq(13)*Sq(13)+Spq(14)*Sq(14)
        W(13)=Spq(16)*Sq(16)+Spq(17)*Sq(17)
        W(14)=Spq(18)*Sq(18)+Spq(19)*Sq(19)+Spq(20)*Sq(20)
        W(15)=Spq(22)*Sq(22)+Spq(23)*Sq(23)+Spq(24)*Sq(24)
        W(16)=Spq(25)*Sq(25)+Spq(26)*Sq(26)+Spq(27)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_0_1_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(1)*Cq(0))-Cpq(3)*Cq(1)-Cpq(6)*Cq(3)
        W(2)=-(Cpq(10)*Cq(6))-Cpq(15)*Cq(10)
        W(3)=-(Cpq(21)*Cq(15))-Cpq(28)*Cq(21)
        COne=W(1)+W(2)+W(3)
        W(1)=-(Cpq(4)*Cq(2))-Cpq(7)*Cq(4)
        W(2)=-(Cpq(8)*Cq(5))-Cpq(11)*Cq(7)-Cpq(12)*Cq(8)
        W(3)=-(Cpq(13)*Cq(9))-Cpq(16)*Cq(11)
        W(4)=-(Cpq(17)*Cq(12))-Cpq(18)*Cq(13)-Cpq(19)*Cq(14)
        W(5)=-(Cpq(22)*Cq(16))-Cpq(23)*Cq(17)
        W(6)=-(Cpq(24)*Cq(18))-Cpq(25)*Cq(19)-Cpq(26)*Cq(20)
        W(7)=-(Cpq(29)*Cq(22))-Cpq(30)*Cq(23)-Cpq(31)*Cq(24)
        W(8)=-(Cpq(32)*Cq(25))-Cpq(33)*Cq(26)-Cpq(34)*Cq(27)
        W(9)=-(Spq(4)*Sq(2))-Spq(7)*Sq(4)
        W(10)=-(Spq(8)*Sq(5))-Spq(11)*Sq(7)-Spq(12)*Sq(8)
        W(11)=-(Spq(13)*Sq(9))-Spq(16)*Sq(11)
        W(12)=-(Spq(17)*Sq(12))-Spq(18)*Sq(13)-Spq(19)*Sq(14)
        W(13)=-(Spq(22)*Sq(16))-Spq(23)*Sq(17)
        W(14)=-(Spq(24)*Sq(18))-Spq(25)*Sq(19)-Spq(26)*Sq(20)
        W(15)=-(Spq(29)*Sq(22))-Spq(30)*Sq(23)-Spq(31)*Sq(24)
        W(16)=-(Spq(32)*Sq(25))-Spq(33)*Sq(26)-Spq(34)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_1_1_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(2)*Cq(0))-Cpq(4)*Cq(1)+Cpq(3)*Cq(2)
        W(2)=-(Cpq(5)*Cq(2))+Cpq(6)*Cq(4)
        W(3)=-(Cpq(8)*Cq(4))-Cpq(9)*Cq(5)
        W(4)=Cpq(7)*(-Cq(3)+Cq(5))+Cpq(10)*Cq(7)
        W(5)=-(Cpq(13)*Cq(8))+Cpq(11)*(-Cq(6)+Cq(8))
        W(6)=-(Cpq(14)*Cq(9))+Cpq(12)*(-Cq(7)+Cq(9))
        W(7)=Cpq(15)*Cq(11)+Cpq(16)*(-Cq(10)+Cq(12))
        W(8)=-(Cpq(19)*Cq(13))
        W(9)=Cpq(17)*(-Cq(11)+Cq(13))-Cpq(20)*Cq(14)
        W(10)=Cpq(18)*(-Cq(12)+Cq(14))+Cpq(21)*Cq(16)
        W(11)=Cpq(22)*(-Cq(15)+Cq(17))+Cpq(23)*(-Cq(16)+Cq(18))
        W(12)=-(Cpq(26)*Cq(19))+Cpq(24)*(-Cq(17)+Cq(19))
        W(13)=-(Cpq(27)*Cq(20))+Cpq(25)*(-Cq(18)+Cq(20))
        W(14)=Cpq(28)*Cq(22)+Cpq(29)*(-Cq(21)+Cq(23))
        W(15)=Cpq(30)*(-Cq(22)+Cq(24))+Cpq(31)*(-Cq(23)+Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(34)*Cq(26))
        W(19)=Cpq(32)*(-Cq(24)+Cq(26))-Cpq(35)*Cq(27)
        W(20)=Cpq(33)*(-Cq(25)+Cq(27))-Spq(5)*Sq(2)
        W(21)=-(Spq(8)*Sq(4))+Spq(7)*Sq(5)
        W(22)=-(Spq(9)*Sq(5))+Spq(11)*Sq(8)
        W(23)=-(Spq(13)*Sq(8))-Spq(14)*Sq(9)
        W(24)=Spq(12)*(-Sq(7)+Sq(9))+Spq(16)*Sq(12)
        W(25)=-(Spq(19)*Sq(13))+Spq(17)*(-Sq(11)+Sq(13))
        W(26)=-(Spq(20)*Sq(14))
        W(27)=Spq(18)*(-Sq(12)+Sq(14))+Spq(22)*Sq(17)
        W(28)=Spq(23)*(-Sq(16)+Sq(18))-Spq(26)*Sq(19)
        W(29)=Spq(24)*(-Sq(17)+Sq(19))-Spq(27)*Sq(20)
        W(30)=Spq(25)*(-Sq(18)+Sq(20))+Spq(29)*Sq(23)
        W(31)=Spq(30)*(-Sq(22)+Sq(24))+Spq(31)*(-Sq(23)+Sq(25))
        W(32)=-(Spq(34)*Sq(26))+Spq(32)*(-Sq(24)+Sq(26))
        W(33)=-(Spq(35)*Sq(27))+Spq(33)*(-Sq(25)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_1_1_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(2))-Cq(1)*Spq(4)-Cq(2)*Spq(5)
        W(2)=-((Cq(3)+Cq(5))*Spq(7))-Cq(4)*Spq(8)
        W(3)=-(Cq(5)*Spq(9))-(Cq(6)+Cq(8))*Spq(11)
        W(4)=-((Cq(7)+Cq(9))*Spq(12))-Cq(8)*Spq(13)
        W(5)=-(Cq(9)*Spq(14))-(Cq(10)+Cq(12))*Spq(16)
        W(6)=-((Cq(11)+Cq(13))*Spq(17))-(Cq(12)+Cq(14))*Spq(18)
        W(7)=-(Cq(13)*Spq(19))-Cq(14)*Spq(20)
        W(8)=-((Cq(15)+Cq(17))*Spq(22))
        W(9)=-((Cq(16)+Cq(18))*Spq(23))-(Cq(17)+Cq(19))*Spq(24)
        W(10)=-((Cq(18)+Cq(20))*Spq(25))-Cq(19)*Spq(26)
        W(11)=-(Cq(20)*Spq(27))-(Cq(21)+Cq(23))*Spq(29)
        W(12)=-((Cq(22)+Cq(24))*Spq(30))-(Cq(23)+Cq(25))*Spq(31)
        W(13)=-((Cq(24)+Cq(26))*Spq(32))-(Cq(25)+Cq(27))*Spq(33)
        W(14)=-(Cq(26)*Spq(34))-Cq(27)*Spq(35)
        W(15)=Cpq(3)*Sq(2)+Cpq(5)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(6)*Sq(4)+Cpq(8)*Sq(4)+Cpq(7)*Sq(5)
        W(19)=Cpq(9)*Sq(5)+Cpq(10)*Sq(7)+Cpq(11)*Sq(8)+Cpq(13)*Sq(8)
        W(20)=Cpq(14)*Sq(9)+Cpq(12)*(Sq(7)+Sq(9))
        W(21)=Cpq(15)*Sq(11)+Cpq(16)*Sq(12)
        W(22)=Cpq(19)*Sq(13)+Cpq(17)*(Sq(11)+Sq(13))
        W(23)=Cpq(20)*Sq(14)+Cpq(18)*(Sq(12)+Sq(14))
        W(24)=Cpq(21)*Sq(16)+Cpq(22)*Sq(17)+Cpq(23)*(Sq(16)+Sq(18))
        W(25)=Cpq(26)*Sq(19)+Cpq(24)*(Sq(17)+Sq(19))
        W(26)=Cpq(27)*Sq(20)+Cpq(25)*(Sq(18)+Sq(20))
        W(27)=Cpq(28)*Sq(22)+Cpq(29)*Sq(23)
        W(28)=Cpq(30)*(Sq(22)+Sq(24))+Cpq(31)*(Sq(23)+Sq(25))
        W(29)=Cpq(34)*Sq(26)+Cpq(32)*(Sq(24)+Sq(26))
        W(30)=Cpq(35)*Sq(27)+Cpq(33)*(Sq(25)+Sq(27))
        W(31)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)
        W(32)=W(24)+W(25)+W(26)+W(27)+W(28)+W(29)+W(30)
        STwo=W(16)+W(17)+W(31)+W(32)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_0_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(3)*Cq(0)+Cpq(6)*Cq(1)+Cpq(10)*Cq(3)
        W(2)=Cpq(15)*Cq(6)+Cpq(21)*Cq(10)+Cpq(28)*Cq(15)+Cpq(36)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(7)*Cq(2)+Cpq(11)*Cq(4)
        W(2)=Cpq(12)*Cq(5)+Cpq(16)*Cq(7)+Cpq(17)*Cq(8)
        W(3)=Cpq(18)*Cq(9)+Cpq(22)*Cq(11)
        W(4)=Cpq(23)*Cq(12)+Cpq(24)*Cq(13)+Cpq(25)*Cq(14)
        W(5)=Cpq(29)*Cq(16)+Cpq(30)*Cq(17)
        W(6)=Cpq(31)*Cq(18)+Cpq(32)*Cq(19)+Cpq(33)*Cq(20)
        W(7)=Cpq(37)*Cq(22)+Cpq(38)*Cq(23)+Cpq(39)*Cq(24)
        W(8)=Cpq(40)*Cq(25)+Cpq(41)*Cq(26)+Cpq(42)*Cq(27)
        W(9)=Spq(7)*Sq(2)+Spq(11)*Sq(4)
        W(10)=Spq(12)*Sq(5)+Spq(16)*Sq(7)+Spq(17)*Sq(8)
        W(11)=Spq(18)*Sq(9)+Spq(22)*Sq(11)
        W(12)=Spq(23)*Sq(12)+Spq(24)*Sq(13)+Spq(25)*Sq(14)
        W(13)=Spq(29)*Sq(16)+Spq(30)*Sq(17)
        W(14)=Spq(31)*Sq(18)+Spq(32)*Sq(19)+Spq(33)*Sq(20)
        W(15)=Spq(37)*Sq(22)+Spq(38)*Sq(23)+Spq(39)*Sq(24)
        W(16)=Spq(40)*Sq(25)+Spq(41)*Sq(26)+Spq(42)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_1_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(4)*Cq(0)+Cpq(7)*Cq(1)-Cpq(6)*Cq(2)
        W(2)=Cpq(8)*Cq(2)-Cpq(10)*Cq(4)
        W(3)=Cpq(12)*Cq(4)+Cpq(11)*(Cq(3)-Cq(5))
        W(4)=Cpq(13)*Cq(5)-Cpq(15)*Cq(7)
        W(5)=Cpq(16)*(Cq(6)-Cq(8))+Cpq(18)*Cq(8)
        W(6)=Cpq(17)*(Cq(7)-Cq(9))+Cpq(19)*Cq(9)
        W(7)=-(Cpq(21)*Cq(11))+Cpq(22)*(Cq(10)-Cq(12))
        W(8)=Cpq(23)*(Cq(11)-Cq(13))
        W(9)=Cpq(25)*Cq(13)+Cpq(24)*(Cq(12)-Cq(14))
        W(10)=Cpq(26)*Cq(14)-Cpq(28)*Cq(16)
        W(11)=Cpq(29)*(Cq(15)-Cq(17))+Cpq(30)*(Cq(16)-Cq(18))
        W(12)=Cpq(31)*(Cq(17)-Cq(19))+Cpq(33)*Cq(19)
        W(13)=Cpq(32)*(Cq(18)-Cq(20))+Cpq(34)*Cq(20)
        W(14)=-(Cpq(36)*Cq(22))+Cpq(37)*(Cq(21)-Cq(23))
        W(15)=Cpq(38)*(Cq(22)-Cq(24))+Cpq(39)*(Cq(23)-Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(40)*(Cq(24)-Cq(26))
        W(19)=Cpq(42)*Cq(26)+Cpq(41)*(Cq(25)-Cq(27))
        W(20)=Cpq(43)*Cq(27)+Spq(8)*Sq(2)
        W(21)=Spq(12)*Sq(4)-Spq(11)*Sq(5)
        W(22)=Spq(13)*Sq(5)-Spq(16)*Sq(8)
        W(23)=Spq(18)*Sq(8)+Spq(17)*(Sq(7)-Sq(9))
        W(24)=Spq(19)*Sq(9)-Spq(22)*Sq(12)
        W(25)=Spq(23)*(Sq(11)-Sq(13))+Spq(25)*Sq(13)
        W(26)=Spq(24)*(Sq(12)-Sq(14))
        W(27)=Spq(26)*Sq(14)-Spq(29)*Sq(17)
        W(28)=Spq(30)*(Sq(16)-Sq(18))+Spq(31)*(Sq(17)-Sq(19))
        W(29)=Spq(33)*Sq(19)+Spq(32)*(Sq(18)-Sq(20))
        W(30)=Spq(34)*Sq(20)-Spq(37)*Sq(23)
        W(31)=Spq(38)*(Sq(22)-Sq(24))+Spq(39)*(Sq(23)-Sq(25))
        W(32)=Spq(40)*(Sq(24)-Sq(26))+Spq(42)*Sq(26)
        W(33)=Spq(41)*(Sq(25)-Sq(27))+Spq(43)*Sq(27)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_1_2_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(4)+Cq(1)*Spq(7)+Cq(2)*Spq(8)
        W(2)=(Cq(3)+Cq(5))*Spq(11)+Cq(4)*Spq(12)
        W(3)=Cq(5)*Spq(13)+(Cq(6)+Cq(8))*Spq(16)
        W(4)=(Cq(7)+Cq(9))*Spq(17)+Cq(8)*Spq(18)
        W(5)=Cq(9)*Spq(19)+(Cq(10)+Cq(12))*Spq(22)
        W(6)=(Cq(11)+Cq(13))*Spq(23)+(Cq(12)+Cq(14))*Spq(24)
        W(7)=Cq(13)*Spq(25)+Cq(14)*Spq(26)
        W(8)=(Cq(15)+Cq(17))*Spq(29)
        W(9)=(Cq(16)+Cq(18))*Spq(30)+(Cq(17)+Cq(19))*Spq(31)
        W(10)=(Cq(18)+Cq(20))*Spq(32)+Cq(19)*Spq(33)
        W(11)=Cq(20)*Spq(34)+(Cq(21)+Cq(23))*Spq(37)
        W(12)=(Cq(22)+Cq(24))*Spq(38)+(Cq(23)+Cq(25))*Spq(39)
        W(13)=(Cq(24)+Cq(26))*Spq(40)+(Cq(25)+Cq(27))*Spq(41)
        W(14)=Cq(26)*Spq(42)+Cq(27)*Spq(43)
        W(15)=-(Cpq(6)*Sq(2))-Cpq(8)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(10)*Sq(4))-Cpq(12)*Sq(4)-Cpq(11)*Sq(5)
        W(19)=-(Cpq(13)*Sq(5))-Cpq(15)*Sq(7)
        W(20)=-(Cpq(16)*Sq(8))-Cpq(18)*Sq(8)
        W(21)=-(Cpq(19)*Sq(9))-Cpq(17)*(Sq(7)+Sq(9))
        W(22)=-(Cpq(21)*Sq(11))-Cpq(22)*Sq(12)
        W(23)=-(Cpq(25)*Sq(13))-Cpq(23)*(Sq(11)+Sq(13))
        W(24)=-(Cpq(26)*Sq(14))-Cpq(24)*(Sq(12)+Sq(14))
        W(25)=-(Cpq(28)*Sq(16))-Cpq(29)*Sq(17)-Cpq(30)*(Sq(16)+Sq(18))
        W(26)=-(Cpq(33)*Sq(19))-Cpq(31)*(Sq(17)+Sq(19))
        W(27)=-(Cpq(34)*Sq(20))-Cpq(32)*(Sq(18)+Sq(20))
        W(28)=-(Cpq(36)*Sq(22))-Cpq(37)*Sq(23)
        W(29)=-(Cpq(38)*(Sq(22)+Sq(24)))-Cpq(39)*(Sq(23)+Sq(25))
        W(30)=-(Cpq(42)*Sq(26))-Cpq(40)*(Sq(24)+Sq(26))
        W(31)=-(Cpq(43)*Sq(27))-Cpq(41)*(Sq(25)+Sq(27))
        W(32)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(33)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)
        STwo=W(16)+W(17)+W(32)+W(33)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_2_2_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(5)*Cq(0)+Cpq(8)*Cq(1)
        W(2)=-(Cpq(7)*Cq(2))+Cpq(9)*Cq(2)
        W(3)=Cpq(12)*Cq(3)-Cpq(11)*Cq(4)
        W(4)=Cpq(13)*Cq(4)+Cpq(10)*Cq(5)
        W(5)=Cpq(14)*Cq(5)+Cpq(17)*Cq(6)+Cpq(18)*Cq(7)+Cpq(15)*Cq(8)
        W(6)=Cpq(19)*Cq(8)+Cpq(20)*Cq(9)
        W(7)=Cpq(16)*(-Cq(7)+Cq(9))+Cpq(24)*Cq(11)+Cpq(21)*Cq(12)
        W(8)=Cpq(25)*Cq(12)+Cpq(26)*Cq(13)
        W(9)=Cpq(22)*(-Cq(11)+Cq(13))+Cpq(27)*Cq(14)
        W(10)=Cpq(23)*(Cq(10)+Cq(14))+Cpq(28)*Cq(17)
        W(11)=Cpq(32)*Cq(17)+Cpq(33)*Cq(18)
        W(12)=Cpq(29)*(-Cq(16)+Cq(18))+Cpq(34)*Cq(19)
        W(13)=Cpq(30)*(Cq(15)+Cq(19))+Cpq(35)*Cq(20)
        W(14)=Cpq(31)*(Cq(16)+Cq(20))+Cpq(36)*Cq(23)
        W(15)=Cpq(41)*Cq(24)+Cpq(37)*(-Cq(22)+Cq(24))+Cpq(42)*Cq(25)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(38)*(Cq(21)+Cq(25))+Cpq(43)*Cq(26)
        W(19)=Cpq(39)*(Cq(22)+Cq(26))+Cpq(44)*Cq(27)
        W(20)=Cpq(40)*(Cq(23)+Cq(27))+Spq(7)*Sq(2)
        W(21)=Spq(9)*Sq(2)+Spq(11)*Sq(4)
        W(22)=Spq(13)*Sq(4)+Spq(14)*Sq(5)+Spq(18)*Sq(7)+Spq(19)*Sq(8)
        W(23)=Spq(20)*Sq(9)+Spq(16)*(Sq(7)+Sq(9))
        W(24)=Spq(24)*Sq(11)+Spq(25)*Sq(12)+Spq(26)*Sq(13)
        W(25)=Spq(22)*(Sq(11)+Sq(13))+Spq(23)*Sq(14)
        W(26)=Spq(27)*Sq(14)+Spq(32)*Sq(17)
        W(27)=Spq(33)*Sq(18)+Spq(29)*(Sq(16)+Sq(18))
        W(28)=Spq(30)*Sq(19)+Spq(34)*Sq(19)+Spq(35)*Sq(20)
        W(29)=Spq(31)*(Sq(16)+Sq(20))+Spq(41)*Sq(24)
        W(30)=Spq(37)*(Sq(22)+Sq(24))+Spq(38)*Sq(25)
        W(31)=Spq(42)*Sq(25)+Spq(43)*Sq(26)
        W(32)=Spq(39)*(Sq(22)+Sq(26))
        W(33)=Spq(44)*Sq(27)+Spq(40)*(Sq(23)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_2_2_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(5)-Cq(2)*Spq(7)
        W(2)=Cq(1)*Spq(8)+Cq(2)*Spq(9)
        W(3)=-(Cq(4)*Spq(11))+Cq(3)*Spq(12)
        W(4)=Cq(4)*Spq(13)+Cq(5)*Spq(14)
        W(5)=-((Cq(7)+Cq(9))*Spq(16))+Cq(6)*Spq(17)
        W(6)=Cq(7)*Spq(18)+Cq(8)*Spq(19)
        W(7)=Cq(9)*Spq(20)-(Cq(11)+Cq(13))*Spq(22)
        W(8)=(Cq(10)-Cq(14))*Spq(23)+Cq(11)*Spq(24)+Cq(12)*Spq(25)
        W(9)=Cq(13)*Spq(26)+Cq(14)*Spq(27)
        W(10)=-((Cq(16)+Cq(18))*Spq(29))+(Cq(15)-Cq(19))*Spq(30)
        W(11)=(Cq(16)-Cq(20))*Spq(31)+Cq(17)*Spq(32)
        W(12)=Cq(18)*Spq(33)+Cq(19)*Spq(34)
        W(13)=Cq(20)*Spq(35)-(Cq(22)+Cq(24))*Spq(37)
        W(14)=(Cq(21)-Cq(25))*Spq(38)+(Cq(22)-Cq(26))*Spq(39)
        W(15)=(Cq(23)-Cq(27))*Spq(40)+Cq(24)*Spq(41)
        W(16)=Cq(25)*Spq(42)+Cq(26)*Spq(43)+Cq(27)*Spq(44)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=-(Cpq(7)*Sq(2))-Cpq(9)*Sq(2)
        W(20)=-(Cpq(11)*Sq(4))-Cpq(13)*Sq(4)
        W(21)=Cpq(10)*Sq(5)-Cpq(14)*Sq(5)
        W(22)=-(Cpq(18)*Sq(7))+Cpq(15)*Sq(8)
        W(23)=-(Cpq(19)*Sq(8))-Cpq(20)*Sq(9)
        W(24)=Cpq(16)*(-Sq(7)+Sq(9))-Cpq(24)*Sq(11)
        W(25)=Cpq(21)*Sq(12)-Cpq(25)*Sq(12)
        W(26)=-(Cpq(26)*Sq(13))
        W(27)=Cpq(22)*(-Sq(11)+Sq(13))+Cpq(23)*Sq(14)
        W(28)=-(Cpq(27)*Sq(14))+Cpq(28)*Sq(17)
        W(29)=-(Cpq(32)*Sq(17))-Cpq(33)*Sq(18)
        W(30)=Cpq(29)*(-Sq(16)+Sq(18))+Cpq(30)*Sq(19)
        W(31)=-(Cpq(34)*Sq(19))
        W(32)=-(Cpq(35)*Sq(20))+Cpq(31)*(-Sq(16)+Sq(20))
        W(33)=Cpq(36)*Sq(23)-Cpq(41)*Sq(24)
        W(34)=Cpq(37)*(-Sq(22)+Sq(24))+Cpq(38)*Sq(25)
        W(35)=-(Cpq(42)*Sq(25))-Cpq(43)*Sq(26)
        W(36)=Cpq(39)*(-Sq(22)+Sq(26))
        W(37)=-(Cpq(44)*Sq(27))+Cpq(40)*(-Sq(23)+Sq(27))
        W(38)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(39)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)+W(37)
        STwo=W(17)+W(18)+W(38)+W(39)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_0_3_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(6)*Cq(0))-Cpq(10)*Cq(1)-Cpq(15)*Cq(3)
        W(2)=-(Cpq(21)*Cq(6))-Cpq(28)*Cq(10)
        W(3)=-(Cpq(36)*Cq(15))-Cpq(45)*Cq(21)
        COne=W(1)+W(2)+W(3)
        W(1)=-(Cpq(11)*Cq(2))-Cpq(16)*Cq(4)
        W(2)=-(Cpq(17)*Cq(5))-Cpq(22)*Cq(7)-Cpq(23)*Cq(8)
        W(3)=-(Cpq(24)*Cq(9))-Cpq(29)*Cq(11)
        W(4)=-(Cpq(30)*Cq(12))-Cpq(31)*Cq(13)-Cpq(32)*Cq(14)
        W(5)=-(Cpq(37)*Cq(16))-Cpq(38)*Cq(17)
        W(6)=-(Cpq(39)*Cq(18))-Cpq(40)*Cq(19)-Cpq(41)*Cq(20)
        W(7)=-(Cpq(46)*Cq(22))-Cpq(47)*Cq(23)-Cpq(48)*Cq(24)
        W(8)=-(Cpq(49)*Cq(25))-Cpq(50)*Cq(26)-Cpq(51)*Cq(27)
        W(9)=-(Spq(11)*Sq(2))-Spq(16)*Sq(4)
        W(10)=-(Spq(17)*Sq(5))-Spq(22)*Sq(7)-Spq(23)*Sq(8)
        W(11)=-(Spq(24)*Sq(9))-Spq(29)*Sq(11)
        W(12)=-(Spq(30)*Sq(12))-Spq(31)*Sq(13)-Spq(32)*Sq(14)
        W(13)=-(Spq(37)*Sq(16))-Spq(38)*Sq(17)
        W(14)=-(Spq(39)*Sq(18))-Spq(40)*Sq(19)-Spq(41)*Sq(20)
        W(15)=-(Spq(46)*Sq(22))-Spq(47)*Sq(23)-Spq(48)*Sq(24)
        W(16)=-(Spq(49)*Sq(25))-Spq(50)*Sq(26)-Spq(51)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_1_3_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(7)*Cq(0))-Cpq(11)*Cq(1)+Cpq(10)*Cq(2)
        W(2)=-(Cpq(12)*Cq(2))+Cpq(15)*Cq(4)
        W(3)=-(Cpq(17)*Cq(4))-Cpq(18)*Cq(5)
        W(4)=Cpq(16)*(-Cq(3)+Cq(5))+Cpq(21)*Cq(7)
        W(5)=-(Cpq(24)*Cq(8))+Cpq(22)*(-Cq(6)+Cq(8))
        W(6)=-(Cpq(25)*Cq(9))+Cpq(23)*(-Cq(7)+Cq(9))
        W(7)=Cpq(28)*Cq(11)+Cpq(29)*(-Cq(10)+Cq(12))
        W(8)=-(Cpq(32)*Cq(13))
        W(9)=Cpq(30)*(-Cq(11)+Cq(13))-Cpq(33)*Cq(14)
        W(10)=Cpq(31)*(-Cq(12)+Cq(14))+Cpq(36)*Cq(16)
        W(11)=Cpq(37)*(-Cq(15)+Cq(17))+Cpq(38)*(-Cq(16)+Cq(18))
        W(12)=-(Cpq(41)*Cq(19))+Cpq(39)*(-Cq(17)+Cq(19))
        W(13)=-(Cpq(42)*Cq(20))+Cpq(40)*(-Cq(18)+Cq(20))
        W(14)=Cpq(45)*Cq(22)+Cpq(46)*(-Cq(21)+Cq(23))
        W(15)=Cpq(47)*(-Cq(22)+Cq(24))+Cpq(48)*(-Cq(23)+Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(51)*Cq(26))
        W(19)=Cpq(49)*(-Cq(24)+Cq(26))-Cpq(52)*Cq(27)
        W(20)=Cpq(50)*(-Cq(25)+Cq(27))-Spq(12)*Sq(2)
        W(21)=-(Spq(17)*Sq(4))+Spq(16)*Sq(5)
        W(22)=-(Spq(18)*Sq(5))+Spq(22)*Sq(8)
        W(23)=-(Spq(24)*Sq(8))-Spq(25)*Sq(9)
        W(24)=Spq(23)*(-Sq(7)+Sq(9))+Spq(29)*Sq(12)
        W(25)=-(Spq(32)*Sq(13))+Spq(30)*(-Sq(11)+Sq(13))
        W(26)=-(Spq(33)*Sq(14))
        W(27)=Spq(31)*(-Sq(12)+Sq(14))+Spq(37)*Sq(17)
        W(28)=Spq(38)*(-Sq(16)+Sq(18))-Spq(41)*Sq(19)
        W(29)=Spq(39)*(-Sq(17)+Sq(19))-Spq(42)*Sq(20)
        W(30)=Spq(40)*(-Sq(18)+Sq(20))+Spq(46)*Sq(23)
        W(31)=Spq(47)*(-Sq(22)+Sq(24))+Spq(48)*(-Sq(23)+Sq(25))
        W(32)=-(Spq(51)*Sq(26))+Spq(49)*(-Sq(24)+Sq(26))
        W(33)=-(Spq(52)*Sq(27))+Spq(50)*(-Sq(25)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_1_3_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(7))-Cq(1)*Spq(11)-Cq(2)*Spq(12)
        W(2)=-((Cq(3)+Cq(5))*Spq(16))-Cq(4)*Spq(17)
        W(3)=-(Cq(5)*Spq(18))-(Cq(6)+Cq(8))*Spq(22)
        W(4)=-((Cq(7)+Cq(9))*Spq(23))-Cq(8)*Spq(24)
        W(5)=-(Cq(9)*Spq(25))-(Cq(10)+Cq(12))*Spq(29)
        W(6)=-((Cq(11)+Cq(13))*Spq(30))-(Cq(12)+Cq(14))*Spq(31)
        W(7)=-(Cq(13)*Spq(32))-Cq(14)*Spq(33)
        W(8)=-((Cq(15)+Cq(17))*Spq(37))
        W(9)=-((Cq(16)+Cq(18))*Spq(38))-(Cq(17)+Cq(19))*Spq(39)
        W(10)=-((Cq(18)+Cq(20))*Spq(40))-Cq(19)*Spq(41)
        W(11)=-(Cq(20)*Spq(42))-(Cq(21)+Cq(23))*Spq(46)
        W(12)=-((Cq(22)+Cq(24))*Spq(47))-(Cq(23)+Cq(25))*Spq(48)
        W(13)=-((Cq(24)+Cq(26))*Spq(49))-(Cq(25)+Cq(27))*Spq(50)
        W(14)=-(Cq(26)*Spq(51))-Cq(27)*Spq(52)
        W(15)=Cpq(10)*Sq(2)+Cpq(12)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(15)*Sq(4)+Cpq(17)*Sq(4)+Cpq(16)*Sq(5)
        W(19)=Cpq(18)*Sq(5)+Cpq(21)*Sq(7)+Cpq(22)*Sq(8)+Cpq(24)*Sq(8)
        W(20)=Cpq(25)*Sq(9)+Cpq(23)*(Sq(7)+Sq(9))
        W(21)=Cpq(28)*Sq(11)+Cpq(29)*Sq(12)
        W(22)=Cpq(32)*Sq(13)+Cpq(30)*(Sq(11)+Sq(13))
        W(23)=Cpq(33)*Sq(14)+Cpq(31)*(Sq(12)+Sq(14))
        W(24)=Cpq(36)*Sq(16)+Cpq(37)*Sq(17)+Cpq(38)*(Sq(16)+Sq(18))
        W(25)=Cpq(41)*Sq(19)+Cpq(39)*(Sq(17)+Sq(19))
        W(26)=Cpq(42)*Sq(20)+Cpq(40)*(Sq(18)+Sq(20))
        W(27)=Cpq(45)*Sq(22)+Cpq(46)*Sq(23)
        W(28)=Cpq(47)*(Sq(22)+Sq(24))+Cpq(48)*(Sq(23)+Sq(25))
        W(29)=Cpq(51)*Sq(26)+Cpq(49)*(Sq(24)+Sq(26))
        W(30)=Cpq(52)*Sq(27)+Cpq(50)*(Sq(25)+Sq(27))
        W(31)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)
        W(32)=W(24)+W(25)+W(26)+W(27)+W(28)+W(29)+W(30)
        STwo=W(16)+W(17)+W(31)+W(32)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_2_3_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(8)*Cq(0))-Cpq(12)*Cq(1)
        W(2)=Cpq(11)*Cq(2)-Cpq(13)*Cq(2)-Cpq(17)*Cq(3)
        W(3)=Cpq(16)*Cq(4)-Cpq(18)*Cq(4)
        W(4)=-(Cpq(15)*Cq(5))-Cpq(19)*Cq(5)-Cpq(23)*Cq(6)
        W(5)=Cpq(22)*Cq(7)-Cpq(24)*Cq(7)
        W(6)=-(Cpq(21)*Cq(8))-Cpq(25)*Cq(8)-Cpq(22)*Cq(9)
        W(7)=-(Cpq(26)*Cq(9))-Cpq(30)*Cq(10)+Cpq(29)*Cq(11)
        W(8)=-(Cpq(31)*Cq(11))-Cpq(28)*Cq(12)-Cpq(32)*Cq(12)
        W(9)=-(Cpq(29)*Cq(13))-Cpq(33)*Cq(13)
        W(10)=-(Cpq(30)*Cq(14))-Cpq(34)*Cq(14)-Cpq(38)*Cq(15)
        W(11)=Cpq(37)*Cq(16)-Cpq(39)*Cq(16)-Cpq(36)*Cq(17)
        W(12)=-(Cpq(40)*Cq(17))-Cpq(37)*Cq(18)-Cpq(41)*Cq(18)
        W(13)=-(Cpq(38)*Cq(19))-Cpq(42)*Cq(19)
        W(14)=-(Cpq(39)*Cq(20))-Cpq(43)*Cq(20)-Cpq(47)*Cq(21)
        W(15)=Cpq(46)*Cq(22)-Cpq(48)*Cq(22)-Cpq(45)*Cq(23)
        W(16)=-(Cpq(49)*Cq(23))-Cpq(46)*Cq(24)-Cpq(50)*Cq(24)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=-(Cpq(47)*Cq(25))-Cpq(51)*Cq(25)
        W(20)=-(Cpq(48)*Cq(26))-Cpq(52)*Cq(26)-Cpq(49)*Cq(27)
        W(21)=-(Cpq(53)*Cq(27))-Spq(11)*Sq(2)
        W(22)=-(Spq(13)*Sq(2))-Spq(16)*Sq(4)-Spq(18)*Sq(4)
        W(23)=-(Spq(19)*Sq(5))-Spq(22)*Sq(7)
        W(24)=-(Spq(24)*Sq(7))-Spq(25)*Sq(8)-Spq(22)*Sq(9)
        W(25)=-(Spq(26)*Sq(9))-Spq(29)*Sq(11)-Spq(31)*Sq(11)
        W(26)=-(Spq(32)*Sq(12))-Spq(29)*Sq(13)-Spq(33)*Sq(13)
        W(27)=-(Spq(30)*Sq(14))-Spq(34)*Sq(14)
        W(28)=-(Spq(37)*Sq(16))-Spq(39)*Sq(16)-Spq(40)*Sq(17)
        W(29)=-(Spq(37)*Sq(18))-Spq(41)*Sq(18)-Spq(38)*Sq(19)
        W(30)=-(Spq(42)*Sq(19))-Spq(39)*Sq(20)-Spq(43)*Sq(20)
        W(31)=-(Spq(46)*Sq(22))-Spq(48)*Sq(22)
        W(32)=-(Spq(49)*Sq(23))-Spq(46)*Sq(24)-Spq(50)*Sq(24)
        W(33)=-(Spq(47)*Sq(25))-Spq(51)*Sq(25)-Spq(48)*Sq(26)
        W(34)=-(Spq(52)*Sq(26))-Spq(49)*Sq(27)-Spq(53)*Sq(27)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        CTwo=W(17)+W(18)+W(35)+W(36)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_2_3_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(8))+Cq(2)*Spq(11)
        W(2)=-(Cq(1)*Spq(12))-Cq(2)*Spq(13)
        W(3)=Cq(4)*Spq(16)-Cq(3)*Spq(17)
        W(4)=-(Cq(4)*Spq(18))-Cq(5)*Spq(19)
        W(5)=(Cq(7)+Cq(9))*Spq(22)-Cq(6)*Spq(23)
        W(6)=-(Cq(7)*Spq(24))-Cq(8)*Spq(25)
        W(7)=-(Cq(9)*Spq(26))+(Cq(11)+Cq(13))*Spq(29)
        W(8)=(-Cq(10)+Cq(14))*Spq(30)
        W(9)=-(Cq(11)*Spq(31))-Cq(12)*Spq(32)
        W(10)=-(Cq(13)*Spq(33))-Cq(14)*Spq(34)
        W(11)=(Cq(16)+Cq(18))*Spq(37)+(-Cq(15)+Cq(19))*Spq(38)
        W(12)=(-Cq(16)+Cq(20))*Spq(39)-Cq(17)*Spq(40)
        W(13)=-(Cq(18)*Spq(41))-Cq(19)*Spq(42)
        W(14)=-(Cq(20)*Spq(43))+(Cq(22)+Cq(24))*Spq(46)
        W(15)=(-Cq(21)+Cq(25))*Spq(47)+(-Cq(22)+Cq(26))*Spq(48)
        W(16)=(-Cq(23)+Cq(27))*Spq(49)-Cq(24)*Spq(50)
        W(17)=-(Cq(25)*Spq(51))-Cq(26)*Spq(52)-Cq(27)*Spq(53)
        W(18)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(19)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)+W(17)
        W(20)=Cpq(11)*Sq(2)+Cpq(13)*Sq(2)+Cpq(16)*Sq(4)+Cpq(18)*Sq(4)
        W(21)=-(Cpq(15)*Sq(5))+Cpq(19)*Sq(5)
        W(22)=Cpq(24)*Sq(7)-Cpq(21)*Sq(8)
        W(23)=Cpq(25)*Sq(8)+Cpq(22)*(Sq(7)-Sq(9))
        W(24)=Cpq(26)*Sq(9)+Cpq(31)*Sq(11)
        W(25)=-(Cpq(28)*Sq(12))+Cpq(32)*Sq(12)
        W(26)=Cpq(29)*(Sq(11)-Sq(13))
        W(27)=Cpq(33)*Sq(13)-Cpq(30)*Sq(14)
        W(28)=Cpq(34)*Sq(14)-Cpq(36)*Sq(17)
        W(29)=Cpq(40)*Sq(17)+Cpq(37)*(Sq(16)-Sq(18))
        W(30)=Cpq(41)*Sq(18)-Cpq(38)*Sq(19)
        W(31)=Cpq(42)*Sq(19)+Cpq(39)*(Sq(16)-Sq(20))+Cpq(43)*Sq(20)
        W(32)=-(Cpq(45)*Sq(23))+Cpq(46)*(Sq(22)-Sq(24))
        W(33)=Cpq(50)*Sq(24)-Cpq(47)*Sq(25)
        W(34)=Cpq(51)*Sq(25)+Cpq(48)*(Sq(22)-Sq(26))
        W(35)=Cpq(52)*Sq(26)+Cpq(49)*(Sq(23)-Sq(27))+Cpq(53)*Sq(27)
        W(36)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(37)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)
        STwo=W(18)+W(19)+W(36)+W(37)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_3_3_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cpq(9)*Cq(0))-Cpq(13)*Cq(1)
        W(2)=Cpq(12)*Cq(2)-Cpq(14)*Cq(2)-Cpq(18)*Cq(3)
        W(3)=Cpq(17)*Cq(4)-Cpq(19)*Cq(4)
        W(4)=-(Cpq(16)*Cq(5))-Cpq(20)*Cq(5)-Cpq(24)*Cq(6)
        W(5)=Cpq(23)*Cq(7)-Cpq(25)*Cq(7)
        W(6)=-(Cpq(22)*Cq(8))-Cpq(26)*Cq(8)+Cpq(21)*Cq(9)
        W(7)=-(Cpq(27)*Cq(9))-Cpq(31)*Cq(10)+Cpq(30)*Cq(11)
        W(8)=-(Cpq(32)*Cq(11))-Cpq(29)*Cq(12)-Cpq(33)*Cq(12)
        W(9)=Cpq(28)*Cq(13)-Cpq(34)*Cq(13)
        W(10)=Cpq(29)*Cq(14)-Cpq(35)*Cq(14)-Cpq(39)*Cq(15)
        W(11)=Cpq(38)*Cq(16)-Cpq(40)*Cq(16)-Cpq(37)*Cq(17)
        W(12)=-(Cpq(41)*Cq(17))+Cpq(36)*Cq(18)-Cpq(42)*Cq(18)
        W(13)=Cpq(37)*Cq(19)-Cpq(43)*Cq(19)
        W(14)=Cpq(38)*Cq(20)-Cpq(44)*Cq(20)-Cpq(48)*Cq(21)
        W(15)=Cpq(47)*Cq(22)-Cpq(49)*Cq(22)-Cpq(46)*Cq(23)
        W(16)=-(Cpq(50)*Cq(23))+Cpq(45)*Cq(24)-Cpq(51)*Cq(24)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=Cpq(46)*Cq(25)-Cpq(52)*Cq(25)
        W(20)=Cpq(47)*Cq(26)-Cpq(53)*Cq(26)+Cpq(48)*Cq(27)
        W(21)=-(Cpq(54)*Cq(27))-Spq(12)*Sq(2)-Spq(14)*Sq(2)
        W(22)=-(Spq(17)*Sq(4))-Spq(19)*Sq(4)+Spq(16)*Sq(5)
        W(23)=-(Spq(20)*Sq(5))-Spq(23)*Sq(7)
        W(24)=-(Spq(25)*Sq(7))+Spq(22)*Sq(8)-Spq(26)*Sq(8)
        W(25)=-(Spq(27)*Sq(9))-Spq(30)*Sq(11)-Spq(32)*Sq(11)
        W(26)=Spq(29)*Sq(12)-Spq(33)*Sq(12)-Spq(34)*Sq(13)
        W(27)=Spq(29)*Sq(14)-Spq(35)*Sq(14)
        W(28)=-(Spq(38)*Sq(16))-Spq(40)*Sq(16)+Spq(37)*Sq(17)
        W(29)=-(Spq(41)*Sq(17))-Spq(42)*Sq(18)+Spq(37)*Sq(19)
        W(30)=-(Spq(43)*Sq(19))+Spq(38)*Sq(20)-Spq(44)*Sq(20)
        W(31)=-(Spq(47)*Sq(22))-Spq(49)*Sq(22)
        W(32)=Spq(46)*Sq(23)-Spq(50)*Sq(23)-Spq(51)*Sq(24)
        W(33)=Spq(46)*Sq(25)-Spq(52)*Sq(25)+Spq(47)*Sq(26)
        W(34)=-(Spq(53)*Sq(26))+Spq(48)*Sq(27)-Spq(54)*Sq(27)
        W(35)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)
        W(36)=W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)
        CTwo=W(17)+W(18)+W(35)+W(36)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_3_3_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=-(Cq(0)*Spq(9))+Cq(2)*Spq(12)
        W(2)=-(Cq(1)*Spq(13))-Cq(2)*Spq(14)
        W(3)=-(Cq(5)*Spq(16))+Cq(4)*Spq(17)
        W(4)=-(Cq(3)*Spq(18))-Cq(4)*Spq(19)-Cq(5)*Spq(20)
        W(5)=-(Cq(8)*Spq(22))+Cq(7)*Spq(23)
        W(6)=-(Cq(6)*Spq(24))-Cq(7)*Spq(25)-Cq(8)*Spq(26)
        W(7)=-(Cq(9)*Spq(27))-(Cq(12)+Cq(14))*Spq(29)
        W(8)=Cq(11)*Spq(30)-Cq(10)*Spq(31)-Cq(11)*Spq(32)
        W(9)=-(Cq(12)*Spq(33))-Cq(13)*Spq(34)
        W(10)=-(Cq(14)*Spq(35))-(Cq(17)+Cq(19))*Spq(37)
        W(11)=(Cq(16)-Cq(20))*Spq(38)-Cq(15)*Spq(39)
        W(12)=-(Cq(16)*Spq(40))-Cq(17)*Spq(41)-Cq(18)*Spq(42)
        W(13)=-(Cq(19)*Spq(43))-Cq(20)*Spq(44)
        W(14)=-((Cq(23)+Cq(25))*Spq(46))
        W(15)=(Cq(22)-Cq(26))*Spq(47)-(Cq(21)+Cq(27))*Spq(48)
        W(16)=-(Cq(22)*Spq(49))-Cq(23)*Spq(50)
        W(17)=-(Cq(24)*Spq(51))-Cq(25)*Spq(52)-Cq(26)*Spq(53)
        W(18)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(19)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)+W(17)
        W(20)=-(Cq(27)*Spq(54))+Cpq(12)*Sq(2)
        W(21)=Cpq(14)*Sq(2)+Cpq(17)*Sq(4)
        W(22)=Cpq(19)*Sq(4)-Cpq(16)*Sq(5)
        W(23)=Cpq(20)*Sq(5)+Cpq(23)*Sq(7)+Cpq(25)*Sq(7)
        W(24)=-(Cpq(22)*Sq(8))+Cpq(26)*Sq(8)
        W(25)=Cpq(21)*Sq(9)+Cpq(27)*Sq(9)+Cpq(30)*Sq(11)
        W(26)=Cpq(32)*Sq(11)+Cpq(33)*Sq(12)
        W(27)=Cpq(28)*Sq(13)+Cpq(34)*Sq(13)+Cpq(35)*Sq(14)
        W(28)=Cpq(29)*(-Sq(12)+Sq(14))+Cpq(40)*Sq(16)
        W(29)=Cpq(41)*Sq(17)+Cpq(36)*Sq(18)
        W(30)=Cpq(42)*Sq(18)+Cpq(43)*Sq(19)
        W(31)=Cpq(37)*(-Sq(17)+Sq(19))
        W(32)=Cpq(44)*Sq(20)+Cpq(38)*(Sq(16)+Sq(20))
        W(33)=Cpq(49)*Sq(22)+Cpq(50)*Sq(23)
        W(34)=Cpq(45)*Sq(24)+Cpq(51)*Sq(24)+Cpq(52)*Sq(25)
        W(35)=Cpq(46)*(-Sq(23)+Sq(25))+Cpq(53)*Sq(26)
        W(36)=Cpq(47)*(Sq(22)+Sq(26))+Cpq(48)*Sq(27)+Cpq(54)*Sq(27)
        W(37)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(38)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)
        STwo=W(18)+W(19)+W(37)+W(38)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_0_4_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(10)*Cq(0)+Cpq(15)*Cq(1)+Cpq(21)*Cq(3)
        W(2)=Cpq(28)*Cq(6)+Cpq(36)*Cq(10)+Cpq(45)*Cq(15)+Cpq(55)*Cq(21)
        COne=W(1)+W(2)
        W(1)=Cpq(16)*Cq(2)+Cpq(22)*Cq(4)
        W(2)=Cpq(23)*Cq(5)+Cpq(29)*Cq(7)+Cpq(30)*Cq(8)
        W(3)=Cpq(31)*Cq(9)+Cpq(37)*Cq(11)
        W(4)=Cpq(38)*Cq(12)+Cpq(39)*Cq(13)+Cpq(40)*Cq(14)
        W(5)=Cpq(46)*Cq(16)+Cpq(47)*Cq(17)
        W(6)=Cpq(48)*Cq(18)+Cpq(49)*Cq(19)+Cpq(50)*Cq(20)
        W(7)=Cpq(56)*Cq(22)+Cpq(57)*Cq(23)+Cpq(58)*Cq(24)
        W(8)=Cpq(59)*Cq(25)+Cpq(60)*Cq(26)+Cpq(61)*Cq(27)
        W(9)=Spq(16)*Sq(2)+Spq(22)*Sq(4)
        W(10)=Spq(23)*Sq(5)+Spq(29)*Sq(7)+Spq(30)*Sq(8)
        W(11)=Spq(31)*Sq(9)+Spq(37)*Sq(11)
        W(12)=Spq(38)*Sq(12)+Spq(39)*Sq(13)+Spq(40)*Sq(14)
        W(13)=Spq(46)*Sq(16)+Spq(47)*Sq(17)
        W(14)=Spq(48)*Sq(18)+Spq(49)*Sq(19)+Spq(50)*Sq(20)
        W(15)=Spq(56)*Sq(22)+Spq(57)*Sq(23)+Spq(58)*Sq(24)
        W(16)=Spq(59)*Sq(25)+Spq(60)*Sq(26)+Spq(61)*Sq(27)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        CTwo=W(17)+W(18)
        Cp=COne+Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_1_4_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(11)*Cq(0)+Cpq(16)*Cq(1)-Cpq(15)*Cq(2)
        W(2)=Cpq(17)*Cq(2)-Cpq(21)*Cq(4)
        W(3)=Cpq(23)*Cq(4)+Cpq(22)*(Cq(3)-Cq(5))
        W(4)=Cpq(24)*Cq(5)-Cpq(28)*Cq(7)
        W(5)=Cpq(29)*(Cq(6)-Cq(8))+Cpq(31)*Cq(8)
        W(6)=Cpq(30)*(Cq(7)-Cq(9))+Cpq(32)*Cq(9)
        W(7)=-(Cpq(36)*Cq(11))+Cpq(37)*(Cq(10)-Cq(12))
        W(8)=Cpq(38)*(Cq(11)-Cq(13))
        W(9)=Cpq(40)*Cq(13)+Cpq(39)*(Cq(12)-Cq(14))
        W(10)=Cpq(41)*Cq(14)-Cpq(45)*Cq(16)
        W(11)=Cpq(46)*(Cq(15)-Cq(17))+Cpq(47)*(Cq(16)-Cq(18))
        W(12)=Cpq(48)*(Cq(17)-Cq(19))+Cpq(50)*Cq(19)
        W(13)=Cpq(49)*(Cq(18)-Cq(20))+Cpq(51)*Cq(20)
        W(14)=-(Cpq(55)*Cq(22))+Cpq(56)*(Cq(21)-Cq(23))
        W(15)=Cpq(57)*(Cq(22)-Cq(24))+Cpq(58)*(Cq(23)-Cq(25))
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(59)*(Cq(24)-Cq(26))
        W(19)=Cpq(61)*Cq(26)+Cpq(60)*(Cq(25)-Cq(27))
        W(20)=Cpq(62)*Cq(27)+Spq(17)*Sq(2)
        W(21)=Spq(23)*Sq(4)-Spq(22)*Sq(5)
        W(22)=Spq(24)*Sq(5)-Spq(29)*Sq(8)
        W(23)=Spq(31)*Sq(8)+Spq(30)*(Sq(7)-Sq(9))
        W(24)=Spq(32)*Sq(9)-Spq(37)*Sq(12)
        W(25)=Spq(38)*(Sq(11)-Sq(13))+Spq(40)*Sq(13)
        W(26)=Spq(39)*(Sq(12)-Sq(14))
        W(27)=Spq(41)*Sq(14)-Spq(46)*Sq(17)
        W(28)=Spq(47)*(Sq(16)-Sq(18))+Spq(48)*(Sq(17)-Sq(19))
        W(29)=Spq(50)*Sq(19)+Spq(49)*(Sq(18)-Sq(20))
        W(30)=Spq(51)*Sq(20)-Spq(56)*Sq(23)
        W(31)=Spq(57)*(Sq(22)-Sq(24))+Spq(58)*(Sq(23)-Sq(25))
        W(32)=Spq(59)*(Sq(24)-Sq(26))+Spq(61)*Sq(26)
        W(33)=Spq(60)*(Sq(25)-Sq(27))+Spq(62)*Sq(27)
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_1_4_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(11)+Cq(1)*Spq(16)+Cq(2)*Spq(17)
        W(2)=(Cq(3)+Cq(5))*Spq(22)+Cq(4)*Spq(23)
        W(3)=Cq(5)*Spq(24)+(Cq(6)+Cq(8))*Spq(29)
        W(4)=(Cq(7)+Cq(9))*Spq(30)+Cq(8)*Spq(31)
        W(5)=Cq(9)*Spq(32)+(Cq(10)+Cq(12))*Spq(37)
        W(6)=(Cq(11)+Cq(13))*Spq(38)+(Cq(12)+Cq(14))*Spq(39)
        W(7)=Cq(13)*Spq(40)+Cq(14)*Spq(41)
        W(8)=(Cq(15)+Cq(17))*Spq(46)
        W(9)=(Cq(16)+Cq(18))*Spq(47)+(Cq(17)+Cq(19))*Spq(48)
        W(10)=(Cq(18)+Cq(20))*Spq(49)+Cq(19)*Spq(50)
        W(11)=Cq(20)*Spq(51)+(Cq(21)+Cq(23))*Spq(56)
        W(12)=(Cq(22)+Cq(24))*Spq(57)+(Cq(23)+Cq(25))*Spq(58)
        W(13)=(Cq(24)+Cq(26))*Spq(59)+(Cq(25)+Cq(27))*Spq(60)
        W(14)=Cq(26)*Spq(61)+Cq(27)*Spq(62)
        W(15)=-(Cpq(15)*Sq(2))-Cpq(17)*Sq(2)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=-(Cpq(21)*Sq(4))-Cpq(23)*Sq(4)-Cpq(22)*Sq(5)
        W(19)=-(Cpq(24)*Sq(5))-Cpq(28)*Sq(7)
        W(20)=-(Cpq(29)*Sq(8))-Cpq(31)*Sq(8)
        W(21)=-(Cpq(32)*Sq(9))-Cpq(30)*(Sq(7)+Sq(9))
        W(22)=-(Cpq(36)*Sq(11))-Cpq(37)*Sq(12)
        W(23)=-(Cpq(40)*Sq(13))-Cpq(38)*(Sq(11)+Sq(13))
        W(24)=-(Cpq(41)*Sq(14))-Cpq(39)*(Sq(12)+Sq(14))
        W(25)=-(Cpq(45)*Sq(16))-Cpq(46)*Sq(17)-Cpq(47)*(Sq(16)+Sq(18))
        W(26)=-(Cpq(50)*Sq(19))-Cpq(48)*(Sq(17)+Sq(19))
        W(27)=-(Cpq(51)*Sq(20))-Cpq(49)*(Sq(18)+Sq(20))
        W(28)=-(Cpq(55)*Sq(22))-Cpq(56)*Sq(23)
        W(29)=-(Cpq(57)*(Sq(22)+Sq(24)))-Cpq(58)*(Sq(23)+Sq(25))
        W(30)=-(Cpq(61)*Sq(26))-Cpq(59)*(Sq(24)+Sq(26))
        W(31)=-(Cpq(62)*Sq(27))-Cpq(60)*(Sq(25)+Sq(27))
        W(32)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)
        W(33)=W(25)+W(26)+W(27)+W(28)+W(29)+W(30)+W(31)
        STwo=W(16)+W(17)+W(32)+W(33)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_2_4_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(12)*Cq(0)+Cpq(17)*Cq(1)
        W(2)=-(Cpq(16)*Cq(2))+Cpq(18)*Cq(2)
        W(3)=Cpq(23)*Cq(3)-Cpq(22)*Cq(4)
        W(4)=Cpq(24)*Cq(4)+Cpq(21)*Cq(5)
        W(5)=Cpq(25)*Cq(5)+Cpq(30)*Cq(6)+Cpq(31)*Cq(7)+Cpq(28)*Cq(8)
        W(6)=Cpq(32)*Cq(8)+Cpq(33)*Cq(9)
        W(7)=Cpq(29)*(-Cq(7)+Cq(9))+Cpq(39)*Cq(11)+Cpq(36)*Cq(12)
        W(8)=Cpq(40)*Cq(12)+Cpq(41)*Cq(13)
        W(9)=Cpq(37)*(-Cq(11)+Cq(13))+Cpq(42)*Cq(14)
        W(10)=Cpq(38)*(Cq(10)+Cq(14))+Cpq(45)*Cq(17)
        W(11)=Cpq(49)*Cq(17)+Cpq(50)*Cq(18)
        W(12)=Cpq(46)*(-Cq(16)+Cq(18))+Cpq(51)*Cq(19)
        W(13)=Cpq(47)*(Cq(15)+Cq(19))+Cpq(52)*Cq(20)
        W(14)=Cpq(48)*(Cq(16)+Cq(20))+Cpq(55)*Cq(23)
        W(15)=Cpq(60)*Cq(24)+Cpq(56)*(-Cq(22)+Cq(24))+Cpq(61)*Cq(25)
        W(16)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)
        W(17)=W(8)+W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)
        W(18)=Cpq(57)*(Cq(21)+Cq(25))+Cpq(62)*Cq(26)
        W(19)=Cpq(58)*(Cq(22)+Cq(26))+Cpq(63)*Cq(27)
        W(20)=Cpq(59)*(Cq(23)+Cq(27))+Spq(16)*Sq(2)
        W(21)=Spq(18)*Sq(2)+Spq(22)*Sq(4)
        W(22)=Spq(24)*Sq(4)+Spq(25)*Sq(5)+Spq(31)*Sq(7)+Spq(32)*Sq(8)
        W(23)=Spq(33)*Sq(9)+Spq(29)*(Sq(7)+Sq(9))
        W(24)=Spq(39)*Sq(11)+Spq(40)*Sq(12)+Spq(41)*Sq(13)
        W(25)=Spq(37)*(Sq(11)+Sq(13))+Spq(38)*Sq(14)
        W(26)=Spq(42)*Sq(14)+Spq(49)*Sq(17)
        W(27)=Spq(50)*Sq(18)+Spq(46)*(Sq(16)+Sq(18))
        W(28)=Spq(47)*Sq(19)+Spq(51)*Sq(19)+Spq(52)*Sq(20)
        W(29)=Spq(48)*(Sq(16)+Sq(20))+Spq(60)*Sq(24)
        W(30)=Spq(56)*(Sq(22)+Sq(24))+Spq(57)*Sq(25)
        W(31)=Spq(61)*Sq(25)+Spq(62)*Sq(26)
        W(32)=Spq(58)*(Sq(22)+Sq(26))
        W(33)=Spq(63)*Sq(27)+Spq(59)*(Sq(23)+Sq(27))
        W(34)=W(18)+W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)
        W(35)=W(26)+W(27)+W(28)+W(29)+W(30)+W(31)+W(32)+W(33)
        CTwo=W(16)+W(17)+W(34)+W(35)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_2_4_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(12)-Cq(2)*Spq(16)
        W(2)=Cq(1)*Spq(17)+Cq(2)*Spq(18)
        W(3)=-(Cq(4)*Spq(22))+Cq(3)*Spq(23)
        W(4)=Cq(4)*Spq(24)+Cq(5)*Spq(25)
        W(5)=-((Cq(7)+Cq(9))*Spq(29))+Cq(6)*Spq(30)
        W(6)=Cq(7)*Spq(31)+Cq(8)*Spq(32)
        W(7)=Cq(9)*Spq(33)-(Cq(11)+Cq(13))*Spq(37)
        W(8)=(Cq(10)-Cq(14))*Spq(38)+Cq(11)*Spq(39)+Cq(12)*Spq(40)
        W(9)=Cq(13)*Spq(41)+Cq(14)*Spq(42)
        W(10)=-((Cq(16)+Cq(18))*Spq(46))+(Cq(15)-Cq(19))*Spq(47)
        W(11)=(Cq(16)-Cq(20))*Spq(48)+Cq(17)*Spq(49)
        W(12)=Cq(18)*Spq(50)+Cq(19)*Spq(51)
        W(13)=Cq(20)*Spq(52)-(Cq(22)+Cq(24))*Spq(56)
        W(14)=(Cq(21)-Cq(25))*Spq(57)+(Cq(22)-Cq(26))*Spq(58)
        W(15)=(Cq(23)-Cq(27))*Spq(59)+Cq(24)*Spq(60)
        W(16)=Cq(25)*Spq(61)+Cq(26)*Spq(62)+Cq(27)*Spq(63)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=-(Cpq(16)*Sq(2))-Cpq(18)*Sq(2)
        W(20)=-(Cpq(22)*Sq(4))-Cpq(24)*Sq(4)
        W(21)=Cpq(21)*Sq(5)-Cpq(25)*Sq(5)
        W(22)=-(Cpq(31)*Sq(7))+Cpq(28)*Sq(8)
        W(23)=-(Cpq(32)*Sq(8))-Cpq(33)*Sq(9)
        W(24)=Cpq(29)*(-Sq(7)+Sq(9))-Cpq(39)*Sq(11)
        W(25)=Cpq(36)*Sq(12)-Cpq(40)*Sq(12)
        W(26)=-(Cpq(41)*Sq(13))
        W(27)=Cpq(37)*(-Sq(11)+Sq(13))+Cpq(38)*Sq(14)
        W(28)=-(Cpq(42)*Sq(14))+Cpq(45)*Sq(17)
        W(29)=-(Cpq(49)*Sq(17))-Cpq(50)*Sq(18)
        W(30)=Cpq(46)*(-Sq(16)+Sq(18))+Cpq(47)*Sq(19)
        W(31)=-(Cpq(51)*Sq(19))
        W(32)=-(Cpq(52)*Sq(20))+Cpq(48)*(-Sq(16)+Sq(20))
        W(33)=Cpq(55)*Sq(23)-Cpq(60)*Sq(24)
        W(34)=Cpq(56)*(-Sq(22)+Sq(24))+Cpq(57)*Sq(25)
        W(35)=-(Cpq(61)*Sq(25))-Cpq(62)*Sq(26)
        W(36)=Cpq(58)*(-Sq(22)+Sq(26))
        W(37)=-(Cpq(63)*Sq(27))+Cpq(59)*(-Sq(23)+Sq(27))
        W(38)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(39)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)+W(37)
        STwo=W(17)+W(18)+W(38)+W(39)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_3_4_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(13)*Cq(0)+Cpq(18)*Cq(1)
        W(2)=-(Cpq(17)*Cq(2))+Cpq(19)*Cq(2)
        W(3)=Cpq(24)*Cq(3)-Cpq(23)*Cq(4)
        W(4)=Cpq(25)*Cq(4)+Cpq(22)*Cq(5)+Cpq(26)*Cq(5)
        W(5)=Cpq(31)*Cq(6)-Cpq(30)*Cq(7)
        W(6)=Cpq(32)*Cq(7)+Cpq(29)*Cq(8)+Cpq(33)*Cq(8)
        W(7)=-(Cpq(28)*Cq(9))+Cpq(34)*Cq(9)
        W(8)=Cpq(39)*Cq(10)-Cpq(38)*Cq(11)+Cpq(40)*Cq(11)
        W(9)=Cpq(41)*Cq(12)-Cpq(36)*Cq(13)
        W(10)=Cpq(42)*Cq(13)+Cpq(37)*(Cq(12)-Cq(14))
        W(11)=Cpq(43)*Cq(14)+Cpq(48)*Cq(15)
        W(12)=Cpq(49)*Cq(16)+Cpq(50)*Cq(17)-Cpq(45)*Cq(18)
        W(13)=Cpq(51)*Cq(18)+Cpq(46)*(Cq(17)-Cq(19))
        W(14)=Cpq(52)*Cq(19)+Cpq(53)*Cq(20)-Cpq(47)*(Cq(16)+Cq(20))
        W(15)=Cpq(59)*Cq(22)+Cpq(60)*Cq(23)
        W(16)=-(Cpq(55)*Cq(24))
        W(17)=Cpq(61)*Cq(24)+Cpq(56)*(Cq(23)-Cq(25))
        W(18)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(19)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)+W(17)
        W(20)=Cpq(62)*Cq(25)+Cpq(63)*Cq(26)
        W(21)=-(Cpq(57)*(Cq(22)+Cq(26)))+Cpq(58)*(Cq(21)-Cq(27))
        W(22)=Cpq(64)*Cq(27)+Spq(17)*Sq(2)
        W(23)=Spq(19)*Sq(2)+Spq(23)*Sq(4)+Spq(25)*Sq(4)
        W(24)=-(Spq(22)*Sq(5))+Spq(26)*Sq(5)
        W(25)=Spq(30)*Sq(7)+Spq(32)*Sq(7)-Spq(29)*Sq(8)
        W(26)=Spq(33)*Sq(8)+Spq(34)*Sq(9)
        W(27)=Spq(38)*Sq(11)+Spq(40)*Sq(11)+Spq(41)*Sq(12)
        W(28)=Spq(42)*Sq(13)+Spq(43)*Sq(14)
        W(29)=-(Spq(37)*(Sq(12)+Sq(14)))+Spq(49)*Sq(16)
        W(30)=Spq(50)*Sq(17)+Spq(51)*Sq(18)
        W(31)=Spq(52)*Sq(19)
        W(32)=-(Spq(46)*(Sq(17)+Sq(19)))+Spq(47)*(Sq(16)-Sq(20))
        W(33)=Spq(53)*Sq(20)+Spq(59)*Sq(22)
        W(34)=Spq(60)*Sq(23)+Spq(61)*Sq(24)+Spq(62)*Sq(25)
        W(35)=-(Spq(56)*(Sq(23)+Sq(25)))+Spq(57)*(Sq(22)-Sq(26))
        W(36)=Spq(63)*Sq(26)-Spq(58)*Sq(27)+Spq(64)*Sq(27)
        W(37)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(38)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)
        CTwo=W(18)+W(19)+W(37)+W(38)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_3_4_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(13)-Cq(2)*Spq(17)
        W(2)=Cq(1)*Spq(18)+Cq(2)*Spq(19)
        W(3)=Cq(5)*Spq(22)-Cq(4)*Spq(23)
        W(4)=Cq(3)*Spq(24)+Cq(4)*Spq(25)+Cq(5)*Spq(26)
        W(5)=Cq(8)*Spq(29)-Cq(7)*Spq(30)
        W(6)=Cq(6)*Spq(31)+Cq(7)*Spq(32)+Cq(8)*Spq(33)
        W(7)=Cq(9)*Spq(34)+(Cq(12)+Cq(14))*Spq(37)
        W(8)=-(Cq(11)*Spq(38))+Cq(10)*Spq(39)+Cq(11)*Spq(40)
        W(9)=Cq(12)*Spq(41)+Cq(13)*Spq(42)
        W(10)=Cq(14)*Spq(43)+(Cq(17)+Cq(19))*Spq(46)
        W(11)=(-Cq(16)+Cq(20))*Spq(47)+Cq(15)*Spq(48)
        W(12)=Cq(16)*Spq(49)+Cq(17)*Spq(50)+Cq(18)*Spq(51)
        W(13)=Cq(19)*Spq(52)+Cq(20)*Spq(53)
        W(14)=(Cq(23)+Cq(25))*Spq(56)
        W(15)=(-Cq(22)+Cq(26))*Spq(57)+(Cq(21)+Cq(27))*Spq(58)
        W(16)=Cq(22)*Spq(59)+Cq(23)*Spq(60)
        W(17)=Cq(24)*Spq(61)+Cq(25)*Spq(62)+Cq(26)*Spq(63)
        W(18)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(19)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)+W(17)
        W(20)=Cq(27)*Spq(64)-Cpq(17)*Sq(2)
        W(21)=-(Cpq(19)*Sq(2))-Cpq(23)*Sq(4)
        W(22)=-(Cpq(25)*Sq(4))+Cpq(22)*Sq(5)
        W(23)=-(Cpq(26)*Sq(5))-Cpq(30)*Sq(7)-Cpq(32)*Sq(7)
        W(24)=Cpq(29)*Sq(8)-Cpq(33)*Sq(8)
        W(25)=-(Cpq(28)*Sq(9))-Cpq(34)*Sq(9)-Cpq(38)*Sq(11)
        W(26)=-(Cpq(40)*Sq(11))-Cpq(41)*Sq(12)
        W(27)=-(Cpq(36)*Sq(13))
        W(28)=-(Cpq(42)*Sq(13))+Cpq(37)*(Sq(12)-Sq(14))
        W(29)=-(Cpq(43)*Sq(14))-Cpq(49)*Sq(16)
        W(30)=-(Cpq(50)*Sq(17))-Cpq(45)*Sq(18)
        W(31)=-(Cpq(51)*Sq(18))+Cpq(46)*(Sq(17)-Sq(19))
        W(32)=-(Cpq(52)*Sq(19))-Cpq(53)*Sq(20)-Cpq(47)*(Sq(16)+Sq(20))
        W(33)=-(Cpq(59)*Sq(22))-Cpq(60)*Sq(23)
        W(34)=-(Cpq(55)*Sq(24))
        W(35)=-(Cpq(61)*Sq(24))+Cpq(56)*(Sq(23)-Sq(25))
        W(36)=-(Cpq(62)*Sq(25))-Cpq(63)*Sq(26)
        W(37)=-(Cpq(57)*(Sq(22)+Sq(26)))-Cpq(58)*Sq(27)-Cpq(64)*Sq(27)
        W(38)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)+W(28)
        W(39)=W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)+W(37)
        STwo=W(18)+W(19)+W(38)+W(39)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE CTX406_4_4_C(Cp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Cp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 COne,CTwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cpq(14)*Cq(0)+Cpq(19)*Cq(1)
        W(2)=-(Cpq(18)*Cq(2))+Cpq(20)*Cq(2)+Cpq(25)*Cq(3)
        W(3)=-(Cpq(24)*Cq(4))+Cpq(26)*Cq(4)
        W(4)=Cpq(23)*Cq(5)+Cpq(27)*Cq(5)+Cpq(32)*Cq(6)
        W(5)=-(Cpq(31)*Cq(7))+Cpq(33)*Cq(7)
        W(6)=Cpq(30)*Cq(8)+Cpq(34)*Cq(8)-Cpq(29)*Cq(9)
        W(7)=Cpq(35)*Cq(9)+Cpq(40)*Cq(10)
        W(8)=-(Cpq(39)*Cq(11))+Cpq(41)*Cq(11)+Cpq(38)*Cq(12)
        W(9)=Cpq(42)*Cq(12)-Cpq(37)*Cq(13)
        W(10)=Cpq(43)*Cq(13)+Cpq(36)*Cq(14)+Cpq(44)*Cq(14)
        W(11)=Cpq(49)*Cq(15)-Cpq(48)*Cq(16)
        W(12)=Cpq(50)*Cq(16)+Cpq(47)*Cq(17)+Cpq(51)*Cq(17)
        W(13)=Cpq(52)*Cq(18)+Cpq(45)*Cq(19)
        W(14)=Cpq(53)*Cq(19)+Cpq(54)*Cq(20)+Cpq(46)*(-Cq(18)+Cq(20))
        W(15)=Cpq(59)*Cq(21)-Cpq(58)*Cq(22)+Cpq(60)*Cq(22)
        W(16)=Cpq(61)*Cq(23)+Cpq(62)*Cq(24)+Cpq(55)*Cq(25)
        W(17)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(18)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)
        W(19)=Cpq(63)*Cq(25)+Cpq(64)*Cq(26)
        W(20)=Cpq(56)*(-Cq(24)+Cq(26))
        W(21)=Cpq(65)*Cq(27)+Cpq(57)*(Cq(23)+Cq(27))
        W(22)=Spq(18)*Sq(2)+Spq(20)*Sq(2)
        W(23)=Spq(24)*Sq(4)+Spq(26)*Sq(4)-Spq(23)*Sq(5)
        W(24)=Spq(27)*Sq(5)+Spq(31)*Sq(7)
        W(25)=Spq(33)*Sq(7)-Spq(30)*Sq(8)+Spq(34)*Sq(8)
        W(26)=Spq(29)*Sq(9)+Spq(35)*Sq(9)
        W(27)=Spq(39)*Sq(11)+Spq(41)*Sq(11)-Spq(38)*Sq(12)
        W(28)=Spq(42)*Sq(12)+Spq(37)*Sq(13)
        W(29)=Spq(43)*Sq(13)+Spq(44)*Sq(14)+Spq(48)*Sq(16)
        W(30)=Spq(50)*Sq(16)-Spq(47)*Sq(17)
        W(31)=Spq(51)*Sq(17)+Spq(52)*Sq(18)+Spq(53)*Sq(19)
        W(32)=Spq(54)*Sq(20)+Spq(46)*(Sq(18)+Sq(20))
        W(33)=Spq(58)*Sq(22)+Spq(60)*Sq(22)+Spq(61)*Sq(23)
        W(34)=Spq(62)*Sq(24)+Spq(63)*Sq(25)+Spq(64)*Sq(26)
        W(35)=Spq(56)*(Sq(24)+Sq(26))
        W(36)=Spq(65)*Sq(27)+Spq(57)*(-Sq(23)+Sq(27))
        W(37)=W(19)+W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(38)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)
        CTwo=W(17)+W(18)+W(37)+W(38)
        Cp=Cp+CTwo*Two
      RETURN
      END
      SUBROUTINE CTX406_4_4_S(Sp,Cpq,Spq,Cq,Sq)
        IMPLICIT NONE
        REAL*8 Sp,Cpq(0:65),Spq(0:65),Cq(0:27),Sq(0:27)
        REAL*8 SOne,STwo,Two,W
        COMMON /CTraXScratch/ W(1000)
        PARAMETER (Two=2D0)
        W(1)=Cq(0)*Spq(14)-Cq(2)*Spq(18)
        W(2)=Cq(1)*Spq(19)+Cq(2)*Spq(20)+Cq(5)*Spq(23)
        W(3)=-(Cq(4)*Spq(24))+Cq(3)*Spq(25)
        W(4)=Cq(4)*Spq(26)+Cq(5)*Spq(27)-Cq(9)*Spq(29)
        W(5)=Cq(8)*Spq(30)-Cq(7)*Spq(31)
        W(6)=Cq(6)*Spq(32)+Cq(7)*Spq(33)+Cq(8)*Spq(34)
        W(7)=Cq(9)*Spq(35)-Cq(13)*Spq(37)
        W(8)=Cq(12)*Spq(38)-Cq(11)*Spq(39)+Cq(10)*Spq(40)
        W(9)=Cq(11)*Spq(41)+Cq(12)*Spq(42)
        W(10)=Cq(13)*Spq(43)+Cq(14)*Spq(44)-(Cq(18)+Cq(20))*Spq(46)
        W(11)=Cq(17)*Spq(47)-Cq(16)*Spq(48)
        W(12)=Cq(15)*Spq(49)+Cq(16)*Spq(50)+Cq(17)*Spq(51)
        W(13)=Cq(18)*Spq(52)+Cq(19)*Spq(53)
        W(14)=Cq(20)*Spq(54)
        W(15)=-((Cq(24)+Cq(26))*Spq(56))+(Cq(23)-Cq(27))*Spq(57)
        W(16)=-(Cq(22)*Spq(58))+Cq(21)*Spq(59)+Cq(22)*Spq(60)
        W(17)=Cq(23)*Spq(61)+Cq(24)*Spq(62)+Cq(25)*Spq(63)
        W(18)=W(1)+W(2)+W(3)+W(4)+W(5)+W(6)+W(7)+W(8)
        W(19)=W(9)+W(10)+W(11)+W(12)+W(13)+W(14)+W(15)+W(16)+W(17)
        W(20)=Cq(26)*Spq(64)+Cq(27)*Spq(65)
        W(21)=-(Cpq(18)*Sq(2))-Cpq(20)*Sq(2)-Cpq(24)*Sq(4)
        W(22)=-(Cpq(26)*Sq(4))+Cpq(23)*Sq(5)
        W(23)=-(Cpq(27)*Sq(5))-Cpq(31)*Sq(7)-Cpq(33)*Sq(7)
        W(24)=Cpq(30)*Sq(8)-Cpq(34)*Sq(8)
        W(25)=-(Cpq(29)*Sq(9))-Cpq(35)*Sq(9)-Cpq(39)*Sq(11)
        W(26)=-(Cpq(41)*Sq(11))+Cpq(38)*Sq(12)
        W(27)=-(Cpq(42)*Sq(12))-Cpq(37)*Sq(13)-Cpq(43)*Sq(13)
        W(28)=Cpq(36)*Sq(14)-Cpq(44)*Sq(14)
        W(29)=-(Cpq(48)*Sq(16))-Cpq(50)*Sq(16)+Cpq(47)*Sq(17)
        W(30)=-(Cpq(51)*Sq(17))-Cpq(52)*Sq(18)
        W(31)=Cpq(45)*Sq(19)-Cpq(53)*Sq(19)-Cpq(54)*Sq(20)
        W(32)=Cpq(46)*(-Sq(18)+Sq(20))-Cpq(58)*Sq(22)
        W(33)=-(Cpq(60)*Sq(22))-Cpq(61)*Sq(23)-Cpq(62)*Sq(24)
        W(34)=Cpq(55)*Sq(25)-Cpq(63)*Sq(25)-Cpq(64)*Sq(26)
        W(35)=Cpq(56)*(-Sq(24)+Sq(26))
        W(36)=-(Cpq(65)*Sq(27))+Cpq(57)*(Sq(23)+Sq(27))
        W(37)=W(20)+W(21)+W(22)+W(23)+W(24)+W(25)+W(26)+W(27)
        W(38)=W(28)+W(29)+W(30)+W(31)+W(32)+W(33)+W(34)+W(35)+W(36)
        STwo=W(18)+W(19)+W(37)+W(38)
        Sp=Sp+STwo*Two
      RETURN
      END
      SUBROUTINE IrRegular406(PQx,PQy,PQz,Cpq,Spq)
         IMPLICIT NONE
         REAL*8 Cpq(0:65),Spq(0:65),LegendreP(0:65)
         REAL*8 Sine(0:10),Cosine(0:10),CoFact(2:10)
         REAL*8 PQx,PQy,PQz,PQ2,pqx2,pqy2,pqxy,PQ
         REAL*8 Zero,One,Two,TT,TwoC,OneOvPQ
         REAL*8 CoTan,OneOvPQxy,RS,SQ,PQToThMnsL
         PARAMETER (Two=2D0,One=1D0,Zero=0D0)
         PQx2=PQx*PQx
         PQy2=PQy*PQy
         PQ=DSQRT(PQx2+PQy2+PQz*PQz)
         OneOvPQ=One/PQ
         CoTan=PQz*OneOvPQ
!        Compute Cosine and Sine by recursion
         Sine(0)  =Zero
         Cosine(0)=One
         PQxy=DSQRT(PQx2+PQy2)
         IF(PQxy/=Zero)THEN
            OneOvPQxy=One/PQxy
            Sine(1)  =PQx*OneOvPQxy
            Cosine(1)=PQy*OneOvPQxy
         ELSE
            Sine(1)  =0.70710678118654752D0
            Cosine(1)=0.70710678118654752D0
         ENDIF
         TwoC=Two*Cosine(1)
         Sine(2)=TwoC*Sine(1)-Sine(0)
         Cosine(2)=TwoC*Cosine(1)-Cosine(0)
         Sine(3)=TwoC*Sine(2)-Sine(1)
         Cosine(3)=TwoC*Cosine(2)-Cosine(1)
         Sine(4)=TwoC*Sine(3)-Sine(2)
         Cosine(4)=TwoC*Cosine(3)-Cosine(2)
         Sine(5)=TwoC*Sine(4)-Sine(3)
         Cosine(5)=TwoC*Cosine(4)-Cosine(3)
         Sine(6)=TwoC*Sine(5)-Sine(4)
         Cosine(6)=TwoC*Cosine(5)-Cosine(4)
         Sine(7)=TwoC*Sine(6)-Sine(5)
         Cosine(7)=TwoC*Cosine(6)-Cosine(5)
         Sine(8)=TwoC*Sine(7)-Sine(6)
         Cosine(8)=TwoC*Cosine(7)-Cosine(6)
         Sine(9)=TwoC*Sine(8)-Sine(7)
         Cosine(9)=TwoC*Cosine(8)-Cosine(7)
         Sine(10)=TwoC*Sine(9)-Sine(8)
         Cosine(10)=TwoC*Cosine(9)-Cosine(8)
!        ----------------------------------------------------------------
!        Associated Legendre Polynomials by recursion
!
!        M=0,Ell; Compute LegendreP(M,M)
         RS=One
         Sq=SQRT(ABS(One-CoTan**2))
         LegendreP(0)=+1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(2)=-1.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(5)=+3.000000000000000D+00*RS
         RS=RS*Sq
         LegendreP(9)=-1.500000000000000D+01*RS
         RS=RS*Sq
         LegendreP(14)=+1.050000000000000D+02*RS
         RS=RS*Sq
         LegendreP(20)=-9.450000000000000D+02*RS
         RS=RS*Sq
         LegendreP(27)=+1.039500000000000D+04*RS
         RS=RS*Sq
         LegendreP(35)=-1.351350000000000D+05*RS
         RS=RS*Sq
         LegendreP(44)=+2.027025000000000D+06*RS
         RS=RS*Sq
         LegendreP(54)=-3.445942500000000D+07*RS
         RS=RS*Sq
         LegendreP(65)=+6.547290750000000D+08*RS
!        ----------------------------------------------------------------
!        M=0,Ell-1; Compute LegendreP(M+1,M)
         LegendreP(1)=+1.000000000000000D+00*CoTan*LegendreP(0)
         LegendreP(4)=+3.000000000000000D+00*CoTan*LegendreP(2)
         LegendreP(8)=+5.000000000000000D+00*CoTan*LegendreP(5)
         LegendreP(13)=+7.000000000000000D+00*CoTan*LegendreP(9)
         LegendreP(19)=+9.000000000000000D+00*CoTan*LegendreP(14)
         LegendreP(26)=+1.100000000000000D+01*CoTan*LegendreP(20)
         LegendreP(34)=+1.300000000000000D+01*CoTan*LegendreP(27)
         LegendreP(43)=+1.500000000000000D+01*CoTan*LegendreP(35)
         LegendreP(53)=+1.700000000000000D+01*CoTan*LegendreP(44)
         LegendreP(64)=+1.900000000000000D+01*CoTan*LegendreP(54)
!        ----------------------------------------------------------------
         CoFact(2)=+3.000000000000000D+00*CoTan
         CoFact(3)=+5.000000000000000D+00*CoTan
         CoFact(4)=+7.000000000000000D+00*CoTan
         CoFact(5)=+9.000000000000000D+00*CoTan
         CoFact(6)=+1.100000000000000D+01*CoTan
         CoFact(7)=+1.300000000000000D+01*CoTan
         CoFact(8)=+1.500000000000000D+01*CoTan
         CoFact(9)=+1.700000000000000D+01*CoTan
         CoFact(10)=+1.900000000000000D+01*CoTan
!        ----------------------------------------------------------------
!        M=0,Ell-2; L=M+2,Ell; Compute LegendreP(L,M)
         LegendreP(3)=CoFact(2)*LegendreP(1)-1.000000000000000D+00*LegendreP(0)
         LegendreP(6)=CoFact(3)*LegendreP(3)-4.000000000000000D+00*LegendreP(1)
         LegendreP(10)=CoFact(4)*LegendreP(6)-9.000000000000000D+00*LegendreP(3)
         LegendreP(15)=CoFact(5)*LegendreP(10)-1.600000000000000D+01*LegendreP(6)
         LegendreP(21)=CoFact(6)*LegendreP(15)-2.500000000000000D+01*LegendreP(10)
         LegendreP(28)=CoFact(7)*LegendreP(21)-3.600000000000000D+01*LegendreP(15)
         LegendreP(36)=CoFact(8)*LegendreP(28)-4.900000000000000D+01*LegendreP(21)
         LegendreP(45)=CoFact(9)*LegendreP(36)-6.400000000000000D+01*LegendreP(28)
         LegendreP(55)=CoFact(10)*LegendreP(45)-8.100000000000000D+01*LegendreP(36)
         LegendreP(7)=CoFact(3)*LegendreP(4)-3.000000000000000D+00*LegendreP(2)
         LegendreP(11)=CoFact(4)*LegendreP(7)-8.000000000000000D+00*LegendreP(4)
         LegendreP(16)=CoFact(5)*LegendreP(11)-1.500000000000000D+01*LegendreP(7)
         LegendreP(22)=CoFact(6)*LegendreP(16)-2.400000000000000D+01*LegendreP(11)
         LegendreP(29)=CoFact(7)*LegendreP(22)-3.500000000000000D+01*LegendreP(16)
         LegendreP(37)=CoFact(8)*LegendreP(29)-4.800000000000000D+01*LegendreP(22)
         LegendreP(46)=CoFact(9)*LegendreP(37)-6.300000000000000D+01*LegendreP(29)
         LegendreP(56)=CoFact(10)*LegendreP(46)-8.000000000000000D+01*LegendreP(37)
         LegendreP(12)=CoFact(4)*LegendreP(8)-5.000000000000000D+00*LegendreP(5)
         LegendreP(17)=CoFact(5)*LegendreP(12)-1.200000000000000D+01*LegendreP(8)
         LegendreP(23)=CoFact(6)*LegendreP(17)-2.100000000000000D+01*LegendreP(12)
         LegendreP(30)=CoFact(7)*LegendreP(23)-3.200000000000000D+01*LegendreP(17)
         LegendreP(38)=CoFact(8)*LegendreP(30)-4.500000000000000D+01*LegendreP(23)
         LegendreP(47)=CoFact(9)*LegendreP(38)-6.000000000000000D+01*LegendreP(30)
         LegendreP(57)=CoFact(10)*LegendreP(47)-7.700000000000000D+01*LegendreP(38)
         LegendreP(18)=CoFact(5)*LegendreP(13)-7.000000000000000D+00*LegendreP(9)
         LegendreP(24)=CoFact(6)*LegendreP(18)-1.600000000000000D+01*LegendreP(13)
         LegendreP(31)=CoFact(7)*LegendreP(24)-2.700000000000000D+01*LegendreP(18)
         LegendreP(39)=CoFact(8)*LegendreP(31)-4.000000000000000D+01*LegendreP(24)
         LegendreP(48)=CoFact(9)*LegendreP(39)-5.500000000000000D+01*LegendreP(31)
         LegendreP(58)=CoFact(10)*LegendreP(48)-7.200000000000000D+01*LegendreP(39)
         LegendreP(25)=CoFact(6)*LegendreP(19)-9.000000000000000D+00*LegendreP(14)
         LegendreP(32)=CoFact(7)*LegendreP(25)-2.000000000000000D+01*LegendreP(19)
         LegendreP(40)=CoFact(8)*LegendreP(32)-3.300000000000000D+01*LegendreP(25)
         LegendreP(49)=CoFact(9)*LegendreP(40)-4.800000000000000D+01*LegendreP(32)
         LegendreP(59)=CoFact(10)*LegendreP(49)-6.500000000000000D+01*LegendreP(40)
         LegendreP(33)=CoFact(7)*LegendreP(26)-1.100000000000000D+01*LegendreP(20)
         LegendreP(41)=CoFact(8)*LegendreP(33)-2.400000000000000D+01*LegendreP(26)
         LegendreP(50)=CoFact(9)*LegendreP(41)-3.900000000000000D+01*LegendreP(33)
         LegendreP(60)=CoFact(10)*LegendreP(50)-5.600000000000000D+01*LegendreP(41)
         LegendreP(42)=CoFact(8)*LegendreP(34)-1.300000000000000D+01*LegendreP(27)
         LegendreP(51)=CoFact(9)*LegendreP(42)-2.800000000000000D+01*LegendreP(34)
         LegendreP(61)=CoFact(10)*LegendreP(51)-4.500000000000000D+01*LegendreP(42)
         LegendreP(52)=CoFact(9)*LegendreP(43)-1.500000000000000D+01*LegendreP(35)
         LegendreP(62)=CoFact(10)*LegendreP(52)-3.200000000000000D+01*LegendreP(43)
         LegendreP(63)=CoFact(10)*LegendreP(53)-1.700000000000000D+01*LegendreP(44)
!        ----------------------------------------------------------------
!        Compute Cpq(L,M) and Spq(L,M)
         PQToThMnsL=OneOvPQ
         TT=PQToThMnsL*LegendreP(0)
         Spq(0)=TT*Sine(0)
         Cpq(0)=TT*Cosine(0)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(1)
         Spq(1)=TT*Sine(0)
         Cpq(1)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(2)
         Spq(2)=TT*Sine(1)
         Cpq(2)=TT*Cosine(1)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(3)
         Spq(3)=TT*Sine(0)
         Cpq(3)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(4)
         Spq(4)=TT*Sine(1)
         Cpq(4)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(5)
         Spq(5)=TT*Sine(2)
         Cpq(5)=TT*Cosine(2)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(6)
         Spq(6)=TT*Sine(0)
         Cpq(6)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(7)
         Spq(7)=TT*Sine(1)
         Cpq(7)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(8)
         Spq(8)=TT*Sine(2)
         Cpq(8)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(9)
         Spq(9)=TT*Sine(3)
         Cpq(9)=TT*Cosine(3)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(10)
         Spq(10)=TT*Sine(0)
         Cpq(10)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(11)
         Spq(11)=TT*Sine(1)
         Cpq(11)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(12)
         Spq(12)=TT*Sine(2)
         Cpq(12)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(13)
         Spq(13)=TT*Sine(3)
         Cpq(13)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(14)
         Spq(14)=TT*Sine(4)
         Cpq(14)=TT*Cosine(4)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(15)
         Spq(15)=TT*Sine(0)
         Cpq(15)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(16)
         Spq(16)=TT*Sine(1)
         Cpq(16)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(17)
         Spq(17)=TT*Sine(2)
         Cpq(17)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(18)
         Spq(18)=TT*Sine(3)
         Cpq(18)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(19)
         Spq(19)=TT*Sine(4)
         Cpq(19)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(20)
         Spq(20)=TT*Sine(5)
         Cpq(20)=TT*Cosine(5)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(21)
         Spq(21)=TT*Sine(0)
         Cpq(21)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(22)
         Spq(22)=TT*Sine(1)
         Cpq(22)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(23)
         Spq(23)=TT*Sine(2)
         Cpq(23)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(24)
         Spq(24)=TT*Sine(3)
         Cpq(24)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(25)
         Spq(25)=TT*Sine(4)
         Cpq(25)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(26)
         Spq(26)=TT*Sine(5)
         Cpq(26)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(27)
         Spq(27)=TT*Sine(6)
         Cpq(27)=TT*Cosine(6)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(28)
         Spq(28)=TT*Sine(0)
         Cpq(28)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(29)
         Spq(29)=TT*Sine(1)
         Cpq(29)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(30)
         Spq(30)=TT*Sine(2)
         Cpq(30)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(31)
         Spq(31)=TT*Sine(3)
         Cpq(31)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(32)
         Spq(32)=TT*Sine(4)
         Cpq(32)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(33)
         Spq(33)=TT*Sine(5)
         Cpq(33)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(34)
         Spq(34)=TT*Sine(6)
         Cpq(34)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(35)
         Spq(35)=TT*Sine(7)
         Cpq(35)=TT*Cosine(7)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(36)
         Spq(36)=TT*Sine(0)
         Cpq(36)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(37)
         Spq(37)=TT*Sine(1)
         Cpq(37)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(38)
         Spq(38)=TT*Sine(2)
         Cpq(38)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(39)
         Spq(39)=TT*Sine(3)
         Cpq(39)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(40)
         Spq(40)=TT*Sine(4)
         Cpq(40)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(41)
         Spq(41)=TT*Sine(5)
         Cpq(41)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(42)
         Spq(42)=TT*Sine(6)
         Cpq(42)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(43)
         Spq(43)=TT*Sine(7)
         Cpq(43)=TT*Cosine(7)
         TT=PQToThMnsL*LegendreP(44)
         Spq(44)=TT*Sine(8)
         Cpq(44)=TT*Cosine(8)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(45)
         Spq(45)=TT*Sine(0)
         Cpq(45)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(46)
         Spq(46)=TT*Sine(1)
         Cpq(46)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(47)
         Spq(47)=TT*Sine(2)
         Cpq(47)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(48)
         Spq(48)=TT*Sine(3)
         Cpq(48)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(49)
         Spq(49)=TT*Sine(4)
         Cpq(49)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(50)
         Spq(50)=TT*Sine(5)
         Cpq(50)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(51)
         Spq(51)=TT*Sine(6)
         Cpq(51)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(52)
         Spq(52)=TT*Sine(7)
         Cpq(52)=TT*Cosine(7)
         TT=PQToThMnsL*LegendreP(53)
         Spq(53)=TT*Sine(8)
         Cpq(53)=TT*Cosine(8)
         TT=PQToThMnsL*LegendreP(54)
         Spq(54)=TT*Sine(9)
         Cpq(54)=TT*Cosine(9)
         PQToThMnsL=PQToThMnsL*OneOvPQ
         TT=PQToThMnsL*LegendreP(55)
         Spq(55)=TT*Sine(0)
         Cpq(55)=TT*Cosine(0)
         TT=PQToThMnsL*LegendreP(56)
         Spq(56)=TT*Sine(1)
         Cpq(56)=TT*Cosine(1)
         TT=PQToThMnsL*LegendreP(57)
         Spq(57)=TT*Sine(2)
         Cpq(57)=TT*Cosine(2)
         TT=PQToThMnsL*LegendreP(58)
         Spq(58)=TT*Sine(3)
         Cpq(58)=TT*Cosine(3)
         TT=PQToThMnsL*LegendreP(59)
         Spq(59)=TT*Sine(4)
         Cpq(59)=TT*Cosine(4)
         TT=PQToThMnsL*LegendreP(60)
         Spq(60)=TT*Sine(5)
         Cpq(60)=TT*Cosine(5)
         TT=PQToThMnsL*LegendreP(61)
         Spq(61)=TT*Sine(6)
         Cpq(61)=TT*Cosine(6)
         TT=PQToThMnsL*LegendreP(62)
         Spq(62)=TT*Sine(7)
         Cpq(62)=TT*Cosine(7)
         TT=PQToThMnsL*LegendreP(63)
         Spq(63)=TT*Sine(8)
         Cpq(63)=TT*Cosine(8)
         TT=PQToThMnsL*LegendreP(64)
         Spq(64)=TT*Sine(9)
         Cpq(64)=TT*Cosine(9)
         TT=PQToThMnsL*LegendreP(65)
         Spq(65)=TT*Sine(10)
         Cpq(65)=TT*Cosine(10)
      RETURN
      END
      SUBROUTINE CTraX406(PQx,PQy,PQz,Cq,Sq,Cp,Sp)
         IMPLICIT NONE
         REAL*8 PQx,PQy,PQz
         REAL*8 Cq(0:27),Sq(0:27),Cp(0:14),Sp(0:14)
         REAL*8 Cpq(0:65),Spq(0:65)
         CALL IrRegular406(PQx,PQy,PQz,Cpq,Spq)
         CALL CTX406_0_0_C(Cp(0),Cpq,Spq,Cq,Sq)
         CALL CTX406_0_1_C(Cp(1),Cpq,Spq,Cq,Sq)
         CALL CTX406_1_1_C(Cp(2),Cpq,Spq,Cq,Sq)
         CALL CTX406_1_1_S(Sp(2),Cpq,Spq,Cq,Sq)
         CALL CTX406_0_2_C(Cp(3),Cpq,Spq,Cq,Sq)
         CALL CTX406_1_2_C(Cp(4),Cpq,Spq,Cq,Sq)
         CALL CTX406_1_2_S(Sp(4),Cpq,Spq,Cq,Sq)
         CALL CTX406_2_2_C(Cp(5),Cpq,Spq,Cq,Sq)
         CALL CTX406_2_2_S(Sp(5),Cpq,Spq,Cq,Sq)
         CALL CTX406_0_3_C(Cp(6),Cpq,Spq,Cq,Sq)
         CALL CTX406_1_3_C(Cp(7),Cpq,Spq,Cq,Sq)
         CALL CTX406_1_3_S(Sp(7),Cpq,Spq,Cq,Sq)
         CALL CTX406_2_3_C(Cp(8),Cpq,Spq,Cq,Sq)
         CALL CTX406_2_3_S(Sp(8),Cpq,Spq,Cq,Sq)
         CALL CTX406_3_3_C(Cp(9),Cpq,Spq,Cq,Sq)
         CALL CTX406_3_3_S(Sp(9),Cpq,Spq,Cq,Sq)
         CALL CTX406_0_4_C(Cp(10),Cpq,Spq,Cq,Sq)
         CALL CTX406_1_4_C(Cp(11),Cpq,Spq,Cq,Sq)
         CALL CTX406_1_4_S(Sp(11),Cpq,Spq,Cq,Sq)
         CALL CTX406_2_4_C(Cp(12),Cpq,Spq,Cq,Sq)
         CALL CTX406_2_4_S(Sp(12),Cpq,Spq,Cq,Sq)
         CALL CTX406_3_4_C(Cp(13),Cpq,Spq,Cq,Sq)
         CALL CTX406_3_4_S(Sp(13),Cpq,Spq,Cq,Sq)
         CALL CTX406_4_4_C(Cp(14),Cpq,Spq,Cq,Sq)
         CALL CTX406_4_4_S(Sp(14),Cpq,Spq,Cq,Sq)
      RETURN
      END
