MODULE PBlokGuess
   USE DerivedTypes
   USE GlobalScalars
   USE Parse
   USE PrettyPrint
   USE LinAlg
   USE MatFunk
   IMPLICIT NONE
   CONTAINS
   SUBROUTINE FillPBlok(N,K,PBlok)
      INTEGER,                    INTENT(IN)  :: N,K
      REAL(DOUBLE),DIMENSION(N,N),INTENT(OUT) :: PBlok
      REAL(DOUBLE),DIMENSION(50,104)          :: AvP
      INTEGER                                 :: I,J     
!------------------------------------------------------
!     Consistency check ...
!
      IF(K>29)CALL Halt(' Add parameters for Z = '  &
              //TRIM(IntToChar(K))//' in FillPBlok ')
!------------------------------------------------------
!     H
!
      AvP(1,1)=1.D0/2.D0
!--------------------------------------
!     He
!
      AvP(1,2)=1.0D0
!--------------------------------------
!     Li
!
      AvP(1,3)=1.0D0
      AvP(2,3)=1.0D0/8.0D0      
      AvP(3,3)=1.0D0/8.0D0      
      AvP(4,3)=1.0D0/8.0D0      
      AvP(5,3)=1.0D0/8.0D0      
!--------------------------------------
!     Be
!
      AvP(1,4)=1.0D0
      AvP(2,4)=1.0D0/2.0D0      
      AvP(3,4)=1.0D0/6.0D0      
      AvP(4,4)=1.0D0/6.0D0      
      AvP(5,4)=1.0D0/6.0D0      
!---------------------------------------
!     B
!
      AvP(1,5)=1.0D0
      AvP(2,5)=1.0D0/2.0D0      
      AvP(3,5)=1.0D0/3.0D0      
      AvP(4,5)=1.0D0/3.0D0      
      AvP(5,5)=1.0D0/3.0D0      
!--------------------------------------
!     C Z=6 C [1s2 2s2 2p2] 3P  
!
      AvP(1,6)=1.0D0
      AvP(2,6)=1.0D0
      AvP(3,6)=1.0D0/3.0D0      
      AvP(4,6)=1.0D0/3.0D0      
      AvP(5,6)=1.0D0/3.0D0      
!--------------------------------------
!     N Z=7 N [1s2 2s2 2p3] 4S
!
      AvP(1,7)=1.0D0
      AvP(2,7)=1.0D0
      AvP(3,7)=1.0D0/2.0D0      
      AvP(4,7)=1.0D0/2.0D0      
      AvP(5,7)=1.0D0/2.0D0      
!--------------------------------------
!     O Z=8 O [1s2 2s2 2p4] 3P
!
      AvP(1,8)=1.0D0
      AvP(2,8)=1.0D0
      AvP(3,8)=2.0D0/3.0D0
      AvP(4,8)=2.0D0/3.0D0
      AvP(5,8)=2.0D0/3.0D0
!------------------------------------
!     F
!
      AvP(1,9)=1.0D0
      AvP(2,9)=1.0D0
      AvP(3,9)=5.0D0/6.0D0      
      AvP(4,9)=5.0D0/6.0D0      
      AvP(5,9)=5.0D0/6.0D0      
!------------------------------------
!     Ne
!
      AvP(1,10)=1.0D0
      AvP(2,10)=1.0D0
      AvP(3,10)=1.0D0
      AvP(4,10)=1.0D0
      AvP(5,10)=1.0D0
!------------------------------------
!     Na
!
      AvP(1,11)=1.0D0
      AvP(2,11)=1.0D0
      AvP(3,11)=1.0D0
      AvP(4,11)=1.0D0
      AvP(5,11)=1.0D0
      AvP(6,11)=0.5D0
      AvP(7,11)=0.0D0
      AvP(8,11)=0.0D0
      AvP(9,11)=0.0D0
!------------------------------------
!     Mg
!
      AvP(1,12)=1.0D0
      AvP(2,12)=1.0D0
      AvP(3,12)=1.0D0
      AvP(4,12)=1.0D0
      AvP(5,12)=1.0D0
      AvP(6,12)=1.0D0/2.0D0      ! 3s
      AvP(7,12)=1.0D0/6.0D0      ! 3p     
      AvP(8,12)=1.0D0/6.0D0      ! 3p
      AvP(9,12)=1.0D0/6.0D0      ! 3p
!------------------------------------------
!     Al
!
      AvP(1,13)=1.0D0
      AvP(2,13)=1.0D0
      AvP(3,13)=1.0D0
      AvP(4,13)=1.0D0
      AvP(5,13)=1.0D0
      AvP(6,13)=1.0D0/2.0D0   ! 3s
      AvP(7,13)=1.0D0/3.0D0   ! 3p
      AvP(8,13)=1.0D0/3.0D0   ! 3p
      AvP(9,13)=1.0D0/3.0D0   ! 3p
!------------------------------------------
!     Si
!
      AvP(1,14)=1.0D0         ! 1s 
      AvP(2,14)=1.0D0         ! 2s
      AvP(3,14)=1.0D0         ! 2p
      AvP(4,14)=1.0D0         ! 2p
      AvP(5,14)=1.0D0         ! 2p
      AvP(6,14)=1.0D0/2.0D0   ! 3s
      AvP(7,14)=1.0D0/2.0D0   ! 3p
      AvP(8,14)=1.0D0/2.0D0   ! 3p
      AvP(9,14)=1.0D0/2.0D0   ! 3p
!------------------------------------------
!     P
!
      AvP(1,15)=1.0D0
      AvP(2,15)=1.0D0
      AvP(3,15)=1.0D0
      AvP(4,15)=1.0D0
      AvP(5,15)=1.0D0
      AvP(6,15)=1.0D0         ! 3s
      AvP(7,15)=1.0D0/2.0D0   ! 3p
      AvP(8,15)=1.0D0/2.0D0   ! 3p
      AvP(9,15)=1.0D0/2.0D0   ! 3p
!-----------------------------------------
!     S Z=16 S [1s2 2s2 2p6 3s2 3p4] 3P  
!
      AvP(1,16)=1.0D0         ! 1s
      AvP(2,16)=1.0D0         ! 2s
      AvP(3,16)=1.0D0         ! 2p
      AvP(4,16)=1.0D0         ! 2p
      AvP(5,16)=1.0D0         ! 2p
      AvP(6,16)=1.0D0         ! 3s
      AvP(7,16)=2.0D0/3.0D0   ! 3p
      AvP(8,16)=2.0D0/3.0D0   ! 3p
      AvP(9,16)=2.0D0/3.0D0   ! 3p
!-----------------------------------------
!     Cl Z=17 S [1s2 2s2 2p6 3s2 3p5] 3P  
!
      AvP(1,17)=1.0D0         ! 1s
      AvP(2,17)=1.0D0         ! 2s
      AvP(3,17)=1.0D0         ! 2p
      AvP(4,17)=1.0D0         ! 2p
      AvP(5,17)=1.0D0         ! 2p
      AvP(6,17)=1.0D0         ! 3s
      AvP(7,17)=5.0D0/6.0D0   ! 3p
      AvP(8,17)=5.0D0/6.0D0   ! 3p
      AvP(9,17)=5.0D0/6.0D0   ! 3p
!-----------------------------------------
!     Ar Z=18 S [1s2 2s2 2p6 3s2 3p6] 3P  
!
      AvP(1,18)=1.0D0         ! 1s
      AvP(2,18)=1.0D0         ! 2s
      AvP(3,18)=1.0D0         ! 2p
      AvP(4,18)=1.0D0         ! 2p
      AvP(5,18)=1.0D0         ! 2p
      AvP(6,18)=1.0D0         ! 3s
      AvP(7,18)=1.0D0         ! 3p
      AvP(8,18)=1.0D0         ! 3p
      AvP(9,18)=1.0D0         ! 3p
!-----------------------------------------
!     Ti Z=22 S [1s2 2s2 2p6 3s2 3p6 4s2 3d2 ] 4P  
!
      AvP(1,22)=1.0D0          ! 1s   2
      AvP(2,22)=1.0D0          ! 2s   2
      AvP(3,22)=1.0D0          ! 2p
      AvP(4,22)=1.0D0          ! 2p   6
      AvP(5,22)=1.0D0          ! 2p
      AvP(6,22)=1.0D0          ! 3s   2
      AvP(7,22)=1.0D0          ! 3p
      AvP(8,22)=1.0D0          ! 3p   6
      AvP(9,22)=1.0D0          ! 3p
      AvP(10,22)=1.0D0/6.0D0   ! 3d2
      AvP(11,22)=1.0D0/6.0D0   ! 3d2
      AvP(12,22)=1.0D0/6.0D0   ! 3d2
      AvP(13,22)=1.0D0/6.0D0   ! 3d2  2
      AvP(14,22)=1.0D0/6.0D0   ! 3d2
      AvP(15,22)=1.0D0/6.0D0   ! 3d2
      AvP(16,22)=1.0D0         ! 4s2  2
      AvP(17,22)=0.0D0         ! 4p6
      AvP(18,22)=0.0D0         ! 4p6  0
      AvP(19,22)=0.0D0         ! 46p
!-----------------------------------------
!     Cr Z=24 S [1s2 2s2 2p6 3s2 3p6 4s1 3d5 ] 4P0  
!
      AvP(1,24)=1.0D0          ! 1s   2
      AvP(2,24)=1.0D0          ! 2s   2
      AvP(3,24)=1.0D0          ! 2p
      AvP(4,24)=1.0D0          ! 2p   6
      AvP(5,24)=1.0D0          ! 2p
      AvP(6,24)=1.0D0          ! 3s   2
      AvP(7,24)=1.0D0          ! 3p
      AvP(8,24)=1.0D0          ! 3p   6
      AvP(9,24)=1.0D0          ! 3p
      AvP(10,24)=5.0D0/12.0D0  ! 3d5
      AvP(11,24)=5.0D0/12.0D0  ! 3d5
      AvP(12,24)=5.0D0/12.0D0  ! 3d5
      AvP(13,24)=5.0D0/12.0D0  ! 3d5  5
      AvP(14,24)=5.0D0/12.0D0  ! 3d5
      AvP(15,24)=5.0D0/12.0D0  ! 3d5
      AvP(16,24)=1.0D0/2.0D0   ! 4s1  1
      AvP(17,24)=0.0D0         ! 4p0
      AvP(18,24)=0.0D0         ! 4p0  0
      AvP(19,24)=0.0D0         ! 4p0
!-----------------------------------------
!     Fe Z=26 S [1s2 2s2 2p6 3s2 3p6 3d6 4s2] 4p0
!
      AvP(1 ,26)=1.0D0         ! 1s2   2
      AvP(2 ,26)=1.0D0         ! 2s2
      AvP(3 ,26)=1.0D0         ! 2p6
      AvP(4 ,26)=1.0D0         ! 2p6   8
      AvP(5 ,26)=1.0D0         ! 2p6
      AvP(6 ,26)=1.0D0         ! 3s2
      AvP(7 ,26)=1.0D0         ! 3p6
      AvP(8 ,26)=1.0D0         ! 3p6   8
      AvP(9 ,26)=1.0D0         ! 3p6
      AvP(10,26)=1.0D0/2.0D0   ! 3d6
      AvP(11,26)=1.0D0/2.0D0   ! 3d6
      AvP(12,26)=1.0D0/2.0D0   ! 3d6
      AvP(13,26)=1.0D0/2.0D0   ! 3d6   6
      AvP(14,26)=1.0D0/2.0D0   ! 3d6
      AvP(15,26)=1.0D0/2.0D0   ! 3d6
      AvP(16,26)=1.0D0         ! 4s2   2
      AvP(17,26)=0.0D0         ! 4p0
      AvP(18,26)=0.0D0         ! 4p0   0
      AvP(19,26)=0.0D0         ! 4p0
!-----------------------------------------
!     Cu Z=29 S [1s2 2s2 2p6 3s2 3p6 3d6 4s2 4p1]
!
      AvP(1 ,29)=1.0D0         ! 1s2  2
      AvP(2 ,29)=1.0D0         ! 2s2
      AvP(3 ,29)=1.0D0         ! 2p2
      AvP(4 ,29)=1.0D0         ! 2p2  8
      AvP(5 ,29)=1.0D0         ! 2p2
      AvP(6 ,29)=1.0D0         ! 3s2
      AvP(7 ,29)=1.0D0         ! 3p2
      AvP(8 ,29)=1.0D0         ! 3p2  8
      AvP(9 ,29)=1.0D0         ! 3p2
      AvP(10,29)=2.0D0/3.0D0   ! 3d10
      AvP(11,29)=2.0D0/3.0D0   ! 3d10
      AvP(12,29)=2.0D0/3.0D0   ! 3d10
      AvP(13,29)=2.0D0/3.0D0   ! 3d10 8 
      AvP(14,29)=2.0D0/3.0D0   ! 3d10
      AvP(15,29)=2.0D0/3.0D0   ! 3d10
      AvP(16,29)=1.0D0         ! 4s2  2
      AvP(17,29)=1.0D0/6.0D0   ! 4p6
      AvP(18,29)=1.0D0/6.0D0   ! 4p6  1
      AvP(19,29)=1.0D0/6.0D0   ! 4p6
!-----------------------------------------
!     Zn Z=30 S [1s2 2s2 2p6 3s2 3p6 3d6 4s2 4p2]
!
      AvP(1 ,29)=1.0D0         ! 1s2  
      AvP(2 ,29)=1.0D0         ! 2s2
      AvP(3 ,29)=1.0D0         ! 2p2
      AvP(4 ,29)=1.0D0         ! 2p2  
      AvP(5 ,29)=1.0D0         ! 2p2
      AvP(6 ,29)=1.0D0         ! 3s2
      AvP(7 ,29)=1.0D0         ! 3p2
      AvP(8 ,29)=1.0D0         ! 3p2  
      AvP(9 ,29)=1.0D0         ! 3p2
      AvP(10,29)=2.0D0/3.0D0   ! 3d10
      AvP(11,29)=2.0D0/3.0D0   ! 3d10
      AvP(12,29)=2.0D0/3.0D0   ! 3d10
      AvP(13,29)=2.0D0/3.0D0   ! 3d10  
      AvP(14,29)=2.0D0/3.0D0   ! 3d10
      AvP(15,29)=2.0D0/3.0D0   ! 3d10
      AvP(16,29)=1.0D0         ! 4s2  
      AvP(17,29)=1.0D0/3.0D0   ! 4p6
      AvP(18,29)=1.0D0/3.0D0   ! 4p6  
      AvP(19,29)=1.0D0/3.0D0   ! 4p6
!-----------------------------------------
!
!

      PBlok=Zero
      DO I=1,N
         PBlok(I,I)=AvP(I,K)
      ENDDO
   END SUBROUTINE FillPBlok
END MODULE
