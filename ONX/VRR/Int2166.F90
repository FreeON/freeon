SUBROUTINE Int2166(N,IntCode,CBra,CKet,DisBufB,PrmBufB,DB,IB,SB,C,U,PBC)
 USE DerivedTypes
 USE GlobalScalars
 USE PrettyPrint
 USE InvExp
 INCLUDE "Int2166.Inc"
 REAL(DOUBLE)  :: Cx,Cy,Cz
 REAL(DOUBLE)  :: Zeta,Up,Px,Py,Pz,cp1,cp2,cp3
 REAL(DOUBLE)  :: Eta, Uq,Qx,Qy,Qz,cq1,cq2,cq3
 REAL(DOUBLE)  :: EtaQx,EtaQy,EtaQz
 REAL(DOUBLE)  :: r1xZpE,ZpE,Rkk,r1xZ,r1x2Z,rpxZ
 REAL(DOUBLE)  :: PAx,PAy,PAz,PQx,PQy,PQz
 REAL(DOUBLE)  :: QBx,QBy,QBz,WQx,WQy,WQz
 REAL(DOUBLE)  :: WPx,WPy,WPz,Wx,Wy,Wz
 REAL(DOUBLE)  :: T1,T2,T3,T4,TwoT
 REAL(DOUBLE)  :: R1,R2,R3,R4,R5,R6,R7,R8,R9
 REAL(DOUBLE)  :: G0,G1,G2,G3,G4,G5,G6,G7,G8,ET
 REAL(DOUBLE)  :: Ts0,Ts1,r1xE,r1x2E,rpxE,r1x2ZE
 INTEGER       :: I,J,K,ME,MG,l
 INTEGER       :: I0,I1,I2
!------------------------------------
! Periodic Variables
!------------------------------------
 TYPE(PBCInfo) :: PBC
 REAL(DOUBLE)  :: FPQx,FPQy,FPQz
 IF(N.EQ.0) RETURN
 C=0.0D0
 Cx=DisBufB( 8)
 Cy=DisBufB( 9)
 Cz=DisBufB(10)
 IF(IntCode.EQ. 2010606) THEN
 DO I=1,N
 I0 = SB%SLPrm%I(I)
 I2 = SB%SLDis%I(I)-4
 DO J=1,CKet
 I1=I0+(J-1)*DB%MAXP
 Eta = DB%PrmBuf%D(I1)
 Qx  = DB%PrmBuf%D(I1+1)
 Qy  = DB%PrmBuf%D(I1+2)
 Qz  = DB%PrmBuf%D(I1+3)
 Uq  = DB%PrmBuf%D(I1+4)
 cq1 = DB%PrmBuf%D(I1+5)
 cq2 = DB%PrmBuf%D(I1+6)
 cq3 = DB%PrmBuf%D(I1+7)
 r1xE  = 1.0D0/Eta
 r1x2E = 0.5D0*r1xE
 EtaQx = Eta*Qx
 EtaQy = Eta*Qy
 EtaQz = Eta*Qz
 QBx = Qx-DB%DisBuf%D(I2+7)
 QBy = Qy-DB%DisBuf%D(I2+8)
 QBz = Qz-DB%DisBuf%D(I2+9)
 DO K=1,CBra
 Zeta = PrmBufB(1,K)
 Px   = PrmBufB(2,K)
 Py   = PrmBufB(3,K)
 Pz   = PrmBufB(4,K)
 Up   = PrmBufB(5,K)
 cp1  = PrmBufB(6,K)
 cp2  = PrmBufB(7,K)
 cp3  = PrmBufB(8,K)
 ZpE  = Zeta+Eta
 r1xZpE = 1.0D0/ZpE
 r1x2ZE = 0.5D0*r1xZpE
 r1xZ   = 1.0D0/Zeta
 r1x2Z  = 0.5D0*r1xZ
 rpxZ   = Eta*r1xZpE
 rpxE   = Zeta*r1xZpE
 Rkk  = Up*Uq*DSQRT(r1xZpE)
 PAx = Px - Cx
 PAy = Py - Cy
 PAz = Pz - Cz
 PQx = Px - Qx
 PQy = Py - Qy
 PQz = Pz - Qz
!
 FPQx = PQx*PBC%InvBoxSh%D(1,1) + PQy*PBC%InvBoxSh%D(1,2) + PQz*PBC%InvBoxSh%D(1,3)
 FPQy = PQy*PBC%InvBoxSh%D(2,2) + PQz*PBC%InvBoxSh%D(2,3)
 FPQz = PQz*PBC%InvBoxSh%D(3,3)
 IF(PBC%AutoW%I(1)==1) FPQx = FPQx-ANINT(FPQx)
 IF(PBC%AutoW%I(2)==1) FPQy = FPQy-ANINT(FPQy)
 IF(PBC%AutoW%I(3)==1) FPQz = FPQz-ANINT(FPQz)
 PQx  = FPQx*PBC%BoxShape%D(1,1)+FPQy*PBC%BoxShape%D(1,2) + FPQz*PBC%BoxShape%D(1,3)
 PQy  = FPQy*PBC%BoxShape%D(2,2)+FPQz*PBC%BoxShape%D(2,3)
 PQz  = FPQz*PBC%BoxShape%D(3,3)
!
 WPx = -Eta*PQx*r1xZpE
 WPy = -Eta*PQy*r1xZpE
 WPz = -Eta*PQz*r1xZpE
 WQx = Zeta*PQx*r1xZpE
 WQy = Zeta*PQy*r1xZpE
 WQz = Zeta*PQz*r1xZpE
 T1=(PQx*PQx+PQy*PQy+PQz*PQz)*Zeta*Eta*r1xZpE
 INCLUDE "RGen5.Inc"
 U(1)=R1                                                          
 U(4)=R2                                                          
 U(2)=R3                                                          
 U(3)=R4                                                          
 U(6)=R5                                                          
 U(7)=R6                                                          
 U(5)=QBx*U(1)+WQx*U(4)                                           
 U(9)=QBy*U(1)+WQy*U(4)                                           
 U(13)=QBz*U(1)+WQz*U(4)                                          
 U(8)=QBx*U(4)+WQx*U(2)                                           
 U(12)=QBy*U(4)+WQy*U(2)                                          
 U(15)=QBz*U(4)+WQz*U(2)                                          
 U(10)=QBx*U(2)+WQx*U(3)                                          
 U(11)=QBy*U(2)+WQy*U(3)                                          
 U(14)=QBz*U(2)+WQz*U(3)                                          
 U(16)=QBx*U(3)+WQx*U(6)                                          
 U(18)=QBy*U(3)+WQy*U(6)                                          
 U(19)=QBz*U(3)+WQz*U(6)                                          
 U(20)=QBx*U(6)+WQx*U(7)                                          
 U(22)=QBy*U(6)+WQy*U(7)                                          
 U(23)=QBz*U(6)+WQz*U(7)                                          
 U(17)=QBx*U(5)+WQx*U(8)+r1x2E*(U(1)-rpxE*U(4))                                            
 U(21)=QBx*U(9)+WQx*U(12)                                         
 U(25)=QBy*U(9)+WQy*U(12)+r1x2E*(U(1)-rpxE*U(4))                                           
 U(29)=QBx*U(13)+WQx*U(15)                                        
 U(33)=QBy*U(13)+WQy*U(15)                                        
 U(37)=QBz*U(13)+WQz*U(15)+r1x2E*(U(1)-rpxE*U(4))                                          
 U(24)=QBx*U(8)+WQx*U(10)+r1x2E*(U(4)-rpxE*U(2))                                           
 U(26)=QBx*U(12)+WQx*U(11)                                        
 U(28)=QBy*U(12)+WQy*U(11)+r1x2E*(U(4)-rpxE*U(2))                                          
 U(31)=QBx*U(15)+WQx*U(14)                                        
 U(34)=QBy*U(15)+WQy*U(14)                                        
 U(39)=QBz*U(15)+WQz*U(14)+r1x2E*(U(4)-rpxE*U(2))                                          
 U(27)=QBx*U(10)+WQx*U(16)+r1x2E*(U(2)-rpxE*U(3))                                          
 U(30)=QBx*U(11)+WQx*U(18)                                        
 U(32)=QBy*U(11)+WQy*U(18)+r1x2E*(U(2)-rpxE*U(3))                                          
 U(35)=QBx*U(14)+WQx*U(19)                                        
 U(36)=QBy*U(14)+WQy*U(19)                                        
 U(38)=QBz*U(14)+WQz*U(19)+r1x2E*(U(2)-rpxE*U(3))                                          
 U(40)=QBx*U(16)+WQx*U(20)+r1x2E*(U(3)-rpxE*U(6))                                          
 U(42)=QBx*U(18)+WQx*U(22)                                        
 U(43)=QBy*U(18)+WQy*U(22)+r1x2E*(U(3)-rpxE*U(6))                                          
 U(44)=QBx*U(19)+WQx*U(23)                                        
 U(46)=QBy*U(19)+WQy*U(23)                                        
 U(47)=QBz*U(19)+WQz*U(23)+r1x2E*(U(3)-rpxE*U(6))                                          
 U(41)=QBx*U(17)+WQx*U(24)+2.0D0*r1x2E*(U(5)-rpxE*U(8))                                    
 U(45)=QBx*U(21)+WQx*U(26)+r1x2E*(U(9)-rpxE*U(12))                                         
 U(49)=QBx*U(25)+WQx*U(28)                                        
 U(53)=QBy*U(25)+WQy*U(28)+2.0D0*r1x2E*(U(9)-rpxE*U(12))                                   
 U(57)=QBx*U(29)+WQx*U(31)+r1x2E*(U(13)-rpxE*U(15))                                        
 U(61)=QBx*U(33)+WQx*U(34)                                        
 U(65)=QBy*U(33)+WQy*U(34)+r1x2E*(U(13)-rpxE*U(15))                                        
 U(69)=QBx*U(37)+WQx*U(39)                                        
 U(73)=QBy*U(37)+WQy*U(39)                                        
 U(77)=QBz*U(37)+WQz*U(39)+2.0D0*r1x2E*(U(13)-rpxE*U(15))                                  
 U(48)=QBx*U(24)+WQx*U(27)+2.0D0*r1x2E*(U(8)-rpxE*U(10))                                   
 U(52)=QBx*U(26)+WQx*U(30)+r1x2E*(U(12)-rpxE*U(11))                                        
 U(54)=QBx*U(28)+WQx*U(32)                                        
 U(56)=QBy*U(28)+WQy*U(32)+2.0D0*r1x2E*(U(12)-rpxE*U(11))                                  
 U(59)=QBx*U(31)+WQx*U(35)+r1x2E*(U(15)-rpxE*U(14))                                        
 U(66)=QBx*U(34)+WQx*U(36)                                        
 U(71)=QBy*U(34)+WQy*U(36)+r1x2E*(U(15)-rpxE*U(14))                                        
 U(74)=QBx*U(39)+WQx*U(38)                                        
 U(78)=QBy*U(39)+WQy*U(38)                                        
 U(79)=QBz*U(39)+WQz*U(38)+2.0D0*r1x2E*(U(15)-rpxE*U(14))                                  
 U(50)=QBx*U(27)+WQx*U(40)+2.0D0*r1x2E*(U(10)-rpxE*U(16))                                  
 U(51)=QBx*U(30)+WQx*U(42)+r1x2E*(U(11)-rpxE*U(18))                                        
 U(55)=QBx*U(32)+WQx*U(43)                                        
 U(58)=QBy*U(32)+WQy*U(43)+2.0D0*r1x2E*(U(11)-rpxE*U(18))                                  
 U(60)=QBx*U(35)+WQx*U(44)+r1x2E*(U(14)-rpxE*U(19))                                        
 U(62)=QBx*U(36)+WQx*U(46)                                        
 U(63)=QBy*U(36)+WQy*U(46)+r1x2E*(U(14)-rpxE*U(19))                                        
 U(64)=QBx*U(38)+WQx*U(47)                                        
 U(67)=QBy*U(38)+WQy*U(47)                                        
 U(68)=QBz*U(38)+WQz*U(47)+2.0D0*r1x2E*(U(14)-rpxE*U(19))                                  
 U(81)=QBx*U(41)+WQx*U(48)+3.0D0*r1x2E*(U(17)-rpxE*U(24))                                  
 U(85)=QBx*U(45)+WQx*U(52)+2.0D0*r1x2E*(U(21)-rpxE*U(26))                                  
 U(89)=QBx*U(49)+WQx*U(54)+r1x2E*(U(25)-rpxE*U(28))                                        
 U(93)=QBx*U(53)+WQx*U(56)                                        
 U(97)=QBy*U(53)+WQy*U(56)+3.0D0*r1x2E*(U(25)-rpxE*U(28))                                  
 U(101)=QBx*U(57)+WQx*U(59)+2.0D0*r1x2E*(U(29)-rpxE*U(31))                                 
 U(105)=QBx*U(61)+WQx*U(66)+r1x2E*(U(33)-rpxE*U(34))                                       
 U(109)=QBx*U(65)+WQx*U(71)                                       
 U(113)=QBy*U(65)+WQy*U(71)+2.0D0*r1x2E*(U(33)-rpxE*U(34))                                 
 U(117)=QBx*U(69)+WQx*U(74)+r1x2E*(U(37)-rpxE*U(39))                                       
 U(121)=QBx*U(73)+WQx*U(78)                                       
 U(125)=QBy*U(73)+WQy*U(78)+r1x2E*(U(37)-rpxE*U(39))                                       
 U(129)=QBx*U(77)+WQx*U(79)                                       
 U(133)=QBy*U(77)+WQy*U(79)                                       
 U(137)=QBz*U(77)+WQz*U(79)+3.0D0*r1x2E*(U(37)-rpxE*U(39))                                 
 U(84)=QBx*U(48)+WQx*U(50)+3.0D0*r1x2E*(U(24)-rpxE*U(27))                                  
 U(88)=QBx*U(52)+WQx*U(51)+2.0D0*r1x2E*(U(26)-rpxE*U(30))                                  
 U(92)=QBx*U(54)+WQx*U(55)+r1x2E*(U(28)-rpxE*U(32))                                        
 U(96)=QBx*U(56)+WQx*U(58)                                        
 U(100)=QBy*U(56)+WQy*U(58)+3.0D0*r1x2E*(U(28)-rpxE*U(32))                                 
 U(103)=QBx*U(59)+WQx*U(60)+2.0D0*r1x2E*(U(31)-rpxE*U(35))                                 
 U(83)=QBx*U(66)+WQx*U(62)+r1x2E*(U(34)-rpxE*U(36))                                        
 U(98)=QBx*U(71)+WQx*U(63)                                        
 U(114)=QBy*U(71)+WQy*U(63)+2.0D0*r1x2E*(U(34)-rpxE*U(36))                                 
 U(119)=QBx*U(74)+WQx*U(64)+r1x2E*(U(39)-rpxE*U(38))                                       
 U(124)=QBx*U(78)+WQx*U(67)                                       
 U(126)=QBy*U(78)+WQy*U(67)+r1x2E*(U(39)-rpxE*U(38))                                       
 U(131)=QBx*U(79)+WQx*U(68)                                       
 U(134)=QBy*U(79)+WQy*U(68)                                       
 U(139)=QBz*U(79)+WQz*U(68)+3.0D0*r1x2E*(U(39)-rpxE*U(38))                                 
 U(6)=PAx*U(5)+WPx*U(8)+r1x2ZE*U(4)                                                        
 U(11)=PAy*U(9)+WPy*U(12)+r1x2ZE*U(4)                                                      
 U(16)=PAz*U(13)+WPz*U(15)+r1x2ZE*U(4)                                                     
 U(18)=PAx*U(17)+WPx*U(24)+2.0D0*r1x2ZE*U(8)                                               
 U(22)=PAx*U(21)+WPx*U(26)+r1x2ZE*U(12)                                                    
 U(23)=PAy*U(21)+WPy*U(26)+r1x2ZE*U(8)                                                     
 U(27)=PAy*U(25)+WPy*U(28)+2.0D0*r1x2ZE*U(12)                                              
 U(30)=PAx*U(29)+WPx*U(31)+r1x2ZE*U(15)                                                    
 U(32)=PAz*U(29)+WPz*U(31)+r1x2ZE*U(8)                                                     
 U(35)=PAy*U(33)+WPy*U(34)+r1x2ZE*U(15)                                                    
 U(36)=PAz*U(33)+WPz*U(34)+r1x2ZE*U(12)                                                    
 U(40)=PAz*U(37)+WPz*U(39)+2.0D0*r1x2ZE*U(15)                                              
 U(42)=PAx*U(41)+WPx*U(48)+3.0D0*r1x2ZE*U(24)                                              
 U(46)=PAx*U(45)+WPx*U(52)+2.0D0*r1x2ZE*U(26)                                              
 U(47)=PAy*U(45)+WPy*U(52)+r1x2ZE*U(24)                                                    
 U(50)=PAx*U(49)+WPx*U(54)+r1x2ZE*U(28)                                                    
 U(51)=PAy*U(49)+WPy*U(54)+2.0D0*r1x2ZE*U(26)                                              
 U(55)=PAy*U(53)+WPy*U(56)+3.0D0*r1x2ZE*U(28)                                              
 U(58)=PAx*U(57)+WPx*U(59)+2.0D0*r1x2ZE*U(31)                                              
 U(60)=PAz*U(57)+WPz*U(59)+r1x2ZE*U(24)                                                    
 U(62)=PAx*U(61)+WPx*U(66)+r1x2ZE*U(34)                                                    
 U(63)=PAy*U(61)+WPy*U(66)+r1x2ZE*U(31)                                                    
 U(64)=PAz*U(61)+WPz*U(66)+r1x2ZE*U(26)                                                    
 U(67)=PAy*U(65)+WPy*U(71)+2.0D0*r1x2ZE*U(34)                                              
 U(68)=PAz*U(65)+WPz*U(71)+r1x2ZE*U(28)                                                    
 U(70)=PAx*U(69)+WPx*U(74)+r1x2ZE*U(39)                                                    
 U(72)=PAz*U(69)+WPz*U(74)+2.0D0*r1x2ZE*U(31)                                              
 U(75)=PAy*U(73)+WPy*U(78)+r1x2ZE*U(39)                                                    
 U(76)=PAz*U(73)+WPz*U(78)+2.0D0*r1x2ZE*U(34)                                              
 U(80)=PAz*U(77)+WPz*U(79)+3.0D0*r1x2ZE*U(39)                                              
 U(82)=PAx*U(81)+WPx*U(84)+4.0D0*r1x2ZE*U(48)                                              
 U(86)=PAx*U(85)+WPx*U(88)+3.0D0*r1x2ZE*U(52)                                              
 U(87)=PAy*U(85)+WPy*U(88)+r1x2ZE*U(48)                                                    
 U(90)=PAx*U(89)+WPx*U(92)+2.0D0*r1x2ZE*U(54)                                              
 U(91)=PAy*U(89)+WPy*U(92)+2.0D0*r1x2ZE*U(52)                                              
 U(94)=PAx*U(93)+WPx*U(96)+r1x2ZE*U(56)                                                    
 U(95)=PAy*U(93)+WPy*U(96)+3.0D0*r1x2ZE*U(54)                                              
 U(99)=PAy*U(97)+WPy*U(100)+4.0D0*r1x2ZE*U(56)                                             
 U(102)=PAx*U(101)+WPx*U(103)+3.0D0*r1x2ZE*U(59)                                           
 U(104)=PAz*U(101)+WPz*U(103)+r1x2ZE*U(48)                                                 
 U(106)=PAx*U(105)+WPx*U(83)+2.0D0*r1x2ZE*U(66)                                            
 U(107)=PAy*U(105)+WPy*U(83)+r1x2ZE*U(59)                                                  
 U(108)=PAz*U(105)+WPz*U(83)+r1x2ZE*U(52)                                                  
 U(110)=PAx*U(109)+WPx*U(98)+r1x2ZE*U(71)                                                  
 U(111)=PAy*U(109)+WPy*U(98)+2.0D0*r1x2ZE*U(66)                                            
 U(112)=PAz*U(109)+WPz*U(98)+r1x2ZE*U(54)                                                  
 U(115)=PAy*U(113)+WPy*U(114)+3.0D0*r1x2ZE*U(71)                                           
 U(116)=PAz*U(113)+WPz*U(114)+r1x2ZE*U(56)                                                 
 U(118)=PAx*U(117)+WPx*U(119)+2.0D0*r1x2ZE*U(74)                                           
 U(120)=PAz*U(117)+WPz*U(119)+2.0D0*r1x2ZE*U(59)                                           
 U(122)=PAx*U(121)+WPx*U(124)+r1x2ZE*U(78)                                                 
 U(123)=PAy*U(121)+WPy*U(124)+r1x2ZE*U(74)                                                 
 U(124)=PAz*U(121)+WPz*U(124)+2.0D0*r1x2ZE*U(66)                                           
 U(127)=PAy*U(125)+WPy*U(126)+2.0D0*r1x2ZE*U(78)                                           
 U(128)=PAz*U(125)+WPz*U(126)+2.0D0*r1x2ZE*U(71)                                           
 U(130)=PAx*U(129)+WPx*U(131)+r1x2ZE*U(79)                                                 
 U(132)=PAz*U(129)+WPz*U(131)+3.0D0*r1x2ZE*U(74)                                           
 U(135)=PAy*U(133)+WPy*U(134)+r1x2ZE*U(79)                                                 
 U(136)=PAz*U(133)+WPz*U(134)+3.0D0*r1x2ZE*U(78)                                           
 U(140)=PAz*U(137)+WPz*U(139)+4.0D0*r1x2ZE*U(79)                                           
 U(2)=PAx*U(1)+WPx*U(4)                                           
 U(3)=PAy*U(1)+WPy*U(4)                                           
 U(4)=PAz*U(1)+WPz*U(4)                                           
 U(7)=PAy*U(5)+WPy*U(8)                                           
 U(8)=PAz*U(5)+WPz*U(8)                                           
 U(10)=PAx*U(9)+WPx*U(12)                                         
 U(12)=PAz*U(9)+WPz*U(12)                                         
 U(14)=PAx*U(13)+WPx*U(15)                                        
 U(15)=PAy*U(13)+WPy*U(15)                                        
 U(19)=PAy*U(17)+WPy*U(24)                                        
 U(20)=PAz*U(17)+WPz*U(24)                                        
 U(24)=PAz*U(21)+WPz*U(26)                                        
 U(26)=PAx*U(25)+WPx*U(28)                                        
 U(28)=PAz*U(25)+WPz*U(28)                                        
 U(31)=PAy*U(29)+WPy*U(31)                                        
 U(34)=PAx*U(33)+WPx*U(34)                                        
 U(38)=PAx*U(37)+WPx*U(39)                                        
 U(39)=PAy*U(37)+WPy*U(39)                                        
 U(43)=PAy*U(41)+WPy*U(48)                                        
 U(44)=PAz*U(41)+WPz*U(48)                                        
 U(48)=PAz*U(45)+WPz*U(52)                                        
 U(52)=PAz*U(49)+WPz*U(54)                                        
 U(54)=PAx*U(53)+WPx*U(56)                                        
 U(56)=PAz*U(53)+WPz*U(56)                                        
 U(59)=PAy*U(57)+WPy*U(59)                                        
 U(66)=PAx*U(65)+WPx*U(71)                                        
 U(71)=PAy*U(69)+WPy*U(74)                                        
 U(74)=PAx*U(73)+WPx*U(78)                                        
 U(78)=PAx*U(77)+WPx*U(79)                                        
 U(79)=PAy*U(77)+WPy*U(79)                                        
 U(83)=PAy*U(81)+WPy*U(84)                                        
 U(84)=PAz*U(81)+WPz*U(84)                                        
 U(88)=PAz*U(85)+WPz*U(88)                                        
 U(92)=PAz*U(89)+WPz*U(92)                                        
 U(96)=PAz*U(93)+WPz*U(96)                                        
 U(98)=PAx*U(97)+WPx*U(100)                                       
 U(100)=PAz*U(97)+WPz*U(100)                                      
 U(103)=PAy*U(101)+WPy*U(103)                                     
 U(114)=PAx*U(113)+WPx*U(114)                                     
 U(119)=PAy*U(117)+WPy*U(119)                                     
 U(126)=PAx*U(125)+WPx*U(126)                                     
 U(131)=PAy*U(129)+WPy*U(131)                                     
 U(134)=PAx*U(133)+WPx*U(134)                                     
 U(138)=PAx*U(137)+WPx*U(139)                                     
 U(139)=PAy*U(137)+WPy*U(139)                                     
 C(I,1)=C(I,1)+U(17)*cp1                                          
 C(I,2)=C(I,2)+U(18)                                              
 C(I,3)=C(I,3)+U(19)                                              
 C(I,4)=C(I,4)+U(20)                                              
 C(I,5)=C(I,5)+U(21)*cp1                                          
 C(I,6)=C(I,6)+U(22)                                              
 C(I,7)=C(I,7)+U(23)                                              
 C(I,8)=C(I,8)+U(24)                                              
 C(I,9)=C(I,9)+U(25)*cp1                                          
 C(I,10)=C(I,10)+U(26)                                            
 C(I,11)=C(I,11)+U(27)                                            
 C(I,12)=C(I,12)+U(28)                                            
 C(I,13)=C(I,13)+U(29)*cp1                                        
 C(I,14)=C(I,14)+U(30)                                            
 C(I,15)=C(I,15)+U(31)                                            
 C(I,16)=C(I,16)+U(32)                                            
 C(I,17)=C(I,17)+U(33)*cp1                                        
 C(I,18)=C(I,18)+U(34)                                            
 C(I,19)=C(I,19)+U(35)                                            
 C(I,20)=C(I,20)+U(36)                                            
 C(I,21)=C(I,21)+U(37)*cp1                                        
 C(I,22)=C(I,22)+U(38)                                            
 C(I,23)=C(I,23)+U(39)                                            
 C(I,24)=C(I,24)+U(40)                                            
 C(I,25)=C(I,25)+U(41)*cp1                                        
 C(I,26)=C(I,26)+U(42)                                            
 C(I,27)=C(I,27)+U(43)                                            
 C(I,28)=C(I,28)+U(44)                                            
 C(I,29)=C(I,29)+U(45)*cp1                                        
 C(I,30)=C(I,30)+U(46)                                            
 C(I,31)=C(I,31)+U(47)                                            
 C(I,32)=C(I,32)+U(48)                                            
 C(I,33)=C(I,33)+U(49)*cp1                                        
 C(I,34)=C(I,34)+U(50)                                            
 C(I,35)=C(I,35)+U(51)                                            
 C(I,36)=C(I,36)+U(52)                                            
 C(I,37)=C(I,37)+U(53)*cp1                                        
 C(I,38)=C(I,38)+U(54)                                            
 C(I,39)=C(I,39)+U(55)                                            
 C(I,40)=C(I,40)+U(56)                                            
 C(I,41)=C(I,41)+U(57)*cp1                                        
 C(I,42)=C(I,42)+U(58)                                            
 C(I,43)=C(I,43)+U(59)                                            
 C(I,44)=C(I,44)+U(60)                                            
 C(I,45)=C(I,45)+U(61)*cp1                                        
 C(I,46)=C(I,46)+U(62)                                            
 C(I,47)=C(I,47)+U(63)                                            
 C(I,48)=C(I,48)+U(64)                                            
 C(I,49)=C(I,49)+U(65)*cp1                                        
 C(I,50)=C(I,50)+U(66)                                            
 C(I,51)=C(I,51)+U(67)                                            
 C(I,52)=C(I,52)+U(68)                                            
 C(I,53)=C(I,53)+U(69)*cp1                                        
 C(I,54)=C(I,54)+U(70)                                            
 C(I,55)=C(I,55)+U(71)                                            
 C(I,56)=C(I,56)+U(72)                                            
 C(I,57)=C(I,57)+U(73)*cp1                                        
 C(I,58)=C(I,58)+U(74)                                            
 C(I,59)=C(I,59)+U(75)                                            
 C(I,60)=C(I,60)+U(76)                                            
 C(I,61)=C(I,61)+U(77)*cp1                                        
 C(I,62)=C(I,62)+U(78)                                            
 C(I,63)=C(I,63)+U(79)                                            
 C(I,64)=C(I,64)+U(80)                                            
 C(I,65)=C(I,65)+U(81)*cp1                                        
 C(I,66)=C(I,66)+U(82)                                            
 C(I,67)=C(I,67)+U(83)                                            
 C(I,68)=C(I,68)+U(84)                                            
 C(I,69)=C(I,69)+U(85)*cp1                                        
 C(I,70)=C(I,70)+U(86)                                            
 C(I,71)=C(I,71)+U(87)                                            
 C(I,72)=C(I,72)+U(88)                                            
 C(I,73)=C(I,73)+U(89)*cp1                                        
 C(I,74)=C(I,74)+U(90)                                            
 C(I,75)=C(I,75)+U(91)                                            
 C(I,76)=C(I,76)+U(92)                                            
 C(I,77)=C(I,77)+U(93)*cp1                                        
 C(I,78)=C(I,78)+U(94)                                            
 C(I,79)=C(I,79)+U(95)                                            
 C(I,80)=C(I,80)+U(96)                                            
 C(I,81)=C(I,81)+U(97)*cp1                                        
 C(I,82)=C(I,82)+U(98)                                            
 C(I,83)=C(I,83)+U(99)                                            
 C(I,84)=C(I,84)+U(100)                                           
 C(I,85)=C(I,85)+U(101)*cp1                                       
 C(I,86)=C(I,86)+U(102)                                           
 C(I,87)=C(I,87)+U(103)                                           
 C(I,88)=C(I,88)+U(104)                                           
 C(I,89)=C(I,89)+U(105)*cp1                                       
 C(I,90)=C(I,90)+U(106)                                           
 C(I,91)=C(I,91)+U(107)                                           
 C(I,92)=C(I,92)+U(108)                                           
 C(I,93)=C(I,93)+U(109)*cp1                                       
 C(I,94)=C(I,94)+U(110)                                           
 C(I,95)=C(I,95)+U(111)                                           
 C(I,96)=C(I,96)+U(112)                                           
 C(I,97)=C(I,97)+U(113)*cp1                                       
 C(I,98)=C(I,98)+U(114)                                           
 C(I,99)=C(I,99)+U(115)                                           
 C(I,100)=C(I,100)+U(116)                                         
 C(I,101)=C(I,101)+U(117)*cp1                                     
 C(I,102)=C(I,102)+U(118)                                         
 C(I,103)=C(I,103)+U(119)                                         
 C(I,104)=C(I,104)+U(120)                                         
 C(I,105)=C(I,105)+U(121)*cp1                                     
 C(I,106)=C(I,106)+U(122)                                         
 C(I,107)=C(I,107)+U(123)                                         
 C(I,108)=C(I,108)+U(124)                                         
 C(I,109)=C(I,109)+U(125)*cp1                                     
 C(I,110)=C(I,110)+U(126)                                         
 C(I,111)=C(I,111)+U(127)                                         
 C(I,112)=C(I,112)+U(128)                                         
 C(I,113)=C(I,113)+U(129)*cp1                                     
 C(I,114)=C(I,114)+U(130)                                         
 C(I,115)=C(I,115)+U(131)                                         
 C(I,116)=C(I,116)+U(132)                                         
 C(I,117)=C(I,117)+U(133)*cp1                                     
 C(I,118)=C(I,118)+U(134)                                         
 C(I,119)=C(I,119)+U(135)                                         
 C(I,120)=C(I,120)+U(136)                                         
 C(I,121)=C(I,121)+U(137)*cp1                                     
 C(I,122)=C(I,122)+U(138)                                         
 C(I,123)=C(I,123)+U(139)                                         
 C(I,124)=C(I,124)+U(140)                                         
 ENDDO
 ENDDO
 ENDDO
 ELSEIF(IntCode.EQ. 3010606) THEN
 DO I=1,N
 I0 = SB%SLPrm%I(I)
 I2 = SB%SLDis%I(I)-4
 DO J=1,CKet
 I1=I0+(J-1)*DB%MAXP
 Eta = DB%PrmBuf%D(I1)
 Qx  = DB%PrmBuf%D(I1+1)
 Qy  = DB%PrmBuf%D(I1+2)
 Qz  = DB%PrmBuf%D(I1+3)
 Uq  = DB%PrmBuf%D(I1+4)
 cq1 = DB%PrmBuf%D(I1+5)
 cq2 = DB%PrmBuf%D(I1+6)
 cq3 = DB%PrmBuf%D(I1+7)
 r1xE  = 1.0D0/Eta
 r1x2E = 0.5D0*r1xE
 EtaQx = Eta*Qx
 EtaQy = Eta*Qy
 EtaQz = Eta*Qz
 QBx = Qx-DB%DisBuf%D(I2+7)
 QBy = Qy-DB%DisBuf%D(I2+8)
 QBz = Qz-DB%DisBuf%D(I2+9)
 DO K=1,CBra
 Zeta = PrmBufB(1,K)
 Px   = PrmBufB(2,K)
 Py   = PrmBufB(3,K)
 Pz   = PrmBufB(4,K)
 Up   = PrmBufB(5,K)
 cp1  = PrmBufB(6,K)
 cp2  = PrmBufB(7,K)
 cp3  = PrmBufB(8,K)
 ZpE  = Zeta+Eta
 r1xZpE = 1.0D0/ZpE
 r1x2ZE = 0.5D0*r1xZpE
 r1xZ   = 1.0D0/Zeta
 r1x2Z  = 0.5D0*r1xZ
 rpxZ   = Eta*r1xZpE
 rpxE   = Zeta*r1xZpE
 Rkk  = Up*Uq*DSQRT(r1xZpE)
 PAx = Px - Cx
 PAy = Py - Cy
 PAz = Pz - Cz
 PQx = Px - Qx
 PQy = Py - Qy
 PQz = Pz - Qz
!
 FPQx = PQx*PBC%InvBoxSh%D(1,1) + PQy*PBC%InvBoxSh%D(1,2) + PQz*PBC%InvBoxSh%D(1,3)
 FPQy = PQy*PBC%InvBoxSh%D(2,2) + PQz*PBC%InvBoxSh%D(2,3)
 FPQz = PQz*PBC%InvBoxSh%D(3,3)
 IF(PBC%AutoW%I(1)==1) FPQx = FPQx-ANINT(FPQx)
 IF(PBC%AutoW%I(2)==1) FPQy = FPQy-ANINT(FPQy)
 IF(PBC%AutoW%I(3)==1) FPQz = FPQz-ANINT(FPQz)
 PQx  = FPQx*PBC%BoxShape%D(1,1)+FPQy*PBC%BoxShape%D(1,2) + FPQz*PBC%BoxShape%D(1,3)
 PQy  = FPQy*PBC%BoxShape%D(2,2)+FPQz*PBC%BoxShape%D(2,3)
 PQz  = FPQz*PBC%BoxShape%D(3,3)
!
 WPx = -Eta*PQx*r1xZpE
 WPy = -Eta*PQy*r1xZpE
 WPz = -Eta*PQz*r1xZpE
 WQx = Zeta*PQx*r1xZpE
 WQy = Zeta*PQy*r1xZpE
 WQz = Zeta*PQz*r1xZpE
 T1=(PQx*PQx+PQy*PQy+PQz*PQz)*Zeta*Eta*r1xZpE
 INCLUDE "RGen5.Inc"
 U(1)=R1                                                          
 U(4)=R2                                                          
 U(2)=R3                                                          
 U(3)=R4                                                          
 U(6)=R5                                                          
 U(7)=R6                                                          
 U(5)=QBx*U(1)+WQx*U(4)                                           
 U(9)=QBy*U(1)+WQy*U(4)                                           
 U(13)=QBz*U(1)+WQz*U(4)                                          
 U(8)=QBx*U(4)+WQx*U(2)                                           
 U(12)=QBy*U(4)+WQy*U(2)                                          
 U(15)=QBz*U(4)+WQz*U(2)                                          
 U(10)=QBx*U(2)+WQx*U(3)                                          
 U(11)=QBy*U(2)+WQy*U(3)                                          
 U(14)=QBz*U(2)+WQz*U(3)                                          
 U(16)=QBx*U(3)+WQx*U(6)                                          
 U(18)=QBy*U(3)+WQy*U(6)                                          
 U(19)=QBz*U(3)+WQz*U(6)                                          
 U(20)=QBx*U(6)+WQx*U(7)                                          
 U(22)=QBy*U(6)+WQy*U(7)                                          
 U(23)=QBz*U(6)+WQz*U(7)                                          
 U(17)=QBx*U(5)+WQx*U(8)+r1x2E*(U(1)-rpxE*U(4))                                            
 U(21)=QBx*U(9)+WQx*U(12)                                         
 U(25)=QBy*U(9)+WQy*U(12)+r1x2E*(U(1)-rpxE*U(4))                                           
 U(29)=QBx*U(13)+WQx*U(15)                                        
 U(33)=QBy*U(13)+WQy*U(15)                                        
 U(37)=QBz*U(13)+WQz*U(15)+r1x2E*(U(1)-rpxE*U(4))                                          
 U(24)=QBx*U(8)+WQx*U(10)+r1x2E*(U(4)-rpxE*U(2))                                           
 U(26)=QBx*U(12)+WQx*U(11)                                        
 U(28)=QBy*U(12)+WQy*U(11)+r1x2E*(U(4)-rpxE*U(2))                                          
 U(31)=QBx*U(15)+WQx*U(14)                                        
 U(34)=QBy*U(15)+WQy*U(14)                                        
 U(39)=QBz*U(15)+WQz*U(14)+r1x2E*(U(4)-rpxE*U(2))                                          
 U(27)=QBx*U(10)+WQx*U(16)+r1x2E*(U(2)-rpxE*U(3))                                          
 U(30)=QBx*U(11)+WQx*U(18)                                        
 U(32)=QBy*U(11)+WQy*U(18)+r1x2E*(U(2)-rpxE*U(3))                                          
 U(35)=QBx*U(14)+WQx*U(19)                                        
 U(36)=QBy*U(14)+WQy*U(19)                                        
 U(38)=QBz*U(14)+WQz*U(19)+r1x2E*(U(2)-rpxE*U(3))                                          
 U(40)=QBx*U(16)+WQx*U(20)+r1x2E*(U(3)-rpxE*U(6))                                          
 U(42)=QBx*U(18)+WQx*U(22)                                        
 U(43)=QBy*U(18)+WQy*U(22)+r1x2E*(U(3)-rpxE*U(6))                                          
 U(44)=QBx*U(19)+WQx*U(23)                                        
 U(46)=QBy*U(19)+WQy*U(23)                                        
 U(47)=QBz*U(19)+WQz*U(23)+r1x2E*(U(3)-rpxE*U(6))                                          
 U(41)=QBx*U(17)+WQx*U(24)+2.0D0*r1x2E*(U(5)-rpxE*U(8))                                    
 U(45)=QBx*U(21)+WQx*U(26)+r1x2E*(U(9)-rpxE*U(12))                                         
 U(49)=QBx*U(25)+WQx*U(28)                                        
 U(53)=QBy*U(25)+WQy*U(28)+2.0D0*r1x2E*(U(9)-rpxE*U(12))                                   
 U(57)=QBx*U(29)+WQx*U(31)+r1x2E*(U(13)-rpxE*U(15))                                        
 U(61)=QBx*U(33)+WQx*U(34)                                        
 U(65)=QBy*U(33)+WQy*U(34)+r1x2E*(U(13)-rpxE*U(15))                                        
 U(69)=QBx*U(37)+WQx*U(39)                                        
 U(73)=QBy*U(37)+WQy*U(39)                                        
 U(77)=QBz*U(37)+WQz*U(39)+2.0D0*r1x2E*(U(13)-rpxE*U(15))                                  
 U(48)=QBx*U(24)+WQx*U(27)+2.0D0*r1x2E*(U(8)-rpxE*U(10))                                   
 U(52)=QBx*U(26)+WQx*U(30)+r1x2E*(U(12)-rpxE*U(11))                                        
 U(54)=QBx*U(28)+WQx*U(32)                                        
 U(56)=QBy*U(28)+WQy*U(32)+2.0D0*r1x2E*(U(12)-rpxE*U(11))                                  
 U(59)=QBx*U(31)+WQx*U(35)+r1x2E*(U(15)-rpxE*U(14))                                        
 U(66)=QBx*U(34)+WQx*U(36)                                        
 U(71)=QBy*U(34)+WQy*U(36)+r1x2E*(U(15)-rpxE*U(14))                                        
 U(74)=QBx*U(39)+WQx*U(38)                                        
 U(78)=QBy*U(39)+WQy*U(38)                                        
 U(79)=QBz*U(39)+WQz*U(38)+2.0D0*r1x2E*(U(15)-rpxE*U(14))                                  
 U(50)=QBx*U(27)+WQx*U(40)+2.0D0*r1x2E*(U(10)-rpxE*U(16))                                  
 U(51)=QBx*U(30)+WQx*U(42)+r1x2E*(U(11)-rpxE*U(18))                                        
 U(55)=QBx*U(32)+WQx*U(43)                                        
 U(58)=QBy*U(32)+WQy*U(43)+2.0D0*r1x2E*(U(11)-rpxE*U(18))                                  
 U(60)=QBx*U(35)+WQx*U(44)+r1x2E*(U(14)-rpxE*U(19))                                        
 U(62)=QBx*U(36)+WQx*U(46)                                        
 U(63)=QBy*U(36)+WQy*U(46)+r1x2E*(U(14)-rpxE*U(19))                                        
 U(64)=QBx*U(38)+WQx*U(47)                                        
 U(67)=QBy*U(38)+WQy*U(47)                                        
 U(68)=QBz*U(38)+WQz*U(47)+2.0D0*r1x2E*(U(14)-rpxE*U(19))                                  
 U(81)=QBx*U(41)+WQx*U(48)+3.0D0*r1x2E*(U(17)-rpxE*U(24))                                  
 U(85)=QBx*U(45)+WQx*U(52)+2.0D0*r1x2E*(U(21)-rpxE*U(26))                                  
 U(89)=QBx*U(49)+WQx*U(54)+r1x2E*(U(25)-rpxE*U(28))                                        
 U(93)=QBx*U(53)+WQx*U(56)                                        
 U(97)=QBy*U(53)+WQy*U(56)+3.0D0*r1x2E*(U(25)-rpxE*U(28))                                  
 U(101)=QBx*U(57)+WQx*U(59)+2.0D0*r1x2E*(U(29)-rpxE*U(31))                                 
 U(105)=QBx*U(61)+WQx*U(66)+r1x2E*(U(33)-rpxE*U(34))                                       
 U(109)=QBx*U(65)+WQx*U(71)                                       
 U(113)=QBy*U(65)+WQy*U(71)+2.0D0*r1x2E*(U(33)-rpxE*U(34))                                 
 U(117)=QBx*U(69)+WQx*U(74)+r1x2E*(U(37)-rpxE*U(39))                                       
 U(121)=QBx*U(73)+WQx*U(78)                                       
 U(125)=QBy*U(73)+WQy*U(78)+r1x2E*(U(37)-rpxE*U(39))                                       
 U(129)=QBx*U(77)+WQx*U(79)                                       
 U(133)=QBy*U(77)+WQy*U(79)                                       
 U(137)=QBz*U(77)+WQz*U(79)+3.0D0*r1x2E*(U(37)-rpxE*U(39))                                 
 U(84)=QBx*U(48)+WQx*U(50)+3.0D0*r1x2E*(U(24)-rpxE*U(27))                                  
 U(88)=QBx*U(52)+WQx*U(51)+2.0D0*r1x2E*(U(26)-rpxE*U(30))                                  
 U(92)=QBx*U(54)+WQx*U(55)+r1x2E*(U(28)-rpxE*U(32))                                        
 U(96)=QBx*U(56)+WQx*U(58)                                        
 U(100)=QBy*U(56)+WQy*U(58)+3.0D0*r1x2E*(U(28)-rpxE*U(32))                                 
 U(103)=QBx*U(59)+WQx*U(60)+2.0D0*r1x2E*(U(31)-rpxE*U(35))                                 
 U(83)=QBx*U(66)+WQx*U(62)+r1x2E*(U(34)-rpxE*U(36))                                        
 U(98)=QBx*U(71)+WQx*U(63)                                        
 U(114)=QBy*U(71)+WQy*U(63)+2.0D0*r1x2E*(U(34)-rpxE*U(36))                                 
 U(119)=QBx*U(74)+WQx*U(64)+r1x2E*(U(39)-rpxE*U(38))                                       
 U(124)=QBx*U(78)+WQx*U(67)                                       
 U(126)=QBy*U(78)+WQy*U(67)+r1x2E*(U(39)-rpxE*U(38))                                       
 U(131)=QBx*U(79)+WQx*U(68)                                       
 U(134)=QBy*U(79)+WQy*U(68)                                       
 U(139)=QBz*U(79)+WQz*U(68)+3.0D0*r1x2E*(U(39)-rpxE*U(38))                                 
 U(6)=PAx*U(5)+WPx*U(8)+r1x2ZE*U(4)                                                        
 U(11)=PAy*U(9)+WPy*U(12)+r1x2ZE*U(4)                                                      
 U(16)=PAz*U(13)+WPz*U(15)+r1x2ZE*U(4)                                                     
 U(18)=PAx*U(17)+WPx*U(24)+2.0D0*r1x2ZE*U(8)                                               
 U(22)=PAx*U(21)+WPx*U(26)+r1x2ZE*U(12)                                                    
 U(23)=PAy*U(21)+WPy*U(26)+r1x2ZE*U(8)                                                     
 U(27)=PAy*U(25)+WPy*U(28)+2.0D0*r1x2ZE*U(12)                                              
 U(30)=PAx*U(29)+WPx*U(31)+r1x2ZE*U(15)                                                    
 U(32)=PAz*U(29)+WPz*U(31)+r1x2ZE*U(8)                                                     
 U(35)=PAy*U(33)+WPy*U(34)+r1x2ZE*U(15)                                                    
 U(36)=PAz*U(33)+WPz*U(34)+r1x2ZE*U(12)                                                    
 U(40)=PAz*U(37)+WPz*U(39)+2.0D0*r1x2ZE*U(15)                                              
 U(42)=PAx*U(41)+WPx*U(48)+3.0D0*r1x2ZE*U(24)                                              
 U(46)=PAx*U(45)+WPx*U(52)+2.0D0*r1x2ZE*U(26)                                              
 U(47)=PAy*U(45)+WPy*U(52)+r1x2ZE*U(24)                                                    
 U(50)=PAx*U(49)+WPx*U(54)+r1x2ZE*U(28)                                                    
 U(51)=PAy*U(49)+WPy*U(54)+2.0D0*r1x2ZE*U(26)                                              
 U(55)=PAy*U(53)+WPy*U(56)+3.0D0*r1x2ZE*U(28)                                              
 U(58)=PAx*U(57)+WPx*U(59)+2.0D0*r1x2ZE*U(31)                                              
 U(60)=PAz*U(57)+WPz*U(59)+r1x2ZE*U(24)                                                    
 U(62)=PAx*U(61)+WPx*U(66)+r1x2ZE*U(34)                                                    
 U(63)=PAy*U(61)+WPy*U(66)+r1x2ZE*U(31)                                                    
 U(64)=PAz*U(61)+WPz*U(66)+r1x2ZE*U(26)                                                    
 U(67)=PAy*U(65)+WPy*U(71)+2.0D0*r1x2ZE*U(34)                                              
 U(68)=PAz*U(65)+WPz*U(71)+r1x2ZE*U(28)                                                    
 U(70)=PAx*U(69)+WPx*U(74)+r1x2ZE*U(39)                                                    
 U(72)=PAz*U(69)+WPz*U(74)+2.0D0*r1x2ZE*U(31)                                              
 U(75)=PAy*U(73)+WPy*U(78)+r1x2ZE*U(39)                                                    
 U(76)=PAz*U(73)+WPz*U(78)+2.0D0*r1x2ZE*U(34)                                              
 U(80)=PAz*U(77)+WPz*U(79)+3.0D0*r1x2ZE*U(39)                                              
 U(82)=PAx*U(81)+WPx*U(84)+4.0D0*r1x2ZE*U(48)                                              
 U(86)=PAx*U(85)+WPx*U(88)+3.0D0*r1x2ZE*U(52)                                              
 U(87)=PAy*U(85)+WPy*U(88)+r1x2ZE*U(48)                                                    
 U(90)=PAx*U(89)+WPx*U(92)+2.0D0*r1x2ZE*U(54)                                              
 U(91)=PAy*U(89)+WPy*U(92)+2.0D0*r1x2ZE*U(52)                                              
 U(94)=PAx*U(93)+WPx*U(96)+r1x2ZE*U(56)                                                    
 U(95)=PAy*U(93)+WPy*U(96)+3.0D0*r1x2ZE*U(54)                                              
 U(99)=PAy*U(97)+WPy*U(100)+4.0D0*r1x2ZE*U(56)                                             
 U(102)=PAx*U(101)+WPx*U(103)+3.0D0*r1x2ZE*U(59)                                           
 U(104)=PAz*U(101)+WPz*U(103)+r1x2ZE*U(48)                                                 
 U(106)=PAx*U(105)+WPx*U(83)+2.0D0*r1x2ZE*U(66)                                            
 U(107)=PAy*U(105)+WPy*U(83)+r1x2ZE*U(59)                                                  
 U(108)=PAz*U(105)+WPz*U(83)+r1x2ZE*U(52)                                                  
 U(110)=PAx*U(109)+WPx*U(98)+r1x2ZE*U(71)                                                  
 U(111)=PAy*U(109)+WPy*U(98)+2.0D0*r1x2ZE*U(66)                                            
 U(112)=PAz*U(109)+WPz*U(98)+r1x2ZE*U(54)                                                  
 U(115)=PAy*U(113)+WPy*U(114)+3.0D0*r1x2ZE*U(71)                                           
 U(116)=PAz*U(113)+WPz*U(114)+r1x2ZE*U(56)                                                 
 U(118)=PAx*U(117)+WPx*U(119)+2.0D0*r1x2ZE*U(74)                                           
 U(120)=PAz*U(117)+WPz*U(119)+2.0D0*r1x2ZE*U(59)                                           
 U(122)=PAx*U(121)+WPx*U(124)+r1x2ZE*U(78)                                                 
 U(123)=PAy*U(121)+WPy*U(124)+r1x2ZE*U(74)                                                 
 U(124)=PAz*U(121)+WPz*U(124)+2.0D0*r1x2ZE*U(66)                                           
 U(127)=PAy*U(125)+WPy*U(126)+2.0D0*r1x2ZE*U(78)                                           
 U(128)=PAz*U(125)+WPz*U(126)+2.0D0*r1x2ZE*U(71)                                           
 U(130)=PAx*U(129)+WPx*U(131)+r1x2ZE*U(79)                                                 
 U(132)=PAz*U(129)+WPz*U(131)+3.0D0*r1x2ZE*U(74)                                           
 U(135)=PAy*U(133)+WPy*U(134)+r1x2ZE*U(79)                                                 
 U(136)=PAz*U(133)+WPz*U(134)+3.0D0*r1x2ZE*U(78)                                           
 U(140)=PAz*U(137)+WPz*U(139)+4.0D0*r1x2ZE*U(79)                                           
 U(2)=PAx*U(1)+WPx*U(4)                                           
 U(3)=PAy*U(1)+WPy*U(4)                                           
 U(4)=PAz*U(1)+WPz*U(4)                                           
 U(7)=PAy*U(5)+WPy*U(8)                                           
 U(8)=PAz*U(5)+WPz*U(8)                                           
 U(10)=PAx*U(9)+WPx*U(12)                                         
 U(12)=PAz*U(9)+WPz*U(12)                                         
 U(14)=PAx*U(13)+WPx*U(15)                                        
 U(15)=PAy*U(13)+WPy*U(15)                                        
 U(19)=PAy*U(17)+WPy*U(24)                                        
 U(20)=PAz*U(17)+WPz*U(24)                                        
 U(24)=PAz*U(21)+WPz*U(26)                                        
 U(26)=PAx*U(25)+WPx*U(28)                                        
 U(28)=PAz*U(25)+WPz*U(28)                                        
 U(31)=PAy*U(29)+WPy*U(31)                                        
 U(34)=PAx*U(33)+WPx*U(34)                                        
 U(38)=PAx*U(37)+WPx*U(39)                                        
 U(39)=PAy*U(37)+WPy*U(39)                                        
 U(43)=PAy*U(41)+WPy*U(48)                                        
 U(44)=PAz*U(41)+WPz*U(48)                                        
 U(48)=PAz*U(45)+WPz*U(52)                                        
 U(52)=PAz*U(49)+WPz*U(54)                                        
 U(54)=PAx*U(53)+WPx*U(56)                                        
 U(56)=PAz*U(53)+WPz*U(56)                                        
 U(59)=PAy*U(57)+WPy*U(59)                                        
 U(66)=PAx*U(65)+WPx*U(71)                                        
 U(71)=PAy*U(69)+WPy*U(74)                                        
 U(74)=PAx*U(73)+WPx*U(78)                                        
 U(78)=PAx*U(77)+WPx*U(79)                                        
 U(79)=PAy*U(77)+WPy*U(79)                                        
 U(83)=PAy*U(81)+WPy*U(84)                                        
 U(84)=PAz*U(81)+WPz*U(84)                                        
 U(88)=PAz*U(85)+WPz*U(88)                                        
 U(92)=PAz*U(89)+WPz*U(92)                                        
 U(96)=PAz*U(93)+WPz*U(96)                                        
 U(98)=PAx*U(97)+WPx*U(100)                                       
 U(100)=PAz*U(97)+WPz*U(100)                                      
 U(103)=PAy*U(101)+WPy*U(103)                                     
 U(114)=PAx*U(113)+WPx*U(114)                                     
 U(119)=PAy*U(117)+WPy*U(119)                                     
 U(126)=PAx*U(125)+WPx*U(126)                                     
 U(131)=PAy*U(129)+WPy*U(131)                                     
 U(134)=PAx*U(133)+WPx*U(134)                                     
 U(138)=PAx*U(137)+WPx*U(139)                                     
 U(139)=PAy*U(137)+WPy*U(139)                                     
 C(I,1)=C(I,1)+U(18)                                              
 C(I,2)=C(I,2)+U(19)                                              
 C(I,3)=C(I,3)+U(20)                                              
 C(I,5)=C(I,5)+U(22)                                              
 C(I,6)=C(I,6)+U(23)                                              
 C(I,7)=C(I,7)+U(24)                                              
 C(I,9)=C(I,9)+U(26)                                              
 C(I,10)=C(I,10)+U(27)                                            
 C(I,11)=C(I,11)+U(28)                                            
 C(I,13)=C(I,13)+U(30)                                            
 C(I,14)=C(I,14)+U(31)                                            
 C(I,15)=C(I,15)+U(32)                                            
 C(I,17)=C(I,17)+U(34)                                            
 C(I,18)=C(I,18)+U(35)                                            
 C(I,19)=C(I,19)+U(36)                                            
 C(I,21)=C(I,21)+U(38)                                            
 C(I,22)=C(I,22)+U(39)                                            
 C(I,23)=C(I,23)+U(40)                                            
 C(I,25)=C(I,25)+U(42)                                            
 C(I,26)=C(I,26)+U(43)                                            
 C(I,27)=C(I,27)+U(44)                                            
 C(I,29)=C(I,29)+U(46)                                            
 C(I,30)=C(I,30)+U(47)                                            
 C(I,31)=C(I,31)+U(48)                                            
 C(I,33)=C(I,33)+U(50)                                            
 C(I,34)=C(I,34)+U(51)                                            
 C(I,35)=C(I,35)+U(52)                                            
 C(I,37)=C(I,37)+U(54)                                            
 C(I,38)=C(I,38)+U(55)                                            
 C(I,39)=C(I,39)+U(56)                                            
 C(I,41)=C(I,41)+U(58)                                            
 C(I,42)=C(I,42)+U(59)                                            
 C(I,43)=C(I,43)+U(60)                                            
 C(I,45)=C(I,45)+U(62)                                            
 C(I,46)=C(I,46)+U(63)                                            
 C(I,47)=C(I,47)+U(64)                                            
 C(I,49)=C(I,49)+U(66)                                            
 C(I,50)=C(I,50)+U(67)                                            
 C(I,51)=C(I,51)+U(68)                                            
 C(I,53)=C(I,53)+U(70)                                            
 C(I,54)=C(I,54)+U(71)                                            
 C(I,55)=C(I,55)+U(72)                                            
 C(I,57)=C(I,57)+U(74)                                            
 C(I,58)=C(I,58)+U(75)                                            
 C(I,59)=C(I,59)+U(76)                                            
 C(I,61)=C(I,61)+U(78)                                            
 C(I,62)=C(I,62)+U(79)                                            
 C(I,63)=C(I,63)+U(80)                                            
 C(I,65)=C(I,65)+U(82)                                            
 C(I,66)=C(I,66)+U(83)                                            
 C(I,67)=C(I,67)+U(84)                                            
 C(I,69)=C(I,69)+U(86)                                            
 C(I,70)=C(I,70)+U(87)                                            
 C(I,71)=C(I,71)+U(88)                                            
 C(I,73)=C(I,73)+U(90)                                            
 C(I,74)=C(I,74)+U(91)                                            
 C(I,75)=C(I,75)+U(92)                                            
 C(I,77)=C(I,77)+U(94)                                            
 C(I,78)=C(I,78)+U(95)                                            
 C(I,79)=C(I,79)+U(96)                                            
 C(I,81)=C(I,81)+U(98)                                            
 C(I,82)=C(I,82)+U(99)                                            
 C(I,83)=C(I,83)+U(100)                                           
 C(I,85)=C(I,85)+U(102)                                           
 C(I,86)=C(I,86)+U(103)                                           
 C(I,87)=C(I,87)+U(104)                                           
 C(I,89)=C(I,89)+U(106)                                           
 C(I,90)=C(I,90)+U(107)                                           
 C(I,91)=C(I,91)+U(108)                                           
 C(I,93)=C(I,93)+U(110)                                           
 C(I,94)=C(I,94)+U(111)                                           
 C(I,95)=C(I,95)+U(112)                                           
 C(I,97)=C(I,97)+U(114)                                           
 C(I,98)=C(I,98)+U(115)                                           
 C(I,99)=C(I,99)+U(116)                                           
 C(I,101)=C(I,101)+U(118)                                         
 C(I,102)=C(I,102)+U(119)                                         
 C(I,103)=C(I,103)+U(120)                                         
 C(I,105)=C(I,105)+U(122)                                         
 C(I,106)=C(I,106)+U(123)                                         
 C(I,107)=C(I,107)+U(124)                                         
 C(I,109)=C(I,109)+U(126)                                         
 C(I,110)=C(I,110)+U(127)                                         
 C(I,111)=C(I,111)+U(128)                                         
 C(I,113)=C(I,113)+U(130)                                         
 C(I,114)=C(I,114)+U(131)                                         
 C(I,115)=C(I,115)+U(132)                                         
 C(I,117)=C(I,117)+U(134)                                         
 C(I,118)=C(I,118)+U(135)                                         
 C(I,119)=C(I,119)+U(136)                                         
 C(I,121)=C(I,121)+U(138)                                         
 C(I,122)=C(I,122)+U(139)                                         
 C(I,123)=C(I,123)+U(140)                                         
 ENDDO
 ENDDO
 ENDDO
 ELSE
  CALL Halt("Illegal IntCode")
 ENDIF
END SUBROUTINE Int2166
