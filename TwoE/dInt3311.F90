! ---------------------------------------------------------- 
! COMPUTES THE INTEGRAL CLASS (P P|S S) 
! ---------------------------------------------------------- 
   SUBROUTINE dInt3311(PrmBufB,LBra,PrmBufK,LKet,ACInfo,BDInfo, & 
                              OA,LDA,OB,LDB,OC,LDC,OD,LDD,GOA,GOB,GOC,GOD,NINT,PBC,dI) 
      USE DerivedTypes
      USE VScratch
      USE GlobalScalars
      USE ShellPairStruct
      USE GammaF2
      USE GammaF3
      IMPLICIT REAL(DOUBLE) (A,I,W,R)
      INTEGER        :: LBra,LKet,NINT
      REAL(DOUBLE)   :: PrmBufB(7,LBra),PrmBufK(7,LKet)
      TYPE(SmallAtomInfo) :: ACInfo,BDInfo
      TYPE(PBCInfo) :: PBC
      REAL(DOUBLE) :: dI(NINT,12)
      REAL(DOUBLE)  :: Zeta,Eta,r1xZpE,HfxZpE,r1x2E,r1x2Z,ExZpE,ZxZpE,Omega,Up,Uq,Upq
      REAL(DOUBLE)  :: Ax,Ay,Az,Bx,By,Bz,Cx,Cy,Cz,Dx,Dy,Dz,Qx,Qy,Qz,Px,Py,Pz
      REAL(DOUBLE)  :: QCx,QCy,QCz,PAx,PAy,PAz,PQx,PQy,PQz,WPx,WPy,WPz,WQx,WQy,WQz   
      REAL(DOUBLE)  :: T,ET,TwoT,InvT,SqInvT,ABx,ABy,ABz,CDx,CDy,CDz
      REAL(DOUBLE)  :: Alpha,Beta,Gamma
      INTEGER       :: CrtSet1,CrtSet2,CrtSet3,CrtSet4 ,CrtSet5 ,CrtSet6
      INTEGER       :: CrtSet7,CrtSet8,CrtSet9,CrtSet10,CrtSet11,CrtSet12
      INTEGER       :: OffSet,GOA,GOB,GOC,GOD
      INTEGER       :: OA,LDA,OB,LDB,OC,LDC,OD,LDD,J,K,L
      REAL(DOUBLE)  :: FPQx,FPQy,FPQz,Dum
      CrtSet1=GOA
      CrtSet2=GOA+1
      CrtSet3=GOA+2
      CrtSet4=GOB
      CrtSet5=GOB+1
      CrtSet6=GOB+2
      CrtSet7=GOC
      CrtSet8=GOC+1
      CrtSet9=GOC+2
      CrtSet10=GOD
      CrtSet11=GOD+1
      CrtSet12=GOD+2
      I1Bar1=0.0d0
      I2Bar1=0.0d0
      I3Bar1=0.0d0
      I4Bar1=0.0d0
      I5Bar1=0.0d0
      I6Bar1=0.0d0
      I7Bar1=0.0d0
      I8Bar1=0.0d0
      I9Bar1=0.0d0
      I10Bar1=0.0d0
      I11Bar1=0.0d0
      I12Bar1=0.0d0
      I13Bar1=0.0d0
      I14Bar1=0.0d0
      I15Bar1=0.0d0
      I16Bar1=0.0d0
      I17Bar1=0.0d0
      I18Bar1=0.0d0
      I19Bar1=0.0d0
      I20Bar1=0.0d0
      I1Bar2=0.0d0
      I2Bar2=0.0d0
      I3Bar2=0.0d0
      I4Bar2=0.0d0
      I5Bar2=0.0d0
      I6Bar2=0.0d0
      I7Bar2=0.0d0
      I8Bar2=0.0d0
      I9Bar2=0.0d0
      I10Bar2=0.0d0
      I1Bar3=0.0d0
      I2Bar3=0.0d0
      I3Bar3=0.0d0
      I4Bar3=0.0d0
      I5Bar3=0.0d0
      I6Bar3=0.0d0
      I7Bar3=0.0d0
      I8Bar3=0.0d0
      I9Bar3=0.0d0
      I10Bar3=0.0d0
      I1Bar4=0.0d0
      I2Bar4=0.0d0
      I3Bar4=0.0d0
      I4Bar4=0.0d0
      I5Bar4=0.0d0
      I6Bar4=0.0d0
      I7Bar4=0.0d0
      I8Bar4=0.0d0
      I9Bar4=0.0d0
      I10Bar4=0.0d0
      Ia10Bar1=0D0
      Ia20Bar1=0D0
      Ia9Bar1=0D0
      Ia19Bar1=0D0
      Ia7Bar1=0D0
      Ia17Bar1=0D0
      Ia14Bar1=0D0
      Ia8Bar1=0D0
      Ia18Bar1=0D0
      Ia6Bar1=0D0
      Ia16Bar1=0D0
      Ia13Bar1=0D0
      Ia5Bar1=0D0
      Ia15Bar1=0D0
      Ia12Bar1=0D0
      Ia11Bar1=0D0
      Ib4Bar1=0D0
      Ib10Bar1=0D0
      Ib20Bar1=0D0
      Ib3Bar1=0D0
      Ib9Bar1=0D0
      Ib19Bar1=0D0
      Ib7Bar1=0D0
      Ib17Bar1=0D0
      Ib14Bar1=0D0
      Ib2Bar1=0D0
      Ib8Bar1=0D0
      Ib18Bar1=0D0
      Ib6Bar1=0D0
      Ib16Bar1=0D0
      Ib13Bar1=0D0
      Ib5Bar1=0D0
      Ib15Bar1=0D0
      Ib12Bar1=0D0
      Ib11Bar1=0D0
      Ic4Bar4=0D0
      Ic4Bar3=0D0
      Ic4Bar2=0D0
      Ic10Bar4=0D0
      Ic10Bar3=0D0
      Ic10Bar2=0D0
      Ic3Bar4=0D0
      Ic3Bar3=0D0
      Ic3Bar2=0D0
      Ic9Bar4=0D0
      Ic9Bar3=0D0
      Ic9Bar2=0D0
      Ic7Bar4=0D0
      Ic7Bar3=0D0
      Ic7Bar2=0D0
      Ic2Bar4=0D0
      Ic2Bar3=0D0
      Ic2Bar2=0D0
      Ic8Bar4=0D0
      Ic8Bar3=0D0
      Ic8Bar2=0D0
      Ic6Bar4=0D0
      Ic6Bar3=0D0
      Ic6Bar2=0D0
      Ic5Bar4=0D0
      Ic5Bar3=0D0
      Ic5Bar2=0D0
      Ax=ACInfo%Atm1X
      Ay=ACInfo%Atm1Y
      Az=ACInfo%Atm1Z
      Bx=ACInfo%Atm2X
      By=ACInfo%Atm2Y
      Bz=ACInfo%Atm2Z
      Cx=BDInfo%Atm1X
      Cy=BDInfo%Atm1Y
      Cz=BDInfo%Atm1Z
      Dx=BDInfo%Atm2X
      Dy=BDInfo%Atm2Y
      Dz=BDInfo%Atm2Z
      ABx=Ax-Bx
      ABy=Ay-By
      ABz=Az-Bz
      CDx=Cx-Dx
      CDy=Cy-Dy
      CDz=Cz-Dz
      DO J=1,LKet ! K^2 VRR |N0) loop 
         Eta=PrmBufK(1,J)
         Qx =PrmBufK(2,J)
         Qy =PrmBufK(3,J)
         Qz =PrmBufK(4,J)
         Uq =PrmBufK(5,J)
         Gamma =PrmBufK(6,J)
         QCx=Qx-Cx
         QCy=Qy-Cy
         QCz=Qz-Cz
         DO K=1,LBra ! K^2 VRR (M0| loop 
            Zeta=PrmBufB(1,K)
            Px  =PrmBufB(2,K)
            Py  =PrmBufB(3,K)
            Pz  =PrmBufB(4,K)
            Up  =PrmBufB(5,K)
            Alpha =PrmBufB(6,K)
            Beta  =PrmBufB(7,K)
            r1xZpE=One/(Zeta+Eta)
            Upq=SQRT(r1xZpE)*Up*Uq
            HfxZpE=Half/(Zeta+Eta)
            r1x2E=Half/Eta
            r1x2Z=Half/Zeta
            ExZpE=Eta*r1xZpE
            ZxZpE=Zeta*r1xZpE
            Omega=Eta*Zeta*r1xZpE
            PAx=Px-Ax
            PAy=Py-Ay
            PAz=Pz-Az
            PQx=Px-Qx
            PQy=Py-Qy
            PQz=Pz-Qz
            INCLUDE 'ERIMIC.Inc'
            WPx = -Eta*PQx*r1xZpE
            WPy = -Eta*PQy*r1xZpE
            WPz = -Eta*PQz*r1xZpE
            WQx = Zeta*PQx*r1xZpE
            WQy = Zeta*PQy*r1xZpE
            WQz = Zeta*PQz*r1xZpE
            T=Omega*(PQx*PQx+PQy*PQy+PQz*PQz)
            IF(T<Gamma_Switch)THEN
              L=AINT(T*Gamma_Grid)
              ET=EXP(-T)
              TwoT=Two*T
              W3=(F3_0(L)+T*(F3_1(L)+T*(F3_2(L)+T*(F3_3(L)+T*F3_4(L)))))
              W2=+2.000000000000000D-01*(TwoT*W3+ET)
              W1=+3.333333333333333D-01*(TwoT*W2+ET)
              W0=TwoT*W1+ET
              AuxR0=Upq*W0
              AuxR1=Upq*W1
              AuxR2=Upq*W2
              AuxR3=Upq*W3
            ELSE
              InvT=One/T
              SqInvT=DSQRT(InvT)
              AuxR0=+8.862269254527580D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR1=+4.431134627263790D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR2=+6.646701940895685D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR3=+1.661675485223921D+00*Upq*SqInvT
            ENDIF
      V(1)=AuxR0*PAx
      V(2)=AuxR1*WPx
      V(3)=V(1)+V(2)
      V(4)=AuxR0*PAy
      V(5)=AuxR1*WPy
      V(6)=V(4)+V(5)
      V(7)=AuxR0*PAz
      V(8)=AuxR1*WPz
      V(9)=V(7)+V(8)
      V(10)=AuxR1*ExZpE
      V(11)=-V(10)
      V(12)=AuxR0+V(11)
      V(13)=r1x2Z*V(12)
      V(14)=PAx*V(3)
      V(15)=AuxR1*PAx
      V(16)=AuxR2*WPx
      V(17)=V(15)+V(16)
      V(18)=WPx*V(17)
      V(19)=V(13)+V(14)+V(18)
      V(20)=PAx*V(6)
      V(21)=AuxR1*PAy
      V(22)=AuxR2*WPy
      V(23)=V(21)+V(22)
      V(24)=WPx*V(23)
      V(25)=V(20)+V(24)
      V(26)=PAy*V(6)
      V(27)=WPy*V(23)
      V(28)=V(13)+V(26)+V(27)
      V(29)=PAx*V(9)
      V(30)=AuxR1*PAz
      V(31)=AuxR2*WPz
      V(32)=V(30)+V(31)
      V(33)=WPx*V(32)
      V(34)=V(29)+V(33)
      V(35)=PAy*V(9)
      V(36)=WPy*V(32)
      V(37)=V(35)+V(36)
      V(38)=PAz*V(9)
      V(39)=WPz*V(32)
      V(40)=V(13)+V(38)+V(39)
      V(41)=ExZpE*V(17)
      V(42)=-V(41)
      V(43)=V(1)+V(2)+V(42)
      V(44)=r1x2Z*V(43)
      V(45)=AuxR2*ExZpE
      V(46)=-V(45)
      V(47)=AuxR1+V(46)
      V(48)=r1x2Z*V(47)
      V(49)=AuxR2*PAx
      V(50)=AuxR3*WPx
      V(51)=V(49)+V(50)
      V(52)=ExZpE*V(23)
      V(53)=-V(52)
      V(54)=V(4)+V(5)+V(53)
      V(55)=r1x2Z*V(54)
      V(56)=PAx*V(23)
      V(57)=AuxR2*PAy
      V(58)=AuxR3*WPy
      V(59)=V(57)+V(58)
      V(60)=WPx*V(59)
      V(61)=V(56)+V(60)
      V(62)=ExZpE*V(32)
      V(63)=-V(62)
      V(64)=V(7)+V(8)+V(63)
      V(65)=r1x2Z*V(64)
      V(66)=PAx*V(32)
      V(67)=AuxR2*PAz
      V(68)=AuxR3*WPz
      V(69)=V(67)+V(68)
      V(70)=WPx*V(69)
      V(71)=V(66)+V(70)
      V(72)=PAy*V(32)
      V(73)=WPy*V(69)
      V(74)=V(72)+V(73)
      V(75)=AuxR0*QCx
      V(76)=AuxR1*WQx
      V(77)=AuxR1*HfxZpE
      V(78)=QCx*V(3)
      V(79)=WQx*V(17)
      V(80)=V(77)+V(78)+V(79)
      V(81)=QCx*V(6)
      V(82)=WQx*V(23)
      V(83)=V(81)+V(82)
      V(84)=QCx*V(9)
      V(85)=WQx*V(32)
      V(86)=V(84)+V(85)
      V(87)=HfxZpE*V(17)
      V(88)=AuxR2*HfxZpE
      V(89)=AuxR1*QCx
      V(90)=AuxR2*WQx
      V(91)=V(89)+V(90)
      V(92)=ExZpE*V(91)
      V(93)=-V(92)
      V(94)=V(75)+V(76)+V(93)
      V(95)=r1x2Z*V(94)
      V(96)=HfxZpE*V(23)
      V(97)=HfxZpE*V(32)
      V(98)=AuxR0*QCy
      V(99)=AuxR1*WQy
      V(100)=QCy*V(3)
      V(101)=WQy*V(17)
      V(102)=V(100)+V(101)
      V(103)=QCy*V(6)
      V(104)=WQy*V(23)
      V(105)=V(77)+V(103)+V(104)
      V(106)=QCy*V(9)
      V(107)=WQy*V(32)
      V(108)=V(106)+V(107)
      V(109)=AuxR1*QCy
      V(110)=AuxR2*WQy
      V(111)=V(109)+V(110)
      V(112)=ExZpE*V(111)
      V(113)=-V(112)
      V(114)=V(98)+V(99)+V(113)
      V(115)=r1x2Z*V(114)
      V(116)=AuxR0*QCz
      V(117)=AuxR1*WQz
      V(118)=QCz*V(3)
      V(119)=WQz*V(17)
      V(120)=V(118)+V(119)
      V(121)=QCz*V(6)
      V(122)=WQz*V(23)
      V(123)=V(121)+V(122)
      V(124)=QCz*V(9)
      V(125)=WQz*V(32)
      V(126)=V(77)+V(124)+V(125)
      V(127)=AuxR1*QCz
      V(128)=AuxR2*WQz
      V(129)=V(127)+V(128)
      V(130)=ExZpE*V(129)
      V(131)=-V(130)
      V(132)=V(116)+V(117)+V(131)
      V(133)=r1x2Z*V(132)
      RawI1Bar1=AuxR0
      I1Bar1=RawI1Bar1+I1Bar1
      RawI2Bar1=V(3)
      I2Bar1=RawI2Bar1+I2Bar1
      RawI3Bar1=V(6)
      I3Bar1=RawI3Bar1+I3Bar1
      RawI4Bar1=V(9)
      I4Bar1=RawI4Bar1+I4Bar1
      RawI5Bar1=V(19)
      I5Bar1=RawI5Bar1+I5Bar1
      RawI6Bar1=V(25)
      I6Bar1=RawI6Bar1+I6Bar1
      RawI7Bar1=V(28)
      I7Bar1=RawI7Bar1+I7Bar1
      RawI8Bar1=V(34)
      I8Bar1=RawI8Bar1+I8Bar1
      RawI9Bar1=V(37)
      I9Bar1=RawI9Bar1+I9Bar1
      RawI10Bar1=V(40)
      I10Bar1=RawI10Bar1+I10Bar1
      W1=PAx*V(19)
      W2=2.D0*V(44)
      W3=WPx*(PAx*V(17)+V(48)+WPx*V(51))
      RawI11Bar1=W1+W2+W3
      I11Bar1=RawI11Bar1+I11Bar1
      RawI12Bar1=PAx*V(25)+V(55)+WPx*V(61)
      I12Bar1=RawI12Bar1+I12Bar1
      RawI13Bar1=PAy*V(25)+V(44)+WPy*V(61)
      I13Bar1=RawI13Bar1+I13Bar1
      W1=PAy*V(28)
      W2=2.D0*V(55)
      W3=WPy*(PAy*V(23)+V(48)+WPy*V(59))
      RawI14Bar1=W1+W2+W3
      I14Bar1=RawI14Bar1+I14Bar1
      RawI15Bar1=PAx*V(34)+V(65)+WPx*V(71)
      I15Bar1=RawI15Bar1+I15Bar1
      RawI16Bar1=PAx*V(37)+WPx*V(74)
      I16Bar1=RawI16Bar1+I16Bar1
      RawI17Bar1=PAy*V(37)+V(65)+WPy*V(74)
      I17Bar1=RawI17Bar1+I17Bar1
      RawI18Bar1=PAz*V(34)+V(44)+WPz*V(71)
      I18Bar1=RawI18Bar1+I18Bar1
      RawI19Bar1=PAz*V(37)+V(55)+WPz*V(74)
      I19Bar1=RawI19Bar1+I19Bar1
      W1=PAz*V(40)
      W2=2.D0*V(65)
      W3=WPz*(PAz*V(32)+V(48)+WPz*V(69))
      RawI20Bar1=W1+W2+W3
      I20Bar1=RawI20Bar1+I20Bar1
      RawI1Bar2=V(75)+V(76)
      I1Bar2=RawI1Bar2+I1Bar2
      RawI2Bar2=V(80)
      I2Bar2=RawI2Bar2+I2Bar2
      RawI3Bar2=V(83)
      I3Bar2=RawI3Bar2+I3Bar2
      RawI4Bar2=V(86)
      I4Bar2=RawI4Bar2+I4Bar2
      W1=PAx*V(80)+V(87)
      W2=WPx*(QCx*V(17)+WQx*V(51)+V(88))
      W3=V(95)
      RawI5Bar2=W1+W2+W3
      I5Bar2=RawI5Bar2+I5Bar2
      RawI6Bar2=QCx*V(25)+WQx*V(61)+V(96)
      I6Bar2=RawI6Bar2+I6Bar2
      W1=WPy*(QCx*V(23)+WQx*V(59))
      W2=PAy*V(83)+V(95)
      RawI7Bar2=W1+W2
      I7Bar2=RawI7Bar2+I7Bar2
      RawI8Bar2=QCx*V(34)+WQx*V(71)+V(97)
      I8Bar2=RawI8Bar2+I8Bar2
      RawI9Bar2=QCx*V(37)+WQx*V(74)
      I9Bar2=RawI9Bar2+I9Bar2
      W1=WPz*(QCx*V(32)+WQx*V(69))
      W2=PAz*V(86)+V(95)
      RawI10Bar2=W1+W2
      I10Bar2=RawI10Bar2+I10Bar2
      RawI1Bar3=V(98)+V(99)
      I1Bar3=RawI1Bar3+I1Bar3
      RawI2Bar3=V(102)
      I2Bar3=RawI2Bar3+I2Bar3
      RawI3Bar3=V(105)
      I3Bar3=RawI3Bar3+I3Bar3
      RawI4Bar3=V(108)
      I4Bar3=RawI4Bar3+I4Bar3
      W1=WPx*(QCy*V(17)+WQy*V(51))
      W2=PAx*V(102)+V(115)
      RawI5Bar3=W1+W2
      I5Bar3=RawI5Bar3+I5Bar3
      RawI6Bar3=QCy*V(25)+WQy*V(61)+V(87)
      I6Bar3=RawI6Bar3+I6Bar3
      W1=WPy*(QCy*V(23)+WQy*V(59)+V(88))
      W2=V(96)
      W3=PAy*V(105)+V(115)
      RawI7Bar3=W1+W2+W3
      I7Bar3=RawI7Bar3+I7Bar3
      RawI8Bar3=QCy*V(34)+WQy*V(71)
      I8Bar3=RawI8Bar3+I8Bar3
      RawI9Bar3=QCy*V(37)+WQy*V(74)+V(97)
      I9Bar3=RawI9Bar3+I9Bar3
      W1=WPz*(QCy*V(32)+WQy*V(69))
      W2=PAz*V(108)+V(115)
      RawI10Bar3=W1+W2
      I10Bar3=RawI10Bar3+I10Bar3
      RawI1Bar4=V(116)+V(117)
      I1Bar4=RawI1Bar4+I1Bar4
      RawI2Bar4=V(120)
      I2Bar4=RawI2Bar4+I2Bar4
      RawI3Bar4=V(123)
      I3Bar4=RawI3Bar4+I3Bar4
      RawI4Bar4=V(126)
      I4Bar4=RawI4Bar4+I4Bar4
      W1=WPx*(QCz*V(17)+WQz*V(51))
      W2=PAx*V(120)+V(133)
      RawI5Bar4=W1+W2
      I5Bar4=RawI5Bar4+I5Bar4
      RawI6Bar4=QCz*V(25)+WQz*V(61)
      I6Bar4=RawI6Bar4+I6Bar4
      W1=WPy*(QCz*V(23)+WQz*V(59))
      W2=PAy*V(123)+V(133)
      RawI7Bar4=W1+W2
      I7Bar4=RawI7Bar4+I7Bar4
      RawI8Bar4=QCz*V(34)+WQz*V(71)+V(87)
      I8Bar4=RawI8Bar4+I8Bar4
      RawI9Bar4=QCz*V(37)+WQz*V(74)+V(96)
      I9Bar4=RawI9Bar4+I9Bar4
      W1=WPz*(QCz*V(32)+WQz*V(69)+V(88))
      W2=V(97)
      W3=PAz*V(126)+V(133)
      RawI10Bar4=W1+W2+W3
      I10Bar4=RawI10Bar4+I10Bar4
            Ia10Bar1=Ia10Bar1+Alpha*RawI10Bar1
            Ia20Bar1=Ia20Bar1+Alpha*RawI20Bar1
            Ia9Bar1=Ia9Bar1+Alpha*RawI9Bar1
            Ia19Bar1=Ia19Bar1+Alpha*RawI19Bar1
            Ia7Bar1=Ia7Bar1+Alpha*RawI7Bar1
            Ia17Bar1=Ia17Bar1+Alpha*RawI17Bar1
            Ia14Bar1=Ia14Bar1+Alpha*RawI14Bar1
            Ia8Bar1=Ia8Bar1+Alpha*RawI8Bar1
            Ia18Bar1=Ia18Bar1+Alpha*RawI18Bar1
            Ia6Bar1=Ia6Bar1+Alpha*RawI6Bar1
            Ia16Bar1=Ia16Bar1+Alpha*RawI16Bar1
            Ia13Bar1=Ia13Bar1+Alpha*RawI13Bar1
            Ia5Bar1=Ia5Bar1+Alpha*RawI5Bar1
            Ia15Bar1=Ia15Bar1+Alpha*RawI15Bar1
            Ia12Bar1=Ia12Bar1+Alpha*RawI12Bar1
            Ia11Bar1=Ia11Bar1+Alpha*RawI11Bar1
            Ib4Bar1=Ib4Bar1+Beta*RawI4Bar1
            Ib10Bar1=Ib10Bar1+Beta*RawI10Bar1
            Ib20Bar1=Ib20Bar1+Beta*RawI20Bar1
            Ib3Bar1=Ib3Bar1+Beta*RawI3Bar1
            Ib9Bar1=Ib9Bar1+Beta*RawI9Bar1
            Ib19Bar1=Ib19Bar1+Beta*RawI19Bar1
            Ib7Bar1=Ib7Bar1+Beta*RawI7Bar1
            Ib17Bar1=Ib17Bar1+Beta*RawI17Bar1
            Ib14Bar1=Ib14Bar1+Beta*RawI14Bar1
            Ib2Bar1=Ib2Bar1+Beta*RawI2Bar1
            Ib8Bar1=Ib8Bar1+Beta*RawI8Bar1
            Ib18Bar1=Ib18Bar1+Beta*RawI18Bar1
            Ib6Bar1=Ib6Bar1+Beta*RawI6Bar1
            Ib16Bar1=Ib16Bar1+Beta*RawI16Bar1
            Ib13Bar1=Ib13Bar1+Beta*RawI13Bar1
            Ib5Bar1=Ib5Bar1+Beta*RawI5Bar1
            Ib15Bar1=Ib15Bar1+Beta*RawI15Bar1
            Ib12Bar1=Ib12Bar1+Beta*RawI12Bar1
            Ib11Bar1=Ib11Bar1+Beta*RawI11Bar1
            Ic4Bar4=Ic4Bar4+Gamma*RawI4Bar4
            Ic4Bar3=Ic4Bar3+Gamma*RawI4Bar3
            Ic4Bar2=Ic4Bar2+Gamma*RawI4Bar2
            Ic10Bar4=Ic10Bar4+Gamma*RawI10Bar4
            Ic10Bar3=Ic10Bar3+Gamma*RawI10Bar3
            Ic10Bar2=Ic10Bar2+Gamma*RawI10Bar2
            Ic3Bar4=Ic3Bar4+Gamma*RawI3Bar4
            Ic3Bar3=Ic3Bar3+Gamma*RawI3Bar3
            Ic3Bar2=Ic3Bar2+Gamma*RawI3Bar2
            Ic9Bar4=Ic9Bar4+Gamma*RawI9Bar4
            Ic9Bar3=Ic9Bar3+Gamma*RawI9Bar3
            Ic9Bar2=Ic9Bar2+Gamma*RawI9Bar2
            Ic7Bar4=Ic7Bar4+Gamma*RawI7Bar4
            Ic7Bar3=Ic7Bar3+Gamma*RawI7Bar3
            Ic7Bar2=Ic7Bar2+Gamma*RawI7Bar2
            Ic2Bar4=Ic2Bar4+Gamma*RawI2Bar4
            Ic2Bar3=Ic2Bar3+Gamma*RawI2Bar3
            Ic2Bar2=Ic2Bar2+Gamma*RawI2Bar2
            Ic8Bar4=Ic8Bar4+Gamma*RawI8Bar4
            Ic8Bar3=Ic8Bar3+Gamma*RawI8Bar3
            Ic8Bar2=Ic8Bar2+Gamma*RawI8Bar2
            Ic6Bar4=Ic6Bar4+Gamma*RawI6Bar4
            Ic6Bar3=Ic6Bar3+Gamma*RawI6Bar3
            Ic6Bar2=Ic6Bar2+Gamma*RawI6Bar2
            Ic5Bar4=Ic5Bar4+Gamma*RawI5Bar4
            Ic5Bar3=Ic5Bar3+Gamma*RawI5Bar3
            Ic5Bar2=Ic5Bar2+Gamma*RawI5Bar2
         ENDDO ! (M0| loop
      ENDDO ! |N0) loop
      ! HRR 
      V(1)=ABx*I1Bar1
      V(2)=-V(1)
      V(3)=-I2Bar1
      V(4)=ABx*Ia5Bar1
      V(5)=ABx*Ib5Bar1
      V(6)=ABx*Ib2Bar1
      V(7)=Ib5Bar1+V(6)
      V(8)=ABx*V(7)
      V(9)=ABx*Ic2Bar2
      V(10)=ABx*Ia6Bar1
      V(11)=ABy*Ib5Bar1
      V(12)=ABy*Ib2Bar1
      V(13)=Ib6Bar1+V(12)
      V(14)=ABx*V(13)
      V(15)=ABx*Ic2Bar3
      V(16)=-Ia12Bar1
      V(17)=-V(10)
      V(18)=-Ib12Bar1
      V(19)=-V(11)
      V(20)=-V(14)
      V(21)=ABx*Ia8Bar1
      V(22)=ABz*Ib5Bar1
      V(23)=ABz*Ib2Bar1
      V(24)=Ib8Bar1+V(23)
      V(25)=ABx*V(24)
      V(26)=ABx*Ic2Bar4
      V(27)=-Ia15Bar1
      V(28)=-V(21)
      V(29)=-Ib15Bar1
      V(30)=-V(22)
      V(31)=-V(25)
      V(32)=-I3Bar1
      V(33)=ABx*Ib6Bar1
      V(34)=ABx*Ib3Bar1
      V(35)=Ib6Bar1+V(34)
      V(36)=ABx*V(35)
      V(37)=ABx*Ic3Bar2
      V(38)=-Ic6Bar2
      V(39)=ABx*Ia7Bar1
      V(40)=ABy*Ib6Bar1
      V(41)=ABy*Ib3Bar1
      V(42)=Ib7Bar1+V(41)
      V(43)=ABx*V(42)
      V(44)=ABx*Ic3Bar3
      V(45)=-Ia13Bar1
      V(46)=-Ib13Bar1
      V(47)=-V(40)
      V(48)=-V(43)
      V(49)=-Ic6Bar3
      V(50)=ABx*Ia9Bar1
      V(51)=ABz*Ib6Bar1
      V(52)=ABz*Ib3Bar1
      V(53)=Ib9Bar1+V(52)
      V(54)=ABx*V(53)
      V(55)=ABx*Ic3Bar4
      V(56)=-Ia16Bar1
      V(57)=-V(50)
      V(58)=-Ib16Bar1
      V(59)=-V(51)
      V(60)=-V(54)
      V(61)=-Ic6Bar4
      V(62)=-I4Bar1
      V(63)=ABx*Ib8Bar1
      V(64)=ABx*Ib4Bar1
      V(65)=Ib8Bar1+V(64)
      V(66)=ABx*V(65)
      V(67)=ABx*Ic4Bar2
      V(68)=-Ic8Bar2
      V(69)=ABy*Ib8Bar1
      V(70)=ABy*Ib4Bar1
      V(71)=Ib9Bar1+V(70)
      V(72)=ABx*V(71)
      V(73)=ABx*Ic4Bar3
      V(74)=-V(69)
      V(75)=-V(72)
      V(76)=-Ic8Bar3
      V(77)=ABx*Ia10Bar1
      V(78)=ABz*Ib4Bar1
      V(79)=Ib10Bar1+V(78)
      V(80)=ABx*V(79)
      V(81)=ABz*Ib8Bar1
      V(82)=ABx*Ic4Bar4
      V(83)=-Ia18Bar1
      V(84)=-Ib18Bar1
      V(85)=-V(80)
      V(86)=-V(81)
      V(87)=-Ic8Bar4
      V(88)=ABy*I1Bar1
      V(89)=-V(88)
      V(90)=ABy*Ia5Bar1
      V(91)=ABy*Ic2Bar2
      V(92)=ABy*Ia6Bar1
      V(93)=ABy*V(13)
      V(94)=ABy*Ic2Bar3
      V(95)=-V(92)
      V(96)=ABy*Ia8Bar1
      V(97)=ABy*V(24)
      V(98)=ABy*Ic2Bar4
      V(99)=-V(96)
      V(100)=-V(97)
      V(101)=ABy*Ic3Bar2
      V(102)=ABy*Ia7Bar1
      V(103)=ABy*Ib7Bar1
      V(104)=ABy*V(42)
      V(105)=ABy*Ic3Bar3
      V(106)=ABy*Ia9Bar1
      V(107)=ABz*Ib7Bar1
      V(108)=ABy*V(53)
      V(109)=ABy*Ic3Bar4
      V(110)=-Ia17Bar1
      V(111)=-V(106)
      V(112)=-Ib17Bar1
      V(113)=-V(107)
      V(114)=-V(108)
      V(115)=ABy*Ic4Bar2
      V(116)=-Ic9Bar2
      V(117)=ABy*Ib9Bar1
      V(118)=ABy*V(71)
      V(119)=ABy*Ic4Bar3
      V(120)=-Ic9Bar3
      V(121)=ABy*Ia10Bar1
      V(122)=ABy*V(79)
      V(123)=ABz*Ib9Bar1
      V(124)=ABy*Ic4Bar4
      V(125)=-Ia19Bar1
      V(126)=-Ib19Bar1
      V(127)=-V(122)
      V(128)=-V(123)
      V(129)=-Ic9Bar4
      V(130)=ABz*I1Bar1
      V(131)=-V(130)
      V(132)=ABz*Ia5Bar1
      V(133)=ABz*Ic2Bar2
      V(134)=ABz*Ia6Bar1
      V(135)=ABz*Ic2Bar3
      V(136)=-V(134)
      V(137)=ABz*Ia8Bar1
      V(138)=ABz*V(24)
      V(139)=ABz*Ic2Bar4
      V(140)=-V(137)
      V(141)=ABz*Ic3Bar2
      V(142)=ABz*Ia7Bar1
      V(143)=ABz*Ic3Bar3
      V(144)=ABz*Ia9Bar1
      V(145)=ABz*V(53)
      V(146)=ABz*Ic3Bar4
      V(147)=-V(144)
      V(148)=ABz*Ic4Bar2
      V(149)=ABz*Ic4Bar3
      V(150)=ABz*Ia10Bar1
      V(151)=ABz*Ib10Bar1
      V(152)=ABz*V(79)
      V(153)=ABz*Ic4Bar4
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia11Bar1+dI(OffSet,CrtSet1)+V(2)+V(3)+V(4)
      dI(OffSet,CrtSet4)=Ib11Bar1+dI(OffSet,CrtSet4)+V(3)+V(5)+V(8)
      dI(OffSet,CrtSet7)=Ic5Bar2+dI(OffSet,CrtSet7)+V(9)
      W1=2.D0*I2Bar1-Ia11Bar1
      W2=-Ib11Bar1-Ic5Bar2+dI(OffSet,CrtSet10)
      W3=V(1)-V(4)
      W4=-V(5)
      W5=-V(8)-V(9)
      dI(OffSet,CrtSet10)=W1+W2+W3+W4+W5
      dI(OffSet,CrtSet2)=Ia12Bar1+dI(OffSet,CrtSet2)+V(10)
      dI(OffSet,CrtSet5)=Ib12Bar1+dI(OffSet,CrtSet5)+V(11)+V(14)
      dI(OffSet,CrtSet8)=Ic5Bar3+dI(OffSet,CrtSet8)+V(15)
      W1=-Ic5Bar3+dI(OffSet,CrtSet11)-V(15)+V(16)
      W2=V(17)+V(18)+V(19)+V(20)
      dI(OffSet,CrtSet11)=W1+W2
      dI(OffSet,CrtSet3)=Ia15Bar1+dI(OffSet,CrtSet3)+V(21)
      dI(OffSet,CrtSet6)=Ib15Bar1+dI(OffSet,CrtSet6)+V(22)+V(25)
      dI(OffSet,CrtSet9)=Ic5Bar4+dI(OffSet,CrtSet9)+V(26)
      W1=-Ic5Bar4+dI(OffSet,CrtSet12)-V(26)+V(27)
      W2=V(28)+V(29)+V(30)+V(31)
      dI(OffSet,CrtSet12)=W1+W2
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia12Bar1+dI(OffSet,CrtSet1)+V(10)
      dI(OffSet,CrtSet4)=Ib12Bar1+dI(OffSet,CrtSet4)+V(32)+V(33)+V(36)
      dI(OffSet,CrtSet7)=Ic6Bar2+dI(OffSet,CrtSet7)+V(37)
      W1=I3Bar1+dI(OffSet,CrtSet10)+V(16)+V(17)
      W2=V(18)-V(33)
      W3=-V(36)-V(37)+V(38)
      dI(OffSet,CrtSet10)=W1+W2+W3
      dI(OffSet,CrtSet2)=Ia13Bar1+dI(OffSet,CrtSet2)+V(2)+V(3)+V(39)
      dI(OffSet,CrtSet5)=Ib13Bar1+dI(OffSet,CrtSet5)+V(40)+V(43)
      dI(OffSet,CrtSet8)=Ic6Bar3+dI(OffSet,CrtSet8)+V(44)
      W1=I2Bar1+dI(OffSet,CrtSet11)
      W2=V(1)-V(39)-V(44)
      W3=V(45)+V(46)+V(47)+V(48)+V(49)
      dI(OffSet,CrtSet11)=W1+W2+W3
      dI(OffSet,CrtSet3)=Ia16Bar1+dI(OffSet,CrtSet3)+V(50)
      dI(OffSet,CrtSet6)=Ib16Bar1+dI(OffSet,CrtSet6)+V(51)+V(54)
      dI(OffSet,CrtSet9)=Ic6Bar4+dI(OffSet,CrtSet9)+V(55)
      W1=dI(OffSet,CrtSet12)-V(55)+V(56)+V(57)
      W2=V(58)+V(59)+V(60)+V(61)
      dI(OffSet,CrtSet12)=W1+W2
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia15Bar1+dI(OffSet,CrtSet1)+V(21)
      dI(OffSet,CrtSet4)=Ib15Bar1+dI(OffSet,CrtSet4)+V(62)+V(63)+V(66)
      dI(OffSet,CrtSet7)=Ic8Bar2+dI(OffSet,CrtSet7)+V(67)
      W1=I4Bar1+dI(OffSet,CrtSet10)+V(27)+V(28)
      W2=V(29)-V(63)
      W3=-V(66)-V(67)+V(68)
      dI(OffSet,CrtSet10)=W1+W2+W3
      dI(OffSet,CrtSet2)=Ia16Bar1+dI(OffSet,CrtSet2)+V(50)
      dI(OffSet,CrtSet5)=Ib16Bar1+dI(OffSet,CrtSet5)+V(69)+V(72)
      dI(OffSet,CrtSet8)=Ic8Bar3+dI(OffSet,CrtSet8)+V(73)
      W1=dI(OffSet,CrtSet11)+V(56)+V(57)+V(58)
      W2=-V(73)+V(74)+V(75)+V(76)
      dI(OffSet,CrtSet11)=W1+W2
      dI(OffSet,CrtSet3)=Ia18Bar1+dI(OffSet,CrtSet3)+V(2)+V(3)+V(77)
      dI(OffSet,CrtSet6)=Ib18Bar1+dI(OffSet,CrtSet6)+V(80)+V(81)
      dI(OffSet,CrtSet9)=Ic8Bar4+dI(OffSet,CrtSet9)+V(82)
      W1=I2Bar1+dI(OffSet,CrtSet12)
      W2=V(1)-V(77)-V(82)
      W3=V(83)+V(84)+V(85)+V(86)+V(87)
      dI(OffSet,CrtSet12)=W1+W2+W3
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia12Bar1+dI(OffSet,CrtSet1)+V(32)+V(89)+V(90)
      dI(OffSet,CrtSet4)=Ib12Bar1+dI(OffSet,CrtSet4)+V(11)+V(14)
      dI(OffSet,CrtSet7)=Ic6Bar2+dI(OffSet,CrtSet7)+V(91)
      W1=I3Bar1+dI(OffSet,CrtSet10)+V(16)+V(18)+V(19)
      W2=V(20)+V(38)
      W3=V(88)-V(90)-V(91)
      dI(OffSet,CrtSet10)=W1+W2+W3
      dI(OffSet,CrtSet2)=Ia13Bar1+dI(OffSet,CrtSet2)+V(92)
      dI(OffSet,CrtSet5)=Ib13Bar1+dI(OffSet,CrtSet5)+V(3)+V(40)+V(93)
      dI(OffSet,CrtSet8)=Ic6Bar3+dI(OffSet,CrtSet8)+V(94)
      W1=I2Bar1+dI(OffSet,CrtSet11)+V(45)+V(46)
      W2=V(47)+V(49)
      W3=-V(93)-V(94)+V(95)
      dI(OffSet,CrtSet11)=W1+W2+W3
      dI(OffSet,CrtSet3)=Ia16Bar1+dI(OffSet,CrtSet3)+V(96)
      dI(OffSet,CrtSet6)=Ib16Bar1+dI(OffSet,CrtSet6)+V(51)+V(97)
      dI(OffSet,CrtSet9)=Ic6Bar4+dI(OffSet,CrtSet9)+V(98)
      W1=dI(OffSet,CrtSet12)+V(56)+V(58)+V(59)
      W2=V(61)-V(98)+V(99)+V(100)
      dI(OffSet,CrtSet12)=W1+W2
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia13Bar1+dI(OffSet,CrtSet1)+V(92)
      dI(OffSet,CrtSet4)=Ib13Bar1+dI(OffSet,CrtSet4)+V(40)+V(43)
      dI(OffSet,CrtSet7)=Ic7Bar2+dI(OffSet,CrtSet7)+V(101)
      W1=-Ic7Bar2+dI(OffSet,CrtSet10)+V(45)+V(46)
      W2=V(47)+V(48)+V(95)-V(101)
      dI(OffSet,CrtSet10)=W1+W2
      dI(OffSet,CrtSet2)=Ia14Bar1+dI(OffSet,CrtSet2)+V(32)+V(89)+V(102)
      dI(OffSet,CrtSet5)=Ib14Bar1+dI(OffSet,CrtSet5)+V(32)+V(103)+V(104)
      dI(OffSet,CrtSet8)=Ic7Bar3+dI(OffSet,CrtSet8)+V(105)
      W1=2.D0*I3Bar1-Ia14Bar1
      W2=-Ib14Bar1-Ic7Bar3+dI(OffSet,CrtSet11)
      W3=V(88)-V(102)
      W4=-V(103)
      W5=-V(104)-V(105)
      dI(OffSet,CrtSet11)=W1+W2+W3+W4+W5
      dI(OffSet,CrtSet3)=Ia17Bar1+dI(OffSet,CrtSet3)+V(106)
      dI(OffSet,CrtSet6)=Ib17Bar1+dI(OffSet,CrtSet6)+V(107)+V(108)
      dI(OffSet,CrtSet9)=Ic7Bar4+dI(OffSet,CrtSet9)+V(109)
      W1=-Ic7Bar4+dI(OffSet,CrtSet12)-V(109)+V(110)
      W2=V(111)+V(112)+V(113)+V(114)
      dI(OffSet,CrtSet12)=W1+W2
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia16Bar1+dI(OffSet,CrtSet1)+V(96)
      dI(OffSet,CrtSet4)=Ib16Bar1+dI(OffSet,CrtSet4)+V(69)+V(72)
      dI(OffSet,CrtSet7)=Ic9Bar2+dI(OffSet,CrtSet7)+V(115)
      W1=dI(OffSet,CrtSet10)+V(56)+V(58)+V(74)
      W2=V(75)+V(99)-V(115)+V(116)
      dI(OffSet,CrtSet10)=W1+W2
      dI(OffSet,CrtSet2)=Ia17Bar1+dI(OffSet,CrtSet2)+V(106)
      dI(OffSet,CrtSet5)=Ib17Bar1+dI(OffSet,CrtSet5)+V(62)+V(117)+V(118)
      dI(OffSet,CrtSet8)=Ic9Bar3+dI(OffSet,CrtSet8)+V(119)
      W1=I4Bar1+dI(OffSet,CrtSet11)+V(110)+V(111)
      W2=V(112)-V(117)
      W3=-V(118)-V(119)+V(120)
      dI(OffSet,CrtSet11)=W1+W2+W3
      dI(OffSet,CrtSet3)=Ia19Bar1+dI(OffSet,CrtSet3)+V(32)+V(89)+V(121)
      dI(OffSet,CrtSet6)=Ib19Bar1+dI(OffSet,CrtSet6)+V(122)+V(123)
      dI(OffSet,CrtSet9)=Ic9Bar4+dI(OffSet,CrtSet9)+V(124)
      W1=I3Bar1+dI(OffSet,CrtSet12)
      W2=V(88)-V(121)-V(124)
      W3=V(125)+V(126)+V(127)+V(128)+V(129)
      dI(OffSet,CrtSet12)=W1+W2+W3
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia15Bar1+dI(OffSet,CrtSet1)+V(62)+V(131)+V(132)
      dI(OffSet,CrtSet4)=Ib15Bar1+dI(OffSet,CrtSet4)+V(22)+V(25)
      dI(OffSet,CrtSet7)=Ic8Bar2+dI(OffSet,CrtSet7)+V(133)
      W1=I4Bar1+dI(OffSet,CrtSet10)+V(27)+V(29)+V(30)
      W2=V(31)+V(68)
      W3=V(130)-V(132)-V(133)
      dI(OffSet,CrtSet10)=W1+W2+W3
      dI(OffSet,CrtSet2)=Ia16Bar1+dI(OffSet,CrtSet2)+V(134)
      dI(OffSet,CrtSet5)=Ib16Bar1+dI(OffSet,CrtSet5)+V(51)+V(97)
      dI(OffSet,CrtSet8)=Ic8Bar3+dI(OffSet,CrtSet8)+V(135)
      W1=dI(OffSet,CrtSet11)+V(56)+V(58)+V(59)
      W2=V(76)+V(100)-V(135)+V(136)
      dI(OffSet,CrtSet11)=W1+W2
      dI(OffSet,CrtSet3)=Ia18Bar1+dI(OffSet,CrtSet3)+V(137)
      dI(OffSet,CrtSet6)=Ib18Bar1+dI(OffSet,CrtSet6)+V(3)+V(81)+V(138)
      dI(OffSet,CrtSet9)=Ic8Bar4+dI(OffSet,CrtSet9)+V(139)
      W1=I2Bar1+dI(OffSet,CrtSet12)+V(83)+V(84)
      W2=V(86)+V(87)
      W3=-V(138)-V(139)+V(140)
      dI(OffSet,CrtSet12)=W1+W2+W3
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia16Bar1+dI(OffSet,CrtSet1)+V(134)
      dI(OffSet,CrtSet4)=Ib16Bar1+dI(OffSet,CrtSet4)+V(51)+V(54)
      dI(OffSet,CrtSet7)=Ic9Bar2+dI(OffSet,CrtSet7)+V(141)
      W1=dI(OffSet,CrtSet10)+V(56)+V(58)+V(59)
      W2=V(60)+V(116)+V(136)-V(141)
      dI(OffSet,CrtSet10)=W1+W2
      dI(OffSet,CrtSet2)=Ia17Bar1+dI(OffSet,CrtSet2)+V(62)+V(131)+V(142)
      dI(OffSet,CrtSet5)=Ib17Bar1+dI(OffSet,CrtSet5)+V(107)+V(108)
      dI(OffSet,CrtSet8)=Ic9Bar3+dI(OffSet,CrtSet8)+V(143)
      W1=I4Bar1+dI(OffSet,CrtSet11)+V(110)+V(112)+V(113)
      W2=V(114)+V(120)
      W3=V(130)-V(142)-V(143)
      dI(OffSet,CrtSet11)=W1+W2+W3
      dI(OffSet,CrtSet3)=Ia19Bar1+dI(OffSet,CrtSet3)+V(144)
      dI(OffSet,CrtSet6)=Ib19Bar1+dI(OffSet,CrtSet6)+V(32)+V(123)+V(145)
      dI(OffSet,CrtSet9)=Ic9Bar4+dI(OffSet,CrtSet9)+V(146)
      W1=I3Bar1+dI(OffSet,CrtSet12)+V(125)+V(126)
      W2=V(128)+V(129)
      W3=-V(145)-V(146)+V(147)
      dI(OffSet,CrtSet12)=W1+W2+W3
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD !=ZippyForPres
      dI(OffSet,CrtSet1)=Ia18Bar1+dI(OffSet,CrtSet1)+V(137)
      dI(OffSet,CrtSet4)=Ib18Bar1+dI(OffSet,CrtSet4)+V(80)+V(81)
      dI(OffSet,CrtSet7)=Ic10Bar2+dI(OffSet,CrtSet7)+V(148)
      W1=-Ic10Bar2+dI(OffSet,CrtSet10)+V(83)+V(84)
      W2=V(85)+V(86)+V(140)-V(148)
      dI(OffSet,CrtSet10)=W1+W2
      dI(OffSet,CrtSet2)=Ia19Bar1+dI(OffSet,CrtSet2)+V(144)
      dI(OffSet,CrtSet5)=Ib19Bar1+dI(OffSet,CrtSet5)+V(122)+V(123)
      dI(OffSet,CrtSet8)=Ic10Bar3+dI(OffSet,CrtSet8)+V(149)
      W1=-Ic10Bar3+dI(OffSet,CrtSet11)+V(125)+V(126)
      W2=V(127)+V(128)+V(147)-V(149)
      dI(OffSet,CrtSet11)=W1+W2
      dI(OffSet,CrtSet3)=Ia20Bar1+dI(OffSet,CrtSet3)+V(62)+V(131)+V(150)
      dI(OffSet,CrtSet6)=Ib20Bar1+dI(OffSet,CrtSet6)+V(62)+V(151)+V(152)
      dI(OffSet,CrtSet9)=Ic10Bar4+dI(OffSet,CrtSet9)+V(153)
      W1=2.D0*I4Bar1-Ia20Bar1
      W2=-Ib20Bar1-Ic10Bar4+dI(OffSet,CrtSet12)
      W3=V(130)-V(150)
      W4=-V(151)
      W5=-V(152)-V(153)
      dI(OffSet,CrtSet12)=W1+W2+W3+W4+W5
   END SUBROUTINE dInt3311
