! ---------------------------------------------------------- 
! COMPUTES THE INTEGRAL CLASS (P P|S S) 
! ---------------------------------------------------------- 
   SUBROUTINE dInt3311(PrmBufB,LBra,PrmBufK,LKet,ACInfo,BDInfo, & 
                              OA,LDA,OB,LDB,OC,LDC,OD,LDD,PBC,dI) 
      USE DerivedTypes
      USE GlobalScalars
      USE ShellPairStruct
      USE GammaF2
      IMPLICIT REAL(DOUBLE) (A,I,V,W)
      INTEGER        :: LBra,LKet
      REAL(DOUBLE)   :: PrmBufB(7,LBra),PrmBufK(7,LKet)
      TYPE(SmallAtomInfo) :: ACInfo,BDInfo
      TYPE(PBCInfo) :: PBC
      REAL(DOUBLE) :: dI(12,*)
      REAL(DOUBLE)  :: Zeta,Eta,r1xZpE,HfxZpE,r1x2E,r1x2Z,ExZpE,ZxZpE,Omega,Up,Uq,Upq
      REAL(DOUBLE)  :: Ax,Ay,Az,Bx,By,Bz,Cx,Cy,Cz,Dx,Dy,Dz,Qx,Qy,Qz,Px,Py,Pz
      REAL(DOUBLE)  :: QCx,QCy,QCz,PAx,PAy,PAz,PQx,PQy,PQz,WPx,WPy,WPz,WQx,WQy,WQz   
      REAL(DOUBLE)  :: T,ET,TwoT,InvT,SqInvT,ABx,ABy,ABz,CDx,CDy,CDz
      REAL(DOUBLE)  :: Alpha,Beta,Gamma
      INTEGER       :: OffSet
      INTEGER       :: OA,LDA,OB,LDB,OC,LDC,OD,LDD,J,K,L
      REAL(DOUBLE)  :: FPQx,FPQy,FPQz
      I1Bar1=0.0d0
      I2Bar1=0.0d0
      I3Bar1=0.0d0
      I4Bar1=0.0d0
      I5Bar1=0.0d0
      I6Bar1=0.0d0
      I7Bar1=0.0d0
      I8Bar1=0.0d0
      I9Bar1=0.0d0
      I10Bar1=0.0d0
      I11Bar1=0.0d0
      I12Bar1=0.0d0
      I13Bar1=0.0d0
      I14Bar1=0.0d0
      I15Bar1=0.0d0
      I16Bar1=0.0d0
      I17Bar1=0.0d0
      I18Bar1=0.0d0
      I19Bar1=0.0d0
      I20Bar1=0.0d0
      I1Bar2=0.0d0
      I2Bar2=0.0d0
      I3Bar2=0.0d0
      I4Bar2=0.0d0
      I5Bar2=0.0d0
      I6Bar2=0.0d0
      I7Bar2=0.0d0
      I8Bar2=0.0d0
      I9Bar2=0.0d0
      I10Bar2=0.0d0
      I1Bar3=0.0d0
      I2Bar3=0.0d0
      I3Bar3=0.0d0
      I4Bar3=0.0d0
      I5Bar3=0.0d0
      I6Bar3=0.0d0
      I7Bar3=0.0d0
      I8Bar3=0.0d0
      I9Bar3=0.0d0
      I10Bar3=0.0d0
      I1Bar4=0.0d0
      I2Bar4=0.0d0
      I3Bar4=0.0d0
      I4Bar4=0.0d0
      I5Bar4=0.0d0
      I6Bar4=0.0d0
      I7Bar4=0.0d0
      I8Bar4=0.0d0
      I9Bar4=0.0d0
      I10Bar4=0.0d0
      Ia10Bar1=0D0
      Ia20Bar1=0D0
      Ia9Bar1=0D0
      Ia19Bar1=0D0
      Ia7Bar1=0D0
      Ia17Bar1=0D0
      Ia14Bar1=0D0
      Ia8Bar1=0D0
      Ia18Bar1=0D0
      Ia6Bar1=0D0
      Ia16Bar1=0D0
      Ia13Bar1=0D0
      Ia5Bar1=0D0
      Ia15Bar1=0D0
      Ia12Bar1=0D0
      Ia11Bar1=0D0
      Ib4Bar1=0D0
      Ib10Bar1=0D0
      Ib20Bar1=0D0
      Ib3Bar1=0D0
      Ib9Bar1=0D0
      Ib19Bar1=0D0
      Ib7Bar1=0D0
      Ib17Bar1=0D0
      Ib14Bar1=0D0
      Ib2Bar1=0D0
      Ib8Bar1=0D0
      Ib18Bar1=0D0
      Ib6Bar1=0D0
      Ib16Bar1=0D0
      Ib13Bar1=0D0
      Ib5Bar1=0D0
      Ib15Bar1=0D0
      Ib12Bar1=0D0
      Ib11Bar1=0D0
      Ic4Bar4=0D0
      Ic4Bar3=0D0
      Ic4Bar2=0D0
      Ic10Bar4=0D0
      Ic10Bar3=0D0
      Ic10Bar2=0D0
      Ic3Bar4=0D0
      Ic3Bar3=0D0
      Ic3Bar2=0D0
      Ic9Bar4=0D0
      Ic9Bar3=0D0
      Ic9Bar2=0D0
      Ic7Bar4=0D0
      Ic7Bar3=0D0
      Ic7Bar2=0D0
      Ic2Bar4=0D0
      Ic2Bar3=0D0
      Ic2Bar2=0D0
      Ic8Bar4=0D0
      Ic8Bar3=0D0
      Ic8Bar2=0D0
      Ic6Bar4=0D0
      Ic6Bar3=0D0
      Ic6Bar2=0D0
      Ic5Bar4=0D0
      Ic5Bar3=0D0
      Ic5Bar2=0D0
      Ax=ACInfo%Atm1X
      Ay=ACInfo%Atm1Y
      Az=ACInfo%Atm1Z
      Bx=ACInfo%Atm2X
      By=ACInfo%Atm2Y
      Bz=ACInfo%Atm2Z
      Cx=BDInfo%Atm1X
      Cy=BDInfo%Atm1Y
      Cz=BDInfo%Atm1Z
      Dx=BDInfo%Atm2X
      Dy=BDInfo%Atm2Y
      Dz=BDInfo%Atm2Z
      ABx=Ax-Bx
      ABy=Ay-By
      ABz=Az-Bz
      CDx=Cx-Dx
      CDy=Cy-Dy
      CDz=Cz-Dz
      DO J=1,LKet ! K^2 VRR |N0) loop 
         Eta=PrmBufK(1,J)
         Qx =PrmBufK(2,J)
         Qy =PrmBufK(3,J)
         Qz =PrmBufK(4,J)
         Uq =PrmBufK(5,J)
         Gamma =PrmBufK(6,J)
         QCx=Qx-Cx
         QCy=Qy-Cy
         QCz=Qz-Cz
         DO K=1,LBra ! K^2 VRR (M0| loop 
            Zeta=PrmBufB(1,K)
            Px  =PrmBufB(2,K)
            Py  =PrmBufB(3,K)
            Pz  =PrmBufB(4,K)
            Up  =PrmBufB(5,K)
            Alpha =PrmBufB(6,K)
            Beta  =PrmBufB(7,K)
            r1xZpE=One/(Zeta+Eta)
            Upq=SQRT(r1xZpE)*Up*Uq
            HfxZpE=Half/(Zeta+Eta)
            r1x2E=Half/Eta
            r1x2Z=Half/Zeta
            ExZpE=Eta*r1xZpE
            ZxZpE=Zeta*r1xZpE
            Omega=Eta*Zeta*r1xZpE
            PAx=Px-Ax
            PAy=Py-Ay
            PAz=Pz-Az
            PQx=Px-Qx
            PQy=Py-Qy
            PQz=Pz-Qz
      ! Need to be improve...
            FPQx = PQx*PBC%InvBoxSh%D(1,1)+PQy*PBC%InvBoxSh%D(1,2)+PQz*PBC%InvBoxSh%D(1,3)
            FPQy = PQy*PBC%InvBoxSh%D(2,2)+PQz*PBC%InvBoxSh%D(2,3)
            FPQz = PQz*PBC%InvBoxSh%D(3,3)
            IF(PBC%AutoW%I(1)==1) FPQx = FPQx-ANINT(ANINT(FPQx*1d9)*1d-9)
            IF(PBC%AutoW%I(2)==1) FPQy = FPQy-ANINT(ANINT(FPQy*1d9)*1d-9)
            IF(PBC%AutoW%I(3)==1) FPQz = FPQz-ANINT(ANINT(FPQz*1d9)*1d-9)
            PQx  = FPQx*PBC%BoxShape%D(1,1)+FPQy*PBC%BoxShape%D(1,2)+FPQz*PBC%BoxShape%D(1,3)
            PQy  = FPQy*PBC%BoxShape%D(2,2)+FPQz*PBC%BoxShape%D(2,3)
            PQz  = FPQz*PBC%BoxShape%D(3,3)
      !
            WPx = -Eta*PQx*r1xZpE
            WPy = -Eta*PQy*r1xZpE
            WPz = -Eta*PQz*r1xZpE
            WQx = Zeta*PQx*r1xZpE
            WQy = Zeta*PQy*r1xZpE
            WQz = Zeta*PQz*r1xZpE
            T=Omega*(PQx*PQx+PQy*PQy+PQz*PQz)
            IF(T<Gamma_Switch)THEN
              L=AINT(T*Gamma_Grid)
              ET=EXP(-T)
              TwoT=Two*T
              W3=(F3_0(L)+T*(F3_1(L)+T*(F3_2(L)+T*(F3_3(L)+T*F3_4(L)))))
              W2=+2.000000000000000D-01*(TwoT*W3+ET)
              W1=+3.333333333333333D-01*(TwoT*W2+ET)
              W0=TwoT*W1+ET
              AuxR0=Upq*W0
              AuxR1=Upq*W1
              AuxR2=Upq*W2
              AuxR3=Upq*W3
            ELSE
              InvT=One/T
              SqInvT=DSQRT(InvT)
              AuxR0=+8.862269254527580D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR1=+4.431134627263790D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR2=+6.646701940895685D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR3=+1.661675485223921D+00*Upq*SqInvT
            ENDIF
            V1=AuxR0*PAx
            V2=AuxR1*WPx
            V3=AuxR0*PAy
            V4=AuxR1*WPy
            V5=AuxR0*PAz
            V6=AuxR1*WPz
            V7=-(AuxR1*ExZpE)
            V8=AuxR0+V7
            V9=r1x2Z*V8
            V10=V1+V2
            V11=PAx*V10
            V12=AuxR1*PAx
            V13=AuxR2*WPx
            V14=V12+V13
            V15=V14*WPx
            V16=V3+V4
            V17=PAx*V16
            V18=AuxR1*PAy
            V19=AuxR2*WPy
            V20=V18+V19
            V21=V20*WPx
            V22=PAy*V16
            V23=V20*WPy
            V24=V5+V6
            V25=PAx*V24
            V26=AuxR1*PAz
            V27=AuxR2*WPz
            V28=V26+V27
            V29=V28*WPx
            V30=PAy*V24
            V31=V28*WPy
            V32=PAz*V24
            V33=V28*WPz
            V34=-(ExZpE*V14)
            V35=V1+V2+V34
            V36=-(AuxR2*ExZpE)
            V37=AuxR1+V36
            V38=r1x2Z*V37
            V39=AuxR2*PAx
            V40=AuxR3*WPx
            V41=V39+V40
            V42=-(ExZpE*V20)
            V43=V3+V4+V42
            V44=r1x2Z*V43
            V45=V17+V21
            V46=PAx*V20
            V47=AuxR2*PAy
            V48=AuxR3*WPy
            V49=V47+V48
            V50=V49*WPx
            V51=V46+V50
            V52=r1x2Z*V35
            V53=-(ExZpE*V28)
            V54=V5+V53+V6
            V55=r1x2Z*V54
            V56=V25+V29
            V57=PAx*V28
            V58=AuxR2*PAz
            V59=AuxR3*WPz
            V60=V58+V59
            V61=V60*WPx
            V62=V57+V61
            V63=V30+V31
            V64=PAy*V28
            V65=V60*WPy
            V66=V64+V65
            V67=AuxR0*QCx
            V68=AuxR1*WQx
            V69=AuxR1*HfxZpE
            V70=QCx*V10
            V71=V14*WQx
            V72=QCx*V16
            V73=V20*WQx
            V74=QCx*V24
            V75=V28*WQx
            V76=HfxZpE*V14
            V77=AuxR2*HfxZpE
            V78=AuxR1*QCx
            V79=AuxR2*WQx
            V80=V78+V79
            V81=-(ExZpE*V80)
            V82=V67+V68+V81
            V83=r1x2Z*V82
            V84=HfxZpE*V20
            V85=HfxZpE*V28
            V86=AuxR0*QCy
            V87=AuxR1*WQy
            V88=QCy*V10
            V89=V14*WQy
            V90=QCy*V16
            V91=V20*WQy
            V92=QCy*V24
            V93=V28*WQy
            V94=AuxR1*QCy
            V95=AuxR2*WQy
            V96=V94+V95
            V97=-(ExZpE*V96)
            V98=V86+V87+V97
            V99=r1x2Z*V98
            V100=AuxR0*QCz
            V101=AuxR1*WQz
            V102=QCz*V10
            V103=V14*WQz
            V104=QCz*V16
            V105=V20*WQz
            V106=QCz*V24
            V107=V28*WQz
            V108=AuxR1*QCz
            V109=AuxR2*WQz
            V110=V108+V109
            V111=-(ExZpE*V110)
            V112=V100+V101+V111
            V113=r1x2Z*V112
            I1Bar1=AuxR0+I1Bar1
            I2Bar1=V1+V2+I2Bar1
            I3Bar1=V3+V4+I3Bar1
            I4Bar1=V5+V6+I4Bar1
            I5Bar1=V11+V15+V9+I5Bar1
            I6Bar1=V17+V21+I6Bar1
            I7Bar1=V22+V23+V9+I7Bar1
            I8Bar1=V25+V29+I8Bar1
            I9Bar1=V30+V31+I9Bar1
            I10Bar1=V32+V33+V9+I10Bar1
            I11Bar1=2.D0*r1x2Z*V35+PAx*(V11+V15+V9)+WPx*(PAx*V14+V38+V41*WPx)+I11Bar1
            I12Bar1=V44+PAx*V45+V51*WPx+I12Bar1
            I13Bar1=PAy*V45+V52+V51*WPy+I13Bar1
            I14Bar1=2.D0*r1x2Z*V43+PAy*(V22+V23+V9)+WPy*(PAy*V20+V38+V49*WPy)+I14Bar1
            I15Bar1=V55+PAx*V56+V62*WPx+I15Bar1
            I16Bar1=PAx*V63+V66*WPx+I16Bar1
            I17Bar1=V55+PAy*V63+V66*WPy+I17Bar1
            I18Bar1=V52+PAz*V56+V62*WPz+I18Bar1
            I19Bar1=V44+PAz*V63+V66*WPz+I19Bar1
            I20Bar1=2.D0*r1x2Z*V54+PAz*(V32+V33+V9)+WPz*(PAz*V28+V38+V60*WPz)+I20Bar1
            I1Bar2=V67+V68+I1Bar2
            I2Bar2=V69+V70+V71+I2Bar2
            I3Bar2=V72+V73+I3Bar2
            I4Bar2=V74+V75+I4Bar2
            I5Bar2=PAx*(V69+V70+V71)+V76+V83+WPx*(QCx*V14+V77+V41*WQx)+I5Bar2
            I6Bar2=QCx*V45+V84+V51*WQx+I6Bar2
            I7Bar2=PAy*(V72+V73)+V83+WPy*(QCx*V20+V49*WQx)+I7Bar2
            I8Bar2=QCx*V56+V85+V62*WQx+I8Bar2
            I9Bar2=QCx*V63+V66*WQx+I9Bar2
            I10Bar2=PAz*(V74+V75)+V83+WPz*(QCx*V28+V60*WQx)+I10Bar2
            I1Bar3=V86+V87+I1Bar3
            I2Bar3=V88+V89+I2Bar3
            I3Bar3=V69+V90+V91+I3Bar3
            I4Bar3=V92+V93+I4Bar3
            I5Bar3=PAx*(V88+V89)+V99+WPx*(QCy*V14+V41*WQy)+I5Bar3
            I6Bar3=QCy*V45+V76+V51*WQy+I6Bar3
            I7Bar3=V84+PAy*(V69+V90+V91)+V99+WPy*(QCy*V20+V77+V49*WQy)+I7Bar3
            I8Bar3=QCy*V56+V62*WQy+I8Bar3
            I9Bar3=QCy*V63+V85+V66*WQy+I9Bar3
            I10Bar3=PAz*(V92+V93)+V99+WPz*(QCy*V28+V60*WQy)+I10Bar3
            I1Bar4=V100+V101+I1Bar4
            I2Bar4=V102+V103+I2Bar4
            I3Bar4=V104+V105+I3Bar4
            I4Bar4=V106+V107+V69+I4Bar4
            I5Bar4=PAx*(V102+V103)+V113+WPx*(QCz*V14+V41*WQz)+I5Bar4
            I6Bar4=QCz*V45+V51*WQz+I6Bar4
            I7Bar4=PAy*(V104+V105)+V113+WPy*(QCz*V20+V49*WQz)+I7Bar4
            I8Bar4=QCz*V56+V76+V62*WQz+I8Bar4
            I9Bar4=QCz*V63+V84+V66*WQz+I9Bar4
            I10Bar4=V113+PAz*(V106+V107+V69)+V85+WPz*(QCz*V28+V77+V60*WQz)+I10Bar4
            Ia10Bar1=Ia10Bar1+Alpha*I10Bar1
            Ia20Bar1=Ia20Bar1+Alpha*I20Bar1
            Ia9Bar1=Ia9Bar1+Alpha*I9Bar1
            Ia19Bar1=Ia19Bar1+Alpha*I19Bar1
            Ia7Bar1=Ia7Bar1+Alpha*I7Bar1
            Ia17Bar1=Ia17Bar1+Alpha*I17Bar1
            Ia14Bar1=Ia14Bar1+Alpha*I14Bar1
            Ia8Bar1=Ia8Bar1+Alpha*I8Bar1
            Ia18Bar1=Ia18Bar1+Alpha*I18Bar1
            Ia6Bar1=Ia6Bar1+Alpha*I6Bar1
            Ia16Bar1=Ia16Bar1+Alpha*I16Bar1
            Ia13Bar1=Ia13Bar1+Alpha*I13Bar1
            Ia5Bar1=Ia5Bar1+Alpha*I5Bar1
            Ia15Bar1=Ia15Bar1+Alpha*I15Bar1
            Ia12Bar1=Ia12Bar1+Alpha*I12Bar1
            Ia11Bar1=Ia11Bar1+Alpha*I11Bar1
            Ib4Bar1=Ib4Bar1+Beta*I4Bar1
            Ib10Bar1=Ib10Bar1+Beta*I10Bar1
            Ib20Bar1=Ib20Bar1+Beta*I20Bar1
            Ib3Bar1=Ib3Bar1+Beta*I3Bar1
            Ib9Bar1=Ib9Bar1+Beta*I9Bar1
            Ib19Bar1=Ib19Bar1+Beta*I19Bar1
            Ib7Bar1=Ib7Bar1+Beta*I7Bar1
            Ib17Bar1=Ib17Bar1+Beta*I17Bar1
            Ib14Bar1=Ib14Bar1+Beta*I14Bar1
            Ib2Bar1=Ib2Bar1+Beta*I2Bar1
            Ib8Bar1=Ib8Bar1+Beta*I8Bar1
            Ib18Bar1=Ib18Bar1+Beta*I18Bar1
            Ib6Bar1=Ib6Bar1+Beta*I6Bar1
            Ib16Bar1=Ib16Bar1+Beta*I16Bar1
            Ib13Bar1=Ib13Bar1+Beta*I13Bar1
            Ib5Bar1=Ib5Bar1+Beta*I5Bar1
            Ib15Bar1=Ib15Bar1+Beta*I15Bar1
            Ib12Bar1=Ib12Bar1+Beta*I12Bar1
            Ib11Bar1=Ib11Bar1+Beta*I11Bar1
            Ic4Bar4=Ic4Bar4+Gamma*I4Bar4
            Ic4Bar3=Ic4Bar3+Gamma*I4Bar3
            Ic4Bar2=Ic4Bar2+Gamma*I4Bar2
            Ic10Bar4=Ic10Bar4+Gamma*I10Bar4
            Ic10Bar3=Ic10Bar3+Gamma*I10Bar3
            Ic10Bar2=Ic10Bar2+Gamma*I10Bar2
            Ic3Bar4=Ic3Bar4+Gamma*I3Bar4
            Ic3Bar3=Ic3Bar3+Gamma*I3Bar3
            Ic3Bar2=Ic3Bar2+Gamma*I3Bar2
            Ic9Bar4=Ic9Bar4+Gamma*I9Bar4
            Ic9Bar3=Ic9Bar3+Gamma*I9Bar3
            Ic9Bar2=Ic9Bar2+Gamma*I9Bar2
            Ic7Bar4=Ic7Bar4+Gamma*I7Bar4
            Ic7Bar3=Ic7Bar3+Gamma*I7Bar3
            Ic7Bar2=Ic7Bar2+Gamma*I7Bar2
            Ic2Bar4=Ic2Bar4+Gamma*I2Bar4
            Ic2Bar3=Ic2Bar3+Gamma*I2Bar3
            Ic2Bar2=Ic2Bar2+Gamma*I2Bar2
            Ic8Bar4=Ic8Bar4+Gamma*I8Bar4
            Ic8Bar3=Ic8Bar3+Gamma*I8Bar3
            Ic8Bar2=Ic8Bar2+Gamma*I8Bar2
            Ic6Bar4=Ic6Bar4+Gamma*I6Bar4
            Ic6Bar3=Ic6Bar3+Gamma*I6Bar3
            Ic6Bar2=Ic6Bar2+Gamma*I6Bar2
            Ic5Bar4=Ic5Bar4+Gamma*I5Bar4
            Ic5Bar3=Ic5Bar3+Gamma*I5Bar3
            Ic5Bar2=Ic5Bar2+Gamma*I5Bar2
         ENDDO ! (M0| loop
      ENDDO ! |N0) loop
      ! HRR 
      V1=LDA*OA
      V2=LDB*OB
      V3=LDC*OC
      V4=LDD*OD
      V5=V1+V2+V3+V4
      V6=-(ABx*I1Bar1)
      V7=-I2Bar1
      V8=ABx*Ia6Bar1
      V9=ABy*Ib5Bar1
      V10=ABy*Ib2Bar1
      V11=Ib6Bar1+V10
      V12=ABy*V11
      V13=ABx*Ia8Bar1
      V14=ABz*Ib5Bar1
      V15=ABz*Ib2Bar1
      V16=Ib8Bar1+V15
      V17=ABz*V16
      V18=1.D0+OA
      V19=LDA*V18
      V20=-I3Bar1
      V21=1+OA
      V22=LDA*V21
      V23=V2+V22+V3+V4
      V24=ABy*Ib6Bar1
      V25=ABy*Ib3Bar1
      V26=Ib7Bar1+V25
      V27=ABy*V26
      V28=ABx*Ia9Bar1
      V29=ABz*Ib6Bar1
      V30=ABz*Ib3Bar1
      V31=Ib9Bar1+V30
      V32=ABz*V31
      V33=2.D0+OA
      V34=LDA*V33
      V35=-I4Bar1
      V36=2+OA
      V37=LDA*V36
      V38=V2+V3+V37+V4
      V39=ABy*Ib8Bar1
      V40=ABy*Ib4Bar1
      V41=Ib9Bar1+V40
      V42=ABy*V41
      V43=ABz*Ib4Bar1
      V44=Ib10Bar1+V43
      V45=ABz*V44
      V46=ABz*Ib8Bar1
      V47=1.D0+OB
      V48=LDB*V47
      V49=-(ABy*I1Bar1)
      V50=1+OB
      V51=LDB*V50
      V52=V1+V3+V4+V51
      V53=ABy*Ia6Bar1
      V54=ABy*Ia8Bar1
      V55=V22+V3+V4+V51
      V56=ABy*Ia9Bar1
      V57=ABz*Ib7Bar1
      V58=V3+V37+V4+V51
      V59=ABz*Ib9Bar1
      V60=2.D0+OB
      V61=LDB*V60
      V62=-(ABz*I1Bar1)
      V63=2+OB
      V64=LDB*V63
      V65=V1+V3+V4+V64
      V66=ABz*Ia6Bar1
      V67=ABz*Ia8Bar1
      V68=V22+V3+V4+V64
      V69=ABz*Ia9Bar1
      V70=V3+V37+V4+V64
      OffSet=V5
      dI(1,OffSet)=Ia11Bar1+ABx*Ia5Bar1+V6+V7+dI(1,OffSet)
      dI(4,OffSet)=Ib11Bar1+ABx*Ib5Bar1+ABx*(ABx*Ib2Bar1+Ib5Bar1)+V7+dI(4,OffSet)
      dI(7,OffSet)=ABx*Ic2Bar2+Ic5Bar2+dI(7,OffSet)
      W1=-dI(1,V5)-dI(4,V5)
      W2=-dI(7,V5)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia12Bar1+V8+dI(2,OffSet)
      dI(5,OffSet)=Ib12Bar1+V12+V9+dI(5,OffSet)
      dI(8,OffSet)=ABx*Ic2Bar3+Ic5Bar3+dI(8,OffSet)
      W1=-dI(2,V5)-dI(5,V5)
      W2=-dI(8,V5)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia15Bar1+V13+dI(3,OffSet)
      dI(6,OffSet)=Ib15Bar1+V14+V17+dI(6,OffSet)
      dI(9,OffSet)=ABx*Ic2Bar4+Ic5Bar4+dI(9,OffSet)
      W1=-dI(3,V5)-dI(6,V5)
      W2=-dI(9,V5)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V19+V2+V3+V4
      dI(1,OffSet)=Ia12Bar1+V8+dI(1,OffSet)
      dI(4,OffSet)=Ib12Bar1+ABx*Ib6Bar1+ABx*(ABx*Ib3Bar1+Ib6Bar1)+V20+dI(4,OffSet)
      dI(7,OffSet)=ABx*Ic3Bar2+Ic6Bar2+dI(7,OffSet)
      W1=-dI(1,V23)-dI(4,V23)
      W2=-dI(7,V23)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia13Bar1+ABx*Ia7Bar1+V6+V7+dI(2,OffSet)
      dI(5,OffSet)=Ib13Bar1+V24+V27+dI(5,OffSet)
      dI(8,OffSet)=ABx*Ic3Bar3+Ic6Bar3+dI(8,OffSet)
      W1=-dI(2,V23)-dI(5,V23)
      W2=-dI(8,V23)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia16Bar1+V28+dI(3,OffSet)
      dI(6,OffSet)=Ib16Bar1+V29+V32+dI(6,OffSet)
      dI(9,OffSet)=ABx*Ic3Bar4+Ic6Bar4+dI(9,OffSet)
      W1=-dI(3,V23)-dI(6,V23)
      W2=-dI(9,V23)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V2+V3+V34+V4
      dI(1,OffSet)=Ia15Bar1+V13+dI(1,OffSet)
      dI(4,OffSet)=Ib15Bar1+ABx*Ib8Bar1+ABx*(ABx*Ib4Bar1+Ib8Bar1)+V35+dI(4,OffSet)
      dI(7,OffSet)=ABx*Ic4Bar2+Ic8Bar2+dI(7,OffSet)
      W1=-dI(1,V38)-dI(4,V38)
      W2=-dI(7,V38)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia16Bar1+V28+dI(2,OffSet)
      dI(5,OffSet)=Ib16Bar1+V39+V42+dI(5,OffSet)
      dI(8,OffSet)=ABx*Ic4Bar3+Ic8Bar3+dI(8,OffSet)
      W1=-dI(2,V38)-dI(5,V38)
      W2=-dI(8,V38)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=ABx*Ia10Bar1+Ia18Bar1+V6+V7+dI(3,OffSet)
      dI(6,OffSet)=Ib18Bar1+V45+V46+dI(6,OffSet)
      dI(9,OffSet)=ABx*Ic4Bar4+Ic8Bar4+dI(9,OffSet)
      W1=-dI(3,V38)-dI(6,V38)
      W2=-dI(9,V38)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V1+V3+V4+V48
      dI(1,OffSet)=Ia12Bar1+ABy*Ia5Bar1+V20+V49+dI(1,OffSet)
      dI(4,OffSet)=Ib12Bar1+V12+V9+dI(4,OffSet)
      dI(7,OffSet)=ABy*Ic2Bar2+Ic6Bar2+dI(7,OffSet)
      W1=-dI(1,V52)-dI(4,V52)
      W2=-dI(7,V52)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia13Bar1+V53+dI(2,OffSet)
      dI(5,OffSet)=Ib13Bar1+V12+V24+V7+dI(5,OffSet)
      dI(8,OffSet)=ABy*Ic2Bar3+Ic6Bar3+dI(8,OffSet)
      W1=-dI(2,V52)-dI(5,V52)
      W2=-dI(8,V52)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia16Bar1+V54+dI(3,OffSet)
      dI(6,OffSet)=Ib16Bar1+V17+V29+dI(6,OffSet)
      dI(9,OffSet)=ABy*Ic2Bar4+Ic6Bar4+dI(9,OffSet)
      W1=-dI(3,V52)-dI(6,V52)
      W2=-dI(9,V52)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V19+V3+V4+V48
      dI(1,OffSet)=Ia13Bar1+V53+dI(1,OffSet)
      dI(4,OffSet)=Ib13Bar1+V24+V27+dI(4,OffSet)
      dI(7,OffSet)=ABy*Ic3Bar2+Ic7Bar2+dI(7,OffSet)
      W1=-dI(1,V55)-dI(4,V55)
      W2=-dI(7,V55)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia14Bar1+ABy*Ia7Bar1+V20+V49+dI(2,OffSet)
      dI(5,OffSet)=Ib14Bar1+ABy*Ib7Bar1+V20+V27+dI(5,OffSet)
      dI(8,OffSet)=ABy*Ic3Bar3+Ic7Bar3+dI(8,OffSet)
      W1=-dI(2,V55)-dI(5,V55)
      W2=-dI(8,V55)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia17Bar1+V56+dI(3,OffSet)
      dI(6,OffSet)=Ib17Bar1+V32+V57+dI(6,OffSet)
      dI(9,OffSet)=ABy*Ic3Bar4+Ic7Bar4+dI(9,OffSet)
      W1=-dI(3,V55)-dI(6,V55)
      W2=-dI(9,V55)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V3+V34+V4+V48
      dI(1,OffSet)=Ia16Bar1+V54+dI(1,OffSet)
      dI(4,OffSet)=Ib16Bar1+V39+V42+dI(4,OffSet)
      dI(7,OffSet)=ABy*Ic4Bar2+Ic9Bar2+dI(7,OffSet)
      W1=-dI(1,V58)-dI(4,V58)
      W2=-dI(7,V58)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia17Bar1+V56+dI(2,OffSet)
      dI(5,OffSet)=Ib17Bar1+ABy*Ib9Bar1+V35+V42+dI(5,OffSet)
      dI(8,OffSet)=ABy*Ic4Bar3+Ic9Bar3+dI(8,OffSet)
      W1=-dI(2,V58)-dI(5,V58)
      W2=-dI(8,V58)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=ABy*Ia10Bar1+Ia19Bar1+V20+V49+dI(3,OffSet)
      dI(6,OffSet)=Ib19Bar1+V45+V59+dI(6,OffSet)
      dI(9,OffSet)=ABy*Ic4Bar4+Ic9Bar4+dI(9,OffSet)
      W1=-dI(3,V58)-dI(6,V58)
      W2=-dI(9,V58)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V1+V3+V4+V61
      dI(1,OffSet)=Ia15Bar1+ABz*Ia5Bar1+V35+V62+dI(1,OffSet)
      dI(4,OffSet)=Ib15Bar1+V14+V17+dI(4,OffSet)
      dI(7,OffSet)=ABz*Ic2Bar2+Ic8Bar2+dI(7,OffSet)
      W1=-dI(1,V65)-dI(4,V65)
      W2=-dI(7,V65)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia16Bar1+V66+dI(2,OffSet)
      dI(5,OffSet)=Ib16Bar1+V17+V29+dI(5,OffSet)
      dI(8,OffSet)=ABz*Ic2Bar3+Ic8Bar3+dI(8,OffSet)
      W1=-dI(2,V65)-dI(5,V65)
      W2=-dI(8,V65)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia18Bar1+V67+dI(3,OffSet)
      dI(6,OffSet)=Ib18Bar1+V17+V46+V7+dI(6,OffSet)
      dI(9,OffSet)=ABz*Ic2Bar4+Ic8Bar4+dI(9,OffSet)
      W1=-dI(3,V65)-dI(6,V65)
      W2=-dI(9,V65)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V19+V3+V4+V61
      dI(1,OffSet)=Ia16Bar1+V66+dI(1,OffSet)
      dI(4,OffSet)=Ib16Bar1+V29+V32+dI(4,OffSet)
      dI(7,OffSet)=ABz*Ic3Bar2+Ic9Bar2+dI(7,OffSet)
      W1=-dI(1,V68)-dI(4,V68)
      W2=-dI(7,V68)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia17Bar1+ABz*Ia7Bar1+V35+V62+dI(2,OffSet)
      dI(5,OffSet)=Ib17Bar1+V32+V57+dI(5,OffSet)
      dI(8,OffSet)=ABz*Ic3Bar3+Ic9Bar3+dI(8,OffSet)
      W1=-dI(2,V68)-dI(5,V68)
      W2=-dI(8,V68)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia19Bar1+V69+dI(3,OffSet)
      dI(6,OffSet)=Ib19Bar1+V20+V32+V59+dI(6,OffSet)
      dI(9,OffSet)=ABz*Ic3Bar4+Ic9Bar4+dI(9,OffSet)
      W1=-dI(3,V68)-dI(6,V68)
      W2=-dI(9,V68)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V3+V34+V4+V61
      dI(1,OffSet)=Ia18Bar1+V67+dI(1,OffSet)
      dI(4,OffSet)=Ib18Bar1+V45+V46+dI(4,OffSet)
      dI(7,OffSet)=Ic10Bar2+ABz*Ic4Bar2+dI(7,OffSet)
      W1=-dI(1,V70)-dI(4,V70)
      W2=-dI(7,V70)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia19Bar1+V69+dI(2,OffSet)
      dI(5,OffSet)=Ib19Bar1+V45+V59+dI(5,OffSet)
      dI(8,OffSet)=Ic10Bar3+ABz*Ic4Bar3+dI(8,OffSet)
      W1=-dI(2,V70)-dI(5,V70)
      W2=-dI(8,V70)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=ABz*Ia10Bar1+Ia20Bar1+V35+V62+dI(3,OffSet)
      dI(6,OffSet)=ABz*Ib10Bar1+Ib20Bar1+V35+V45+dI(6,OffSet)
      dI(9,OffSet)=Ic10Bar4+ABz*Ic4Bar4+dI(9,OffSet)
      W1=-dI(3,V70)-dI(6,V70)
      W2=-dI(9,V70)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
   END SUBROUTINE dInt3311
