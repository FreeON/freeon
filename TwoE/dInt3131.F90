! ---------------------------------------------------------- 
! COMPUTES THE INTEGRAL CLASS (P S|P S) 
! ---------------------------------------------------------- 
   SUBROUTINE dInt3131(PrmBufB,LBra,PrmBufK,LKet,ACInfo,BDInfo, & 
                              OA,LDA,OB,LDB,OC,LDC,OD,LDD,PBC,dI) 
      USE DerivedTypes
      USE GlobalScalars
      USE ShellPairStruct
      USE GammaF2
      IMPLICIT REAL(DOUBLE) (A,I,V,W)
      INTEGER        :: LBra,LKet
      REAL(DOUBLE)   :: PrmBufB(7,LBra),PrmBufK(7,LKet)
      TYPE(SmallAtomInfo) :: ACInfo,BDInfo
      TYPE(PBCInfo) :: PBC
      REAL(DOUBLE) :: dI(12,*)
      REAL(DOUBLE)  :: Zeta,Eta,r1xZpE,HfxZpE,r1x2E,r1x2Z,ExZpE,ZxZpE,Omega,Up,Uq,Upq
      REAL(DOUBLE)  :: Ax,Ay,Az,Bx,By,Bz,Cx,Cy,Cz,Dx,Dy,Dz,Qx,Qy,Qz,Px,Py,Pz
      REAL(DOUBLE)  :: QCx,QCy,QCz,PAx,PAy,PAz,PQx,PQy,PQz,WPx,WPy,WPz,WQx,WQy,WQz   
      REAL(DOUBLE)  :: T,ET,TwoT,InvT,SqInvT,ABx,ABy,ABz,CDx,CDy,CDz
      REAL(DOUBLE)  :: Alpha,Beta,Gamma
      INTEGER       :: OffSet
      INTEGER       :: OA,LDA,OB,LDB,OC,LDC,OD,LDD,J,K,L
      REAL(DOUBLE)  :: FPQx,FPQy,FPQz
      I1Bar1=0.0d0
      I2Bar1=0.0d0
      I3Bar1=0.0d0
      I4Bar1=0.0d0
      I5Bar1=0.0d0
      I6Bar1=0.0d0
      I7Bar1=0.0d0
      I8Bar1=0.0d0
      I9Bar1=0.0d0
      I10Bar1=0.0d0
      I1Bar2=0.0d0
      I2Bar2=0.0d0
      I3Bar2=0.0d0
      I4Bar2=0.0d0
      I5Bar2=0.0d0
      I6Bar2=0.0d0
      I7Bar2=0.0d0
      I8Bar2=0.0d0
      I9Bar2=0.0d0
      I10Bar2=0.0d0
      I1Bar3=0.0d0
      I2Bar3=0.0d0
      I3Bar3=0.0d0
      I4Bar3=0.0d0
      I5Bar3=0.0d0
      I6Bar3=0.0d0
      I7Bar3=0.0d0
      I8Bar3=0.0d0
      I9Bar3=0.0d0
      I10Bar3=0.0d0
      I1Bar4=0.0d0
      I2Bar4=0.0d0
      I3Bar4=0.0d0
      I4Bar4=0.0d0
      I5Bar4=0.0d0
      I6Bar4=0.0d0
      I7Bar4=0.0d0
      I8Bar4=0.0d0
      I9Bar4=0.0d0
      I10Bar4=0.0d0
      I1Bar5=0.0d0
      I2Bar5=0.0d0
      I3Bar5=0.0d0
      I4Bar5=0.0d0
      I1Bar6=0.0d0
      I2Bar6=0.0d0
      I3Bar6=0.0d0
      I4Bar6=0.0d0
      I1Bar7=0.0d0
      I2Bar7=0.0d0
      I3Bar7=0.0d0
      I4Bar7=0.0d0
      I1Bar8=0.0d0
      I2Bar8=0.0d0
      I3Bar8=0.0d0
      I4Bar8=0.0d0
      I1Bar9=0.0d0
      I2Bar9=0.0d0
      I3Bar9=0.0d0
      I4Bar9=0.0d0
      I1Bar10=0.0d0
      I2Bar10=0.0d0
      I3Bar10=0.0d0
      I4Bar10=0.0d0
      Ia10Bar4=0D0
      Ia10Bar3=0D0
      Ia10Bar2=0D0
      Ia9Bar4=0D0
      Ia9Bar3=0D0
      Ia9Bar2=0D0
      Ia7Bar4=0D0
      Ia7Bar3=0D0
      Ia7Bar2=0D0
      Ia8Bar4=0D0
      Ia8Bar3=0D0
      Ia8Bar2=0D0
      Ia6Bar4=0D0
      Ia6Bar3=0D0
      Ia6Bar2=0D0
      Ia5Bar4=0D0
      Ia5Bar3=0D0
      Ia5Bar2=0D0
      Ib4Bar4=0D0
      Ib4Bar3=0D0
      Ib4Bar2=0D0
      Ib10Bar4=0D0
      Ib10Bar3=0D0
      Ib10Bar2=0D0
      Ib3Bar4=0D0
      Ib3Bar3=0D0
      Ib3Bar2=0D0
      Ib9Bar4=0D0
      Ib9Bar3=0D0
      Ib9Bar2=0D0
      Ib7Bar4=0D0
      Ib7Bar3=0D0
      Ib7Bar2=0D0
      Ib2Bar4=0D0
      Ib2Bar3=0D0
      Ib2Bar2=0D0
      Ib8Bar4=0D0
      Ib8Bar3=0D0
      Ib8Bar2=0D0
      Ib6Bar4=0D0
      Ib6Bar3=0D0
      Ib6Bar2=0D0
      Ib5Bar4=0D0
      Ib5Bar3=0D0
      Ib5Bar2=0D0
      Ic4Bar10=0D0
      Ic4Bar9=0D0
      Ic4Bar7=0D0
      Ic4Bar8=0D0
      Ic4Bar6=0D0
      Ic4Bar5=0D0
      Ic3Bar10=0D0
      Ic3Bar9=0D0
      Ic3Bar7=0D0
      Ic3Bar8=0D0
      Ic3Bar6=0D0
      Ic3Bar5=0D0
      Ic2Bar10=0D0
      Ic2Bar9=0D0
      Ic2Bar7=0D0
      Ic2Bar8=0D0
      Ic2Bar6=0D0
      Ic2Bar5=0D0
      Ax=ACInfo%Atm1X
      Ay=ACInfo%Atm1Y
      Az=ACInfo%Atm1Z
      Bx=ACInfo%Atm2X
      By=ACInfo%Atm2Y
      Bz=ACInfo%Atm2Z
      Cx=BDInfo%Atm1X
      Cy=BDInfo%Atm1Y
      Cz=BDInfo%Atm1Z
      Dx=BDInfo%Atm2X
      Dy=BDInfo%Atm2Y
      Dz=BDInfo%Atm2Z
      ABx=Ax-Bx
      ABy=Ay-By
      ABz=Az-Bz
      CDx=Cx-Dx
      CDy=Cy-Dy
      CDz=Cz-Dz
      DO J=1,LKet ! K^2 VRR |N0) loop 
         Eta=PrmBufK(1,J)
         Qx =PrmBufK(2,J)
         Qy =PrmBufK(3,J)
         Qz =PrmBufK(4,J)
         Uq =PrmBufK(5,J)
         Gamma =PrmBufK(6,J)
         QCx=Qx-Cx
         QCy=Qy-Cy
         QCz=Qz-Cz
         DO K=1,LBra ! K^2 VRR (M0| loop 
            Zeta=PrmBufB(1,K)
            Px  =PrmBufB(2,K)
            Py  =PrmBufB(3,K)
            Pz  =PrmBufB(4,K)
            Up  =PrmBufB(5,K)
            Alpha =PrmBufB(6,K)
            Beta  =PrmBufB(7,K)
            r1xZpE=One/(Zeta+Eta)
            Upq=SQRT(r1xZpE)*Up*Uq
            HfxZpE=Half/(Zeta+Eta)
            r1x2E=Half/Eta
            r1x2Z=Half/Zeta
            ExZpE=Eta*r1xZpE
            ZxZpE=Zeta*r1xZpE
            Omega=Eta*Zeta*r1xZpE
            PAx=Px-Ax
            PAy=Py-Ay
            PAz=Pz-Az
            PQx=Px-Qx
            PQy=Py-Qy
            PQz=Pz-Qz
      ! Need to be improve...
            FPQx = PQx*PBC%InvBoxSh%D(1,1)+PQy*PBC%InvBoxSh%D(1,2)+PQz*PBC%InvBoxSh%D(1,3)
            FPQy = PQy*PBC%InvBoxSh%D(2,2)+PQz*PBC%InvBoxSh%D(2,3)
            FPQz = PQz*PBC%InvBoxSh%D(3,3)
            IF(PBC%AutoW%I(1)==1) FPQx = FPQx-ANINT(ANINT(FPQx*1d9)*1d-9)
            IF(PBC%AutoW%I(2)==1) FPQy = FPQy-ANINT(ANINT(FPQy*1d9)*1d-9)
            IF(PBC%AutoW%I(3)==1) FPQz = FPQz-ANINT(ANINT(FPQz*1d9)*1d-9)
            PQx  = FPQx*PBC%BoxShape%D(1,1)+FPQy*PBC%BoxShape%D(1,2)+FPQz*PBC%BoxShape%D(1,3)
            PQy  = FPQy*PBC%BoxShape%D(2,2)+FPQz*PBC%BoxShape%D(2,3)
            PQz  = FPQz*PBC%BoxShape%D(3,3)
      !
            WPx = -Eta*PQx*r1xZpE
            WPy = -Eta*PQy*r1xZpE
            WPz = -Eta*PQz*r1xZpE
            WQx = Zeta*PQx*r1xZpE
            WQy = Zeta*PQy*r1xZpE
            WQz = Zeta*PQz*r1xZpE
            T=Omega*(PQx*PQx+PQy*PQy+PQz*PQz)
            IF(T<Gamma_Switch)THEN
              L=AINT(T*Gamma_Grid)
              ET=EXP(-T)
              TwoT=Two*T
              W3=(F3_0(L)+T*(F3_1(L)+T*(F3_2(L)+T*(F3_3(L)+T*F3_4(L)))))
              W2=+2.000000000000000D-01*(TwoT*W3+ET)
              W1=+3.333333333333333D-01*(TwoT*W2+ET)
              W0=TwoT*W1+ET
              AuxR0=Upq*W0
              AuxR1=Upq*W1
              AuxR2=Upq*W2
              AuxR3=Upq*W3
            ELSE
              InvT=One/T
              SqInvT=DSQRT(InvT)
              AuxR0=+8.862269254527580D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR1=+4.431134627263790D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR2=+6.646701940895685D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR3=+1.661675485223921D+00*Upq*SqInvT
            ENDIF
            V1=AuxR0*PAx
            V2=AuxR1*WPx
            V3=AuxR0*PAy
            V4=AuxR1*WPy
            V5=AuxR0*PAz
            V6=AuxR1*WPz
            V7=-(AuxR1*ExZpE)
            V8=AuxR0+V7
            V9=r1x2Z*V8
            V10=V1+V2
            V11=AuxR1*PAx
            V12=AuxR2*WPx
            V13=V11+V12
            V14=V3+V4
            V15=PAx*V14
            V16=AuxR1*PAy
            V17=AuxR2*WPy
            V18=V16+V17
            V19=V18*WPx
            V20=V5+V6
            V21=PAx*V20
            V22=AuxR1*PAz
            V23=AuxR2*WPz
            V24=V22+V23
            V25=V24*WPx
            V26=PAy*V20
            V27=V24*WPy
            V28=AuxR0*QCx
            V29=AuxR1*WQx
            V30=AuxR1*HfxZpE
            V31=QCx*V10
            V32=V13*WQx
            V33=QCx*V14
            V34=V18*WQx
            V35=QCx*V20
            V36=V24*WQx
            V37=HfxZpE*V13
            V38=V30+V31+V32
            V39=AuxR2*HfxZpE
            V40=QCx*V13
            V41=AuxR2*PAx
            V42=AuxR3*WPx
            V43=V41+V42
            V44=V43*WQx
            V45=V39+V40+V44
            V46=AuxR1*QCx
            V47=AuxR2*WQx
            V48=V46+V47
            V49=-(ExZpE*V48)
            V50=V28+V29+V49
            V51=r1x2Z*V50
            V52=HfxZpE*V18
            V53=V15+V19
            V54=PAx*V18
            V55=AuxR2*PAy
            V56=AuxR3*WPy
            V57=V55+V56
            V58=V57*WPx
            V59=V54+V58
            V60=V33+V34
            V61=QCx*V18
            V62=V57*WQx
            V63=V61+V62
            V64=HfxZpE*V24
            V65=V21+V25
            V66=PAx*V24
            V67=AuxR2*PAz
            V68=AuxR3*WPz
            V69=V67+V68
            V70=V69*WPx
            V71=V66+V70
            V72=V26+V27
            V73=PAy*V24
            V74=V69*WPy
            V75=V73+V74
            V76=V35+V36
            V77=QCx*V24
            V78=V69*WQx
            V79=V77+V78
            V80=AuxR0*QCy
            V81=AuxR1*WQy
            V82=QCy*V10
            V83=V13*WQy
            V84=QCy*V14
            V85=V18*WQy
            V86=QCy*V20
            V87=V24*WQy
            V88=V82+V83
            V89=QCy*V13
            V90=V43*WQy
            V91=V89+V90
            V92=AuxR1*QCy
            V93=AuxR2*WQy
            V94=V92+V93
            V95=-(ExZpE*V94)
            V96=V80+V81+V95
            V97=r1x2Z*V96
            V98=V30+V84+V85
            V99=QCy*V18
            V100=V57*WQy
            V101=V100+V39+V99
            V102=V86+V87
            V103=QCy*V24
            V104=V69*WQy
            V105=V103+V104
            V106=AuxR0*QCz
            V107=AuxR1*WQz
            V108=QCz*V10
            V109=V13*WQz
            V110=QCz*V14
            V111=V18*WQz
            V112=QCz*V20
            V113=V24*WQz
            V114=V108+V109
            V115=QCz*V13
            V116=V43*WQz
            V117=V115+V116
            V118=AuxR1*QCz
            V119=AuxR2*WQz
            V120=V118+V119
            V121=-(ExZpE*V120)
            V122=V106+V107+V121
            V123=r1x2Z*V122
            V124=V110+V111
            V125=QCz*V18
            V126=V57*WQz
            V127=V125+V126
            V128=V112+V113+V30
            V129=QCz*V24
            V130=V69*WQz
            V131=V129+V130+V39
            V132=-(AuxR1*ZxZpE)
            V133=AuxR0+V132
            V134=r1x2E*V133
            V135=-(V13*ZxZpE)
            V136=V1+V135+V2
            V137=r1x2E*V136
            V138=-(V18*ZxZpE)
            V139=V138+V3+V4
            V140=r1x2E*V139
            V141=-(V24*ZxZpE)
            V142=V141+V5+V6
            V143=r1x2E*V142
            V144=V80+V81
            V145=HfxZpE*V94
            V146=V106+V107
            V147=HfxZpE*V120
            I1Bar1=AuxR0+I1Bar1
            I2Bar1=V1+V2+I2Bar1
            I3Bar1=V3+V4+I3Bar1
            I4Bar1=V5+V6+I4Bar1
            I5Bar1=PAx*V10+V9+V13*WPx+I5Bar1
            I6Bar1=V15+V19+I6Bar1
            I7Bar1=PAy*V14+V9+V18*WPy+I7Bar1
            I8Bar1=V21+V25+I8Bar1
            I9Bar1=V26+V27+I9Bar1
            I10Bar1=PAz*V20+V9+V24*WPz+I10Bar1
            I1Bar2=V28+V29+I1Bar2
            I2Bar2=V30+V31+V32+I2Bar2
            I3Bar2=V33+V34+I3Bar2
            I4Bar2=V35+V36+I4Bar2
            I5Bar2=V37+PAx*V38+V51+V45*WPx+I5Bar2
            I6Bar2=V52+QCx*V53+V59*WQx+I6Bar2
            I7Bar2=V51+PAy*V60+V63*WPy+I7Bar2
            I8Bar2=V64+QCx*V65+V71*WQx+I8Bar2
            I9Bar2=QCx*V72+V75*WQx+I9Bar2
            I10Bar2=V51+PAz*V76+V79*WPz+I10Bar2
            I1Bar3=V80+V81+I1Bar3
            I2Bar3=V82+V83+I2Bar3
            I3Bar3=V30+V84+V85+I3Bar3
            I4Bar3=V86+V87+I4Bar3
            I5Bar3=PAx*V88+V97+V91*WPx+I5Bar3
            I6Bar3=V37+QCy*V53+V59*WQy+I6Bar3
            I7Bar3=V52+V97+PAy*V98+V101*WPy+I7Bar3
            I8Bar3=QCy*V65+V71*WQy+I8Bar3
            I9Bar3=V64+QCy*V72+V75*WQy+I9Bar3
            I10Bar3=PAz*V102+V97+V105*WPz+I10Bar3
            I1Bar4=V106+V107+I1Bar4
            I2Bar4=V108+V109+I2Bar4
            I3Bar4=V110+V111+I3Bar4
            I4Bar4=V112+V113+V30+I4Bar4
            I5Bar4=PAx*V114+V123+V117*WPx+I5Bar4
            I6Bar4=QCz*V53+V59*WQz+I6Bar4
            I7Bar4=V123+PAy*V124+V127*WPy+I7Bar4
            I8Bar4=V37+QCz*V65+V71*WQz+I8Bar4
            I9Bar4=V52+QCz*V72+V75*WQz+I9Bar4
            I10Bar4=V123+PAz*V128+V64+V131*WPz+I10Bar4
            I1Bar5=V134+QCx*(V28+V29)+V48*WQx+I1Bar5
            I2Bar5=V137+QCx*V38+HfxZpE*V48+V45*WQx+I2Bar5
            I3Bar5=V140+QCx*V60+V63*WQx+I3Bar5
            I4Bar5=V143+QCx*V76+V79*WQx+I4Bar5
            I1Bar6=QCx*V144+V94*WQx+I1Bar6
            I2Bar6=V145+QCx*V88+V91*WQx+I2Bar6
            I3Bar6=QCx*V98+V101*WQx+I3Bar6
            I4Bar6=QCx*V102+V105*WQx+I4Bar6
            I1Bar7=V134+QCy*V144+V94*WQy+I1Bar7
            I2Bar7=V137+QCy*V88+V91*WQy+I2Bar7
            I3Bar7=V140+V145+QCy*V98+V101*WQy+I3Bar7
            I4Bar7=QCy*V102+V143+V105*WQy+I4Bar7
            I1Bar8=QCx*V146+V120*WQx+I1Bar8
            I2Bar8=QCx*V114+V147+V117*WQx+I2Bar8
            I3Bar8=QCx*V124+V127*WQx+I3Bar8
            I4Bar8=QCx*V128+V131*WQx+I4Bar8
            I1Bar9=QCy*V146+V120*WQy+I1Bar9
            I2Bar9=QCy*V114+V117*WQy+I2Bar9
            I3Bar9=QCy*V124+V147+V127*WQy+I3Bar9
            I4Bar9=QCy*V128+V131*WQy+I4Bar9
            I1Bar10=V134+QCz*V146+V120*WQz+I1Bar10
            I2Bar10=QCz*V114+V137+V117*WQz+I2Bar10
            I3Bar10=QCz*V124+V140+V127*WQz+I3Bar10
            I4Bar10=QCz*V128+V143+V147+V131*WQz+I4Bar10
            Ia10Bar4=Ia10Bar4+Alpha*I10Bar4
            Ia10Bar3=Ia10Bar3+Alpha*I10Bar3
            Ia10Bar2=Ia10Bar2+Alpha*I10Bar2
            Ia9Bar4=Ia9Bar4+Alpha*I9Bar4
            Ia9Bar3=Ia9Bar3+Alpha*I9Bar3
            Ia9Bar2=Ia9Bar2+Alpha*I9Bar2
            Ia7Bar4=Ia7Bar4+Alpha*I7Bar4
            Ia7Bar3=Ia7Bar3+Alpha*I7Bar3
            Ia7Bar2=Ia7Bar2+Alpha*I7Bar2
            Ia8Bar4=Ia8Bar4+Alpha*I8Bar4
            Ia8Bar3=Ia8Bar3+Alpha*I8Bar3
            Ia8Bar2=Ia8Bar2+Alpha*I8Bar2
            Ia6Bar4=Ia6Bar4+Alpha*I6Bar4
            Ia6Bar3=Ia6Bar3+Alpha*I6Bar3
            Ia6Bar2=Ia6Bar2+Alpha*I6Bar2
            Ia5Bar4=Ia5Bar4+Alpha*I5Bar4
            Ia5Bar3=Ia5Bar3+Alpha*I5Bar3
            Ia5Bar2=Ia5Bar2+Alpha*I5Bar2
            Ib4Bar4=Ib4Bar4+Beta*I4Bar4
            Ib4Bar3=Ib4Bar3+Beta*I4Bar3
            Ib4Bar2=Ib4Bar2+Beta*I4Bar2
            Ib10Bar4=Ib10Bar4+Beta*I10Bar4
            Ib10Bar3=Ib10Bar3+Beta*I10Bar3
            Ib10Bar2=Ib10Bar2+Beta*I10Bar2
            Ib3Bar4=Ib3Bar4+Beta*I3Bar4
            Ib3Bar3=Ib3Bar3+Beta*I3Bar3
            Ib3Bar2=Ib3Bar2+Beta*I3Bar2
            Ib9Bar4=Ib9Bar4+Beta*I9Bar4
            Ib9Bar3=Ib9Bar3+Beta*I9Bar3
            Ib9Bar2=Ib9Bar2+Beta*I9Bar2
            Ib7Bar4=Ib7Bar4+Beta*I7Bar4
            Ib7Bar3=Ib7Bar3+Beta*I7Bar3
            Ib7Bar2=Ib7Bar2+Beta*I7Bar2
            Ib2Bar4=Ib2Bar4+Beta*I2Bar4
            Ib2Bar3=Ib2Bar3+Beta*I2Bar3
            Ib2Bar2=Ib2Bar2+Beta*I2Bar2
            Ib8Bar4=Ib8Bar4+Beta*I8Bar4
            Ib8Bar3=Ib8Bar3+Beta*I8Bar3
            Ib8Bar2=Ib8Bar2+Beta*I8Bar2
            Ib6Bar4=Ib6Bar4+Beta*I6Bar4
            Ib6Bar3=Ib6Bar3+Beta*I6Bar3
            Ib6Bar2=Ib6Bar2+Beta*I6Bar2
            Ib5Bar4=Ib5Bar4+Beta*I5Bar4
            Ib5Bar3=Ib5Bar3+Beta*I5Bar3
            Ib5Bar2=Ib5Bar2+Beta*I5Bar2
            Ic4Bar10=Ic4Bar10+Gamma*I4Bar10
            Ic4Bar9=Ic4Bar9+Gamma*I4Bar9
            Ic4Bar7=Ic4Bar7+Gamma*I4Bar7
            Ic4Bar8=Ic4Bar8+Gamma*I4Bar8
            Ic4Bar6=Ic4Bar6+Gamma*I4Bar6
            Ic4Bar5=Ic4Bar5+Gamma*I4Bar5
            Ic3Bar10=Ic3Bar10+Gamma*I3Bar10
            Ic3Bar9=Ic3Bar9+Gamma*I3Bar9
            Ic3Bar7=Ic3Bar7+Gamma*I3Bar7
            Ic3Bar8=Ic3Bar8+Gamma*I3Bar8
            Ic3Bar6=Ic3Bar6+Gamma*I3Bar6
            Ic3Bar5=Ic3Bar5+Gamma*I3Bar5
            Ic2Bar10=Ic2Bar10+Gamma*I2Bar10
            Ic2Bar9=Ic2Bar9+Gamma*I2Bar9
            Ic2Bar7=Ic2Bar7+Gamma*I2Bar7
            Ic2Bar8=Ic2Bar8+Gamma*I2Bar8
            Ic2Bar6=Ic2Bar6+Gamma*I2Bar6
            Ic2Bar5=Ic2Bar5+Gamma*I2Bar5
         ENDDO ! (M0| loop
      ENDDO ! |N0) loop
      ! HRR 
      V1=LDA*OA
      V2=LDB*OB
      V3=LDC*OC
      V4=LDD*OD
      V5=V1+V2+V3+V4
      V6=-I1Bar2
      V7=-I2Bar1
      V8=1.D0+OA
      V9=LDA*V8
      V10=-I3Bar1
      V11=1+OA
      V12=LDA*V11
      V13=V12+V2+V3+V4
      V14=2.D0+OA
      V15=LDA*V14
      V16=-I4Bar1
      V17=2+OA
      V18=LDA*V17
      V19=V18+V2+V3+V4
      V20=1.D0+OC
      V21=LDC*V20
      V22=-I1Bar3
      V23=1+OC
      V24=LDC*V23
      V25=V1+V2+V24+V4
      V26=V12+V2+V24+V4
      V27=V18+V2+V24+V4
      V28=2.D0+OC
      V29=LDC*V28
      V30=-I1Bar4
      V31=2+OC
      V32=LDC*V31
      V33=V1+V2+V32+V4
      V34=V12+V2+V32+V4
      V35=V18+V2+V32+V4
      OffSet=V5
      dI(1,OffSet)=Ia5Bar2+V6+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib2Bar2+Ib5Bar2+dI(4,OffSet)
      dI(7,OffSet)=Ic2Bar5+V7+dI(7,OffSet)
      W1=-dI(1,V5)-dI(4,V5)
      W2=-dI(7,V5)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia6Bar2+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib2Bar2+Ib6Bar2+dI(5,OffSet)
      dI(8,OffSet)=Ic2Bar6+dI(8,OffSet)
      W1=-dI(2,V5)-dI(5,V5)
      W2=-dI(8,V5)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia8Bar2+dI(3,OffSet)
      dI(6,OffSet)=ABz*Ib2Bar2+Ib8Bar2+dI(6,OffSet)
      dI(9,OffSet)=Ic2Bar8+dI(9,OffSet)
      W1=-dI(3,V5)-dI(6,V5)
      W2=-dI(9,V5)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V2+V3+V4+V9
      dI(1,OffSet)=Ia6Bar2+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib3Bar2+Ib6Bar2+dI(4,OffSet)
      dI(7,OffSet)=Ic3Bar5+V10+dI(7,OffSet)
      W1=-dI(1,V13)-dI(4,V13)
      W2=-dI(7,V13)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia7Bar2+V6+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib3Bar2+Ib7Bar2+dI(5,OffSet)
      dI(8,OffSet)=Ic3Bar6+dI(8,OffSet)
      W1=-dI(2,V13)-dI(5,V13)
      W2=-dI(8,V13)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia9Bar2+dI(3,OffSet)
      dI(6,OffSet)=ABz*Ib3Bar2+Ib9Bar2+dI(6,OffSet)
      dI(9,OffSet)=Ic3Bar8+dI(9,OffSet)
      W1=-dI(3,V13)-dI(6,V13)
      W2=-dI(9,V13)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V15+V2+V3+V4
      dI(1,OffSet)=Ia8Bar2+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib4Bar2+Ib8Bar2+dI(4,OffSet)
      dI(7,OffSet)=Ic4Bar5+V16+dI(7,OffSet)
      W1=-dI(1,V19)-dI(4,V19)
      W2=-dI(7,V19)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia9Bar2+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib4Bar2+Ib9Bar2+dI(5,OffSet)
      dI(8,OffSet)=Ic4Bar6+dI(8,OffSet)
      W1=-dI(2,V19)-dI(5,V19)
      W2=-dI(8,V19)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia10Bar2+V6+dI(3,OffSet)
      dI(6,OffSet)=Ib10Bar2+ABz*Ib4Bar2+dI(6,OffSet)
      dI(9,OffSet)=Ic4Bar8+dI(9,OffSet)
      W1=-dI(3,V19)-dI(6,V19)
      W2=-dI(9,V19)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V1+V2+V21+V4
      dI(1,OffSet)=Ia5Bar3+V22+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib2Bar3+Ib5Bar3+dI(4,OffSet)
      dI(7,OffSet)=Ic2Bar6+dI(7,OffSet)
      W1=-dI(1,V25)-dI(4,V25)
      W2=-dI(7,V25)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia6Bar3+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib2Bar3+Ib6Bar3+dI(5,OffSet)
      dI(8,OffSet)=Ic2Bar7+V7+dI(8,OffSet)
      W1=-dI(2,V25)-dI(5,V25)
      W2=-dI(8,V25)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia8Bar3+dI(3,OffSet)
      dI(6,OffSet)=ABz*Ib2Bar3+Ib8Bar3+dI(6,OffSet)
      dI(9,OffSet)=Ic2Bar9+dI(9,OffSet)
      W1=-dI(3,V25)-dI(6,V25)
      W2=-dI(9,V25)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V2+V21+V4+V9
      dI(1,OffSet)=Ia6Bar3+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib3Bar3+Ib6Bar3+dI(4,OffSet)
      dI(7,OffSet)=Ic3Bar6+dI(7,OffSet)
      W1=-dI(1,V26)-dI(4,V26)
      W2=-dI(7,V26)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia7Bar3+V22+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib3Bar3+Ib7Bar3+dI(5,OffSet)
      dI(8,OffSet)=Ic3Bar7+V10+dI(8,OffSet)
      W1=-dI(2,V26)-dI(5,V26)
      W2=-dI(8,V26)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia9Bar3+dI(3,OffSet)
      dI(6,OffSet)=ABz*Ib3Bar3+Ib9Bar3+dI(6,OffSet)
      dI(9,OffSet)=Ic3Bar9+dI(9,OffSet)
      W1=-dI(3,V26)-dI(6,V26)
      W2=-dI(9,V26)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V15+V2+V21+V4
      dI(1,OffSet)=Ia8Bar3+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib4Bar3+Ib8Bar3+dI(4,OffSet)
      dI(7,OffSet)=Ic4Bar6+dI(7,OffSet)
      W1=-dI(1,V27)-dI(4,V27)
      W2=-dI(7,V27)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia9Bar3+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib4Bar3+Ib9Bar3+dI(5,OffSet)
      dI(8,OffSet)=Ic4Bar7+V16+dI(8,OffSet)
      W1=-dI(2,V27)-dI(5,V27)
      W2=-dI(8,V27)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia10Bar3+V22+dI(3,OffSet)
      dI(6,OffSet)=Ib10Bar3+ABz*Ib4Bar3+dI(6,OffSet)
      dI(9,OffSet)=Ic4Bar9+dI(9,OffSet)
      W1=-dI(3,V27)-dI(6,V27)
      W2=-dI(9,V27)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V1+V2+V29+V4
      dI(1,OffSet)=Ia5Bar4+V30+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib2Bar4+Ib5Bar4+dI(4,OffSet)
      dI(7,OffSet)=Ic2Bar8+dI(7,OffSet)
      W1=-dI(1,V33)-dI(4,V33)
      W2=-dI(7,V33)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia6Bar4+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib2Bar4+Ib6Bar4+dI(5,OffSet)
      dI(8,OffSet)=Ic2Bar9+dI(8,OffSet)
      W1=-dI(2,V33)-dI(5,V33)
      W2=-dI(8,V33)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia8Bar4+dI(3,OffSet)
      dI(6,OffSet)=ABz*Ib2Bar4+Ib8Bar4+dI(6,OffSet)
      dI(9,OffSet)=Ic2Bar10+V7+dI(9,OffSet)
      W1=-dI(3,V33)-dI(6,V33)
      W2=-dI(9,V33)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V2+V29+V4+V9
      dI(1,OffSet)=Ia6Bar4+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib3Bar4+Ib6Bar4+dI(4,OffSet)
      dI(7,OffSet)=Ic3Bar8+dI(7,OffSet)
      W1=-dI(1,V34)-dI(4,V34)
      W2=-dI(7,V34)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia7Bar4+V30+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib3Bar4+Ib7Bar4+dI(5,OffSet)
      dI(8,OffSet)=Ic3Bar9+dI(8,OffSet)
      W1=-dI(2,V34)-dI(5,V34)
      W2=-dI(8,V34)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia9Bar4+dI(3,OffSet)
      dI(6,OffSet)=ABz*Ib3Bar4+Ib9Bar4+dI(6,OffSet)
      dI(9,OffSet)=Ic3Bar10+V10+dI(9,OffSet)
      W1=-dI(3,V34)-dI(6,V34)
      W2=-dI(9,V34)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
      OffSet=V15+V2+V29+V4
      dI(1,OffSet)=Ia8Bar4+dI(1,OffSet)
      dI(4,OffSet)=ABx*Ib4Bar4+Ib8Bar4+dI(4,OffSet)
      dI(7,OffSet)=Ic4Bar8+dI(7,OffSet)
      W1=-dI(1,V35)-dI(4,V35)
      W2=-dI(7,V35)+dI(10,OffSet)
      dI(10,OffSet)=W1+W2
      dI(2,OffSet)=Ia9Bar4+dI(2,OffSet)
      dI(5,OffSet)=ABy*Ib4Bar4+Ib9Bar4+dI(5,OffSet)
      dI(8,OffSet)=Ic4Bar9+dI(8,OffSet)
      W1=-dI(2,V35)-dI(5,V35)
      W2=-dI(8,V35)+dI(11,OffSet)
      dI(11,OffSet)=W1+W2
      dI(3,OffSet)=Ia10Bar4+V30+dI(3,OffSet)
      dI(6,OffSet)=Ib10Bar4+ABz*Ib4Bar4+dI(6,OffSet)
      dI(9,OffSet)=Ic4Bar10+V16+dI(9,OffSet)
      W1=-dI(3,V35)-dI(6,V35)
      W2=-dI(9,V35)+dI(12,OffSet)
      dI(12,OffSet)=W1+W2
   END SUBROUTINE dInt3131
