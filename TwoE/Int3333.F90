! ---------------------------------------------------------- 
! COMPUTES THE INTEGRAL CLASS (P P|P P) 
! ---------------------------------------------------------- 
   SUBROUTINE Int3333(PrmBufB,LBra,PrmBufK,LKet,ACInfo,BDInfo, & 
                              OA,LDA,OB,LDB,OC,LDC,OD,LDD,PBC,I) 
      USE DerivedTypes
      USE VScratch
      USE GlobalScalars
      USE ShellPairStruct
      USE GammaF4
      IMPLICIT REAL(DOUBLE) (A,I,W)
      INTEGER        :: LBra,LKet
      REAL(DOUBLE)   :: PrmBufB(5,LBra),PrmBufK(5,LKet)
      TYPE(SmallAtomInfo) :: ACInfo,BDInfo
      TYPE(PBCInfo) :: PBC
      REAL(DOUBLE) :: I(*)
      REAL(DOUBLE)  :: Zeta,Eta,r1xZpE,HfxZpE,r1x2E,r1x2Z,ExZpE,ZxZpE,Omega,Up,Uq,Upq
      REAL(DOUBLE)  :: Ax,Ay,Az,Bx,By,Bz,Cx,Cy,Cz,Dx,Dy,Dz,Qx,Qy,Qz,Px,Py,Pz
      REAL(DOUBLE)  :: QCx,QCy,QCz,PAx,PAy,PAz,PQx,PQy,PQz,WPx,WPy,WPz,WQx,WQy,WQz   
      REAL(DOUBLE)  :: T,ET,TwoT,InvT,SqInvT,ABx,ABy,ABz,CDx,CDy,CDz
      INTEGER       :: OffSet,OA,LDA,OB,LDB,OC,LDC,OD,LDD,J,K,L
      REAL(DOUBLE)  :: FPQx,FPQy,FPQz
      I1Bar1=0.0d0
      I2Bar1=0.0d0
      I3Bar1=0.0d0
      I4Bar1=0.0d0
      I5Bar1=0.0d0
      I6Bar1=0.0d0
      I7Bar1=0.0d0
      I8Bar1=0.0d0
      I9Bar1=0.0d0
      I10Bar1=0.0d0
      I1Bar2=0.0d0
      I2Bar2=0.0d0
      I3Bar2=0.0d0
      I4Bar2=0.0d0
      I5Bar2=0.0d0
      I6Bar2=0.0d0
      I7Bar2=0.0d0
      I8Bar2=0.0d0
      I9Bar2=0.0d0
      I10Bar2=0.0d0
      I1Bar3=0.0d0
      I2Bar3=0.0d0
      I3Bar3=0.0d0
      I4Bar3=0.0d0
      I5Bar3=0.0d0
      I6Bar3=0.0d0
      I7Bar3=0.0d0
      I8Bar3=0.0d0
      I9Bar3=0.0d0
      I10Bar3=0.0d0
      I1Bar4=0.0d0
      I2Bar4=0.0d0
      I3Bar4=0.0d0
      I4Bar4=0.0d0
      I5Bar4=0.0d0
      I6Bar4=0.0d0
      I7Bar4=0.0d0
      I8Bar4=0.0d0
      I9Bar4=0.0d0
      I10Bar4=0.0d0
      I1Bar5=0.0d0
      I2Bar5=0.0d0
      I3Bar5=0.0d0
      I4Bar5=0.0d0
      I5Bar5=0.0d0
      I6Bar5=0.0d0
      I7Bar5=0.0d0
      I8Bar5=0.0d0
      I9Bar5=0.0d0
      I10Bar5=0.0d0
      I1Bar6=0.0d0
      I2Bar6=0.0d0
      I3Bar6=0.0d0
      I4Bar6=0.0d0
      I5Bar6=0.0d0
      I6Bar6=0.0d0
      I7Bar6=0.0d0
      I8Bar6=0.0d0
      I9Bar6=0.0d0
      I10Bar6=0.0d0
      I1Bar7=0.0d0
      I2Bar7=0.0d0
      I3Bar7=0.0d0
      I4Bar7=0.0d0
      I5Bar7=0.0d0
      I6Bar7=0.0d0
      I7Bar7=0.0d0
      I8Bar7=0.0d0
      I9Bar7=0.0d0
      I10Bar7=0.0d0
      I1Bar8=0.0d0
      I2Bar8=0.0d0
      I3Bar8=0.0d0
      I4Bar8=0.0d0
      I5Bar8=0.0d0
      I6Bar8=0.0d0
      I7Bar8=0.0d0
      I8Bar8=0.0d0
      I9Bar8=0.0d0
      I10Bar8=0.0d0
      I1Bar9=0.0d0
      I2Bar9=0.0d0
      I3Bar9=0.0d0
      I4Bar9=0.0d0
      I5Bar9=0.0d0
      I6Bar9=0.0d0
      I7Bar9=0.0d0
      I8Bar9=0.0d0
      I9Bar9=0.0d0
      I10Bar9=0.0d0
      I1Bar10=0.0d0
      I2Bar10=0.0d0
      I3Bar10=0.0d0
      I4Bar10=0.0d0
      I5Bar10=0.0d0
      I6Bar10=0.0d0
      I7Bar10=0.0d0
      I8Bar10=0.0d0
      I9Bar10=0.0d0
      I10Bar10=0.0d0
      Ax=ACInfo%Atm1X
      Ay=ACInfo%Atm1Y
      Az=ACInfo%Atm1Z
      Bx=ACInfo%Atm2X
      By=ACInfo%Atm2Y
      Bz=ACInfo%Atm2Z
      Cx=BDInfo%Atm1X
      Cy=BDInfo%Atm1Y
      Cz=BDInfo%Atm1Z
      Dx=BDInfo%Atm2X
      Dy=BDInfo%Atm2Y
      Dz=BDInfo%Atm2Z
      ABx=Ax-Bx
      ABy=Ay-By
      ABz=Az-Bz
      CDx=Cx-Dx
      CDy=Cy-Dy
      CDz=Cz-Dz
      DO J=1,LKet ! K^2 VRR |N0) loop 
         Eta=PrmBufK(1,J)
         Qx =PrmBufK(2,J)
         Qy =PrmBufK(3,J)
         Qz =PrmBufK(4,J)
         Uq =PrmBufK(5,J)
         QCx=Qx-Cx
         QCy=Qy-Cy
         QCz=Qz-Cz
         DO K=1,LBra ! K^2 VRR (M0| loop 
            Zeta=PrmBufB(1,K)
            Px  =PrmBufB(2,K)
            Py  =PrmBufB(3,K)
            Pz  =PrmBufB(4,K)
            Up  =PrmBufB(5,K)
            r1xZpE=One/(Zeta+Eta)
            Upq=SQRT(r1xZpE)*Up*Uq
            HfxZpE=Half/(Zeta+Eta)
            r1x2E=Half/Eta
            r1x2Z=Half/Zeta
            ExZpE=Eta*r1xZpE
            ZxZpE=Zeta*r1xZpE
            Omega=Eta*Zeta*r1xZpE
            PAx=Px-Ax
            PAy=Py-Ay
            PAz=Pz-Az
            PQx=Px-Qx
            PQy=Py-Qy
            PQz=Pz-Qz
      ! Need to be improve...
            FPQx = PQx*PBC%InvBoxSh%D(1,1)+PQy*PBC%InvBoxSh%D(1,2)+PQz*PBC%InvBoxSh%D(1,3)
            FPQy = PQy*PBC%InvBoxSh%D(2,2)+PQz*PBC%InvBoxSh%D(2,3)
            FPQz = PQz*PBC%InvBoxSh%D(3,3)
            IF(PBC%AutoW%I(1)==1) FPQx = FPQx-ANINT(ANINT(FPQx*1d9)*1d-9)
            IF(PBC%AutoW%I(2)==1) FPQy = FPQy-ANINT(ANINT(FPQy*1d9)*1d-9)
            IF(PBC%AutoW%I(3)==1) FPQz = FPQz-ANINT(ANINT(FPQz*1d9)*1d-9)
            PQx  = FPQx*PBC%BoxShape%D(1,1)+FPQy*PBC%BoxShape%D(1,2)+FPQz*PBC%BoxShape%D(1,3)
            PQy  = FPQy*PBC%BoxShape%D(2,2)+FPQz*PBC%BoxShape%D(2,3)
            PQz  = FPQz*PBC%BoxShape%D(3,3)
      !
            WPx = -Eta*PQx*r1xZpE
            WPy = -Eta*PQy*r1xZpE
            WPz = -Eta*PQz*r1xZpE
            WQx = Zeta*PQx*r1xZpE
            WQy = Zeta*PQy*r1xZpE
            WQz = Zeta*PQz*r1xZpE
            T=Omega*(PQx*PQx+PQy*PQy+PQz*PQz)
            IF(T<Gamma_Switch)THEN
              L=AINT(T*Gamma_Grid)
              ET=EXP(-T)
              TwoT=Two*T
              W4=(F4_0(L)+T*(F4_1(L)+T*(F4_2(L)+T*(F4_3(L)+T*F4_4(L)))))
              W3=+1.428571428571428D-01*(TwoT*W4+ET)
              W2=+2.000000000000000D-01*(TwoT*W3+ET)
              W1=+3.333333333333333D-01*(TwoT*W2+ET)
              W0=TwoT*W1+ET
              AuxR0=Upq*W0
              AuxR1=Upq*W1
              AuxR2=Upq*W2
              AuxR3=Upq*W3
              AuxR4=Upq*W4
            ELSE
              InvT=One/T
              SqInvT=DSQRT(InvT)
              AuxR0=+8.862269254527580D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR1=+4.431134627263790D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR2=+6.646701940895685D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR3=+1.661675485223921D+00*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR4=+5.815864198283724D+00*Upq*SqInvT
            ENDIF
      V(1)=AuxR0*PAx
      V(2)=AuxR1*WPx
      V(3)=AuxR0*PAy
      V(4)=AuxR1*WPy
      V(5)=AuxR0*PAz
      V(6)=AuxR1*WPz
      V(7)=AuxR1*ExZpE
      V(8)=-V(7)
      V(9)=AuxR0+V(8)
      V(10)=r1x2Z*V(9)
      V(11)=V(1)+V(2)
      V(12)=PAx*V(11)
      V(13)=AuxR1*PAx
      V(14)=AuxR2*WPx
      V(15)=V(13)+V(14)
      V(16)=WPx*V(15)
      V(17)=V(3)+V(4)
      V(18)=PAx*V(17)
      V(19)=AuxR1*PAy
      V(20)=AuxR2*WPy
      V(21)=V(19)+V(20)
      V(22)=WPx*V(21)
      V(23)=PAy*V(17)
      V(24)=WPy*V(21)
      V(25)=V(5)+V(6)
      V(26)=PAx*V(25)
      V(27)=AuxR1*PAz
      V(28)=AuxR2*WPz
      V(29)=V(27)+V(28)
      V(30)=WPx*V(29)
      V(31)=PAy*V(25)
      V(32)=WPy*V(29)
      V(33)=PAz*V(25)
      V(34)=WPz*V(29)
      V(35)=AuxR0*QCx
      V(36)=AuxR1*WQx
      V(37)=AuxR1*HfxZpE
      V(38)=QCx*V(11)
      V(39)=WQx*V(15)
      V(40)=QCx*V(17)
      V(41)=WQx*V(21)
      V(42)=QCx*V(25)
      V(43)=WQx*V(29)
      V(44)=HfxZpE*V(15)
      V(45)=V(37)+V(38)+V(39)
      V(46)=PAx*V(45)
      V(47)=AuxR2*HfxZpE
      V(48)=QCx*V(15)
      V(49)=AuxR2*PAx
      V(50)=AuxR3*WPx
      V(51)=V(49)+V(50)
      V(52)=WQx*V(51)
      V(53)=V(47)+V(48)+V(52)
      V(54)=WPx*V(53)
      V(55)=AuxR1*QCx
      V(56)=AuxR2*WQx
      V(57)=V(55)+V(56)
      V(58)=ExZpE*V(57)
      V(59)=-V(58)
      V(60)=V(35)+V(36)+V(59)
      V(61)=r1x2Z*V(60)
      V(62)=HfxZpE*V(21)
      V(63)=V(18)+V(22)
      V(64)=QCx*V(63)
      V(65)=PAx*V(21)
      V(66)=AuxR2*PAy
      V(67)=AuxR3*WPy
      V(68)=V(66)+V(67)
      V(69)=WPx*V(68)
      V(70)=V(65)+V(69)
      V(71)=WQx*V(70)
      V(72)=V(40)+V(41)
      V(73)=PAy*V(72)
      V(74)=QCx*V(21)
      V(75)=WQx*V(68)
      V(76)=V(74)+V(75)
      V(77)=WPy*V(76)
      V(78)=HfxZpE*V(29)
      V(79)=V(26)+V(30)
      V(80)=QCx*V(79)
      V(81)=PAx*V(29)
      V(82)=AuxR2*PAz
      V(83)=AuxR3*WPz
      V(84)=V(82)+V(83)
      V(85)=WPx*V(84)
      V(86)=V(81)+V(85)
      V(87)=WQx*V(86)
      V(88)=V(31)+V(32)
      V(89)=QCx*V(88)
      V(90)=PAy*V(29)
      V(91)=WPy*V(84)
      V(92)=V(90)+V(91)
      V(93)=WQx*V(92)
      V(94)=V(42)+V(43)
      V(95)=PAz*V(94)
      V(96)=QCx*V(29)
      V(97)=WQx*V(84)
      V(98)=V(96)+V(97)
      V(99)=WPz*V(98)
      V(100)=AuxR0*QCy
      V(101)=AuxR1*WQy
      V(102)=QCy*V(11)
      V(103)=WQy*V(15)
      V(104)=QCy*V(17)
      V(105)=WQy*V(21)
      V(106)=QCy*V(25)
      V(107)=WQy*V(29)
      V(108)=V(102)+V(103)
      V(109)=PAx*V(108)
      V(110)=QCy*V(15)
      V(111)=WQy*V(51)
      V(112)=V(110)+V(111)
      V(113)=WPx*V(112)
      V(114)=AuxR1*QCy
      V(115)=AuxR2*WQy
      V(116)=V(114)+V(115)
      V(117)=ExZpE*V(116)
      V(118)=-V(117)
      V(119)=V(100)+V(101)+V(118)
      V(120)=r1x2Z*V(119)
      V(121)=QCy*V(63)
      V(122)=WQy*V(70)
      V(123)=V(37)+V(104)+V(105)
      V(124)=PAy*V(123)
      V(125)=QCy*V(21)
      V(126)=WQy*V(68)
      V(127)=V(47)+V(125)+V(126)
      V(128)=WPy*V(127)
      V(129)=QCy*V(79)
      V(130)=WQy*V(86)
      V(131)=QCy*V(88)
      V(132)=WQy*V(92)
      V(133)=V(106)+V(107)
      V(134)=PAz*V(133)
      V(135)=QCy*V(29)
      V(136)=WQy*V(84)
      V(137)=V(135)+V(136)
      V(138)=WPz*V(137)
      V(139)=AuxR0*QCz
      V(140)=AuxR1*WQz
      V(141)=QCz*V(11)
      V(142)=WQz*V(15)
      V(143)=QCz*V(17)
      V(144)=WQz*V(21)
      V(145)=QCz*V(25)
      V(146)=WQz*V(29)
      V(147)=V(141)+V(142)
      V(148)=PAx*V(147)
      V(149)=QCz*V(15)
      V(150)=WQz*V(51)
      V(151)=V(149)+V(150)
      V(152)=WPx*V(151)
      V(153)=AuxR1*QCz
      V(154)=AuxR2*WQz
      V(155)=V(153)+V(154)
      V(156)=ExZpE*V(155)
      V(157)=-V(156)
      V(158)=V(139)+V(140)+V(157)
      V(159)=r1x2Z*V(158)
      V(160)=QCz*V(63)
      V(161)=WQz*V(70)
      V(162)=V(143)+V(144)
      V(163)=PAy*V(162)
      V(164)=QCz*V(21)
      V(165)=WQz*V(68)
      V(166)=V(164)+V(165)
      V(167)=WPy*V(166)
      V(168)=QCz*V(79)
      V(169)=WQz*V(86)
      V(170)=QCz*V(88)
      V(171)=WQz*V(92)
      V(172)=V(37)+V(145)+V(146)
      V(173)=PAz*V(172)
      V(174)=QCz*V(29)
      V(175)=WQz*V(84)
      V(176)=V(47)+V(174)+V(175)
      V(177)=WPz*V(176)
      V(178)=AuxR1*ZxZpE
      V(179)=-V(178)
      V(180)=AuxR0+V(179)
      V(181)=r1x2E*V(180)
      V(182)=ZxZpE*V(15)
      V(183)=-V(182)
      V(184)=V(1)+V(2)+V(183)
      V(185)=r1x2E*V(184)
      V(186)=ZxZpE*V(21)
      V(187)=-V(186)
      V(188)=V(3)+V(4)+V(187)
      V(189)=r1x2E*V(188)
      V(190)=ZxZpE*V(29)
      V(191)=-V(190)
      V(192)=V(5)+V(6)+V(191)
      V(193)=r1x2E*V(192)
      V(194)=HfxZpE*V(51)
      V(195)=AuxR3*HfxZpE
      V(196)=AuxR3*PAx
      V(197)=AuxR4*WPx
      V(198)=V(196)+V(197)
      V(199)=AuxR2*QCx
      V(200)=AuxR3*WQx
      V(201)=V(199)+V(200)
      V(202)=ExZpE*V(201)
      V(203)=-V(202)
      V(204)=V(55)+V(56)+V(203)
      V(205)=r1x2Z*V(204)
      V(206)=AuxR2*ExZpE
      V(207)=-V(206)
      V(208)=AuxR1+V(207)
      V(209)=r1x2Z*V(208)
      V(210)=PAx*V(15)
      V(211)=WPx*V(51)
      V(212)=V(209)+V(210)+V(211)
      V(213)=ZxZpE*V(212)
      V(214)=-V(213)
      V(215)=V(10)+V(12)+V(16)+V(214)
      V(216)=r1x2E*V(215)
      V(217)=HfxZpE*V(76)
      V(218)=HfxZpE*V(68)
      V(219)=PAx*V(68)
      V(220)=AuxR3*PAy
      V(221)=AuxR4*WPy
      V(222)=V(220)+V(221)
      V(223)=WPx*V(222)
      V(224)=V(219)+V(223)
      V(225)=ZxZpE*V(70)
      V(226)=-V(225)
      V(227)=V(18)+V(22)+V(226)
      V(228)=r1x2E*V(227)
      V(229)=PAy*V(21)
      V(230)=WPy*V(68)
      V(231)=V(209)+V(229)+V(230)
      V(232)=ZxZpE*V(231)
      V(233)=-V(232)
      V(234)=V(10)+V(23)+V(24)+V(233)
      V(235)=r1x2E*V(234)
      V(236)=HfxZpE*V(98)
      V(237)=HfxZpE*V(84)
      V(238)=PAx*V(84)
      V(239)=AuxR3*PAz
      V(240)=AuxR4*WPz
      V(241)=V(239)+V(240)
      V(242)=WPx*V(241)
      V(243)=V(238)+V(242)
      V(244)=ZxZpE*V(86)
      V(245)=-V(244)
      V(246)=V(26)+V(30)+V(245)
      V(247)=r1x2E*V(246)
      V(248)=PAy*V(84)
      V(249)=WPy*V(241)
      V(250)=V(248)+V(249)
      V(251)=ZxZpE*V(92)
      V(252)=-V(251)
      V(253)=V(31)+V(32)+V(252)
      V(254)=r1x2E*V(253)
      V(255)=PAz*V(29)
      V(256)=WPz*V(84)
      V(257)=V(209)+V(255)+V(256)
      V(258)=ZxZpE*V(257)
      V(259)=-V(258)
      V(260)=V(10)+V(33)+V(34)+V(259)
      V(261)=r1x2E*V(260)
      V(262)=V(100)+V(101)
      V(263)=QCx*V(262)
      V(264)=WQx*V(116)
      V(265)=HfxZpE*V(116)
      V(266)=QCx*V(108)
      V(267)=WQx*V(112)
      V(268)=QCx*V(123)
      V(269)=WQx*V(127)
      V(270)=QCx*V(133)
      V(271)=WQx*V(137)
      V(272)=HfxZpE*V(112)
      V(273)=AuxR2*QCy
      V(274)=AuxR3*WQy
      V(275)=V(273)+V(274)
      V(276)=QCy*V(51)
      V(277)=WQy*V(198)
      V(278)=V(276)+V(277)
      V(279)=QCx*V(116)
      V(280)=WQx*V(275)
      V(281)=V(279)+V(280)
      V(282)=ExZpE*V(281)
      V(283)=-V(282)
      V(284)=V(263)+V(264)+V(283)
      V(285)=r1x2Z*V(284)
      V(286)=HfxZpE*V(127)
      V(287)=V(44)+V(121)+V(122)
      V(288)=QCy*V(70)
      V(289)=WQy*V(224)
      V(290)=V(194)+V(288)+V(289)
      V(291)=QCy*V(68)
      V(292)=WQy*V(222)
      V(293)=V(195)+V(291)+V(292)
      V(294)=HfxZpE*V(137)
      V(295)=V(129)+V(130)
      V(296)=QCy*V(86)
      V(297)=WQy*V(243)
      V(298)=V(296)+V(297)
      V(299)=V(78)+V(131)+V(132)
      V(300)=QCy*V(92)
      V(301)=WQy*V(250)
      V(302)=V(237)+V(300)+V(301)
      V(303)=QCy*V(84)
      V(304)=WQy*V(241)
      V(305)=V(303)+V(304)
      V(306)=ExZpE*V(275)
      V(307)=-V(306)
      V(308)=V(114)+V(115)+V(307)
      V(309)=r1x2Z*V(308)
      V(310)=V(139)+V(140)
      V(311)=QCx*V(310)
      V(312)=WQx*V(155)
      V(313)=HfxZpE*V(155)
      V(314)=QCx*V(147)
      V(315)=WQx*V(151)
      V(316)=QCx*V(162)
      V(317)=WQx*V(166)
      V(318)=QCx*V(172)
      V(319)=WQx*V(176)
      V(320)=HfxZpE*V(151)
      V(321)=AuxR2*QCz
      V(322)=AuxR3*WQz
      V(323)=V(321)+V(322)
      V(324)=HfxZpE*V(323)
      V(325)=QCz*V(51)
      V(326)=WQz*V(198)
      V(327)=V(325)+V(326)
      V(328)=QCx*V(155)
      V(329)=WQx*V(323)
      V(330)=V(328)+V(329)
      V(331)=ExZpE*V(330)
      V(332)=-V(331)
      V(333)=V(311)+V(312)+V(332)
      V(334)=r1x2Z*V(333)
      V(335)=HfxZpE*V(166)
      V(336)=V(160)+V(161)
      V(337)=QCz*V(70)
      V(338)=WQz*V(224)
      V(339)=V(337)+V(338)
      V(340)=QCz*V(68)
      V(341)=WQz*V(222)
      V(342)=V(340)+V(341)
      V(343)=HfxZpE*V(176)
      V(344)=V(44)+V(168)+V(169)
      V(345)=QCz*V(86)
      V(346)=WQz*V(243)
      V(347)=V(194)+V(345)+V(346)
      V(348)=V(62)+V(170)+V(171)
      V(349)=QCz*V(92)
      V(350)=WQz*V(250)
      V(351)=V(218)+V(349)+V(350)
      V(352)=QCz*V(84)
      V(353)=WQz*V(241)
      V(354)=V(195)+V(352)+V(353)
      V(355)=QCy*V(310)
      V(356)=WQy*V(155)
      V(357)=QCy*V(147)
      V(358)=WQy*V(151)
      V(359)=QCy*V(162)
      V(360)=WQy*V(166)
      V(361)=QCy*V(172)
      V(362)=WQy*V(176)
      V(363)=QCy*V(155)
      V(364)=WQy*V(323)
      V(365)=V(363)+V(364)
      V(366)=ExZpE*V(365)
      V(367)=-V(366)
      V(368)=V(355)+V(356)+V(367)
      V(369)=r1x2Z*V(368)
      V(370)=ExZpE*V(323)
      V(371)=-V(370)
      V(372)=V(153)+V(154)+V(371)
      V(373)=r1x2Z*V(372)
      I1Bar1=AuxR0+I1Bar1
      I2Bar1=I2Bar1+V(1)+V(2)
      I3Bar1=I3Bar1+V(3)+V(4)
      I4Bar1=I4Bar1+V(5)+V(6)
      I5Bar1=I5Bar1+V(10)+V(12)+V(16)
      I6Bar1=I6Bar1+V(18)+V(22)
      I7Bar1=I7Bar1+V(10)+V(23)+V(24)
      I8Bar1=I8Bar1+V(26)+V(30)
      I9Bar1=I9Bar1+V(31)+V(32)
      I10Bar1=I10Bar1+V(10)+V(33)+V(34)
      I1Bar2=I1Bar2+V(35)+V(36)
      I2Bar2=I2Bar2+V(37)+V(38)+V(39)
      I3Bar2=I3Bar2+V(40)+V(41)
      I4Bar2=I4Bar2+V(42)+V(43)
      I5Bar2=I5Bar2+V(44)+V(46)+V(54)+V(61)
      I6Bar2=I6Bar2+V(62)+V(64)+V(71)
      I7Bar2=I7Bar2+V(61)+V(73)+V(77)
      I8Bar2=I8Bar2+V(78)+V(80)+V(87)
      I9Bar2=I9Bar2+V(89)+V(93)
      I10Bar2=I10Bar2+V(61)+V(95)+V(99)
      I1Bar3=I1Bar3+V(100)+V(101)
      I2Bar3=I2Bar3+V(102)+V(103)
      I3Bar3=I3Bar3+V(37)+V(104)+V(105)
      I4Bar3=I4Bar3+V(106)+V(107)
      I5Bar3=I5Bar3+V(109)+V(113)+V(120)
      I6Bar3=I6Bar3+V(44)+V(121)+V(122)
      I7Bar3=I7Bar3+V(62)+V(120)+V(124)+V(128)
      I8Bar3=I8Bar3+V(129)+V(130)
      I9Bar3=I9Bar3+V(78)+V(131)+V(132)
      I10Bar3=I10Bar3+V(120)+V(134)+V(138)
      I1Bar4=I1Bar4+V(139)+V(140)
      I2Bar4=I2Bar4+V(141)+V(142)
      I3Bar4=I3Bar4+V(143)+V(144)
      I4Bar4=I4Bar4+V(37)+V(145)+V(146)
      I5Bar4=I5Bar4+V(148)+V(152)+V(159)
      I6Bar4=I6Bar4+V(160)+V(161)
      I7Bar4=I7Bar4+V(159)+V(163)+V(167)
      I8Bar4=I8Bar4+V(44)+V(168)+V(169)
      I9Bar4=I9Bar4+V(62)+V(170)+V(171)
      I10Bar4=I10Bar4+V(78)+V(159)+V(173)+V(177)
      W1=I1Bar5+QCx*(V(35)+V(36))
      W2=WQx*V(57)+V(181)
      I1Bar5=W1+W2
      W1=I2Bar5+QCx*V(45)
      W2=WQx*V(53)+HfxZpE*V(57)+V(185)
      I2Bar5=W1+W2
      I3Bar5=I3Bar5+QCx*V(72)+WQx*V(76)+V(189)
      I4Bar5=I4Bar5+QCx*V(94)+WQx*V(98)+V(193)
      W1=I5Bar5+2.D0*HfxZpE*V(53)
      W2=QCx*(V(44)+V(46)+V(54)+V(61))
      W3=PAx*V(53)+V(194)
      W4=WPx*(QCx*V(51)+V(195)+WQx*V(198))
      W5=V(205)
      W6=V(216)
      W7=W1+W2
      W8=WQx*(W3+W4+W5)+W6
      I5Bar5=W7+W8
      W1=I6Bar5+QCx*(V(62)+V(64)+V(71))
      W2=V(217)
      W3=WQx*(QCx*V(70)+V(218)+WQx*V(224))
      W4=V(228)
      I6Bar5=W1+W2+W3+W4
      W1=I7Bar5+QCx*(V(61)+V(73)+V(77))
      W2=PAy*V(76)
      W3=V(205)+WPy*(QCx*V(68)+WQx*V(222))
      W4=V(235)
      I7Bar5=W1+WQx*(W2+W3)+W4
      W1=I8Bar5+QCx*(V(78)+V(80)+V(87))
      W2=V(236)
      W3=WQx*(QCx*V(86)+V(237)+WQx*V(243))
      W4=V(247)
      I8Bar5=W1+W2+W3+W4
      W1=I9Bar5+QCx*(V(89)+V(93))
      W2=WQx*(QCx*V(92)+WQx*V(250))+V(254)
      I9Bar5=W1+W2
      W1=I10Bar5+QCx*(V(61)+V(95)+V(99))
      W2=PAz*V(98)
      W3=V(205)+WPz*(QCx*V(84)+WQx*V(241))
      W4=V(261)
      I10Bar5=W1+WQx*(W2+W3)+W4
      I1Bar6=I1Bar6+V(263)+V(264)
      I2Bar6=I2Bar6+V(265)+V(266)+V(267)
      I3Bar6=I3Bar6+V(268)+V(269)
      I4Bar6=I4Bar6+V(270)+V(271)
      W1=I5Bar6+PAx*(V(265)+V(266)+V(267))
      W2=V(272)
      W3=WPx*(QCx*V(112)+HfxZpE*V(275)+WQx*V(278))
      W4=V(285)
      I5Bar6=W1+W2+W3+W4
      I6Bar6=I6Bar6+V(286)+QCx*V(287)+WQx*V(290)
      W1=I7Bar6+V(217)
      W2=PAy*(V(268)+V(269))
      W3=V(285)+WPy*(QCx*V(127)+WQx*V(293))
      I7Bar6=W1+W2+W3
      I8Bar6=I8Bar6+V(294)+QCx*V(295)+WQx*V(298)
      I9Bar6=I9Bar6+QCx*V(299)+WQx*V(302)
      W1=I10Bar6+PAz*(V(270)+V(271))
      W2=V(285)+WPz*(QCx*V(137)+WQx*V(305))
      I10Bar6=W1+W2
      I1Bar7=I1Bar7+WQy*V(116)+V(181)+QCy*V(262)
      I2Bar7=I2Bar7+QCy*V(108)+WQy*V(112)+V(185)
      I3Bar7=I3Bar7+QCy*V(123)+WQy*V(127)+V(189)+V(265)
      I4Bar7=I4Bar7+QCy*V(133)+WQy*V(137)+V(193)
      W1=I5Bar7+QCy*(V(109)+V(113)+V(120))
      W2=V(216)
      W3=WQy*(PAx*V(112)+WPx*V(278)+V(309))
      I5Bar7=W1+W2+W3
      I6Bar7=I6Bar7+V(228)+V(272)+QCy*V(287)+WQy*V(290)
      W1=I7Bar7+QCy*(V(62)+V(120)+V(124)+V(128))
      W2=V(235)
      W3=2.D0*V(286)
      W4=WQy*(PAy*V(127)+V(218)+WPy*V(293)+V(309))
      I7Bar7=W1+W2+W3+W4
      I8Bar7=I8Bar7+V(247)+QCy*V(295)+WQy*V(298)
      I9Bar7=I9Bar7+V(254)+V(294)+QCy*V(299)+WQy*V(302)
      W1=I10Bar7+QCy*(V(120)+V(134)+V(138))
      W2=V(261)
      W3=WQy*(PAz*V(137)+WPz*V(305)+V(309))
      I10Bar7=W1+W2+W3
      I1Bar8=I1Bar8+V(311)+V(312)
      I2Bar8=I2Bar8+V(313)+V(314)+V(315)
      I3Bar8=I3Bar8+V(316)+V(317)
      I4Bar8=I4Bar8+V(318)+V(319)
      W1=I5Bar8+PAx*(V(313)+V(314)+V(315))
      W2=V(320)
      W3=WPx*(QCx*V(151)+V(324)+WQx*V(327))
      W4=V(334)
      I5Bar8=W1+W2+W3+W4
      I6Bar8=I6Bar8+V(335)+QCx*V(336)+WQx*V(339)
      W1=I7Bar8+PAy*(V(316)+V(317))
      W2=V(334)+WPy*(QCx*V(166)+WQx*V(342))
      I7Bar8=W1+W2
      I8Bar8=I8Bar8+V(343)+QCx*V(344)+WQx*V(347)
      I9Bar8=I9Bar8+QCx*V(348)+WQx*V(351)
      W1=I10Bar8+V(236)
      W2=PAz*(V(318)+V(319))
      W3=V(334)+WPz*(QCx*V(176)+WQx*V(354))
      I10Bar8=W1+W2+W3
      I1Bar9=I1Bar9+V(355)+V(356)
      I2Bar9=I2Bar9+V(357)+V(358)
      I3Bar9=I3Bar9+V(313)+V(359)+V(360)
      I4Bar9=I4Bar9+V(361)+V(362)
      W1=I5Bar9+WPx*(QCy*V(151)+WQy*V(327))
      W2=PAx*(V(357)+V(358))+V(369)
      I5Bar9=W1+W2
      I6Bar9=I6Bar9+V(320)+QCy*V(336)+WQy*V(339)
      W1=I7Bar9+V(335)
      W2=WPy*(QCy*V(166)+V(324)+WQy*V(342))
      W3=PAy*(V(313)+V(359)+V(360))+V(369)
      I7Bar9=W1+W2+W3
      I8Bar9=I8Bar9+QCy*V(344)+WQy*V(347)
      I9Bar9=I9Bar9+V(343)+QCy*V(348)+WQy*V(351)
      W1=I10Bar9+V(294)
      W2=WPz*(QCy*V(176)+WQy*V(354))
      W3=PAz*(V(361)+V(362))+V(369)
      I10Bar9=W1+W2+W3
      I1Bar10=I1Bar10+WQz*V(155)+V(181)+QCz*V(310)
      I2Bar10=I2Bar10+QCz*V(147)+WQz*V(151)+V(185)
      I3Bar10=I3Bar10+QCz*V(162)+WQz*V(166)+V(189)
      I4Bar10=I4Bar10+QCz*V(172)+WQz*V(176)+V(193)+V(313)
      W1=I5Bar10+QCz*(V(148)+V(152)+V(159))
      W2=V(216)
      W3=WQz*(PAx*V(151)+WPx*V(327)+V(373))
      I5Bar10=W1+W2+W3
      I6Bar10=I6Bar10+V(228)+QCz*V(336)+WQz*V(339)
      W1=I7Bar10+QCz*(V(159)+V(163)+V(167))
      W2=V(235)
      W3=WQz*(PAy*V(166)+WPy*V(342)+V(373))
      I7Bar10=W1+W2+W3
      I8Bar10=I8Bar10+V(247)+V(320)+QCz*V(344)+WQz*V(347)
      I9Bar10=I9Bar10+V(254)+V(335)+QCz*V(348)+WQz*V(351)
      W1=I10Bar10+QCz*(V(78)+V(159)+V(173)+V(177))
      W2=V(261)
      W3=2.D0*V(343)
      W4=WQz*(PAz*V(176)+V(237)+WPz*V(354)+V(373))
      I10Bar10=W1+W2+W3+W4
         ENDDO ! (M0| loop
      ENDDO ! |N0) loop
      ! HRR 
      V(1)=CDx*I2Bar2
      V(2)=I2Bar5+V(1)
      V(3)=CDx*I3Bar2
      V(4)=I3Bar5+V(3)
      V(5)=CDx*I6Bar2
      V(6)=CDx*I4Bar2
      V(7)=I4Bar5+V(6)
      V(8)=CDx*I8Bar2
      V(9)=CDx*I9Bar2
      V(10)=CDx*I2Bar3
      V(11)=I2Bar6+V(10)
      V(12)=CDx*I3Bar3
      V(13)=I3Bar6+V(12)
      V(14)=CDx*I6Bar3
      V(15)=CDx*I4Bar3
      V(16)=I4Bar6+V(15)
      V(17)=CDx*I8Bar3
      V(18)=CDx*I9Bar3
      V(19)=CDx*I2Bar4
      V(20)=I2Bar8+V(19)
      V(21)=CDx*I3Bar4
      V(22)=I3Bar8+V(21)
      V(23)=CDx*I6Bar4
      V(24)=CDx*I4Bar4
      V(25)=I4Bar8+V(24)
      V(26)=CDx*I8Bar4
      V(27)=CDx*I9Bar4
      V(28)=CDy*I2Bar2
      V(29)=I2Bar6+V(28)
      V(30)=CDy*I3Bar2
      V(31)=I3Bar6+V(30)
      V(32)=CDy*I6Bar2
      V(33)=CDy*I4Bar2
      V(34)=I4Bar6+V(33)
      V(35)=CDy*I8Bar2
      V(36)=CDy*I9Bar2
      V(37)=CDy*I2Bar3
      V(38)=I2Bar7+V(37)
      V(39)=CDy*I3Bar3
      V(40)=I3Bar7+V(39)
      V(41)=CDy*I6Bar3
      V(42)=CDy*I4Bar3
      V(43)=I4Bar7+V(42)
      V(44)=CDy*I8Bar3
      V(45)=CDy*I9Bar3
      V(46)=CDy*I2Bar4
      V(47)=I2Bar9+V(46)
      V(48)=CDy*I3Bar4
      V(49)=I3Bar9+V(48)
      V(50)=CDy*I6Bar4
      V(51)=CDy*I4Bar4
      V(52)=I4Bar9+V(51)
      V(53)=CDy*I8Bar4
      V(54)=CDy*I9Bar4
      V(55)=CDz*I2Bar2
      V(56)=I2Bar8+V(55)
      V(57)=CDz*I3Bar2
      V(58)=I3Bar8+V(57)
      V(59)=CDz*I6Bar2
      V(60)=CDz*I4Bar2
      V(61)=I4Bar8+V(60)
      V(62)=CDz*I8Bar2
      V(63)=CDz*I9Bar2
      V(64)=CDz*I2Bar3
      V(65)=I2Bar9+V(64)
      V(66)=CDz*I3Bar3
      V(67)=I3Bar9+V(66)
      V(68)=CDz*I6Bar3
      V(69)=CDz*I4Bar3
      V(70)=I4Bar9+V(69)
      V(71)=CDz*I8Bar3
      V(72)=CDz*I9Bar3
      V(73)=CDz*I2Bar4
      V(74)=I2Bar10+V(73)
      V(75)=CDz*I3Bar4
      V(76)=I3Bar10+V(75)
      V(77)=CDz*I6Bar4
      V(78)=CDz*I4Bar4
      V(79)=I4Bar10+V(78)
      V(80)=CDz*I8Bar4
      V(81)=CDz*I9Bar4
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I5Bar2+I5Bar5+I(OffSet)+ABx*V(2)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I6Bar5+I(OffSet)+ABx*V(4)+V(5)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I8Bar5+I(OffSet)+ABx*V(7)+V(8)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I6Bar5+I(OffSet)+ABy*V(2)+V(5)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I7Bar2+I7Bar5+I(OffSet)+ABy*V(4)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I9Bar5+I(OffSet)+ABy*V(7)+V(9)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I8Bar5+I(OffSet)+ABz*V(2)+V(8)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I9Bar5+I(OffSet)+ABz*V(4)+V(9)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I10Bar2+I10Bar5+I(OffSet)+ABz*V(7)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I5Bar3+I5Bar6+I(OffSet)+ABx*V(11)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I6Bar6+I(OffSet)+ABx*V(13)+V(14)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I8Bar6+I(OffSet)+ABx*V(16)+V(17)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I6Bar6+I(OffSet)+ABy*V(11)+V(14)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I7Bar3+I7Bar6+I(OffSet)+ABy*V(13)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I9Bar6+I(OffSet)+ABy*V(16)+V(18)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I8Bar6+I(OffSet)+ABz*V(11)+V(17)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I9Bar6+I(OffSet)+ABz*V(13)+V(18)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I10Bar3+I10Bar6+I(OffSet)+ABz*V(16)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I5Bar4+I5Bar8+I(OffSet)+ABx*V(20)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I6Bar8+I(OffSet)+ABx*V(22)+V(23)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I8Bar8+I(OffSet)+ABx*V(25)+V(26)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I6Bar8+I(OffSet)+ABy*V(20)+V(23)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I7Bar4+I7Bar8+I(OffSet)+ABy*V(22)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I9Bar8+I(OffSet)+ABy*V(25)+V(27)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I8Bar8+I(OffSet)+ABz*V(20)+V(26)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I9Bar8+I(OffSet)+ABz*V(22)+V(27)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=CDx*I10Bar4+I10Bar8+I(OffSet)+ABz*V(25)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I5Bar2+I5Bar6+I(OffSet)+ABx*V(29)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=I6Bar6+I(OffSet)+ABx*V(31)+V(32)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=I8Bar6+I(OffSet)+ABx*V(34)+V(35)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=I6Bar6+I(OffSet)+ABy*V(29)+V(32)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I7Bar2+I7Bar6+I(OffSet)+ABy*V(31)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=I9Bar6+I(OffSet)+ABy*V(34)+V(36)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=I8Bar6+I(OffSet)+ABz*V(29)+V(35)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=I9Bar6+I(OffSet)+ABz*V(31)+V(36)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I10Bar2+I10Bar6+I(OffSet)+ABz*V(34)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I5Bar3+I5Bar7+I(OffSet)+ABx*V(38)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=I6Bar7+I(OffSet)+ABx*V(40)+V(41)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=I8Bar7+I(OffSet)+ABx*V(43)+V(44)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=I6Bar7+I(OffSet)+ABy*V(38)+V(41)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I7Bar3+I7Bar7+I(OffSet)+ABy*V(40)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=I9Bar7+I(OffSet)+ABy*V(43)+V(45)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=I8Bar7+I(OffSet)+ABz*V(38)+V(44)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=I9Bar7+I(OffSet)+ABz*V(40)+V(45)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I10Bar3+I10Bar7+I(OffSet)+ABz*V(43)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I5Bar4+I5Bar9+I(OffSet)+ABx*V(47)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=I6Bar9+I(OffSet)+ABx*V(49)+V(50)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=I8Bar9+I(OffSet)+ABx*V(52)+V(53)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=I6Bar9+I(OffSet)+ABy*V(47)+V(50)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I7Bar4+I7Bar9+I(OffSet)+ABy*V(49)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=I9Bar9+I(OffSet)+ABy*V(52)+V(54)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=I8Bar9+I(OffSet)+ABz*V(47)+V(53)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=I9Bar9+I(OffSet)+ABz*V(49)+V(54)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+1)*LDD 
      I(OffSet)=CDy*I10Bar4+I10Bar9+I(OffSet)+ABz*V(52)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=CDz*I5Bar2+I5Bar8+I(OffSet)+ABx*V(56)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=I6Bar8+I(OffSet)+ABx*V(58)+V(59)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=I8Bar8+I(OffSet)+ABx*V(61)+V(62)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=I6Bar8+I(OffSet)+ABy*V(56)+V(59)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=CDz*I7Bar2+I7Bar8+I(OffSet)+ABy*V(58)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=I9Bar8+I(OffSet)+ABy*V(61)+V(63)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=I8Bar8+I(OffSet)+ABz*V(56)+V(62)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=I9Bar8+I(OffSet)+ABz*V(58)+V(63)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+2)*LDD 
      I(OffSet)=CDz*I10Bar2+I10Bar8+I(OffSet)+ABz*V(61)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=CDz*I5Bar3+I5Bar9+I(OffSet)+ABx*V(65)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=I6Bar9+I(OffSet)+ABx*V(67)+V(68)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=I8Bar9+I(OffSet)+ABx*V(70)+V(71)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=I6Bar9+I(OffSet)+ABy*V(65)+V(68)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=CDz*I7Bar3+I7Bar9+I(OffSet)+ABy*V(67)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=I9Bar9+I(OffSet)+ABy*V(70)+V(72)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=I8Bar9+I(OffSet)+ABz*V(65)+V(71)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=I9Bar9+I(OffSet)+ABz*V(67)+V(72)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+2)*LDD 
      I(OffSet)=CDz*I10Bar3+I10Bar9+I(OffSet)+ABz*V(70)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I5Bar10+CDz*I5Bar4+I(OffSet)+ABx*V(74)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I6Bar10+I(OffSet)+ABx*V(76)+V(77)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I8Bar10+I(OffSet)+ABx*V(79)+V(80)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I6Bar10+I(OffSet)+ABy*V(74)+V(77)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I7Bar10+CDz*I7Bar4+I(OffSet)+ABy*V(76)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I9Bar10+I(OffSet)+ABy*V(79)+V(81)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I8Bar10+I(OffSet)+ABz*V(74)+V(80)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I9Bar10+I(OffSet)+ABz*V(76)+V(81)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+2)*LDD 
      I(OffSet)=I10Bar10+CDz*I10Bar4+I(OffSet)+ABz*V(79)
   END SUBROUTINE Int3333
