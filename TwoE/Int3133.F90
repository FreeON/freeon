! ---------------------------------------------------------- 
! COMPUTES THE INTEGRAL CLASS (P S|P P) 
! ---------------------------------------------------------- 
   SUBROUTINE Int3133(PrmBufB,LBra,PrmBufK,LKet,ACInfo,BDInfo,I) 
      USE DerivedTypes
      USE GlobalScalars
      USE GammaF3
      USE ONX2DataType
      IMPLICIT REAL(DOUBLE) (A,I,V,W)
      INTEGER        :: LBra,LKet
      REAL(DOUBLE)   :: PrmBufB(5,LBra),PrmBufK(5,LKet)
      TYPE(AtomInfo) :: ACInfo,BDInfo
      REAL(DOUBLE),DIMENSION(4,1,4,4) :: I
      REAL(DOUBLE)  :: Zeta,Eta,r1xZpE,HfxZpE,r1x2E,r1x2Z,ExZpE,ZxZpE,Omega,Up,Uq,Upq
      REAL(DOUBLE)  :: Ax,Ay,Az,Bx,By,Bz,Cx,Cy,Cz,Dx,Dy,Dz,Qx,Qy,Qz,Px,Py,Pz,Wx,Wy,Wz
      REAL(DOUBLE)  :: QCx,QCy,QCz,PAx,PAy,PAz,PQx,PQy,PQz,WPx,WPy,WPz,WQx,WQy,WQz   
      REAL(DOUBLE)  :: T,ET,TwoT,InvT,SqInvT
      INTEGER       :: J,K,L
      I1Bar1=Zero
      I2Bar1=Zero
      I3Bar1=Zero
      I4Bar1=Zero
      I1Bar2=Zero
      I2Bar2=Zero
      I3Bar2=Zero
      I4Bar2=Zero
      I1Bar3=Zero
      I2Bar3=Zero
      I3Bar3=Zero
      I4Bar3=Zero
      I1Bar4=Zero
      I2Bar4=Zero
      I3Bar4=Zero
      I4Bar4=Zero
      I1Bar5=Zero
      I2Bar5=Zero
      I3Bar5=Zero
      I4Bar5=Zero
      I1Bar6=Zero
      I2Bar6=Zero
      I3Bar6=Zero
      I4Bar6=Zero
      I1Bar7=Zero
      I2Bar7=Zero
      I3Bar7=Zero
      I4Bar7=Zero
      I1Bar8=Zero
      I2Bar8=Zero
      I3Bar8=Zero
      I4Bar8=Zero
      I1Bar9=Zero
      I2Bar9=Zero
      I3Bar9=Zero
      I4Bar9=Zero
      I1Bar10=Zero
      I2Bar10=Zero
      I3Bar10=Zero
      I4Bar10=Zero
      Ax=ACInfo%Atm1X
      Ay=ACInfo%Atm1Y
      Az=ACInfo%Atm1Z
      Bx=BDInfo%Atm1X
      By=BDInfo%Atm1Y
      Bz=BDInfo%Atm1Z
      Cx=ACInfo%Atm2X
      Cy=ACInfo%Atm2Y
      Cz=ACInfo%Atm2Z
      Dx=BDInfo%Atm2X
      Dy=BDInfo%Atm2Y
      Dz=BDInfo%Atm2Z
      ABx=Ax-Bx
      ABy=Ay-By
      ABz=Az-Bz
      CDx=Cx-Dx
      CDy=Cy-Dy
      CDz=Cz-Dz
      DO J=1,LKet ! K^2 VRR |N0) loop 
         Eta=PrmBufK(1,J)
         Qx =PrmBufK(2,J)
         Qy =PrmBufK(3,J)
         Qz =PrmBufK(4,J)
         Uq =PrmBufK(5,J)
         QCx=Qx-Cx
         QCy=Qy-Cy
         QCz=Qz-Cz
         DO K=1,LBra ! K^2 VRR (M0| loop 
            Zeta=PrmBufB(1,K)
            Px  =PrmBufB(2,K)
            Py  =PrmBufB(3,K)
            Pz  =PrmBufB(4,K)
            Up  =PrmBufB(5,K)
            r1xZpE=One/(Zeta+Eta)
            Upq=SQRT(r1xZpE)*Up*Uq
            HfxZpE=Half/(Zeta+Eta)
            r1x2E=Half/Eta
            r1x2Z=Half/Zeta
            ExZpE=Eta*r1xZpE
            ZxZpE=Zeta*r1xZpE
            Omega=Eta*Zeta*r1xZpE
            Wx=(Zeta*Px+Eta*Qx)*r1xZpE
            Wy=(Zeta*Py+Eta*Qy)*r1xZpE
            Wz=(Zeta*Pz+Eta*Qz)*r1xZpE
            PAx=Px-Ax
            PAy=Py-Ay
            PAz=Pz-Az
            PQx=Px-Qx
            PQy=Py-Qy
            PQz=Pz-Qz
            WPx=Wx-Px
            WPy=Wy-Py
            WPz=Wz-Pz
            WQx=Wx-Qx
            WQy=Wy-Qy
            WQz=Wz-Qz
            T=Omega*(PQx*PQx+PQy*PQy+PQz*PQz)
            IF(T<Gamma_Switch)THEN
              L=AINT(T*Gamma_Grid)
              ET=EXP(-T)
              TwoT=Two*T
              W3=(F3_0(L)+T*(F3_1(L)+T*(F3_2(L)+T*(F3_3(L)+T*F3_4(L)))))
              W2=+2.000000000000000D-01*(TwoT*W3+ET)
              W1=+3.333333333333333D-01*(TwoT*W2+ET)
              W0=TwoT*W1+ET
              AuxR0=Upq*W0
              AuxR1=Upq*W1
              AuxR2=Upq*W2
              AuxR3=Upq*W3
            ELSE
              InvT=One/T
              SqInvT=DSQRT(InvT)
              AuxR0=+8.862269254527580D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR1=+4.431134627263790D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR2=+6.646701940895685D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR3=+1.661675485223921D+00*Upq*SqInvT
            ENDIF
            V1=AuxR0*PAx
            V2=AuxR1*WPx
            V3=AuxR0*PAy
            V4=AuxR1*WPy
            V5=AuxR0*PAz
            V6=AuxR1*WPz
            V7=AuxR0*QCx
            V8=AuxR1*WQx
            V9=AuxR1*HfxZpE
            V10=V1+V2
            V11=QCx*V10
            V12=AuxR1*PAx
            V13=AuxR2*WPx
            V14=V12+V13
            V15=V14*WQx
            V16=V3+V4
            V17=QCx*V16
            V18=AuxR1*PAy
            V19=AuxR2*WPy
            V20=V18+V19
            V21=V20*WQx
            V22=V5+V6
            V23=QCx*V22
            V24=AuxR1*PAz
            V25=AuxR2*WPz
            V26=V24+V25
            V27=V26*WQx
            V28=AuxR0*QCy
            V29=AuxR1*WQy
            V30=QCy*V10
            V31=V14*WQy
            V32=QCy*V16
            V33=V20*WQy
            V34=QCy*V22
            V35=V26*WQy
            V36=AuxR0*QCz
            V37=AuxR1*WQz
            V38=QCz*V10
            V39=V14*WQz
            V40=QCz*V16
            V41=V20*WQz
            V42=QCz*V22
            V43=V26*WQz
            V44=AuxR1*QCx
            V45=AuxR2*WQx
            V46=V44+V45
            V47=-(AuxR1*ZxZpE)
            V48=AuxR0+V47
            V49=r1x2E*V48
            V50=AuxR2*HfxZpE
            V51=AuxR2*PAx
            V52=AuxR3*WPx
            V53=V51+V52
            V54=-(V14*ZxZpE)
            V55=V1+V2+V54
            V56=r1x2E*V55
            V57=AuxR2*PAy
            V58=AuxR3*WPy
            V59=V57+V58
            V60=-(V20*ZxZpE)
            V61=V3+V4+V60
            V62=r1x2E*V61
            V63=AuxR2*PAz
            V64=AuxR3*WPz
            V65=V63+V64
            V66=-(V26*ZxZpE)
            V67=V5+V6+V66
            V68=r1x2E*V67
            V69=V28+V29
            V70=AuxR1*QCy
            V71=AuxR2*WQy
            V72=V70+V71
            V73=HfxZpE*V72
            V74=V30+V31
            V75=QCy*V14
            V76=V53*WQy
            V77=V75+V76
            V78=V32+V33+V9
            V79=QCy*V20
            V80=V59*WQy
            V81=V50+V79+V80
            V82=V34+V35
            V83=QCy*V26
            V84=V65*WQy
            V85=V83+V84
            V86=V36+V37
            V87=AuxR1*QCz
            V88=AuxR2*WQz
            V89=V87+V88
            V90=HfxZpE*V89
            V91=V38+V39
            V92=QCz*V14
            V93=V53*WQz
            V94=V92+V93
            V95=V40+V41
            V96=QCz*V20
            V97=V59*WQz
            V98=V96+V97
            V99=V42+V43+V9
            V100=QCz*V26
            V101=V65*WQz
            V102=V100+V101+V50
            I1Bar1=AuxR0+I1Bar1
            I2Bar1=V1+V2+I2Bar1
            I3Bar1=V3+V4+I3Bar1
            I4Bar1=V5+V6+I4Bar1
            I1Bar2=V7+V8+I1Bar2
            I2Bar2=V11+V15+V9+I2Bar2
            I3Bar2=V17+V21+I3Bar2
            I4Bar2=V23+V27+I4Bar2
            I1Bar3=V28+V29+I1Bar3
            I2Bar3=V30+V31+I2Bar3
            I3Bar3=V32+V33+V9+I3Bar3
            I4Bar3=V34+V35+I4Bar3
            I1Bar4=V36+V37+I1Bar4
            I2Bar4=V38+V39+I2Bar4
            I3Bar4=V40+V41+I3Bar4
            I4Bar4=V42+V43+V9+I4Bar4
            I1Bar5=V49+QCx*(V7+V8)+V46*WQx+I1Bar5
            W1=HfxZpE*V46+V56
            W2=QCx*(V11+V15+V9)
            W3=WQx*(QCx*V14+V50+V53*WQx)+I2Bar5
            I2Bar5=W1+W2+W3
            W1=QCx*(V17+V21)+V62
            W2=WQx*(QCx*V20+V59*WQx)+I3Bar5
            I3Bar5=W1+W2
            W1=QCx*(V23+V27)+V68
            W2=WQx*(QCx*V26+V65*WQx)+I4Bar5
            I4Bar5=W1+W2
            I1Bar6=QCx*V69+V72*WQx+I1Bar6
            I2Bar6=V73+QCx*V74+V77*WQx+I2Bar6
            I3Bar6=QCx*V78+V81*WQx+I3Bar6
            I4Bar6=QCx*V82+V85*WQx+I4Bar6
            I1Bar7=V49+QCy*V69+V72*WQy+I1Bar7
            I2Bar7=V56+QCy*V74+V77*WQy+I2Bar7
            I3Bar7=V62+V73+QCy*V78+V81*WQy+I3Bar7
            I4Bar7=V68+QCy*V82+V85*WQy+I4Bar7
            I1Bar8=QCx*V86+V89*WQx+I1Bar8
            I2Bar8=V90+QCx*V91+V94*WQx+I2Bar8
            I3Bar8=QCx*V95+V98*WQx+I3Bar8
            I4Bar8=QCx*V99+V102*WQx+I4Bar8
            I1Bar9=QCy*V86+V89*WQy+I1Bar9
            I2Bar9=QCy*V91+V94*WQy+I2Bar9
            I3Bar9=V90+QCy*V95+V98*WQy+I3Bar9
            I4Bar9=QCy*V99+V102*WQy+I4Bar9
            I1Bar10=V49+QCz*V86+V89*WQz+I1Bar10
            I2Bar10=V56+QCz*V91+V94*WQz+I2Bar10
            I3Bar10=V62+QCz*V95+V98*WQz+I3Bar10
            I4Bar10=V68+V90+QCz*V99+V102*WQz+I4Bar10
         ENDDO ! (M0| loop
      ENDDO ! |N0) loop
      ! HRR 
      I(2,1,2,2)=CDx*I2Bar2+I2Bar5
      I(3,1,2,2)=CDx*I3Bar2+I3Bar5
      I(4,1,2,2)=CDx*I4Bar2+I4Bar5
      I(2,1,3,2)=CDx*I2Bar3+I2Bar6
      I(3,1,3,2)=CDx*I3Bar3+I3Bar6
      I(4,1,3,2)=CDx*I4Bar3+I4Bar6
      I(2,1,4,2)=CDx*I2Bar4+I2Bar8
      I(3,1,4,2)=CDx*I3Bar4+I3Bar8
      I(4,1,4,2)=CDx*I4Bar4+I4Bar8
      I(2,1,2,3)=CDy*I2Bar2+I2Bar6
      I(3,1,2,3)=CDy*I3Bar2+I3Bar6
      I(4,1,2,3)=CDy*I4Bar2+I4Bar6
      I(2,1,3,3)=CDy*I2Bar3+I2Bar7
      I(3,1,3,3)=CDy*I3Bar3+I3Bar7
      I(4,1,3,3)=CDy*I4Bar3+I4Bar7
      I(2,1,4,3)=CDy*I2Bar4+I2Bar9
      I(3,1,4,3)=CDy*I3Bar4+I3Bar9
      I(4,1,4,3)=CDy*I4Bar4+I4Bar9
      I(2,1,2,4)=CDz*I2Bar2+I2Bar8
      I(3,1,2,4)=CDz*I3Bar2+I3Bar8
      I(4,1,2,4)=CDz*I4Bar2+I4Bar8
      I(2,1,3,4)=CDz*I2Bar3+I2Bar9
      I(3,1,3,4)=CDz*I3Bar3+I3Bar9
      I(4,1,3,4)=CDz*I4Bar3+I4Bar9
      I(2,1,4,4)=I2Bar10+CDz*I2Bar4
      I(3,1,4,4)=I3Bar10+CDz*I3Bar4
      I(4,1,4,4)=I4Bar10+CDz*I4Bar4
   END SUBROUTINE Int3133
