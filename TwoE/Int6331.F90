! ---------------------------------------------------------- 
! COMPUTES THE INTEGRAL CLASS (D P|P S) 
! ---------------------------------------------------------- 
   SUBROUTINE Int6331(PrmBufB,LBra,PrmBufK,LKet,ACInfo,BDInfo, & 
                              OA,LDA,OB,LDB,OC,LDC,OD,LDD,PBC,I) 
      USE DerivedTypes
      USE VScratch
      USE GlobalScalars
      USE ShellPairStruct
      USE GammaF4
      IMPLICIT REAL(DOUBLE) (A,I,W)
      INTEGER        :: LBra,LKet
      REAL(DOUBLE)   :: PrmBufB(7,LBra),PrmBufK(7,LKet)
      TYPE(SmallAtomInfo) :: ACInfo,BDInfo
      TYPE(PBCInfo) :: PBC
      REAL(DOUBLE) :: I(*)
      REAL(DOUBLE)  :: Zeta,Eta,r1xZpE,HfxZpE,r1x2E,r1x2Z,ExZpE,ZxZpE,Omega,Up,Uq,Upq
      REAL(DOUBLE)  :: Ax,Ay,Az,Bx,By,Bz,Cx,Cy,Cz,Dx,Dy,Dz,Qx,Qy,Qz,Px,Py,Pz
      REAL(DOUBLE)  :: QCx,QCy,QCz,PAx,PAy,PAz,PQx,PQy,PQz,WPx,WPy,WPz,WQx,WQy,WQz   
      REAL(DOUBLE)  :: T,ET,TwoT,InvT,SqInvT,ABx,ABy,ABz,CDx,CDy,CDz
      INTEGER       :: OffSet,OA,LDA,OB,LDB,OC,LDC,OD,LDD,J,K,L
      REAL(DOUBLE)  :: FPQx,FPQy,FPQz
      I1Bar1=0.0d0
      I2Bar1=0.0d0
      I3Bar1=0.0d0
      I4Bar1=0.0d0
      I5Bar1=0.0d0
      I6Bar1=0.0d0
      I7Bar1=0.0d0
      I8Bar1=0.0d0
      I9Bar1=0.0d0
      I10Bar1=0.0d0
      I11Bar1=0.0d0
      I12Bar1=0.0d0
      I13Bar1=0.0d0
      I14Bar1=0.0d0
      I15Bar1=0.0d0
      I16Bar1=0.0d0
      I17Bar1=0.0d0
      I18Bar1=0.0d0
      I19Bar1=0.0d0
      I20Bar1=0.0d0
      I1Bar2=0.0d0
      I2Bar2=0.0d0
      I3Bar2=0.0d0
      I4Bar2=0.0d0
      I5Bar2=0.0d0
      I6Bar2=0.0d0
      I7Bar2=0.0d0
      I8Bar2=0.0d0
      I9Bar2=0.0d0
      I10Bar2=0.0d0
      I11Bar2=0.0d0
      I12Bar2=0.0d0
      I13Bar2=0.0d0
      I14Bar2=0.0d0
      I15Bar2=0.0d0
      I16Bar2=0.0d0
      I17Bar2=0.0d0
      I18Bar2=0.0d0
      I19Bar2=0.0d0
      I20Bar2=0.0d0
      I1Bar3=0.0d0
      I2Bar3=0.0d0
      I3Bar3=0.0d0
      I4Bar3=0.0d0
      I5Bar3=0.0d0
      I6Bar3=0.0d0
      I7Bar3=0.0d0
      I8Bar3=0.0d0
      I9Bar3=0.0d0
      I10Bar3=0.0d0
      I11Bar3=0.0d0
      I12Bar3=0.0d0
      I13Bar3=0.0d0
      I14Bar3=0.0d0
      I15Bar3=0.0d0
      I16Bar3=0.0d0
      I17Bar3=0.0d0
      I18Bar3=0.0d0
      I19Bar3=0.0d0
      I20Bar3=0.0d0
      I1Bar4=0.0d0
      I2Bar4=0.0d0
      I3Bar4=0.0d0
      I4Bar4=0.0d0
      I5Bar4=0.0d0
      I6Bar4=0.0d0
      I7Bar4=0.0d0
      I8Bar4=0.0d0
      I9Bar4=0.0d0
      I10Bar4=0.0d0
      I11Bar4=0.0d0
      I12Bar4=0.0d0
      I13Bar4=0.0d0
      I14Bar4=0.0d0
      I15Bar4=0.0d0
      I16Bar4=0.0d0
      I17Bar4=0.0d0
      I18Bar4=0.0d0
      I19Bar4=0.0d0
      I20Bar4=0.0d0
      Ax=ACInfo%Atm1X
      Ay=ACInfo%Atm1Y
      Az=ACInfo%Atm1Z
      Bx=ACInfo%Atm2X
      By=ACInfo%Atm2Y
      Bz=ACInfo%Atm2Z
      Cx=BDInfo%Atm1X
      Cy=BDInfo%Atm1Y
      Cz=BDInfo%Atm1Z
      Dx=BDInfo%Atm2X
      Dy=BDInfo%Atm2Y
      Dz=BDInfo%Atm2Z
      ABx=Ax-Bx
      ABy=Ay-By
      ABz=Az-Bz
      CDx=Cx-Dx
      CDy=Cy-Dy
      CDz=Cz-Dz
      DO J=1,LKet ! K^2 VRR |N0) loop 
         Eta=PrmBufK(1,J)
         Qx =PrmBufK(2,J)
         Qy =PrmBufK(3,J)
         Qz =PrmBufK(4,J)
         Uq =PrmBufK(5,J)
         QCx=Qx-Cx
         QCy=Qy-Cy
         QCz=Qz-Cz
         DO K=1,LBra ! K^2 VRR (M0| loop 
            Zeta=PrmBufB(1,K)
            Px  =PrmBufB(2,K)
            Py  =PrmBufB(3,K)
            Pz  =PrmBufB(4,K)
            Up  =PrmBufB(5,K)
            r1xZpE=One/(Zeta+Eta)
            Upq=SQRT(r1xZpE)*Up*Uq
            HfxZpE=Half/(Zeta+Eta)
            r1x2E=Half/Eta
            r1x2Z=Half/Zeta
            ExZpE=Eta*r1xZpE
            ZxZpE=Zeta*r1xZpE
            Omega=Eta*Zeta*r1xZpE
            PAx=Px-Ax
            PAy=Py-Ay
            PAz=Pz-Az
            PQx=Px-Qx
            PQy=Py-Qy
            PQz=Pz-Qz
      ! Need to be improve...
            FPQx = PQx*PBC%InvBoxSh%D(1,1)+PQy*PBC%InvBoxSh%D(1,2)+PQz*PBC%InvBoxSh%D(1,3)
            FPQy = PQy*PBC%InvBoxSh%D(2,2)+PQz*PBC%InvBoxSh%D(2,3)
            FPQz = PQz*PBC%InvBoxSh%D(3,3)
            IF(PBC%AutoW%I(1)==1) FPQx = FPQx-ANINT(ANINT(FPQx*1d9)*1d-9)
            IF(PBC%AutoW%I(2)==1) FPQy = FPQy-ANINT(ANINT(FPQy*1d9)*1d-9)
            IF(PBC%AutoW%I(3)==1) FPQz = FPQz-ANINT(ANINT(FPQz*1d9)*1d-9)
            PQx  = FPQx*PBC%BoxShape%D(1,1)+FPQy*PBC%BoxShape%D(1,2)+FPQz*PBC%BoxShape%D(1,3)
            PQy  = FPQy*PBC%BoxShape%D(2,2)+FPQz*PBC%BoxShape%D(2,3)
            PQz  = FPQz*PBC%BoxShape%D(3,3)
      !
            WPx = -Eta*PQx*r1xZpE
            WPy = -Eta*PQy*r1xZpE
            WPz = -Eta*PQz*r1xZpE
            WQx = Zeta*PQx*r1xZpE
            WQy = Zeta*PQy*r1xZpE
            WQz = Zeta*PQz*r1xZpE
            T=Omega*(PQx*PQx+PQy*PQy+PQz*PQz)
            IF(T<Gamma_Switch)THEN
              L=AINT(T*Gamma_Grid)
              ET=EXP(-T)
              TwoT=Two*T
              W4=(F4_0(L)+T*(F4_1(L)+T*(F4_2(L)+T*(F4_3(L)+T*F4_4(L)))))
              W3=+1.428571428571428D-01*(TwoT*W4+ET)
              W2=+2.000000000000000D-01*(TwoT*W3+ET)
              W1=+3.333333333333333D-01*(TwoT*W2+ET)
              W0=TwoT*W1+ET
              AuxR0=Upq*W0
              AuxR1=Upq*W1
              AuxR2=Upq*W2
              AuxR3=Upq*W3
              AuxR4=Upq*W4
            ELSE
              InvT=One/T
              SqInvT=DSQRT(InvT)
              AuxR0=+8.862269254527580D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR1=+4.431134627263790D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR2=+6.646701940895685D-01*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR3=+1.661675485223921D+00*Upq*SqInvT
              SqInvT=SqInvT*InvT
              AuxR4=+5.815864198283724D+00*Upq*SqInvT
            ENDIF
      V(1)=AuxR0*PAx
      V(2)=AuxR1*WPx
      V(3)=AuxR0*PAy
      V(4)=AuxR1*WPy
      V(5)=AuxR0*PAz
      V(6)=AuxR1*WPz
      V(7)=AuxR1*ExZpE
      V(8)=-V(7)
      V(9)=AuxR0+V(8)
      V(10)=r1x2Z*V(9)
      V(11)=V(1)+V(2)
      V(12)=PAx*V(11)
      V(13)=AuxR1*PAx
      V(14)=AuxR2*WPx
      V(15)=V(13)+V(14)
      V(16)=WPx*V(15)
      V(17)=V(3)+V(4)
      V(18)=PAx*V(17)
      V(19)=AuxR1*PAy
      V(20)=AuxR2*WPy
      V(21)=V(19)+V(20)
      V(22)=WPx*V(21)
      V(23)=PAy*V(17)
      V(24)=WPy*V(21)
      V(25)=V(5)+V(6)
      V(26)=PAx*V(25)
      V(27)=AuxR1*PAz
      V(28)=AuxR2*WPz
      V(29)=V(27)+V(28)
      V(30)=WPx*V(29)
      V(31)=PAy*V(25)
      V(32)=WPy*V(29)
      V(33)=PAz*V(25)
      V(34)=WPz*V(29)
      V(35)=ExZpE*V(15)
      V(36)=-V(35)
      V(37)=V(1)+V(2)+V(36)
      V(38)=r1x2Z*V(37)
      V(39)=AuxR2*ExZpE
      V(40)=-V(39)
      V(41)=AuxR1+V(40)
      V(42)=r1x2Z*V(41)
      V(43)=PAx*V(15)
      V(44)=AuxR2*PAx
      V(45)=AuxR3*WPx
      V(46)=V(44)+V(45)
      V(47)=WPx*V(46)
      V(48)=V(42)+V(43)+V(47)
      V(49)=ExZpE*V(21)
      V(50)=-V(49)
      V(51)=V(3)+V(4)+V(50)
      V(52)=r1x2Z*V(51)
      V(53)=V(18)+V(22)
      V(54)=PAx*V(21)
      V(55)=AuxR2*PAy
      V(56)=AuxR3*WPy
      V(57)=V(55)+V(56)
      V(58)=WPx*V(57)
      V(59)=V(54)+V(58)
      V(60)=PAy*V(21)
      V(61)=WPy*V(57)
      V(62)=V(42)+V(60)+V(61)
      V(63)=ExZpE*V(29)
      V(64)=-V(63)
      V(65)=V(5)+V(6)+V(64)
      V(66)=r1x2Z*V(65)
      V(67)=V(26)+V(30)
      V(68)=PAx*V(29)
      V(69)=AuxR2*PAz
      V(70)=AuxR3*WPz
      V(71)=V(69)+V(70)
      V(72)=WPx*V(71)
      V(73)=V(68)+V(72)
      V(74)=V(31)+V(32)
      V(75)=PAx*V(74)
      V(76)=PAy*V(29)
      V(77)=WPy*V(71)
      V(78)=V(76)+V(77)
      V(79)=WPx*V(78)
      V(80)=PAz*V(29)
      V(81)=WPz*V(71)
      V(82)=V(42)+V(80)+V(81)
      V(83)=AuxR0*QCx
      V(84)=AuxR1*WQx
      V(85)=AuxR1*HfxZpE
      V(86)=QCx*V(11)
      V(87)=WQx*V(15)
      V(88)=QCx*V(17)
      V(89)=WQx*V(21)
      V(90)=QCx*V(25)
      V(91)=WQx*V(29)
      V(92)=HfxZpE*V(15)
      V(93)=V(85)+V(86)+V(87)
      V(94)=PAx*V(93)
      V(95)=AuxR2*HfxZpE
      V(96)=QCx*V(15)
      V(97)=WQx*V(46)
      V(98)=V(95)+V(96)+V(97)
      V(99)=WPx*V(98)
      V(100)=AuxR1*QCx
      V(101)=AuxR2*WQx
      V(102)=V(100)+V(101)
      V(103)=ExZpE*V(102)
      V(104)=-V(103)
      V(105)=V(83)+V(84)+V(104)
      V(106)=r1x2Z*V(105)
      V(107)=HfxZpE*V(21)
      V(108)=QCx*V(53)
      V(109)=WQx*V(59)
      V(110)=V(88)+V(89)
      V(111)=PAy*V(110)
      V(112)=QCx*V(21)
      V(113)=WQx*V(57)
      V(114)=V(112)+V(113)
      V(115)=WPy*V(114)
      V(116)=HfxZpE*V(29)
      V(117)=QCx*V(67)
      V(118)=WQx*V(73)
      V(119)=QCx*V(74)
      V(120)=WQx*V(78)
      V(121)=V(90)+V(91)
      V(122)=PAz*V(121)
      V(123)=QCx*V(29)
      V(124)=WQx*V(71)
      V(125)=V(123)+V(124)
      V(126)=WPz*V(125)
      V(127)=ExZpE*V(98)
      V(128)=-V(127)
      V(129)=V(85)+V(86)+V(87)+V(128)
      V(130)=r1x2Z*V(129)
      V(131)=HfxZpE*V(46)
      V(132)=AuxR3*HfxZpE
      V(133)=AuxR3*PAx
      V(134)=AuxR4*WPx
      V(135)=V(133)+V(134)
      V(136)=AuxR2*QCx
      V(137)=AuxR3*WQx
      V(138)=V(136)+V(137)
      V(139)=ExZpE*V(138)
      V(140)=-V(139)
      V(141)=V(100)+V(101)+V(140)
      V(142)=r1x2Z*V(141)
      V(143)=HfxZpE*V(59)
      V(144)=V(107)+V(108)+V(109)
      V(145)=HfxZpE*V(57)
      V(146)=QCx*V(59)
      V(147)=PAx*V(57)
      V(148)=AuxR3*PAy
      V(149)=AuxR4*WPy
      V(150)=V(148)+V(149)
      V(151)=WPx*V(150)
      V(152)=V(147)+V(151)
      V(153)=WQx*V(152)
      V(154)=V(145)+V(146)+V(153)
      V(155)=ExZpE*V(114)
      V(156)=-V(155)
      V(157)=V(88)+V(89)+V(156)
      V(158)=r1x2Z*V(157)
      V(159)=HfxZpE*V(73)
      V(160)=V(116)+V(117)+V(118)
      V(161)=HfxZpE*V(71)
      V(162)=QCx*V(73)
      V(163)=PAx*V(71)
      V(164)=AuxR3*PAz
      V(165)=AuxR4*WPz
      V(166)=V(164)+V(165)
      V(167)=WPx*V(166)
      V(168)=V(163)+V(167)
      V(169)=WQx*V(168)
      V(170)=V(161)+V(162)+V(169)
      V(171)=ExZpE*V(125)
      V(172)=-V(171)
      V(173)=V(90)+V(91)+V(172)
      V(174)=r1x2Z*V(173)
      V(175)=HfxZpE*V(78)
      V(176)=V(75)+V(79)
      V(177)=PAx*V(78)
      V(178)=PAy*V(71)
      V(179)=WPy*V(166)
      V(180)=V(178)+V(179)
      V(181)=WPx*V(180)
      V(182)=V(177)+V(181)
      V(183)=V(119)+V(120)
      V(184)=QCx*V(78)
      V(185)=WQx*V(180)
      V(186)=V(184)+V(185)
      V(187)=AuxR0*QCy
      V(188)=AuxR1*WQy
      V(189)=QCy*V(11)
      V(190)=WQy*V(15)
      V(191)=QCy*V(17)
      V(192)=WQy*V(21)
      V(193)=QCy*V(25)
      V(194)=WQy*V(29)
      V(195)=V(189)+V(190)
      V(196)=PAx*V(195)
      V(197)=QCy*V(15)
      V(198)=WQy*V(46)
      V(199)=V(197)+V(198)
      V(200)=WPx*V(199)
      V(201)=AuxR1*QCy
      V(202)=AuxR2*WQy
      V(203)=V(201)+V(202)
      V(204)=ExZpE*V(203)
      V(205)=-V(204)
      V(206)=V(187)+V(188)+V(205)
      V(207)=r1x2Z*V(206)
      V(208)=QCy*V(53)
      V(209)=WQy*V(59)
      V(210)=V(85)+V(191)+V(192)
      V(211)=PAy*V(210)
      V(212)=QCy*V(21)
      V(213)=WQy*V(57)
      V(214)=V(95)+V(212)+V(213)
      V(215)=WPy*V(214)
      V(216)=QCy*V(67)
      V(217)=WQy*V(73)
      V(218)=QCy*V(74)
      V(219)=WQy*V(78)
      V(220)=V(193)+V(194)
      V(221)=PAz*V(220)
      V(222)=QCy*V(29)
      V(223)=WQy*V(71)
      V(224)=V(222)+V(223)
      V(225)=WPz*V(224)
      V(226)=ExZpE*V(199)
      V(227)=-V(226)
      V(228)=V(189)+V(190)+V(227)
      V(229)=r1x2Z*V(228)
      V(230)=AuxR2*QCy
      V(231)=AuxR3*WQy
      V(232)=V(230)+V(231)
      V(233)=ExZpE*V(232)
      V(234)=-V(233)
      V(235)=V(201)+V(202)+V(234)
      V(236)=r1x2Z*V(235)
      V(237)=V(92)+V(208)+V(209)
      V(238)=QCy*V(59)
      V(239)=WQy*V(152)
      V(240)=V(131)+V(238)+V(239)
      V(241)=ExZpE*V(214)
      V(242)=-V(241)
      V(243)=V(85)+V(191)+V(192)+V(242)
      V(244)=r1x2Z*V(243)
      V(245)=V(216)+V(217)
      V(246)=QCy*V(73)
      V(247)=WQy*V(168)
      V(248)=V(246)+V(247)
      V(249)=ExZpE*V(224)
      V(250)=-V(249)
      V(251)=V(193)+V(194)+V(250)
      V(252)=r1x2Z*V(251)
      V(253)=V(116)+V(218)+V(219)
      V(254)=QCy*V(78)
      V(255)=WQy*V(180)
      V(256)=V(161)+V(254)+V(255)
      V(257)=AuxR0*QCz
      V(258)=AuxR1*WQz
      V(259)=QCz*V(11)
      V(260)=WQz*V(15)
      V(261)=QCz*V(17)
      V(262)=WQz*V(21)
      V(263)=QCz*V(25)
      V(264)=WQz*V(29)
      V(265)=V(259)+V(260)
      V(266)=PAx*V(265)
      V(267)=QCz*V(15)
      V(268)=WQz*V(46)
      V(269)=V(267)+V(268)
      V(270)=WPx*V(269)
      V(271)=AuxR1*QCz
      V(272)=AuxR2*WQz
      V(273)=V(271)+V(272)
      V(274)=ExZpE*V(273)
      V(275)=-V(274)
      V(276)=V(257)+V(258)+V(275)
      V(277)=r1x2Z*V(276)
      V(278)=QCz*V(53)
      V(279)=WQz*V(59)
      V(280)=V(261)+V(262)
      V(281)=PAy*V(280)
      V(282)=QCz*V(21)
      V(283)=WQz*V(57)
      V(284)=V(282)+V(283)
      V(285)=WPy*V(284)
      V(286)=QCz*V(67)
      V(287)=WQz*V(73)
      V(288)=QCz*V(74)
      V(289)=WQz*V(78)
      V(290)=V(85)+V(263)+V(264)
      V(291)=PAz*V(290)
      V(292)=QCz*V(29)
      V(293)=WQz*V(71)
      V(294)=V(95)+V(292)+V(293)
      V(295)=WPz*V(294)
      V(296)=ExZpE*V(269)
      V(297)=-V(296)
      V(298)=V(259)+V(260)+V(297)
      V(299)=r1x2Z*V(298)
      V(300)=AuxR2*QCz
      V(301)=AuxR3*WQz
      V(302)=V(300)+V(301)
      V(303)=ExZpE*V(302)
      V(304)=-V(303)
      V(305)=V(271)+V(272)+V(304)
      V(306)=r1x2Z*V(305)
      V(307)=V(278)+V(279)
      V(308)=QCz*V(59)
      V(309)=WQz*V(152)
      V(310)=V(308)+V(309)
      V(311)=ExZpE*V(284)
      V(312)=-V(311)
      V(313)=V(261)+V(262)+V(312)
      V(314)=r1x2Z*V(313)
      V(315)=V(92)+V(286)+V(287)
      V(316)=QCz*V(73)
      V(317)=WQz*V(168)
      V(318)=V(131)+V(316)+V(317)
      V(319)=ExZpE*V(294)
      V(320)=-V(319)
      V(321)=V(85)+V(263)+V(264)+V(320)
      V(322)=r1x2Z*V(321)
      V(323)=V(107)+V(288)+V(289)
      V(324)=QCz*V(78)
      V(325)=WQz*V(180)
      V(326)=V(145)+V(324)+V(325)
      I1Bar1=AuxR0+I1Bar1
      I2Bar1=I2Bar1+V(1)+V(2)
      I3Bar1=I3Bar1+V(3)+V(4)
      I4Bar1=I4Bar1+V(5)+V(6)
      I5Bar1=I5Bar1+V(10)+V(12)+V(16)
      I6Bar1=I6Bar1+V(18)+V(22)
      I7Bar1=I7Bar1+V(10)+V(23)+V(24)
      I8Bar1=I8Bar1+V(26)+V(30)
      I9Bar1=I9Bar1+V(31)+V(32)
      I10Bar1=I10Bar1+V(10)+V(33)+V(34)
      W1=I11Bar1+PAx*(V(10)+V(12)+V(16))
      W2=2.D0*V(38)+WPx*V(48)
      I11Bar1=W1+W2
      I12Bar1=I12Bar1+V(52)+PAx*V(53)+WPx*V(59)
      I13Bar1=I13Bar1+V(38)+PAy*V(53)+WPy*V(59)
      W1=I14Bar1+PAy*(V(10)+V(23)+V(24))
      W2=2.D0*V(52)+WPy*V(62)
      I14Bar1=W1+W2
      I15Bar1=I15Bar1+V(66)+PAx*V(67)+WPx*V(73)
      I16Bar1=I16Bar1+V(75)+V(79)
      I17Bar1=I17Bar1+V(66)+PAy*V(74)+WPy*V(78)
      I18Bar1=I18Bar1+V(38)+PAz*V(67)+WPz*V(73)
      I19Bar1=I19Bar1+V(52)+PAz*V(74)+WPz*V(78)
      W1=I20Bar1+PAz*(V(10)+V(33)+V(34))
      W2=2.D0*V(66)+WPz*V(82)
      I20Bar1=W1+W2
      I1Bar2=I1Bar2+V(83)+V(84)
      I2Bar2=I2Bar2+V(85)+V(86)+V(87)
      I3Bar2=I3Bar2+V(88)+V(89)
      I4Bar2=I4Bar2+V(90)+V(91)
      I5Bar2=I5Bar2+V(92)+V(94)+V(99)+V(106)
      I6Bar2=I6Bar2+V(107)+V(108)+V(109)
      I7Bar2=I7Bar2+V(106)+V(111)+V(115)
      I8Bar2=I8Bar2+V(116)+V(117)+V(118)
      I9Bar2=I9Bar2+V(119)+V(120)
      I10Bar2=I10Bar2+V(106)+V(122)+V(126)
      W1=I11Bar2+HfxZpE*V(48)
      W2=PAx*(V(92)+V(94)+V(99)+V(106))
      W3=2.D0*V(130)
      W4=PAx*V(98)+V(131)
      W5=WPx*(QCx*V(46)+V(132)+WQx*V(135))
      W6=V(142)
      W7=W1+W2
      W8=W3+WPx*(W4+W5+W6)
      I11Bar2=W7+W8
      I12Bar2=I12Bar2+V(143)+PAx*V(144)+WPx*V(154)+V(158)
      I13Bar2=I13Bar2+V(130)+PAy*V(144)+WPy*V(154)
      W1=I14Bar2+PAy*(V(106)+V(111)+V(115))
      W2=PAy*V(114)
      W3=V(142)+WPy*(QCx*V(57)+WQx*V(150))
      W4=2.D0*V(158)
      I14Bar2=W1+WPy*(W2+W3)+W4
      I15Bar2=I15Bar2+V(159)+PAx*V(160)+WPx*V(170)+V(174)
      I16Bar2=I16Bar2+V(175)+QCx*V(176)+WQx*V(182)
      I17Bar2=I17Bar2+V(174)+PAy*V(183)+WPy*V(186)
      I18Bar2=I18Bar2+V(130)+PAz*V(160)+WPz*V(170)
      I19Bar2=I19Bar2+V(158)+PAz*V(183)+WPz*V(186)
      W1=I20Bar2+PAz*(V(106)+V(122)+V(126))
      W2=PAz*V(125)
      W3=V(142)+WPz*(QCx*V(71)+WQx*V(166))
      W4=2.D0*V(174)
      I20Bar2=W1+WPz*(W2+W3)+W4
      I1Bar3=I1Bar3+V(187)+V(188)
      I2Bar3=I2Bar3+V(189)+V(190)
      I3Bar3=I3Bar3+V(85)+V(191)+V(192)
      I4Bar3=I4Bar3+V(193)+V(194)
      I5Bar3=I5Bar3+V(196)+V(200)+V(207)
      I6Bar3=I6Bar3+V(92)+V(208)+V(209)
      I7Bar3=I7Bar3+V(107)+V(207)+V(211)+V(215)
      I8Bar3=I8Bar3+V(216)+V(217)
      I9Bar3=I9Bar3+V(116)+V(218)+V(219)
      I10Bar3=I10Bar3+V(207)+V(221)+V(225)
      W1=I11Bar3+PAx*(V(196)+V(200)+V(207))
      W2=2.D0*V(229)
      W3=WPx*(QCy*V(46)+WQy*V(135))
      W4=PAx*V(199)+V(236)
      I11Bar3=W1+W2+WPx*(W3+W4)
      I12Bar3=I12Bar3+PAx*V(237)+WPx*V(240)+V(244)
      I13Bar3=I13Bar3+V(143)+V(229)+PAy*V(237)+WPy*V(240)
      W1=I14Bar3+HfxZpE*V(62)
      W2=PAy*(V(107)+V(207)+V(211)+V(215))
      W3=V(145)
      W4=WPy*(QCy*V(57)+V(132)+WQy*V(150))
      W5=PAy*V(214)+V(236)
      W6=2.D0*V(244)
      W7=W1+W2
      W8=WPy*(W3+W4+W5)+W6
      I14Bar3=W7+W8
      I15Bar3=I15Bar3+PAx*V(245)+WPx*V(248)+V(252)
      I16Bar3=I16Bar3+V(159)+QCy*V(176)+WQy*V(182)
      I17Bar3=I17Bar3+V(175)+V(252)+PAy*V(253)+WPy*V(256)
      I18Bar3=I18Bar3+V(229)+PAz*V(245)+WPz*V(248)
      I19Bar3=I19Bar3+V(244)+PAz*V(253)+WPz*V(256)
      W1=I20Bar3+PAz*(V(207)+V(221)+V(225))
      W2=WPz*(QCy*V(71)+WQy*V(166))
      W3=PAz*V(224)+V(236)
      W4=2.D0*V(252)
      I20Bar3=W1+WPz*(W2+W3)+W4
      I1Bar4=I1Bar4+V(257)+V(258)
      I2Bar4=I2Bar4+V(259)+V(260)
      I3Bar4=I3Bar4+V(261)+V(262)
      I4Bar4=I4Bar4+V(85)+V(263)+V(264)
      I5Bar4=I5Bar4+V(266)+V(270)+V(277)
      I6Bar4=I6Bar4+V(278)+V(279)
      I7Bar4=I7Bar4+V(277)+V(281)+V(285)
      I8Bar4=I8Bar4+V(92)+V(286)+V(287)
      I9Bar4=I9Bar4+V(107)+V(288)+V(289)
      I10Bar4=I10Bar4+V(116)+V(277)+V(291)+V(295)
      W1=I11Bar4+PAx*(V(266)+V(270)+V(277))
      W2=2.D0*V(299)
      W3=WPx*(QCz*V(46)+WQz*V(135))
      W4=PAx*V(269)+V(306)
      I11Bar4=W1+W2+WPx*(W3+W4)
      I12Bar4=I12Bar4+PAx*V(307)+WPx*V(310)+V(314)
      I13Bar4=I13Bar4+V(299)+PAy*V(307)+WPy*V(310)
      W1=I14Bar4+PAy*(V(277)+V(281)+V(285))
      W2=WPy*(QCz*V(57)+WQz*V(150))
      W3=PAy*V(284)+V(306)
      W4=2.D0*V(314)
      I14Bar4=W1+WPy*(W2+W3)+W4
      I15Bar4=I15Bar4+PAx*V(315)+WPx*V(318)+V(322)
      I16Bar4=I16Bar4+V(143)+QCz*V(176)+WQz*V(182)
      I17Bar4=I17Bar4+V(322)+PAy*V(323)+WPy*V(326)
      I18Bar4=I18Bar4+V(159)+V(299)+PAz*V(315)+WPz*V(318)
      I19Bar4=I19Bar4+V(175)+V(314)+PAz*V(323)+WPz*V(326)
      W1=I20Bar4+HfxZpE*V(82)
      W2=PAz*(V(116)+V(277)+V(291)+V(295))
      W3=V(161)
      W4=WPz*(QCz*V(71)+V(132)+WQz*V(166))
      W5=PAz*V(294)+V(306)
      W6=2.D0*V(322)
      W7=W1+W2
      W8=WPz*(W3+W4+W5)+W6
      I20Bar4=W7+W8
         ENDDO ! (M0| loop
      ENDDO ! |N0) loop
      ! HRR 
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I11Bar2+ABx*I5Bar2+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I12Bar2+ABx*I6Bar2+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I13Bar2+ABx*I7Bar2+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I15Bar2+ABx*I8Bar2+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar2+ABx*I9Bar2+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+0)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=ABx*I10Bar2+I18Bar2+I(OffSet)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I12Bar2+ABy*I5Bar2+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I13Bar2+ABy*I6Bar2+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I14Bar2+ABy*I7Bar2+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar2+ABy*I8Bar2+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I17Bar2+ABy*I9Bar2+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+1)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=ABy*I10Bar2+I19Bar2+I(OffSet)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I15Bar2+ABz*I5Bar2+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar2+ABz*I6Bar2+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I17Bar2+ABz*I7Bar2+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I18Bar2+ABz*I8Bar2+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=I19Bar2+ABz*I9Bar2+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+2)*LDB+(OC+0)*LDC+(OD+0)*LDD 
      I(OffSet)=ABz*I10Bar2+I20Bar2+I(OffSet)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I11Bar3+ABx*I5Bar3+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I12Bar3+ABx*I6Bar3+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I13Bar3+ABx*I7Bar3+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I15Bar3+ABx*I8Bar3+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar3+ABx*I9Bar3+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+0)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=ABx*I10Bar3+I18Bar3+I(OffSet)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I12Bar3+ABy*I5Bar3+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I13Bar3+ABy*I6Bar3+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I14Bar3+ABy*I7Bar3+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar3+ABy*I8Bar3+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I17Bar3+ABy*I9Bar3+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+1)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=ABy*I10Bar3+I19Bar3+I(OffSet)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I15Bar3+ABz*I5Bar3+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar3+ABz*I6Bar3+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I17Bar3+ABz*I7Bar3+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I18Bar3+ABz*I8Bar3+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=I19Bar3+ABz*I9Bar3+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+2)*LDB+(OC+1)*LDC+(OD+0)*LDD 
      I(OffSet)=ABz*I10Bar3+I20Bar3+I(OffSet)
      OffSet=(OA+0)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I11Bar4+ABx*I5Bar4+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I12Bar4+ABx*I6Bar4+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I13Bar4+ABx*I7Bar4+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I15Bar4+ABx*I8Bar4+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar4+ABx*I9Bar4+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+0)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=ABx*I10Bar4+I18Bar4+I(OffSet)
      OffSet=(OA+0)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I12Bar4+ABy*I5Bar4+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I13Bar4+ABy*I6Bar4+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I14Bar4+ABy*I7Bar4+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar4+ABy*I8Bar4+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I17Bar4+ABy*I9Bar4+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+1)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=ABy*I10Bar4+I19Bar4+I(OffSet)
      OffSet=(OA+0)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I15Bar4+ABz*I5Bar4+I(OffSet)
      OffSet=(OA+1)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I16Bar4+ABz*I6Bar4+I(OffSet)
      OffSet=(OA+2)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I17Bar4+ABz*I7Bar4+I(OffSet)
      OffSet=(OA+3)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I18Bar4+ABz*I8Bar4+I(OffSet)
      OffSet=(OA+4)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=I19Bar4+ABz*I9Bar4+I(OffSet)
      OffSet=(OA+5)*LDA+(OB+2)*LDB+(OC+2)*LDC+(OD+0)*LDD 
      I(OffSet)=ABz*I10Bar4+I20Bar4+I(OffSet)
   END SUBROUTINE Int6331
