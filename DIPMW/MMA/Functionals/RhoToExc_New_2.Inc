        Exc(1) = dRhoExc(0) 
        Vxc(1) = dRhoVxc(0) 
! 
        Exc(2) = dRhoExc(1)*RhoXX(2) 
        Vxc(2) = dRhoVxc(1)*RhoXX(2) 
        Exc(3) = dRhoExc(1)*RhoXX(3) 
        Vxc(3) = dRhoVxc(1)*RhoXX(3) 
        Exc(4) = dRhoExc(1)*RhoXX(4) 
        Vxc(4) = dRhoVxc(1)*RhoXX(4) 
        Exc(5) = dRhoExc(1)*RhoXX(5) 
        Vxc(5) = dRhoVxc(1)*RhoXX(5) 
        Exc(6) = dRhoExc(1)*RhoXX(6) 
        Vxc(6) = dRhoVxc(1)*RhoXX(6) 
        Exc(7) = dRhoExc(1)*RhoXX(7) 
        Vxc(7) = dRhoVxc(1)*RhoXX(7) 
        Exc(8) = dRhoExc(1)*RhoXX(8) 
        Vxc(8) = dRhoVxc(1)*RhoXX(8) 
        Exc(9) = dRhoExc(1)*RhoXX(9) 
        Vxc(9) = dRhoVxc(1)*RhoXX(9) 
        Exc(10) = dRhoExc(1)*RhoXX(10) 
        Vxc(10) = dRhoVxc(1)*RhoXX(10) 
        Exc(11) = dRhoExc(1)*RhoXX(11) 
        Vxc(11) = dRhoVxc(1)*RhoXX(11) 
        Exc(12) = dRhoExc(1)*RhoXX(12) 
        Vxc(12) = dRhoVxc(1)*RhoXX(12) 
        Exc(13) = dRhoExc(1)*RhoXX(13) 
        Vxc(13) = dRhoVxc(1)*RhoXX(13) 
        Exc(14) = dRhoExc(1)*RhoXX(14) 
        Vxc(14) = dRhoVxc(1)*RhoXX(14) 
        Exc(15) = dRhoExc(1)*RhoXX(15) 
        Vxc(15) = dRhoVxc(1)*RhoXX(15) 
        Exc(16) = dRhoExc(1)*RhoXX(16) 
        Vxc(16) = dRhoVxc(1)*RhoXX(16) 
        Exc(17) = dRhoExc(1)*RhoXX(17) 
        Vxc(17) = dRhoVxc(1)*RhoXX(17) 
        Exc(18) = dRhoExc(1)*RhoXX(18) 
        Vxc(18) = dRhoVxc(1)*RhoXX(18) 
        Exc(19) = dRhoExc(1)*RhoXX(19) 
        Vxc(19) = dRhoVxc(1)*RhoXX(19) 
        Exc(20) = dRhoExc(1)*RhoXX(20) 
        Vxc(20) = dRhoVxc(1)*RhoXX(20) 
        Exc(21) = dRhoExc(1)*RhoXX(21) 
        Vxc(21) = dRhoVxc(1)*RhoXX(21) 
        Exc(22) = dRhoExc(1)*RhoXX(22) 
        Vxc(22) = dRhoVxc(1)*RhoXX(22) 
        Exc(23) = dRhoExc(1)*RhoXX(23) 
        Vxc(23) = dRhoVxc(1)*RhoXX(23) 
        Exc(24) = dRhoExc(1)*RhoXX(24) 
        Vxc(24) = dRhoVxc(1)*RhoXX(24) 
        Exc(25) = dRhoExc(1)*RhoXX(25) 
        Vxc(25) = dRhoVxc(1)*RhoXX(25) 
        Exc(26) = dRhoExc(1)*RhoXX(26) 
        Vxc(26) = dRhoVxc(1)*RhoXX(26) 
        Exc(27) = dRhoExc(1)*RhoXX(27) 
        Vxc(27) = dRhoVxc(1)*RhoXX(27) 
! 
        RhoXX2(3) = RhoXX(2)**2
        Exc(3)    = Exc(3) + dRhoExc(2)*RhoXX2(3) 
        Vxc(3)    = Vxc(3) + dRhoVxc(2)*RhoXX2(3) 
        RhoXX2(5) = RhoXX(2)*RhoXX(4)
        Exc(5)    = Exc(5) + dRhoExc(2)*RhoXX2(5) 
        Vxc(5)    = Vxc(5) + dRhoVxc(2)*RhoXX2(5) 
        RhoXX2(6) = RhoXX(3)*RhoXX(4) + 2.D0*RhoXX(2)*RhoXX(5)
        Exc(6)    = Exc(6) + dRhoExc(2)*RhoXX2(6) 
        Vxc(6)    = Vxc(6) + dRhoVxc(2)*RhoXX2(6) 
        RhoXX2(7) = RhoXX(4)**2
        Exc(7)    = Exc(7) + dRhoExc(2)*RhoXX2(7) 
        Vxc(7)    = Vxc(7) + dRhoVxc(2)*RhoXX2(7) 
        RhoXX2(8) = 2.D0*RhoXX(4)*RhoXX(5) + RhoXX(2)*RhoXX(7)
        Exc(8)    = Exc(8) + dRhoExc(2)*RhoXX2(8) 
        Vxc(8)    = Vxc(8) + dRhoVxc(2)*RhoXX2(8) 
        t1 = 2.D0*RhoXX(5)**2 + 2.D0*RhoXX(4)*RhoXX(6)
        t2 = RhoXX(3)*RhoXX(7) + 2.D0*RhoXX(2)*RhoXX(8)
        RhoXX2(9) = t1 + t2
        Exc(9)    = Exc(9) + dRhoExc(2)*RhoXX2(9) 
        Vxc(9)    = Vxc(9) + dRhoVxc(2)*RhoXX2(9) 
        RhoXX2(11) = RhoXX(2)*RhoXX(10)
        Exc(11)    = Exc(11) + dRhoExc(2)*RhoXX2(11) 
        Vxc(11)    = Vxc(11) + dRhoVxc(2)*RhoXX2(11) 
        RhoXX2(12) = RhoXX(3)*RhoXX(10) + 2.D0*RhoXX(2)*RhoXX(11)
        Exc(12)    = Exc(12) + dRhoExc(2)*RhoXX2(12) 
        Vxc(12)    = Vxc(12) + dRhoVxc(2)*RhoXX2(12) 
        RhoXX2(13) = RhoXX(4)*RhoXX(10)
        Exc(13)    = Exc(13) + dRhoExc(2)*RhoXX2(13) 
        Vxc(13)    = Vxc(13) + dRhoVxc(2)*RhoXX2(13) 
        RhoXX2(14) = RhoXX(5)*RhoXX(10) + RhoXX(4)*RhoXX(11) + RhoXX(2)*RhoXX(13)
        Exc(14)    = Exc(14) + dRhoExc(2)*RhoXX2(14) 
        Vxc(14)    = Vxc(14) + dRhoVxc(2)*RhoXX2(14) 
        t1 = RhoXX(6)*RhoXX(10) + 2.D0*RhoXX(5)*RhoXX(11)
        t2 = RhoXX(4)*RhoXX(12)
        t3 = RhoXX(3)*RhoXX(13) + 2.D0*RhoXX(2)*RhoXX(14)
        RhoXX2(15) = t1 + t2 + t3
        Exc(15)    = Exc(15) + dRhoExc(2)*RhoXX2(15) 
        Vxc(15)    = Vxc(15) + dRhoVxc(2)*RhoXX2(15) 
        RhoXX2(16) = RhoXX(7)*RhoXX(10) + 2.D0*RhoXX(4)*RhoXX(13)
        Exc(16)    = Exc(16) + dRhoExc(2)*RhoXX2(16) 
        Vxc(16)    = Vxc(16) + dRhoVxc(2)*RhoXX2(16) 
        t1 = RhoXX(8)*RhoXX(10) + RhoXX(7)*RhoXX(11)
        t2 = 2.D0*RhoXX(5)*RhoXX(13)
        t3 = 2.D0*RhoXX(4)*RhoXX(14) + RhoXX(2)*RhoXX(16)
        RhoXX2(17) = t1 + t2 + t3
        Exc(17)    = Exc(17) + dRhoExc(2)*RhoXX2(17) 
        Vxc(17)    = Vxc(17) + dRhoVxc(2)*RhoXX2(17) 
        t1 = RhoXX(9)*RhoXX(10) + 2.D0*RhoXX(8)*RhoXX(11)
        t2 = RhoXX(7)*RhoXX(12) + 2.D0*RhoXX(6)*RhoXX(13)
        t3 = 4.D0*RhoXX(5)*RhoXX(14) + 2.D0*RhoXX(4)*RhoXX(15)
        t4 = RhoXX(3)*RhoXX(16) + 2.D0*RhoXX(2)*RhoXX(17)
        RhoXX2(18) = t1 + t2 + t3 + t4
        Exc(18)    = Exc(18) + dRhoExc(2)*RhoXX2(18) 
        Vxc(18)    = Vxc(18) + dRhoVxc(2)*RhoXX2(18) 
        RhoXX2(19) = RhoXX(10)**2
        Exc(19)    = Exc(19) + dRhoExc(2)*RhoXX2(19) 
        Vxc(19)    = Vxc(19) + dRhoVxc(2)*RhoXX2(19) 
        RhoXX2(20) = 2.D0*RhoXX(10)*RhoXX(11) + RhoXX(2)*RhoXX(19)
        Exc(20)    = Exc(20) + dRhoExc(2)*RhoXX2(20) 
        Vxc(20)    = Vxc(20) + dRhoVxc(2)*RhoXX2(20) 
        t1 = 2.D0*RhoXX(11)**2 + 2.D0*RhoXX(10)*RhoXX(12)
        t2 = RhoXX(3)*RhoXX(19) + 2.D0*RhoXX(2)*RhoXX(20)
        RhoXX2(21) = t1 + t2
        Exc(21)    = Exc(21) + dRhoExc(2)*RhoXX2(21) 
        Vxc(21)    = Vxc(21) + dRhoVxc(2)*RhoXX2(21) 
        RhoXX2(22) = 2.D0*RhoXX(10)*RhoXX(13) + RhoXX(4)*RhoXX(19)
        Exc(22)    = Exc(22) + dRhoExc(2)*RhoXX2(22) 
        Vxc(22)    = Vxc(22) + dRhoVxc(2)*RhoXX2(22) 
        t1 = 2.D0*RhoXX(11)*RhoXX(13) + 2.D0*RhoXX(10)*RhoXX(14)
        t2 = RhoXX(5)*RhoXX(19) + RhoXX(4)*RhoXX(20) + RhoXX(2)*RhoXX(22)
        RhoXX2(23) = t1 + t2
        Exc(23)    = Exc(23) + dRhoExc(2)*RhoXX2(23) 
        Vxc(23)    = Vxc(23) + dRhoVxc(2)*RhoXX2(23) 
        t1 = 2.D0*RhoXX(12)*RhoXX(13) + 4.D0*RhoXX(11)*RhoXX(14)
        t2 = 2.D0*RhoXX(10)*RhoXX(15) + RhoXX(6)*RhoXX(19)
        t3 = 2.D0*RhoXX(5)*RhoXX(20) + RhoXX(4)*RhoXX(21)
        t4 = RhoXX(3)*RhoXX(22) + 2.D0*RhoXX(2)*RhoXX(23)
        RhoXX2(24) = t1 + t2 + t3 + t4
        Exc(24)    = Exc(24) + dRhoExc(2)*RhoXX2(24) 
        Vxc(24)    = Vxc(24) + dRhoVxc(2)*RhoXX2(24) 
        t1 = 2.D0*RhoXX(13)**2 + 2.D0*RhoXX(10)*RhoXX(16)
        t2 = RhoXX(7)*RhoXX(19) + 2.D0*RhoXX(4)*RhoXX(22)
        RhoXX2(25) = t1 + t2
        Exc(25)    = Exc(25) + dRhoExc(2)*RhoXX2(25) 
        Vxc(25)    = Vxc(25) + dRhoVxc(2)*RhoXX2(25) 
        t1 = 4.D0*RhoXX(13)*RhoXX(14) + 2.D0*RhoXX(11)*RhoXX(16)
        t2 = 2.D0*RhoXX(10)*RhoXX(17) + RhoXX(8)*RhoXX(19)
        t3 = RhoXX(7)*RhoXX(20) + 2.D0*RhoXX(5)*RhoXX(22)
        t4 = 2.D0*RhoXX(4)*RhoXX(23) + RhoXX(2)*RhoXX(25)
        RhoXX2(26) = t1 + t2 + t3 + t4
        Exc(26)    = Exc(26) + dRhoExc(2)*RhoXX2(26) 
        Vxc(26)    = Vxc(26) + dRhoVxc(2)*RhoXX2(26) 
        t1 = 4.D0*RhoXX(14)**2
        t2 = 4.D0*RhoXX(13)*RhoXX(15) + 2.D0*RhoXX(12)*RhoXX(16)
        t3 = 4.D0*RhoXX(11)*RhoXX(17)
        t4 = 2.D0*RhoXX(10)*RhoXX(18) + RhoXX(9)*RhoXX(19)
        t5 = 2.D0*RhoXX(8)*RhoXX(20)
        t6 = RhoXX(7)*RhoXX(21) + 2.D0*RhoXX(6)*RhoXX(22)
        t7 = 4.D0*RhoXX(5)*RhoXX(23) + 2.D0*RhoXX(4)*RhoXX(24)
        t8 = RhoXX(3)*RhoXX(25) + 2.D0*RhoXX(2)*RhoXX(26)
        RhoXX2(27) = t1 + t2 + t3 + t4 + t5 + t6 + t7 + t8
        Exc(27)    = Exc(27) + dRhoExc(2)*RhoXX2(27) 
        Vxc(27)    = Vxc(27) + dRhoVxc(2)*RhoXX2(27) 
! 
        t1 = RhoXX(6)*RhoXX2(1) + 2.D0*RhoXX(5)*RhoXX2(2)
        t2 = RhoXX(4)*RhoXX2(3)
        t3 = RhoXX(3)*RhoXX2(4) + 2.D0*RhoXX(2)*RhoXX2(5)
        RhoXX3(6) = 3.333333333333333D-1*(t1 + t2 + t3)
        Exc(6)    = Exc(6) + dRhoExc(3)*RhoXX3(6) 
        Vxc(6)    = Vxc(6) + dRhoVxc(3)*RhoXX3(6) 
        t1 = RhoXX(8)*RhoXX2(1) + RhoXX(7)*RhoXX2(2)
        t2 = 2.D0*RhoXX(5)*RhoXX2(4)
        t3 = 2.D0*RhoXX(4)*RhoXX2(5) + RhoXX(2)*RhoXX2(7)
        RhoXX3(8) = 3.333333333333333D-1*(t1 + t2 + t3)
        Exc(8)    = Exc(8) + dRhoExc(3)*RhoXX3(8) 
        Vxc(8)    = Vxc(8) + dRhoVxc(3)*RhoXX3(8) 
        t1 = RhoXX(9)*RhoXX2(1) + 2.D0*RhoXX(8)*RhoXX2(2)
        t2 = RhoXX(7)*RhoXX2(3) + 2.D0*RhoXX(6)*RhoXX2(4)
        t3 = 4.D0*RhoXX(5)*RhoXX2(5) + 2.D0*RhoXX(4)*RhoXX2(6)
        t4 = RhoXX(3)*RhoXX2(7) + 2.D0*RhoXX(2)*RhoXX2(8)
        RhoXX3(9) = 3.333333333333333D-1*(t1 + t2 + t3 + t4)
        Exc(9)    = Exc(9) + dRhoExc(3)*RhoXX3(9) 
        Vxc(9)    = Vxc(9) + dRhoVxc(3)*RhoXX3(9) 
        t1 = RhoXX(12)*RhoXX2(1) + 2.D0*RhoXX(11)*RhoXX2(2)
        t2 = RhoXX(10)*RhoXX2(3)
        t3 = RhoXX(3)*RhoXX2(10) + 2.D0*RhoXX(2)*RhoXX2(11)
        RhoXX3(12) = 3.333333333333333D-1*(t1 + t2 + t3)
        Exc(12)    = Exc(12) + dRhoExc(3)*RhoXX3(12) 
        Vxc(12)    = Vxc(12) + dRhoVxc(3)*RhoXX3(12) 
        t1 = RhoXX(14)*RhoXX2(1) + RhoXX(13)*RhoXX2(2) + RhoXX(11)*RhoXX2(4)
        t2 = RhoXX(10)*RhoXX2(5) + RhoXX(5)*RhoXX2(10)
        t3 = RhoXX(4)*RhoXX2(11) + RhoXX(2)*RhoXX2(13)
        RhoXX3(14) = 3.333333333333333D-1*(t1 + t2 + t3)
        Exc(14)    = Exc(14) + dRhoExc(3)*RhoXX3(14) 
        Vxc(14)    = Vxc(14) + dRhoVxc(3)*RhoXX3(14) 
        t1 = RhoXX(15)*RhoXX2(1) + 2.D0*RhoXX(14)*RhoXX2(2)
        t2 = RhoXX(13)*RhoXX2(3)
        t3 = RhoXX(12)*RhoXX2(4) + 2.D0*RhoXX(11)*RhoXX2(5)
        t4 = RhoXX(10)*RhoXX2(6)
        t5 = RhoXX(6)*RhoXX2(10) + 2.D0*RhoXX(5)*RhoXX2(11)
        t6 = RhoXX(4)*RhoXX2(12)
        t7 = RhoXX(3)*RhoXX2(13) + 2.D0*RhoXX(2)*RhoXX2(14)
        t8 = t1 + t2 + t3 + t4 + t5 + t6 + t7
        RhoXX3(15) = 3.333333333333333D-1*t8
        Exc(15)    = Exc(15) + dRhoExc(3)*RhoXX3(15) 
        Vxc(15)    = Vxc(15) + dRhoVxc(3)*RhoXX3(15) 
        t1 = RhoXX(16)*RhoXX2(1) + 2.D0*RhoXX(13)*RhoXX2(4)
        t2 = RhoXX(10)*RhoXX2(7)
        t3 = RhoXX(7)*RhoXX2(10) + 2.D0*RhoXX(4)*RhoXX2(13)
        RhoXX3(16) = 3.333333333333333D-1*(t1 + t2 + t3)
        Exc(16)    = Exc(16) + dRhoExc(3)*RhoXX3(16) 
        Vxc(16)    = Vxc(16) + dRhoVxc(3)*RhoXX3(16) 
        t1 = RhoXX(17)*RhoXX2(1) + RhoXX(16)*RhoXX2(2)
        t2 = 2.D0*RhoXX(14)*RhoXX2(4)
        t3 = 2.D0*RhoXX(13)*RhoXX2(5) + RhoXX(11)*RhoXX2(7)
        t4 = RhoXX(10)*RhoXX2(8) + RhoXX(8)*RhoXX2(10) + RhoXX(7)*RhoXX2(11)
        t5 = 2.D0*RhoXX(5)*RhoXX2(13)
        t6 = 2.D0*RhoXX(4)*RhoXX2(14) + RhoXX(2)*RhoXX2(16)
        RhoXX3(17) = 3.333333333333333D-1*(t1 + t2 + t3 + t4 + t5 + t6)
        Exc(17)    = Exc(17) + dRhoExc(3)*RhoXX3(17) 
        Vxc(17)    = Vxc(17) + dRhoVxc(3)*RhoXX3(17) 
        t1 = RhoXX(18)*RhoXX2(1) + 2.D0*RhoXX(17)*RhoXX2(2)
        t2 = RhoXX(16)*RhoXX2(3) + 2.D0*RhoXX(15)*RhoXX2(4)
        t3 = 4.D0*RhoXX(14)*RhoXX2(5) + 2.D0*RhoXX(13)*RhoXX2(6)
        t4 = RhoXX(12)*RhoXX2(7) + 2.D0*RhoXX(11)*RhoXX2(8)
        t5 = RhoXX(10)*RhoXX2(9) + RhoXX(9)*RhoXX2(10)
        t6 = 2.D0*RhoXX(8)*RhoXX2(11) + RhoXX(7)*RhoXX2(12)
        t7 = 2.D0*RhoXX(6)*RhoXX2(13) + 4.D0*RhoXX(5)*RhoXX2(14)
        t8 = 2.D0*RhoXX(4)*RhoXX2(15)
        t9 = RhoXX(3)*RhoXX2(16) + 2.D0*RhoXX(2)*RhoXX2(17)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX3(18) = 3.333333333333333D-1*(t10 + t11)
        Exc(18)    = Exc(18) + dRhoExc(3)*RhoXX3(18) 
        Vxc(18)    = Vxc(18) + dRhoVxc(3)*RhoXX3(18) 
        t1 = RhoXX(20)*RhoXX2(1) + RhoXX(19)*RhoXX2(2)
        t2 = 2.D0*RhoXX(11)*RhoXX2(10)
        t3 = 2.D0*RhoXX(10)*RhoXX2(11) + RhoXX(2)*RhoXX2(19)
        RhoXX3(20) = 3.333333333333333D-1*(t1 + t2 + t3)
        Exc(20)    = Exc(20) + dRhoExc(3)*RhoXX3(20) 
        Vxc(20)    = Vxc(20) + dRhoVxc(3)*RhoXX3(20) 
        t1 = RhoXX(21)*RhoXX2(1) + 2.D0*RhoXX(20)*RhoXX2(2)
        t2 = RhoXX(19)*RhoXX2(3) + 2.D0*RhoXX(12)*RhoXX2(10)
        t3 = 4.D0*RhoXX(11)*RhoXX2(11) + 2.D0*RhoXX(10)*RhoXX2(12)
        t4 = RhoXX(3)*RhoXX2(19) + 2.D0*RhoXX(2)*RhoXX2(20)
        RhoXX3(21) = 3.333333333333333D-1*(t1 + t2 + t3 + t4)
        Exc(21)    = Exc(21) + dRhoExc(3)*RhoXX3(21) 
        Vxc(21)    = Vxc(21) + dRhoVxc(3)*RhoXX3(21) 
        t1 = RhoXX(22)*RhoXX2(1) + RhoXX(19)*RhoXX2(4)
        t2 = 2.D0*RhoXX(13)*RhoXX2(10)
        t3 = 2.D0*RhoXX(10)*RhoXX2(13) + RhoXX(4)*RhoXX2(19)
        RhoXX3(22) = 3.333333333333333D-1*(t1 + t2 + t3)
        Exc(22)    = Exc(22) + dRhoExc(3)*RhoXX3(22) 
        Vxc(22)    = Vxc(22) + dRhoVxc(3)*RhoXX3(22) 
        t1 = RhoXX(23)*RhoXX2(1) + RhoXX(22)*RhoXX2(2)
        t2 = RhoXX(20)*RhoXX2(4)
        t3 = RhoXX(19)*RhoXX2(5) + 2.D0*RhoXX(14)*RhoXX2(10)
        t4 = 2.D0*RhoXX(13)*RhoXX2(11)
        t5 = 2.D0*RhoXX(11)*RhoXX2(13) + 2.D0*RhoXX(10)*RhoXX2(14)
        t6 = RhoXX(5)*RhoXX2(19) + RhoXX(4)*RhoXX2(20) + RhoXX(2)*RhoXX2(22)
        RhoXX3(23) = 3.333333333333333D-1*(t1 + t2 + t3 + t4 + t5 + t6)
        Exc(23)    = Exc(23) + dRhoExc(3)*RhoXX3(23) 
        Vxc(23)    = Vxc(23) + dRhoVxc(3)*RhoXX3(23) 
        t1 = RhoXX(24)*RhoXX2(1) + 2.D0*RhoXX(23)*RhoXX2(2)
        t2 = RhoXX(22)*RhoXX2(3) + RhoXX(21)*RhoXX2(4)
        t3 = 2.D0*RhoXX(20)*RhoXX2(5) + RhoXX(19)*RhoXX2(6)
        t4 = 2.D0*RhoXX(15)*RhoXX2(10) + 4.D0*RhoXX(14)*RhoXX2(11)
        t5 = 2.D0*RhoXX(13)*RhoXX2(12) + 2.D0*RhoXX(12)*RhoXX2(13)
        t6 = 4.D0*RhoXX(11)*RhoXX2(14) + 2.D0*RhoXX(10)*RhoXX2(15)
        t7 = RhoXX(6)*RhoXX2(19) + 2.D0*RhoXX(5)*RhoXX2(20)
        t8 = RhoXX(4)*RhoXX2(21)
        t9 = RhoXX(3)*RhoXX2(22) + 2.D0*RhoXX(2)*RhoXX2(23)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX3(24) = 3.333333333333333D-1*(t10 + t11)
        Exc(24)    = Exc(24) + dRhoExc(3)*RhoXX3(24) 
        Vxc(24)    = Vxc(24) + dRhoVxc(3)*RhoXX3(24) 
        t1 = RhoXX(25)*RhoXX2(1) + 2.D0*RhoXX(22)*RhoXX2(4)
        t2 = RhoXX(19)*RhoXX2(7) + 2.D0*RhoXX(16)*RhoXX2(10)
        t3 = 4.D0*RhoXX(13)*RhoXX2(13) + 2.D0*RhoXX(10)*RhoXX2(16)
        t4 = RhoXX(7)*RhoXX2(19) + 2.D0*RhoXX(4)*RhoXX2(22)
        RhoXX3(25) = 3.333333333333333D-1*(t1 + t2 + t3 + t4)
        Exc(25)    = Exc(25) + dRhoExc(3)*RhoXX3(25) 
        Vxc(25)    = Vxc(25) + dRhoVxc(3)*RhoXX3(25) 
        t1 = RhoXX(26)*RhoXX2(1) + RhoXX(25)*RhoXX2(2)
        t2 = 2.D0*RhoXX(23)*RhoXX2(4) + 2.D0*RhoXX(22)*RhoXX2(5)
        t3 = RhoXX(20)*RhoXX2(7) + RhoXX(19)*RhoXX2(8)
        t4 = 2.D0*RhoXX(17)*RhoXX2(10) + 2.D0*RhoXX(16)*RhoXX2(11)
        t5 = 4.D0*RhoXX(14)*RhoXX2(13) + 4.D0*RhoXX(13)*RhoXX2(14)
        t6 = 2.D0*RhoXX(11)*RhoXX2(16) + 2.D0*RhoXX(10)*RhoXX2(17)
        t7 = RhoXX(8)*RhoXX2(19) + RhoXX(7)*RhoXX2(20)
        t8 = 2.D0*RhoXX(5)*RhoXX2(22)
        t9 = 2.D0*RhoXX(4)*RhoXX2(23) + RhoXX(2)*RhoXX2(25)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX3(26) = 3.333333333333333D-1*(t10 + t11)
        Exc(26)    = Exc(26) + dRhoExc(3)*RhoXX3(26) 
        Vxc(26)    = Vxc(26) + dRhoVxc(3)*RhoXX3(26) 
        t1 = RhoXX(27)*RhoXX2(1)
        t2 = 2.D0*RhoXX(26)*RhoXX2(2) + RhoXX(25)*RhoXX2(3)
        t3 = 2.D0*RhoXX(24)*RhoXX2(4)
        t4 = 4.D0*RhoXX(23)*RhoXX2(5) + 2.D0*RhoXX(22)*RhoXX2(6)
        t5 = RhoXX(21)*RhoXX2(7)
        t6 = 2.D0*RhoXX(20)*RhoXX2(8) + RhoXX(19)*RhoXX2(9)
        t7 = 2.D0*RhoXX(18)*RhoXX2(10) + 4.D0*RhoXX(17)*RhoXX2(11)
        t8 = 2.D0*RhoXX(16)*RhoXX2(12) + 4.D0*RhoXX(15)*RhoXX2(13)
        t9 = 8.D0*RhoXX(14)*RhoXX2(14)
        t10 = 4.D0*RhoXX(13)*RhoXX2(15) + 2.D0*RhoXX(12)*RhoXX2(16)
        t11 = 4.D0*RhoXX(11)*RhoXX2(17)
        t12 = 2.D0*RhoXX(10)*RhoXX2(18) + RhoXX(9)*RhoXX2(19)
        t13 = 2.D0*RhoXX(8)*RhoXX2(20)
        t14 = RhoXX(7)*RhoXX2(21) + 2.D0*RhoXX(6)*RhoXX2(22)
        t15 = 4.D0*RhoXX(5)*RhoXX2(23) + 2.D0*RhoXX(4)*RhoXX2(24)
        t16 = RhoXX(3)*RhoXX2(25) + 2.D0*RhoXX(2)*RhoXX2(26)
        t17 = t1 + t2 + t3 + t4 + t5 + t6 + t7 + t8
        t18 = t9 + t10 + t11 + t12 + t13 + t14 + t15 + t16
        RhoXX3(27) = 3.333333333333333D-1*(t17 + t18)
        Exc(27)    = Exc(27) + dRhoExc(3)*RhoXX3(27) 
        Vxc(27)    = Vxc(27) + dRhoVxc(3)*RhoXX3(27) 
! 
        t1 = RhoXX(9)*RhoXX3(1) + 2.D0*RhoXX(8)*RhoXX3(2)
        t2 = RhoXX(7)*RhoXX3(3) + 2.D0*RhoXX(6)*RhoXX3(4)
        t3 = 4.D0*RhoXX(5)*RhoXX3(5) + 2.D0*RhoXX(4)*RhoXX3(6)
        t4 = RhoXX(3)*RhoXX3(7) + 2.D0*RhoXX(2)*RhoXX3(8)
        RhoXX4(9) = 2.5D-1*(t1 + t2 + t3 + t4)
        Exc(9)    = Exc(9) + dRhoExc(4)*RhoXX4(9) 
        Vxc(9)    = Vxc(9) + dRhoVxc(4)*RhoXX4(9) 
        t1 = RhoXX(15)*RhoXX3(1) + 2.D0*RhoXX(14)*RhoXX3(2)
        t2 = RhoXX(13)*RhoXX3(3)
        t3 = RhoXX(12)*RhoXX3(4) + 2.D0*RhoXX(11)*RhoXX3(5)
        t4 = RhoXX(10)*RhoXX3(6)
        t5 = RhoXX(6)*RhoXX3(10) + 2.D0*RhoXX(5)*RhoXX3(11)
        t6 = RhoXX(4)*RhoXX3(12)
        t7 = RhoXX(3)*RhoXX3(13) + 2.D0*RhoXX(2)*RhoXX3(14)
        t8 = t1 + t2 + t3 + t4 + t5 + t6 + t7
        RhoXX4(15) = 2.5D-1*t8
        Exc(15)    = Exc(15) + dRhoExc(4)*RhoXX4(15) 
        Vxc(15)    = Vxc(15) + dRhoVxc(4)*RhoXX4(15) 
        t1 = RhoXX(17)*RhoXX3(1) + RhoXX(16)*RhoXX3(2)
        t2 = 2.D0*RhoXX(14)*RhoXX3(4)
        t3 = 2.D0*RhoXX(13)*RhoXX3(5) + RhoXX(11)*RhoXX3(7)
        t4 = RhoXX(10)*RhoXX3(8) + RhoXX(8)*RhoXX3(10) + RhoXX(7)*RhoXX3(11)
        t5 = 2.D0*RhoXX(5)*RhoXX3(13)
        t6 = 2.D0*RhoXX(4)*RhoXX3(14) + RhoXX(2)*RhoXX3(16)
        RhoXX4(17) = 2.5D-1*(t1 + t2 + t3 + t4 + t5 + t6)
        Exc(17)    = Exc(17) + dRhoExc(4)*RhoXX4(17) 
        Vxc(17)    = Vxc(17) + dRhoVxc(4)*RhoXX4(17) 
        t1 = RhoXX(18)*RhoXX3(1) + 2.D0*RhoXX(17)*RhoXX3(2)
        t2 = RhoXX(16)*RhoXX3(3) + 2.D0*RhoXX(15)*RhoXX3(4)
        t3 = 4.D0*RhoXX(14)*RhoXX3(5) + 2.D0*RhoXX(13)*RhoXX3(6)
        t4 = RhoXX(12)*RhoXX3(7) + 2.D0*RhoXX(11)*RhoXX3(8)
        t5 = RhoXX(10)*RhoXX3(9) + RhoXX(9)*RhoXX3(10)
        t6 = 2.D0*RhoXX(8)*RhoXX3(11) + RhoXX(7)*RhoXX3(12)
        t7 = 2.D0*RhoXX(6)*RhoXX3(13) + 4.D0*RhoXX(5)*RhoXX3(14)
        t8 = 2.D0*RhoXX(4)*RhoXX3(15)
        t9 = RhoXX(3)*RhoXX3(16) + 2.D0*RhoXX(2)*RhoXX3(17)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX4(18) = 2.5D-1*(t10 + t11)
        Exc(18)    = Exc(18) + dRhoExc(4)*RhoXX4(18) 
        Vxc(18)    = Vxc(18) + dRhoVxc(4)*RhoXX4(18) 
        t1 = RhoXX(21)*RhoXX3(1) + 2.D0*RhoXX(20)*RhoXX3(2)
        t2 = RhoXX(19)*RhoXX3(3) + 2.D0*RhoXX(12)*RhoXX3(10)
        t3 = 4.D0*RhoXX(11)*RhoXX3(11) + 2.D0*RhoXX(10)*RhoXX3(12)
        t4 = RhoXX(3)*RhoXX3(19) + 2.D0*RhoXX(2)*RhoXX3(20)
        RhoXX4(21) = 2.5D-1*(t1 + t2 + t3 + t4)
        Exc(21)    = Exc(21) + dRhoExc(4)*RhoXX4(21) 
        Vxc(21)    = Vxc(21) + dRhoVxc(4)*RhoXX4(21) 
        t1 = RhoXX(23)*RhoXX3(1) + RhoXX(22)*RhoXX3(2)
        t2 = RhoXX(20)*RhoXX3(4)
        t3 = RhoXX(19)*RhoXX3(5) + 2.D0*RhoXX(14)*RhoXX3(10)
        t4 = 2.D0*RhoXX(13)*RhoXX3(11)
        t5 = 2.D0*RhoXX(11)*RhoXX3(13) + 2.D0*RhoXX(10)*RhoXX3(14)
        t6 = RhoXX(5)*RhoXX3(19) + RhoXX(4)*RhoXX3(20) + RhoXX(2)*RhoXX3(22)
        RhoXX4(23) = 2.5D-1*(t1 + t2 + t3 + t4 + t5 + t6)
        Exc(23)    = Exc(23) + dRhoExc(4)*RhoXX4(23) 
        Vxc(23)    = Vxc(23) + dRhoVxc(4)*RhoXX4(23) 
        t1 = RhoXX(24)*RhoXX3(1) + 2.D0*RhoXX(23)*RhoXX3(2)
        t2 = RhoXX(22)*RhoXX3(3) + RhoXX(21)*RhoXX3(4)
        t3 = 2.D0*RhoXX(20)*RhoXX3(5) + RhoXX(19)*RhoXX3(6)
        t4 = 2.D0*RhoXX(15)*RhoXX3(10) + 4.D0*RhoXX(14)*RhoXX3(11)
        t5 = 2.D0*RhoXX(13)*RhoXX3(12) + 2.D0*RhoXX(12)*RhoXX3(13)
        t6 = 4.D0*RhoXX(11)*RhoXX3(14) + 2.D0*RhoXX(10)*RhoXX3(15)
        t7 = RhoXX(6)*RhoXX3(19) + 2.D0*RhoXX(5)*RhoXX3(20)
        t8 = RhoXX(4)*RhoXX3(21)
        t9 = RhoXX(3)*RhoXX3(22) + 2.D0*RhoXX(2)*RhoXX3(23)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX4(24) = 2.5D-1*(t10 + t11)
        Exc(24)    = Exc(24) + dRhoExc(4)*RhoXX4(24) 
        Vxc(24)    = Vxc(24) + dRhoVxc(4)*RhoXX4(24) 
        t1 = RhoXX(25)*RhoXX3(1) + 2.D0*RhoXX(22)*RhoXX3(4)
        t2 = RhoXX(19)*RhoXX3(7) + 2.D0*RhoXX(16)*RhoXX3(10)
        t3 = 4.D0*RhoXX(13)*RhoXX3(13) + 2.D0*RhoXX(10)*RhoXX3(16)
        t4 = RhoXX(7)*RhoXX3(19) + 2.D0*RhoXX(4)*RhoXX3(22)
        RhoXX4(25) = 2.5D-1*(t1 + t2 + t3 + t4)
        Exc(25)    = Exc(25) + dRhoExc(4)*RhoXX4(25) 
        Vxc(25)    = Vxc(25) + dRhoVxc(4)*RhoXX4(25) 
        t1 = RhoXX(26)*RhoXX3(1) + RhoXX(25)*RhoXX3(2)
        t2 = 2.D0*RhoXX(23)*RhoXX3(4) + 2.D0*RhoXX(22)*RhoXX3(5)
        t3 = RhoXX(20)*RhoXX3(7) + RhoXX(19)*RhoXX3(8)
        t4 = 2.D0*RhoXX(17)*RhoXX3(10) + 2.D0*RhoXX(16)*RhoXX3(11)
        t5 = 4.D0*RhoXX(14)*RhoXX3(13) + 4.D0*RhoXX(13)*RhoXX3(14)
        t6 = 2.D0*RhoXX(11)*RhoXX3(16) + 2.D0*RhoXX(10)*RhoXX3(17)
        t7 = RhoXX(8)*RhoXX3(19) + RhoXX(7)*RhoXX3(20)
        t8 = 2.D0*RhoXX(5)*RhoXX3(22)
        t9 = 2.D0*RhoXX(4)*RhoXX3(23) + RhoXX(2)*RhoXX3(25)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX4(26) = 2.5D-1*(t10 + t11)
        Exc(26)    = Exc(26) + dRhoExc(4)*RhoXX4(26) 
        Vxc(26)    = Vxc(26) + dRhoVxc(4)*RhoXX4(26) 
        t1 = RhoXX(27)*RhoXX3(1)
        t2 = 2.D0*RhoXX(26)*RhoXX3(2) + RhoXX(25)*RhoXX3(3)
        t3 = 2.D0*RhoXX(24)*RhoXX3(4)
        t4 = 4.D0*RhoXX(23)*RhoXX3(5) + 2.D0*RhoXX(22)*RhoXX3(6)
        t5 = RhoXX(21)*RhoXX3(7)
        t6 = 2.D0*RhoXX(20)*RhoXX3(8) + RhoXX(19)*RhoXX3(9)
        t7 = 2.D0*RhoXX(18)*RhoXX3(10) + 4.D0*RhoXX(17)*RhoXX3(11)
        t8 = 2.D0*RhoXX(16)*RhoXX3(12) + 4.D0*RhoXX(15)*RhoXX3(13)
        t9 = 8.D0*RhoXX(14)*RhoXX3(14)
        t10 = 4.D0*RhoXX(13)*RhoXX3(15) + 2.D0*RhoXX(12)*RhoXX3(16)
        t11 = 4.D0*RhoXX(11)*RhoXX3(17)
        t12 = 2.D0*RhoXX(10)*RhoXX3(18) + RhoXX(9)*RhoXX3(19)
        t13 = 2.D0*RhoXX(8)*RhoXX3(20)
        t14 = RhoXX(7)*RhoXX3(21) + 2.D0*RhoXX(6)*RhoXX3(22)
        t15 = 4.D0*RhoXX(5)*RhoXX3(23) + 2.D0*RhoXX(4)*RhoXX3(24)
        t16 = RhoXX(3)*RhoXX3(25) + 2.D0*RhoXX(2)*RhoXX3(26)
        t17 = t1 + t2 + t3 + t4 + t5 + t6 + t7 + t8
        t18 = t9 + t10 + t11 + t12 + t13 + t14 + t15 + t16
        RhoXX4(27) = 2.5D-1*(t17 + t18)
        Exc(27)    = Exc(27) + dRhoExc(4)*RhoXX4(27) 
        Vxc(27)    = Vxc(27) + dRhoVxc(4)*RhoXX4(27) 
! 
        t1 = RhoXX(18)*RhoXX4(1) + 2.D0*RhoXX(17)*RhoXX4(2)
        t2 = RhoXX(16)*RhoXX4(3) + 2.D0*RhoXX(15)*RhoXX4(4)
        t3 = 4.D0*RhoXX(14)*RhoXX4(5) + 2.D0*RhoXX(13)*RhoXX4(6)
        t4 = RhoXX(12)*RhoXX4(7) + 2.D0*RhoXX(11)*RhoXX4(8)
        t5 = RhoXX(10)*RhoXX4(9) + RhoXX(9)*RhoXX4(10)
        t6 = 2.D0*RhoXX(8)*RhoXX4(11) + RhoXX(7)*RhoXX4(12)
        t7 = 2.D0*RhoXX(6)*RhoXX4(13) + 4.D0*RhoXX(5)*RhoXX4(14)
        t8 = 2.D0*RhoXX(4)*RhoXX4(15)
        t9 = RhoXX(3)*RhoXX4(16) + 2.D0*RhoXX(2)*RhoXX4(17)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX5(18) = 2.D-1*(t10 + t11)
        Exc(18)    = Exc(18) + dRhoExc(5)*RhoXX5(18) 
        Vxc(18)    = Vxc(18) + dRhoVxc(5)*RhoXX5(18) 
        t1 = RhoXX(24)*RhoXX4(1) + 2.D0*RhoXX(23)*RhoXX4(2)
        t2 = RhoXX(22)*RhoXX4(3) + RhoXX(21)*RhoXX4(4)
        t3 = 2.D0*RhoXX(20)*RhoXX4(5) + RhoXX(19)*RhoXX4(6)
        t4 = 2.D0*RhoXX(15)*RhoXX4(10) + 4.D0*RhoXX(14)*RhoXX4(11)
        t5 = 2.D0*RhoXX(13)*RhoXX4(12) + 2.D0*RhoXX(12)*RhoXX4(13)
        t6 = 4.D0*RhoXX(11)*RhoXX4(14) + 2.D0*RhoXX(10)*RhoXX4(15)
        t7 = RhoXX(6)*RhoXX4(19) + 2.D0*RhoXX(5)*RhoXX4(20)
        t8 = RhoXX(4)*RhoXX4(21)
        t9 = RhoXX(3)*RhoXX4(22) + 2.D0*RhoXX(2)*RhoXX4(23)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX5(24) = 2.D-1*(t10 + t11)
        Exc(24)    = Exc(24) + dRhoExc(5)*RhoXX5(24) 
        Vxc(24)    = Vxc(24) + dRhoVxc(5)*RhoXX5(24) 
        t1 = RhoXX(26)*RhoXX4(1) + RhoXX(25)*RhoXX4(2)
        t2 = 2.D0*RhoXX(23)*RhoXX4(4) + 2.D0*RhoXX(22)*RhoXX4(5)
        t3 = RhoXX(20)*RhoXX4(7) + RhoXX(19)*RhoXX4(8)
        t4 = 2.D0*RhoXX(17)*RhoXX4(10) + 2.D0*RhoXX(16)*RhoXX4(11)
        t5 = 4.D0*RhoXX(14)*RhoXX4(13) + 4.D0*RhoXX(13)*RhoXX4(14)
        t6 = 2.D0*RhoXX(11)*RhoXX4(16) + 2.D0*RhoXX(10)*RhoXX4(17)
        t7 = RhoXX(8)*RhoXX4(19) + RhoXX(7)*RhoXX4(20)
        t8 = 2.D0*RhoXX(5)*RhoXX4(22)
        t9 = 2.D0*RhoXX(4)*RhoXX4(23) + RhoXX(2)*RhoXX4(25)
        t10 = t1 + t2 + t3 + t4
        t11 = t5 + t6 + t7 + t8 + t9
        RhoXX5(26) = 2.D-1*(t10 + t11)
        Exc(26)    = Exc(26) + dRhoExc(5)*RhoXX5(26) 
        Vxc(26)    = Vxc(26) + dRhoVxc(5)*RhoXX5(26) 
        t1 = RhoXX(27)*RhoXX4(1)
        t2 = 2.D0*RhoXX(26)*RhoXX4(2) + RhoXX(25)*RhoXX4(3)
        t3 = 2.D0*RhoXX(24)*RhoXX4(4)
        t4 = 4.D0*RhoXX(23)*RhoXX4(5) + 2.D0*RhoXX(22)*RhoXX4(6)
        t5 = RhoXX(21)*RhoXX4(7)
        t6 = 2.D0*RhoXX(20)*RhoXX4(8) + RhoXX(19)*RhoXX4(9)
        t7 = 2.D0*RhoXX(18)*RhoXX4(10) + 4.D0*RhoXX(17)*RhoXX4(11)
        t8 = 2.D0*RhoXX(16)*RhoXX4(12) + 4.D0*RhoXX(15)*RhoXX4(13)
        t9 = 8.D0*RhoXX(14)*RhoXX4(14)
        t10 = 4.D0*RhoXX(13)*RhoXX4(15) + 2.D0*RhoXX(12)*RhoXX4(16)
        t11 = 4.D0*RhoXX(11)*RhoXX4(17)
        t12 = 2.D0*RhoXX(10)*RhoXX4(18) + RhoXX(9)*RhoXX4(19)
        t13 = 2.D0*RhoXX(8)*RhoXX4(20)
        t14 = RhoXX(7)*RhoXX4(21) + 2.D0*RhoXX(6)*RhoXX4(22)
        t15 = 4.D0*RhoXX(5)*RhoXX4(23) + 2.D0*RhoXX(4)*RhoXX4(24)
        t16 = RhoXX(3)*RhoXX4(25) + 2.D0*RhoXX(2)*RhoXX4(26)
        t17 = t1 + t2 + t3 + t4 + t5 + t6 + t7 + t8
        t18 = t9 + t10 + t11 + t12 + t13 + t14 + t15 + t16
        RhoXX5(27) = 2.D-1*(t17 + t18)
        Exc(27)    = Exc(27) + dRhoExc(5)*RhoXX5(27) 
        Vxc(27)    = Vxc(27) + dRhoVxc(5)*RhoXX5(27) 
! 
        t1 = RhoXX(27)*RhoXX5(1)
        t2 = 2.D0*RhoXX(26)*RhoXX5(2) + RhoXX(25)*RhoXX5(3)
        t3 = 2.D0*RhoXX(24)*RhoXX5(4)
        t4 = 4.D0*RhoXX(23)*RhoXX5(5) + 2.D0*RhoXX(22)*RhoXX5(6)
        t5 = RhoXX(21)*RhoXX5(7)
        t6 = 2.D0*RhoXX(20)*RhoXX5(8) + RhoXX(19)*RhoXX5(9)
        t7 = 2.D0*RhoXX(18)*RhoXX5(10) + 4.D0*RhoXX(17)*RhoXX5(11)
        t8 = 2.D0*RhoXX(16)*RhoXX5(12) + 4.D0*RhoXX(15)*RhoXX5(13)
        t9 = 8.D0*RhoXX(14)*RhoXX5(14)
        t10 = 4.D0*RhoXX(13)*RhoXX5(15) + 2.D0*RhoXX(12)*RhoXX5(16)
        t11 = 4.D0*RhoXX(11)*RhoXX5(17)
        t12 = 2.D0*RhoXX(10)*RhoXX5(18) + RhoXX(9)*RhoXX5(19)
        t13 = 2.D0*RhoXX(8)*RhoXX5(20)
        t14 = RhoXX(7)*RhoXX5(21) + 2.D0*RhoXX(6)*RhoXX5(22)
        t15 = 4.D0*RhoXX(5)*RhoXX5(23) + 2.D0*RhoXX(4)*RhoXX5(24)
        t16 = RhoXX(3)*RhoXX5(25) + 2.D0*RhoXX(2)*RhoXX5(26)
        t17 = t1 + t2 + t3 + t4 + t5 + t6 + t7 + t8
        t18 = t9 + t10 + t11 + t12 + t13 + t14 + t15 + t16
        RhoXX6(27) = 1.666666666666667D-1*(t17 + t18)
        Exc(27)    = Exc(27) + dRhoExc(6)*RhoXX6(27) 
        Vxc(27)    = Vxc(27) + dRhoVxc(6)*RhoXX6(27) 
! 
