        Tmp(1) = Node%Co(1)*LamX(0)*LamY(0)*LamZ(0)
        Tmp(2) = -1.D0*Node%Co(2)*LamX(1)*LamY(0)*LamZ(0)
        Tmp(3) = Node%Co(5)*LamX(2)*LamY(0)*LamZ(0)
        Tmp(4) = -1.D0*Node%Co(3)*LamX(0)*LamY(1)*LamZ(0)
        Tmp(5) = Node%Co(6)*LamX(1)*LamY(1)*LamZ(0)
        Tmp(6) = Node%Co(7)*LamX(0)*LamY(2)*LamZ(0)
        Tmp(7) = -1.D0*Node%Co(4)*LamX(0)*LamY(0)*LamZ(1)
        Tmp(8) = Node%Co(8)*LamX(1)*LamY(0)*LamZ(1)
        Tmp(9) = Node%Co(9)*LamX(0)*LamY(1)*LamZ(1)
        Tmp(10) = Node%Co(10)*LamX(0)*LamY(0)*LamZ(2) + RhoSum(1)
        Tmp(11) = Tmp(1) + Tmp(2) + Tmp(3) + Tmp(4) + Tmp(5)
        Tmp(12) = Tmp(6) + Tmp(7) + Tmp(8) + Tmp(9) + Tmp(10)
        RhoSum(1)  = Tmp(11) + Tmp(12)
        Tmp(1) = Node%Co(1)*LamX(1)*LamY(0)*LamZ(0)
        Tmp(2) = -1.D0*Node%Co(2)*LamX(2)*LamY(0)*LamZ(0)
        Tmp(3) = Node%Co(5)*LamX(3)*LamY(0)*LamZ(0)
        Tmp(4) = -1.D0*Node%Co(3)*LamX(1)*LamY(1)*LamZ(0)
        Tmp(5) = Node%Co(6)*LamX(2)*LamY(1)*LamZ(0)
        Tmp(6) = Node%Co(7)*LamX(1)*LamY(2)*LamZ(0)
        Tmp(7) = -1.D0*Node%Co(4)*LamX(1)*LamY(0)*LamZ(1)
        Tmp(8) = Node%Co(8)*LamX(2)*LamY(0)*LamZ(1)
        Tmp(9) = Node%Co(9)*LamX(1)*LamY(1)*LamZ(1)
        Tmp(10) = Node%Co(10)*LamX(1)*LamY(0)*LamZ(2) + RhoSum(2)
        Tmp(11) = Tmp(1) + Tmp(2) + Tmp(3) + Tmp(4) + Tmp(5)
        Tmp(12) = Tmp(6) + Tmp(7) + Tmp(8) + Tmp(9) + Tmp(10)
        RhoSum(2)  = Tmp(11) + Tmp(12)
        Tmp(1) = Node%Co(1)*LamX(0)*LamY(1)*LamZ(0)
        Tmp(2) = -1.D0*Node%Co(2)*LamX(1)*LamY(1)*LamZ(0)
        Tmp(3) = Node%Co(5)*LamX(2)*LamY(1)*LamZ(0)
        Tmp(4) = -1.D0*Node%Co(3)*LamX(0)*LamY(2)*LamZ(0)
        Tmp(5) = Node%Co(6)*LamX(1)*LamY(2)*LamZ(0)
        Tmp(6) = Node%Co(7)*LamX(0)*LamY(3)*LamZ(0)
        Tmp(7) = -1.D0*Node%Co(4)*LamX(0)*LamY(1)*LamZ(1)
        Tmp(8) = Node%Co(8)*LamX(1)*LamY(1)*LamZ(1)
        Tmp(9) = Node%Co(9)*LamX(0)*LamY(2)*LamZ(1)
        Tmp(10) = Node%Co(10)*LamX(0)*LamY(1)*LamZ(2) + RhoSum(3)
        Tmp(11) = Tmp(1) + Tmp(2) + Tmp(3) + Tmp(4) + Tmp(5)
        Tmp(12) = Tmp(6) + Tmp(7) + Tmp(8) + Tmp(9) + Tmp(10)
        RhoSum(3)  = Tmp(11) + Tmp(12)
        Tmp(1) = Node%Co(1)*LamX(1)*LamY(1)*LamZ(0)
        Tmp(2) = -1.D0*Node%Co(2)*LamX(2)*LamY(1)*LamZ(0)
        Tmp(3) = Node%Co(5)*LamX(3)*LamY(1)*LamZ(0)
        Tmp(4) = -1.D0*Node%Co(3)*LamX(1)*LamY(2)*LamZ(0)
        Tmp(5) = Node%Co(6)*LamX(2)*LamY(2)*LamZ(0)
        Tmp(6) = Node%Co(7)*LamX(1)*LamY(3)*LamZ(0)
        Tmp(7) = -1.D0*Node%Co(4)*LamX(1)*LamY(1)*LamZ(1)
        Tmp(8) = Node%Co(8)*LamX(2)*LamY(1)*LamZ(1)
        Tmp(9) = Node%Co(9)*LamX(1)*LamY(2)*LamZ(1)
        Tmp(10) = Node%Co(10)*LamX(1)*LamY(1)*LamZ(2) + RhoSum(4)
        Tmp(11) = Tmp(1) + Tmp(2) + Tmp(3) + Tmp(4) + Tmp(5)
        Tmp(12) = Tmp(6) + Tmp(7) + Tmp(8) + Tmp(9) + Tmp(10)
        RhoSum(4)  = Tmp(11) + Tmp(12)
        Tmp(1) = Node%Co(1)*LamX(0)*LamY(0)*LamZ(1)
        Tmp(2) = -1.D0*Node%Co(2)*LamX(1)*LamY(0)*LamZ(1)
        Tmp(3) = Node%Co(5)*LamX(2)*LamY(0)*LamZ(1)
        Tmp(4) = -1.D0*Node%Co(3)*LamX(0)*LamY(1)*LamZ(1)
        Tmp(5) = Node%Co(6)*LamX(1)*LamY(1)*LamZ(1)
        Tmp(6) = Node%Co(7)*LamX(0)*LamY(2)*LamZ(1)
        Tmp(7) = -1.D0*Node%Co(4)*LamX(0)*LamY(0)*LamZ(2)
        Tmp(8) = Node%Co(8)*LamX(1)*LamY(0)*LamZ(2)
        Tmp(9) = Node%Co(9)*LamX(0)*LamY(1)*LamZ(2)
        Tmp(10) = Node%Co(10)*LamX(0)*LamY(0)*LamZ(3) + RhoSum(5)
        Tmp(11) = Tmp(1) + Tmp(2) + Tmp(3) + Tmp(4) + Tmp(5)
        Tmp(12) = Tmp(6) + Tmp(7) + Tmp(8) + Tmp(9) + Tmp(10)
        RhoSum(5)  = Tmp(11) + Tmp(12)
        Tmp(1) = Node%Co(1)*LamX(1)*LamY(0)*LamZ(1)
        Tmp(2) = -1.D0*Node%Co(2)*LamX(2)*LamY(0)*LamZ(1)
        Tmp(3) = Node%Co(5)*LamX(3)*LamY(0)*LamZ(1)
        Tmp(4) = -1.D0*Node%Co(3)*LamX(1)*LamY(1)*LamZ(1)
        Tmp(5) = Node%Co(6)*LamX(2)*LamY(1)*LamZ(1)
        Tmp(6) = Node%Co(7)*LamX(1)*LamY(2)*LamZ(1)
        Tmp(7) = -1.D0*Node%Co(4)*LamX(1)*LamY(0)*LamZ(2)
        Tmp(8) = Node%Co(8)*LamX(2)*LamY(0)*LamZ(2)
        Tmp(9) = Node%Co(9)*LamX(1)*LamY(1)*LamZ(2)
        Tmp(10) = Node%Co(10)*LamX(1)*LamY(0)*LamZ(3) + RhoSum(6)
        Tmp(11) = Tmp(1) + Tmp(2) + Tmp(3) + Tmp(4) + Tmp(5)
        Tmp(12) = Tmp(6) + Tmp(7) + Tmp(8) + Tmp(9) + Tmp(10)
        RhoSum(6)  = Tmp(11) + Tmp(12)
        Tmp(1) = Node%Co(1)*LamX(0)*LamY(1)*LamZ(1)
        Tmp(2) = -1.D0*Node%Co(2)*LamX(1)*LamY(1)*LamZ(1)
        Tmp(3) = Node%Co(5)*LamX(2)*LamY(1)*LamZ(1)
        Tmp(4) = -1.D0*Node%Co(3)*LamX(0)*LamY(2)*LamZ(1)
        Tmp(5) = Node%Co(6)*LamX(1)*LamY(2)*LamZ(1)
        Tmp(6) = Node%Co(7)*LamX(0)*LamY(3)*LamZ(1)
        Tmp(7) = -1.D0*Node%Co(4)*LamX(0)*LamY(1)*LamZ(2)
        Tmp(8) = Node%Co(8)*LamX(1)*LamY(1)*LamZ(2)
        Tmp(9) = Node%Co(9)*LamX(0)*LamY(2)*LamZ(2)
        Tmp(10) = Node%Co(10)*LamX(0)*LamY(1)*LamZ(3) + RhoSum(7)
        Tmp(11) = Tmp(1) + Tmp(2) + Tmp(3) + Tmp(4) + Tmp(5)
        Tmp(12) = Tmp(6) + Tmp(7) + Tmp(8) + Tmp(9) + Tmp(10)
        RhoSum(7)  = Tmp(11) + Tmp(12)
        Tmp(1) = Node%Co(1)*LamX(1)*LamY(1)*LamZ(1)
        Tmp(2) = -1.D0*Node%Co(2)*LamX(2)*LamY(1)*LamZ(1)
        Tmp(3) = Node%Co(5)*LamX(3)*LamY(1)*LamZ(1)
        Tmp(4) = -1.D0*Node%Co(3)*LamX(1)*LamY(2)*LamZ(1)
        Tmp(5) = Node%Co(6)*LamX(2)*LamY(2)*LamZ(1)
        Tmp(6) = Node%Co(7)*LamX(1)*LamY(3)*LamZ(1)
        Tmp(7) = -1.D0*Node%Co(4)*LamX(1)*LamY(1)*LamZ(2)
        Tmp(8) = Node%Co(8)*LamX(2)*LamY(1)*LamZ(2)
        Tmp(9) = Node%Co(9)*LamX(1)*LamY(2)*LamZ(2)
        Tmp(10) = Node%Co(10)*LamX(1)*LamY(1)*LamZ(3) + RhoSum(8)
        Tmp(11) = Tmp(1) + Tmp(2) + Tmp(3) + Tmp(4) + Tmp(5)
        Tmp(12) = Tmp(6) + Tmp(7) + Tmp(8) + Tmp(9) + Tmp(10)
        RhoSum(8)  = Tmp(11) + Tmp(12)
